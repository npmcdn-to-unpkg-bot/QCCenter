var gb={chart:null,chart2:null,chart3:null,chart4:null,chart5:null,PM25:null,AQI:null,PM10:null,CO:null,NO2:null,O3:null,SO2:null,rec_time:null},geoCoordMap={"锦江区":[104.080989,30.657689],"青羊区":[104.055731,30.667648],"金牛区":[104.043487,30.692058],"武侯区":[104.05167,30.630862],"成华区":[104.103077,30.660275],"龙泉驿区":[104.269181,30.56065],"青白江区":[104.25494,30.883438],"新都区":[104.16022,30.824223],"双流县":[103.922706,30.573243],"郫县":[103.887842,30.808752],"大邑县":[103.522397,30.586602],"温江区":[103.836776,30.697996],"蒲江县":[103.511541,30.194359],"金堂县":[104.415604,30.858417],"新津县":[103.812449,30.414284],"都江堰市":[103.627898,30.99114],"邛崃市":[103.46143,30.413271],"崇州市":[103.671049,30.631478],"彭州市":[103.941173,30.985161]},convertData=function(e){for(var t=[],a=0;a<e.length;a++){var o=geoCoordMap[e[a].name];o&&t.push(o.concat(e[a].value))}return t},convertScatterData=function(e){for(var t=[],a=0;a<e.length;a++){var o=geoCoordMap[e[a].name];o&&t.push({name:e[a].name,value:o.concat(e[a].value)})}return t},handleAQIData=function(){function e(){var e=(new Date).getTime();$.ajax({url:"assets/aqi.php?t="+e,type:"get",dataType:"json",async:!0,success:function(e){gb.PM25=[],gb.AQI=[],gb.PM10=[],gb.CO=[],gb.NO2=[],gb.O3=[],gb.SO2=[];for(var o=e.Head,r=0;r<o.length-1;r++)gb.PM25[r]={},gb.AQI[r]={},gb.PM10[r]={},gb.CO[r]={},gb.NO2[r]={},gb.O3[r]={},gb.SO2[r]={},gb.PM25[r].name=o[r].PointArea,gb.AQI[r].name=o[r].PointArea,gb.PM10[r].name=o[r].PointArea,gb.CO[r].name=o[r].PointArea,gb.NO2[r].name=o[r].PointArea,gb.O3[r].name=o[r].PointArea,gb.SO2[r].name=o[r].PointArea,""===o[r].PM25_1H&&(o[r].PM25_1H="-"),""===o[r].SO2_1H&&(o[r].SO2_1H="-"),""===o[r].NO2_1H&&(o[r].NO2_1H="-"),""===o[r].PM10_1H&&(o[r].PM10_1H="-"),""===o[r].CO_1H&&(o[r].CO_1H="-"),""===o[r].O3_1H&&(o[r].O3_1H="-"),""===o[r].AQI_1H&&(o[r].AQI_1H="-"),gb.PM25[r].value=parseFloat(o[r].PM25_1H,10),gb.AQI[r].value=parseFloat(o[r].AQI_1H,10),gb.PM10[r].value=parseFloat(o[r].PM10_1H,10),gb.CO[r].value=10*parseFloat(o[r].CO_1H,10),gb.NO2[r].value=parseFloat(o[r].NO2_1H,10),gb.O3[r].value=parseFloat(o[r].O3_1H,10),gb.SO2[r].value=parseFloat(o[r].SO2_1H,10);gb.rec_time=o[0].Rec_Time,t(),a()}})}function t(){gb.chart=echarts.init(document.getElementById("mainHeatMap")),gb.chart3=echarts.init(document.getElementById("mainHeatMap2")),$.get("assets/data/chengdu.json",function(e){echarts.registerMap("CD",e),gb.chart.setOption(option={title:{text:"成都市环境空气质量热力图",subtext:"数据来源: 成都市环境保护局\n更新时间:"+gb.rec_time.substring(0,16),sublink:"http://www.cdepb.gov.cn",textStyle:{color:"#fff",fontSize:30},x:"center"},tooltip:{trigger:"item",formatter:"{b}<br/>{c}"},legend:{x:"left",data:["AQI","PM2.5","PM10","CO","NO2","O3","SO2"],textStyle:{color:"#ccc"},orient:"vertical",selectedMode:"single",selected:{AQI:!0,PM10:!1,"PM2.5":!1}},toolbox:{show:!0,orient:"vertical",x:"right",y:"center",feature:{mark:{show:!0},dataView:{show:!0,readOnly:!1},restore:{show:!0},saveAsImage:{show:!0}}},dataRange:{min:50,max:300,text:["严重污染","优"],realtime:!0,calculable:!0,color:["orangered","yellow","lightskyblue"],textStyle:{color:"#fff"},x:"right",y:50},geo:{map:"CD",label:{emphasis:{show:!0,textStyle:{color:"#fff",fontSize:15}}},roam:!0,itemStyle:{normal:{areaColor:"#323c48",borderColor:"#111"},emphasis:{areaColor:"#2a333d"}}},series:[{name:"AQI",type:"heatmap",coordinateSystem:"geo",mapType:"CD",roam:!0,itemStyle:{normal:{label:{show:!0}},emphasis:{label:{show:!0}}},data:convertData(gb.AQI),nameMap:{"都江堰市":"都江堰"}},{name:"PM2.5",type:"heatmap",coordinateSystem:"geo",mapType:"CD",roam:!0,itemStyle:{normal:{label:{show:!0}},emphasis:{label:{show:!0}}},data:convertData(gb.PM25),nameMap:{"都江堰市":"都江堰"}},{name:"PM10",type:"heatmap",coordinateSystem:"geo",mapType:"CD",roam:!0,itemStyle:{normal:{label:{show:!0}},emphasis:{label:{show:!0}}},data:convertData(gb.PM10),nameMap:{"都江堰市":"都江堰"}},{name:"PM2.5 Top 5",type:"effectScatter",coordinateSystem:"geo",data:convertData(gb.PM25.sort(function(e,t){return t.value-e.value}).slice(0,6)),symbol:"pin",symbolSize:function(e){return e[2]/4},showEffectOn:"render",hoverAnimation:!0,zlevel:1}]}),gb.chart3.setOption(option={title:{text:"成都市环境空气质量热力图",subtext:"数据来源: 成都市环境保护局\n更新时间:"+gb.rec_time.substring(0,16),sublink:"http://www.cdepb.gov.cn",textStyle:{color:"#fff",fontSize:30},x:"center"},tooltip:{trigger:"item",formatter:"{b}<br/>{c}"},legend:{x:"left",data:["CO","NO2","O3","SO2"],textStyle:{color:"#ccc"},orient:"vertical",selectedMode:"single",selected:{CO:!0,NO2:!1,O3:!1,SO2:!1}},toolbox:{show:!0,orient:"vertical",x:"right",y:"center",feature:{mark:{show:!0},dataView:{show:!0,readOnly:!1},restore:{show:!0},saveAsImage:{show:!0}}},dataRange:{min:0,max:30,text:["严重污染","优"],realtime:!0,calculable:!0,color:["orangered","yellow","lightskyblue"],textStyle:{color:"#fff"},x:"right",y:50},geo:{map:"CD",label:{emphasis:{show:!0,textStyle:{color:"#fff",fontSize:15}}},roam:!0,itemStyle:{normal:{areaColor:"#323c48",borderColor:"#111"},emphasis:{areaColor:"#2a333d"}}},series:[{name:"CO",type:"heatmap",coordinateSystem:"geo",mapType:"CD",roam:!0,itemStyle:{normal:{label:{show:!0}},emphasis:{label:{show:!0}}},data:convertData(gb.CO),nameMap:{"都江堰市":"都江堰"}},{name:"NO2",type:"heatmap",coordinateSystem:"geo",mapType:"CD",roam:!0,itemStyle:{normal:{label:{show:!0}},emphasis:{label:{show:!0}}},data:convertData(gb.NO2),nameMap:{"都江堰市":"都江堰"}},{name:"O3",type:"heatmap",coordinateSystem:"geo",mapType:"CD",roam:!0,itemStyle:{normal:{label:{show:!0}},emphasis:{label:{show:!0}}},data:convertData(gb.O3),nameMap:{"都江堰市":"都江堰"}},{name:"SO2",type:"heatmap",coordinateSystem:"geo",mapType:"CD",roam:!0,itemStyle:{normal:{label:{show:!0}},emphasis:{label:{show:!0}}},data:convertData(gb.SO2),nameMap:{"都江堰市":"都江堰"}}]})})}function a(){gb.chart2=echarts.init(document.getElementById("mainMap")),gb.chart4=echarts.init(document.getElementById("mainMap2")),gb.chart5=echarts.init(document.getElementById("mainMap3")),$.get("assets/data/chengdu.json",function(e){echarts.registerMap("CD",e),gb.chart2.setOption(option={title:{text:"成都市环境空气质量",subtext:"数据来源: 成都市环境保护局\n更新时间:"+gb.rec_time.substring(0,16),sublink:"http://www.cdepb.gov.cn",textStyle:{color:"#fff",fontSize:30},x:"center"},tooltip:{trigger:"item",formatter:"{b}<br/>{c}"},legend:{x:"left",data:["AQI","PM2.5","PM10","CO","NO2","O3","SO2"],textStyle:{color:"#ccc"},orient:"vertical",selectedMode:"single",selected:{AQI:!0,PM10:!1,"PM2.5":!1}},toolbox:{show:!0,orient:"vertical",x:"right",y:"center",feature:{mark:{show:!0},dataView:{show:!0,readOnly:!1},restore:{show:!0},saveAsImage:{show:!0}}},dataRange:{min:50,max:300,text:["严重污染","优"],realtime:!0,calculable:!0,color:["orangered","yellow","lightskyblue"],textStyle:{color:"#fff"},x:"right",y:50},series:[{name:"AQI",type:"map",mapType:"CD",roam:!0,itemStyle:{normal:{label:{show:!0}},emphasis:{label:{show:!0}}},data:gb.AQI,nameMap:{"都江堰市":"都江堰"}},{name:"PM2.5",type:"map",mapType:"CD",roam:!0,itemStyle:{normal:{label:{show:!0}},emphasis:{label:{show:!0}}},data:gb.PM25,nameMap:{"都江堰市":"都江堰"}},{name:"PM10",type:"map",mapType:"CD",roam:!0,itemStyle:{normal:{label:{show:!0}},emphasis:{label:{show:!0}}},data:gb.PM10,nameMap:{"都江堰市":"都江堰"}}]}),gb.chart5.setOption(option={title:{text:"成都市环境空气质量",subtext:"数据来源: 成都市环境保护局\n更新时间:"+gb.rec_time.substring(0,16),sublink:"http://www.cdepb.gov.cn",textStyle:{color:"#fff",fontSize:30},x:"center"},tooltip:{trigger:"item"},legend:{x:"left",data:["AQI","PM2.5","PM10","CO","NO2","O3","SO2"],textStyle:{color:"#ccc"},orient:"vertical",selectedMode:"single",selected:{AQI:!0,PM10:!1,"PM2.5":!1}},toolbox:{show:!0,orient:"vertical",x:"right",y:"center",feature:{mark:{show:!0},dataView:{show:!0,readOnly:!1},restore:{show:!0},saveAsImage:{show:!0}}},geo:{map:"CD",label:{emphasis:{show:!1}},roam:!0,itemStyle:{normal:{areaColor:"#323c48",borderColor:"#111"},emphasis:{areaColor:"#2a333d"}}},dataRange:{min:50,max:300,text:["严重污染","优"],realtime:!0,calculable:!0,color:["orangered","yellow","lightskyblue"],textStyle:{color:"#fff"},x:"right",y:50},series:[{name:"AQI",type:"scatter",coordinateSystem:"geo",data:convertScatterData(gb.AQI),symbolSize:function(e){return e[2]/6},mapType:"CD",roam:!0,label:{normal:{formatter:"{b}",position:"right",show:!0},emphasis:{show:!0}},nameMap:{"都江堰市":"都江堰"}},{name:"PM2.5 Top 5",type:"effectScatter",coordinateSystem:"geo",data:convertData(gb.PM25.sort(function(e,t){return t.value-e.value}).slice(0,6)),symbolSize:function(e){return e[2]/6},showEffectOn:"render",hoverAnimation:!0,zlevel:1},{name:"PM2.5",type:"scatter",coordinateSystem:"geo",data:convertScatterData(gb.PM25),symbolSize:function(e){return e[2]/6},mapType:"CD",roam:!0,label:{normal:{formatter:"{b}",position:"right",show:!0},emphasis:{show:!0}},nameMap:{"都江堰市":"都江堰"}},{name:"PM10",type:"scatter",coordinateSystem:"geo",data:convertScatterData(gb.PM10),symbolSize:function(e){return e[2]/6},type:"map",mapType:"CD",roam:!0,label:{normal:{formatter:"{b}",position:"right",show:!0},emphasis:{show:!0}},nameMap:{"都江堰市":"都江堰"}}]}),gb.chart4.setOption(option={title:{text:"成都市环境空气质量",subtext:"数据来源: 成都市环境保护局\n更新时间:"+gb.rec_time.substring(0,16),sublink:"http://www.cdepb.gov.cn",textStyle:{color:"#fff",fontSize:30},x:"center"},tooltip:{trigger:"item",formatter:"{b}<br/>{c}"},legend:{x:"left",data:["AQI","PM2.5","PM10","CO","NO2","O3","SO2"],textStyle:{color:"#ccc"},orient:"vertical",selectedMode:"single",selected:{CO:!0,NO2:!1,O3:!1,SO2:!1}},toolbox:{show:!0,orient:"vertical",x:"right",y:"center",feature:{mark:{show:!0},dataView:{show:!0,readOnly:!1},restore:{show:!0},saveAsImage:{show:!0}}},dataRange:{min:0,max:30,text:["严重污染","优"],realtime:!0,calculable:!0,color:["orangered","yellow","lightskyblue"],textStyle:{color:"#fff"},x:"right",y:50},series:[{name:"CO",type:"map",mapType:"CD",roam:!0,itemStyle:{normal:{label:{show:!0}},emphasis:{label:{show:!0}}},data:gb.CO,nameMap:{"都江堰市":"都江堰"}},{name:"NO2",type:"map",mapType:"CD",roam:!0,itemStyle:{normal:{label:{show:!0}},emphasis:{label:{show:!0}}},data:gb.NO2,nameMap:{"都江堰市":"都江堰"}},{name:"O3",type:"map",mapType:"CD",roam:!0,itemStyle:{normal:{label:{show:!0}},emphasis:{label:{show:!0}}},data:gb.O3,nameMap:{"都江堰市":"都江堰"}},{name:"SO2",type:"map",mapType:"CD",roam:!0,itemStyle:{normal:{label:{show:!0}},emphasis:{label:{show:!0}}},data:gb.SO2,nameMap:{"都江堰市":"都江堰"}}]})})}return{init:function(){e()}}}();$(window).resize(function(){gb.chart.resize(),gb.chart2.resize()}),$(document).ready(function(){$("div.col-md-12").height($(window).height()),handleAQIData.init()});
//# sourceMappingURL=chengdu.min.js.map