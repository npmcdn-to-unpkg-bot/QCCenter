!function(t){t.fn.autocomplete=function(e){var i=-1,s=[];return e=t.extend({hints:[],placeholder:"Search",width:200,height:16,showButton:!0,buttonText:"Search",onSubmit:function(t){},onBlur:function(){}},e),this.each(function(){var l=t("<div></div>").addClass("autocomplete-container").css("height",2*e.height),a=t('<input type="text" autocomplete="off" name="query">').attr("placeholder",e.placeholder).addClass("autocomplete-input").css({width:e.width,height:e.height});e.showButton&&a.css("border-radius","3px 0 0 3px");var o=t("<div></div>").addClass("proposal-box").css("width",e.width+18).css("top",a.height()+20),h=t("<ul></ul>").addClass("proposal-list");if(o.append(h),a.keydown(function(l){switch(l.which){case 38:l.preventDefault(),t("ul.proposal-list li").removeClass("selected"),i-1>=0?(i--,t("ul.proposal-list li:eq("+i+")").addClass("selected")):i=-1;break;case 40:l.preventDefault(),i+1<s.length&&(t("ul.proposal-list li").removeClass("selected"),i++,t("ul.proposal-list li:eq("+i+")").addClass("selected"));break;case 13:if(i>-1){var o=t("ul.proposal-list li:eq("+i+")").html();a.val(o)}i=-1,h.empty(),e.onSubmit(a.val());break;case 27:i=-1,h.empty(),a.val("")}}),a.bind("change paste keyup",function(l){if(13!=l.which&&27!=l.which&&38!=l.which&&40!=l.which&&(s=[],i=-1,h.empty(),""!=a.val())){h.empty();for(var o in e.hints)if(-1!==e.hints[o].indexOf(a.val())){s.push(e.hints[o]);var n=t("<li></li>").html(e.hints[o]).addClass("proposal").click(function(){a.val(t(this).html()),h.empty(),e.onSubmit(a.val())}).mouseenter(function(){t(this).addClass("selected")}).mouseleave(function(){t(this).removeClass("selected")});h.append(n)}}}),a.blur(function(t){i=-1,e.onBlur()}),l.append(a),l.append(o),e.showButton){var n=t("<div></div>").addClass("autocomplete-button").html(e.buttonText).css({height:e.height+2,"line-height":e.height+"px"}).click(function(){h.empty(),e.onSubmit(a.val())});l.append(n)}t(this).append(l),e.showButton&&l.css("width",e.width+n.width()+50)}),this}}(jQuery);
