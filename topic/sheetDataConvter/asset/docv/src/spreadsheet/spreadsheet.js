define("dt/lib/Set",["require","jquery"],function(require){function e(e){return Object(e)===e}var t=require("jquery"),n="__isDTLibSet",i=function(e){this._valueSet={},this[n]=!0,this.reset(e)};return i.getSet=function(e){return i.isSet(e)?e:new i(e)},i.isSet=function(t){return e(t)&&!!t[n]},i.prototype={add:function(e){return t.extend(this._valueSet,this._normalize(e)),this},union:function(e){return this.add(e)},reset:function(e){return this._valueSet=this._normalize(e),this},contains:function(e){var t=this._normalize(e);for(var n in t)if(t.hasOwnProperty(n)&&!this._valueSet.hasOwnProperty(n))return!1;return!0},intersects:function(e){var t=this._normalize(e),n=[];for(var r in t)if(t.hasOwnProperty(r)&&this._valueSet.hasOwnProperty(r))n.push(r);return new i(n)},subtracts:function(e){var t=this._normalize(e),n=[];for(var r in this._valueSet)if(this._valueSet.hasOwnProperty(r)&&!t.hasOwnProperty(r))n.push(r);return new i(n)},isEmpty:function(){return 0===this.count()},count:function(){var e=0;for(var t in this._valueSet)if(this._valueSet.hasOwnProperty(t))e++;return e},list:function(){var e=this._valueSet,t=[];for(var n in e)if(e.hasOwnProperty(n))t.push(n);return t},clone:function(){return new i(this)},filter:function(e){var t=this._valueSet,n=[];for(var r in t)if(t.hasOwnProperty(r))if(e(r))n.push(r);return new i(n)},map:function(e){var t=this._valueSet,n=[];for(var r in t)if(t.hasOwnProperty(r))n.push(e(r));return new i(n)},classify:function(t,n){var r=this._valueSet,o={};for(var s in r)if(r.hasOwnProperty(s)){var a=t(s);if(!e(a)){var l={};l[a]=s,a=l}for(var u in a)if(a.hasOwnProperty(u)){var c=o[u]||(o[u]=new i);c.add(a[u])}}for(var f=0,h=(n||[]).length;h>f;f++)if(!o[n[f]])o[n[f]]=new i;return o},_normalize:function(e){var n={},r=t.type(e);if(!e)return n;if(i.isSet(e))e=e.list();else if("string"===r){e=e.split(",");for(var o=0,s=e.length;s>o;o++)e[o]=t.trim(e[o])}else if("array"!==r)throw new Error;for(var o=0,s=e.length;s>o;o++)n[e[o]]=1;return n}},i.prototype.constructor=i,i}),define("dt/lib/base",["require","jquery"],function(require){function e(e){var n={},i=t.type(e);if("array"===i)for(var r=0,o=e.length;o>r;r++)n[e[r]]=e[r];else if("object"===i)for(var r in e)if(e.hasOwnProperty(r))n[e[r]]=r;return n}var t=require("jquery"),n=Array.prototype.slice,i=Array.prototype.indexOf,r=/^[\s\t\xa0\u3000]*$/,o="-",s="-",a="__is__component__",l="__component__",u={},c=0,f=u.uncurry=function(e){return function(){return Function.call.apply(e,arguments)}};u.arraySlice=f(n),u.curry=function(e){var t=n.call(arguments,1);return function(){return e.apply(this,t.concat(n.call(arguments)))}},u.ieVersion=/msie (\d+\.\d+)/i.test(navigator.userAgent)?document.documentMode||+RegExp.$1:void 0,u.encodeHTML=function(e){return null==e?"":String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")},u.decodeHTML=function(e){if(null==e)return"";var t=String(e).replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&");return t.replace(/&#([\d]+);/g,function(e,t){return String.fromCharCode(parseInt(t,10))})},u.assert=function(e,t){if(!e)throw new Error(t||"assert fail!")},u.objForEach=function(e,t){var n;for(n in e)if(e.hasOwnProperty(n))t(n,e[n]);if(h)for(var i=0;n=p[i++];)if(e[n]!==Object.prototype[n])t(n,e[n])};var h=!{toString:1}.propertyIsEnumerable("toString"),p=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];u.localUID=function(){return c++},u.makeInner=function(){var e="__private_d_"+u.localUID(),t=function(t){return t[e]||(t[e]={})};return t.attach=function(t){var n="__private_s_",i="__private_attach_",r=t.prototype;if(r.hasOwnProperty(i))e=r[i];else if(r[i])e=r[i]=n+(Number(r[i].split("_s_")[1])+1);else e=r[i]=n+"0";return t},t},u.isComponent=function(e,t){if(Object(e)!==e)return!1;if(t)e[a]=1;return!!e[a]},u.getComponent=function(e){if(u.isJQuery(e))e=e[0];if(!e)return!1;else return e[l]},u.bindComponent=function(e,t){if(u.isJQuery(e))e=e[0];if(!e)return!1;if(u.isComponent(t))e[l]=t;else if(t===!1)e[l]=null;return e[l]},u.isJQuery=function(e){return e instanceof t},u.toInt=function(e){return parseInt(e,10)},u.assign=function(t,n,i,r,o){var s=e(i),a=e(r);for(var l in n)if(n.hasOwnProperty(l)&&!a.hasOwnProperty(l)){var u=null;if(!i)u=l;else if(s.hasOwnProperty(l))u=s[l];if(null!=u){if(o&&t.hasOwnProperty(u))throw new Error('Target attr "'+u+'" exists!');t[u]=n[l]}}return t};var d=u.isObject=function(e){return Object(e)===e};return u.isEmptyObj=function(e){if(!d(e))return!1;for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},u.isNaN=function(e){return e!==e},u.arrayIndexOf=function(e,t,n){if(!e)return-1;if(arguments.length<3&&"function"==typeof i)return i.call(e,t);for(var r=0,o=e.length;o>r;r++)if(arguments.length<3&&e[r]===t||d(e[r])&&e[r][n]===t)return r;return-1},u.arrayRemoveItem=function(e,t){var n=u.arrayIndexOf(e,t);if(n>0)e.splice(n,1);else if(0===n)e.shift()},u.arrayMap=function(e,t){for(var n=[],i=0,r=(e||[]).length;r>i;i++)n.push(t(e[i]));return n},u.arrayEquals=function(e,n){if(!t.isArray(e)||!t.isArray(n)||e.length!==n.length)return!1;for(var i=0,r=e.length;r>i;i++)if(e[i]!==n[i])return!1;return!0},u.objectKeys=function(e){var t=[];if(!u.isObject(e))return t;for(var n in e)if(e.hasOwnProperty(n))t.push(n);return t},u.objHasAttr=function(e,n){if("string"===t.type(n))n=[n];for(var i=0,r=n.length;r>i;i++)if(e.hasOwnProperty[n[i]])return!0;return!1},u.diffObjects=function(e,n){function i(){return r.push({path:o.join("."),obj1:e,obj2:n}),r}var r=arguments[2]||[],o=arguments[3]||[],s=t.type(e),a=t.type(n);if(s!==a)return i();if("array"===s){if(e.length!==n.length)return i();for(var l=0,c=e.length;c>l;l++)o.push(l),u.diffObjects(e[l],n[l],r,o),o.pop()}else if("object"===s&&"object"===a){var f=u.objectKeys(e),h=u.objectKeys(n);if(!u.arrayEquals(f,h))return i();for(var l=0,c=f.length;c>l;l++){var p=f[l];o.push(p),u.diffObjects(e[p],n[p],r,o),o.pop()}}else if("date"===s){if(e.getTime()!==n.getTime())return i()}else if("regexp"===s){if(e.toString()!==n.toString())return i()}else if(e!==n)return i();return r},u.isBlank=function(e){return null==e||r.test(e)},u.toEcValue=function(e){return null==e?o:e},u.fromEcValue=function(e){return e===o?null:e},u.toNotEmptyEcName=function(e){return u.isBlank(e)?s:e},u.isSupportBase64=function(){var e=new Image,t=!0;return e.onload=e.onerror=function(){if(1!==this.width||1!==this.height)t=!1},e.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==",t}(),u.flashVersion=function(){var e;try{e=navigator.plugins["Shockwave Flash"],e=e.description}catch(t){try{e=new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version")}catch(n){e="0.0"}}return e=e.match(/\d+/g),parseFloat(e[0]+"."+e[1])}(),u.supportTransition=function(){var e=document.createElement("p").style,t="transition"in e||"WebkitTransition"in e||"MozTransition"in e||"msTransition"in e||"OTransition"in e;return e=null,t}(),u.noop=new Function,u.onlyHasProperty=function(e,n){var i=!0;if(null==n)return!1;if(!t.isArray(n))n=[n];for(var r in e)if(e.hasOwnProperty(r)&&-1===u.arrayIndexOf(n,r))i=!1;return i},u}),define("dt/lib/json",["require"],function(){var e={};return e.parseJSONLaxly=function(e,t){return new Function("return ("+e+");").call(t)},e}),define("dt/lib/throttle",["require"],function(){var e={};return e.throttle=function(e,t,n,i){function r(r){function p(){c=(new Date).getTime(),f=null,(h?e:e[r]).apply(s,a||[])}return function(){if(l=(new Date).getTime(),s=this,a=arguments,o=l-(i?u:c)-t,clearTimeout(f),i){if(n)f=setTimeout(p,t);else if(o>=0)p()}else if(o>=0)p();else if(n)f=setTimeout(p,-o);u=l}}var o,s,a,l=(new Date).getTime(),u=0,c=0,f=null,h="function"==typeof e;if(t=t||0,h)return r();else{for(var p=[],d=0;d<e.length;d++)p[d]=r(d);return p}},e.fixedRate=function(t,n){return null!=n?e.throttle(t,n,!0,!1):t},e.debounce=function(t,n){return null!=n?e.throttle(t,n,!0,!0):t},e}),define("dt/lib/dataDriven",["require","./base","jquery","./throttle"],function(require){function e(e,t){var n=null===e||a.type(e)in v;return n?e===t:!1}function t(e,t){var n,i,r=[],o=this[h+"children"];for(n=0;i=o[n];n++)r.push(i.getCallback());for(r=t(r,e),n=0;i=o[n];n++)i.setCallback(r[n])}function n(e,t,n,i){if(arguments.length>1){this[h+"currValueInfo"]=n;var o=this();if(i&&i.force||this.isDifferent(o[e],t))(!i||!i.silent)&&this.valueWillMutate(),o[e]=t,(!i||!i.silent)&&this.valueHasMutated();r(this,i)}else return this()[e]}function i(e){return{ob:1,obArray:1,obHash:1}.hasOwnProperty(T(e))}function r(e,t){for(var n=t&&t.volatiles||[],i=e[h+"currValueInfo"],r=0,o=n.length;o>r;r++)delete i[n[r]]}var o,s=require("./base"),a=require("jquery"),l=require("./throttle"),u=Array.prototype.slice,c={},f="__ob__type__",h="__prop__",p="change",d="arrayChange";c.subscribable=function(e){s.assign(e,g),e._subscriptions={}};var g={subscribe:function(e,t,n){n=n||p;var i=this._subscriptions[n]||(this._subscriptions[n]=[]),r=new m(e,t,function(){s.arrayRemoveItem(i,r)});return i.push(r),r},notify:function(e,t){if(t=t||p,this.hasSubscriptionsForEvent(t))for(var n,i=this._subscriptions[t].slice(),r=0;n=i[r];r++)n.callback(e)},hasSubscriptionsForEvent:function(e){return this._subscriptions[e]&&this._subscriptions[e].length},isDifferent:function(e,t){return!this.equalityComparer||!this.equalityComparer(e,t)},equalityComparer:e},v={undefined:1,"boolean":1,number:1,string:1},m=function(e,t,n){this[h+"callback"]=e,this[h+"callbackScope"]=t,this[h+"disposeCallback"]=n,this[h+"isDisposed"]=!1},y=m.prototype;y.callback=function(e){if(!this[h+"isDisposed"])this[h+"callback"].apply(this[h+"callbackScope"],e||[]);return this},y.setCallback=function(e){return this[h+"callback"]=e,this},y.getCallback=function(){return this[h+"callback"]},y.dispose=function(){return this[h+"isDisposed"]=!0,this[h+"disposeCallback"](),this},y.throttle=function(e){return this[h+"callback"]=l.fixedRate(this[h+"callback"],e),this},y.debounce=function(e){return this[h+"callback"]=l.debounce(this[h+"callback"],e),this};var b=function(e){this[h+"children"]=a.extend([],e)},w=b.prototype;w.callback=function(e){for(var t,n=0;t=this[h+"children"][n];n++)t.callback(e)},w.dispose=function(){for(var e,t=0;e=this[h+"children"][t];t++)e.dispose()},w.throttle=function(e){return t.call(this,e,l.fixedRate),this},w.debounce=function(e){return t.call(this,e,l.debounce),this},c.ob=c.observable=function(e,t,n){function i(e,t,n){if(arguments.length>0)return void i[h+"writer"](e,t,n);else return i[h+"currValue"]}if(T(e))e=e.peek(),t=e.peekValueInfo();return i[h+"currValue"]=e,i[h+"currValueInfo"]=t,i[h+"authKey"]=n?n.authKey:null,c.subscribable(i),s.assign(i,C),i[f]="ob",i[h+"writer"]=function(e,t,n){i.validateAuthKey(n?n.authKey:null),s.assert(null==t||a.isPlainObject(t)),i[h+"currValueInfo"]=t;var o=n&&n.force;if(o||i.isDifferent(i[h+"currValue"],e))(!n||!n.silent)&&i.valueWillMutate(),i[h+"currValue"]=e,(!n||!n.silent)&&i.valueHasMutated();r(this,n)},i};var C={force:function(e,t,n){n=n||{},n.force=!0,this[h+"writer"](e,t,n)},peek:function(){return this[h+"currValue"]},peekValueInfo:function(e){if(0===arguments.length){var t=this[h+"currValueInfo"];if(t)t=a.extend({},t);return t}else if(s.isObject(this[h+"currValueInfo"]))return this[h+"currValueInfo"][e]},extendWriter:function(e){var t=this,n=t[h+"writer"];return this[h+"writer"]=function(i,r,o){t.validateAuthKey(o?o.authKey:null),e.call(t,n,i,r,o)},this},valueHasMutated:function(){this.notify([this[h+"currValue"],this])},valueWillMutate:function(){this.notify([this[h+"currValue"],this],"beforeChange")},validateAuthKey:function(e){var t=this[h+"authKey"];if(null!=t&&e!==t)throw new Error("AuthKey error: "+e)}};c.obHash=function(e){var t=c.ob(e||{});return t[f]="obHash",t.prop=n,t},c.obArray=function(e){s.assert(e===o||a.isArray(e));var t=c.ob(e||[]);return s.assign(t,_),t[f]="obArray",t};var _={remove:function(e){for(var t,n=this(),i=[],r=[],o=0,s=n.length;s>o;)if("function"==typeof e?e(n[o]):n[o]===e){if(!t)this.valueWillMutate(),t=!0;i.push(n.splice(o,1)),r.push(o),s--}else o++;if(i.length){var a={key:S.REMOVE,indexes:r};this.notify([a,this],d),this.valueHasMutated()}return i},removeAll:function(){return this.splice(0,this.count())},indexOf:function(e){return s.arrayIndexOf(this(),e)},pop:function(){return this.splice(this.count()-1,1)},push:function(){return this.splice.apply(this,[this.count(),0].concat(u.call(arguments)))},shift:function(){return this.splice(0,1)},unshift:function(e){return this.splice(0,0,e)},splice:function(e,t){var n=this(),i=n.length,r=arguments.length;if(!r||!(e>=0&&i>=e))return[];if(1===r)t=i;else if(!(t>=0))t=0;else if(t>i-e)t=i-e;this.valueWillMutate();var o=n.splice.apply(n,arguments),s={key:S.SPLICE,index:e,removeCount:t,added:u.call(arguments,2)};return this.notify([s,this],d),this.valueHasMutated(),o},slice:function(){return u.apply(this(),arguments)},pushArray:function(e){return this.push.apply(this,e||[])},count:function(){return this().length},move:function(e,t){var n=this(),i=n.length;if(!(0>e||e>=i||0>t||t>=i||e===t)){this.valueWillMutate();var r=n.splice(e,1)[0];n.splice(t,0,r);var o={key:S.MOVE,originIndex:e,finalIndex:t};this.notify([o,this],d),this.valueHasMutated()}}},S=c.obArray.ChangeKey={REMOVE:"remove",SPLICE:"splice",MOVE:"move"};c.obSubscribe=function(e,t,n,i){if(T(e))return e.subscribe(t,n,i);else if(a.isArray(e)){for(var r=[],o=0,s=e.length;s>o;o++)if(T(e[o]))r.push(e[o].subscribe(t,n,i));return new b(r)}},c.value=function(e){return T(e)?e():e},c.peek=function(e){return T(e)?e.peek():e},c.setValue=function(e,t,n){return t=c.peek(t),i(e)?(e(t,n),e):t},c.valueInfo=function(e,t){if(s.isObject(e))return s.assign({},e,["type","info"]);else return{type:e,info:t}},c.valueInfo.CONFIRMED="confirmed",c.valueInfoForConfirmed=function(e,t){var n=c.valueInfo(c.valueInfo.CONFIRMED,e);if(t)s.assign(n,t,null,["type","info"]);return n},c.checkValueInfo=function(e,t,n){var i=c.obTypeOf(e)?e.peekValueInfo():e;return s.isObject(i)&&(null==t||i.type===t)&&(null==n||i.info===n)},c.checkValueInfoForConfirmed=function(e,t){return c.checkValueInfo(e,c.valueInfo.CONFIRMED,t)};var T=c.obTypeOf=function(e){return Object(e)===e&&e[f]};return c}),define("dt/lib/model",["require","jquery","./base","./dataDriven"],function(require){var e,t=require("jquery"),n=require("./base"),i=require("./dataDriven"),r={},o="__atom__",s=r.isAtom=function(e,r){return Object(e)!==e||!r&&e[o]||i.obTypeOf(e)||n.isComponent(e)||!t.isPlainObject(e)};r.isPlain=function(e,n){return t.isArray(e)||!s(e,n)},r.atom=function(e){if(Object(e)===e&&!e[o])e[o]=1;return e},r.cloneAtom=function(e,r){var o,l,u=t.type(e);if(s(e,!0)){if(o=i.obTypeOf(e))return i[o](a({},e.peek(),{clone:!0}));else if(n.isComponent(e))return e.clone();else if("date"===u)return new Date(e.getTime());else if("regexp"===u)return new RegExp(e);else if("array"===u){l=[];for(var c in e)if(e.hasOwnProperty(c))l[c]=a({},e[c],{clone:!0});return l}else if(u in{"function":1,undefined:1,"null":1,"boolean":1,number:1,string:1}||r&&r.assignWhenCannotClone)return e}else;};var a=r.merge=function(t,n,i){if(n===e)return t;else if(s(n))return i&&i.clone?r.cloneAtom(n,i):n;else{if(s(t))t={};var o=i&&i.levelOneNeedMerge;i&&(i.levelOneNeedMerge=null);for(var l in n)if(n.hasOwnProperty(l)&&(!i||!i.onlyMergeOwnPropertyInTarget||t.hasOwnProperty(l)))t[l]=!o||o[l]?a(t[l],n[l],i):n[l];else;return t}};return r.clone=function(t,n){if(t===e)return e;else return a({},t,{clone:!0,assignWhenCannotClone:n})},r}),define("dt/lib/objectAccess",["require","./model"],function(require){function e(e){return e===Object(e)}function t(e){return"[object Array]"===Object.prototype.toString.call(e)}var n,i={},r=require("./model"),o=/[\.\[]/,s=/\[/g,a=/\]/g,l=i.getByPath=function(e,n,i){if(null==e)return n;var r=t(e)?e:l.parsePath(e),i=i||f;n={k:n},r.unshift("k");for(var o=0,s=r.length;s>o;o++){var a=r[o],c=!o?u.DRILL_DOWN:i(n,a);switch(c){case u.DRILL_DOWN:n=n[a];break;case u.RETURN:return;default:throw new Error("path: "+a)}}return n},u=l.Action={DRILL_DOWN:"drillDown",THROW:"throw",RETURN:"return"},c=l.actionChoice={notObjectThrow:function(t){return e(t)?u.DRILL_DOWN:u.THROW},notObjectReturn:function(t){return e(t)?u.DRILL_DOWN:u.RETURN},atomThrow:function(t){return e(t)&&!r.isAtom(t)?u.DRILL_DOWN:u.THROW},notPlainThrow:function(t){return e(t)&&r.isPlain(t)?u.DRILL_DOWN:u.THROW},notPlainReturn:function(t){return e(t)&&r.isPlain(t)?u.DRILL_DOWN:u.RETURN}},f=c.notObjectThrow;l.normalizePath=function(e){return e.replace(s,".").replace(a,"")},l.parsePath=function(e){return e.replace(a,"").split(o)};var h=i.setByPath=function(e,t,n,i,r){if(null!=e){var s,a,l=e.split(o),i=i||g;n={k:n},l.unshift("k");for(var u,c=0,f=l.length;f>c;c++){a=l[c];var h=a.length;if(u=0,a.indexOf("]")===h-1)l[c]=a=a.slice(0,h-1),u=1;var d=!c?p.DRILL_DOWN:i(n,a);switch(d){case p.OVERLAP:s[l[c-1]]=n=u?[]:{};break;case p.DELETE:return void delete s[l[c-1]];case p.DRILL_DOWN:break;case p.RETURN:return;default:throw new Error("path: "+a)}s=n,n=n[a]}if("function"==typeof r)t=r(s,a,t);else s[a]=t;return t}},p=h.Action={DRILL_DOWN:"drillDown",THROW:"throw",RETURN:"return",OVERLAP:"overlap",DELETE:"delete"},d=h.actionChoice={notObjectOverlap:function(t){return e(t)?p.DRILL_DOWN:p.OVERLAP},notObjectThrow:function(t){return e(t)?p.DRILL_DOWN:t!==n?p.THROW:p.OVERLAP},notObjectReturn:function(t){return e(t)?p.DRILL_DOWN:t!==n?p.RETURN:p.OVERLAP},atomThrow:function(t){return e(t)&&!r.isAtom(t)?p.DRILL_DOWN:t!==n?p.THROW:p.OVERLAP},notPlainThrow:function(t){return e(t)&&r.isPlain(t)?p.DRILL_DOWN:t!==n?p.THROW:p.OVERLAP},notPlainOverlap:function(t){return e(t)&&r.isPlain(t)?p.DRILL_DOWN:p.OVERLAP}},g=d.notObjectThrow;return i.deleteByPath=function(e,t,i){function r(e,t){o=e[t],delete e[t]}var o;return h(e,n,t,i,r),o},i.reducePath=function(e,t){for(var n=e.split(o),i=[],r=0,s=n.length;s>r;r++){var a=n[r],l=a.length,u=!1;if(a.indexOf("]")===l-1)u=!0,a=a.slice(0,l-1);if(a!==t[r])break;else i.push((0===r?"":u?"[":".")+n[r])}return i.join("")},i}),define("dt/lib/objectOriented",["require","exports","./base"],function(require,exports){function e(e,t){for(var n,i=this.constructor,r=this[e];(i=i.prototype._superClass)&&(n=i.prototype[e])&&n===r;);if(n)return n.apply(this,t||[]);throw new Error("parent Class has no method named "+e)}function t(t){var n=this,r=exports.newClass({_define:n.defineProperties}),o=function(){};o.prototype=n.prototype;var s=r.prototype=new o;return i(r.defineProperties,t._define),t._define=null,r.implement(t),s._applySuper=e,s._superClass=n,s.constructor=r,r}function n(e){return i(this.prototype,e)}function i(e,t){for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n];return e}function r(e){return"[object Function]"===Object.prototype.toString.call(e)}var o=require("./base");return exports.newClass=function(e){var s=function(){return r(this._construct)?this._construct.apply(this,arguments):this};return s.extend=t,s.implement=n,i(s.defineProperties={},e._define),e._define=null,s.implement(e),s.uid="Class_"+o.localUID(),s},exports.simpleInherit=function(t,n){var r=t.prototype,o=new Function;o.prototype=n.prototype;var s=t.prototype=new o;return i(s,r),s._applySuper=e,s._superClass=n,s.constructor=t,t},exports}),define("dt/lib/event",["require","jquery"],function(require){function e(e){return t.extend(e,r)}var t=require("jquery"),n=t.isFunction,i=t.inArray,r={addEventListener:function(e,t){if(n(e))t=e,e="*";this.__listeners=this.__listeners||{};var r=this.__listeners[e]||(this.__listeners[e]=[]);if(i(r,t)<0)r.push(t);return this},removeEventListener:function(e,t){if(n(e))t=e,e="*";this.__listeners=this.__listeners||{};var r=this.__listeners[e];if(r)if(t){var o=i(r,t);if(~o)delete r[o]}else r.length=0,delete this.__listeners[e];return this},removeAllEventListener:function(){return this.__listeners=[],this},fire:function(e,n){this.__listeners=this.__listeners||{};var i=this.__listeners[e],r=this;if(i)t.each(i,function(t,i){n=n||{},n.type=e,i.call(r,n)});if("*"!==e)this.fire("*",n);return this}};return{enableEvent:e}}),define("dt/lib/enumeration",["require","jquery"],function(require){function e(e){var t;if("array"===n.type(e)){t={};for(var i=0,r=e.length;r>i;i++)t[e[i]]=e[i]}else t=e;return t}function t(e){for(var t in e)if(e.hasOwnProperty(t)&&!r.test(t))throw new Error('Key must be spelled like "AAAA_BBB".')}var n=require("jquery"),i={},r=/^[A-Z][A-Z_]*$/;i.makeEnum=function(i,r){function s(){}return r=r||{},i=e(i),t(i),n.extend(s.prototype,o,r),n.extend(new s,i)};var o={has:function(e){return this.hasOwnProperty(e)},hasValue:function(e){return null!=this.getKeyByValue(e)},get:function(e){return this.hasOwnProperty(e)?this[e]:null},getKeyByValue:function(e){for(var t in this)if(this.hasOwnProperty(t)&&this[t]===e)return t;return null},contains:function(e,t){if(t&&!n.isArray(t))t=[t];for(var i=0,r=t.length;r>i;i++){for(var o=!1,s=0,a=e.length;a>s;s++)if(this[e[s]]===t[i])o=!0;if(!o)return!1}return!0},forEachEnum:function(e,t){for(var n in this)if(this.hasOwnProperty(n)&&r.test(n))e.call(t,n,this[n])}};return i}),define("dt/lib/disable",["require","jquery"],function(require){function e(e,n,r){e=null!=e?e:"";var s=o[e];if(!s&&r){var a=null!=n?i+"-"+n:"";s=o[e]=t('<div class="'+i+" "+a+'"></div>').appendTo(document.body)}return s}var t=require("jquery"),n={},i="dt-global-mask",r="dtGlobalMask",o={};return n.globalDisable=function(e){n.globalMask(e?0:!1)},n.globalMask=function(t,n,i,o){var s;if(t===!1)s=e(n),s&&s.hide().off("."+r);else{if(null==t)t=.5;s=e(n,i,!0),s.css({opacity:t}).show();for(var a in o)if(o.hasOwnProperty(a))s.on(a+"."+r,o[a])}},n.disposeGlobalMask=function(t){var n=e(t);n&&n.off().remove()},n}),define("dt/lib/number",["require"],function(){var e={},t=/^(\d+)px$/,n=/^(\d+|\d+\.\d+)%$/;e.ordinalSuffix=function(e){if(1==e)return"st";else if(2==e)return"nd";else if(3==e)return"rd";else return"th"},e.pad=function(e,t){var n="",i=0>e,r=String(Math.abs(e));if(r.length<t)n=new Array(t-r.length+1).join("0");return(i?"-":"")+n+r},e.formatNumber=function(t,n,i,r,o){if(!n)return t;if(o&&/[ID]%/.test(n))t=100*t;var s=/D+/.exec(n),a=s&&s.length>0?s[0].length:0;t=e.fixNumber(t,a,r);var l,u=t.toString(),c=u.split("."),f=c[0],h=c.length>1?c[1]:"";return l=n.replace(/I+,*I*/g,function(){var e,t,n=arguments[0],r=n.lastIndexOf(","),o=[];if(r>=0&&r!==f.length-1){t=n.length-1-r;for(var s;(s=f.length-t)>0&&t>0;)o.push(f.substr(s,t)),f=f.substring(0,s);if(o.push(f),o.reverse(),"-"===o[0])o.shift(),e="-"+o.join(",");else e=o.join(",")}else e=f;if(i&&e&&e.indexOf("-")<0)e="+"+e;return e}),l=l.replace(/D+/g,function(){var e=arguments[0],t=h;if(t.length>e.length)t=t.substr(0,e.length);else t+=new Array(e.length-t.length).join("0");return t})},e.fixNumber=function(e,t,n){if(e=i(e),null==t||null==e)return e;if(!n){var r=Math.pow(10,t);return Math.round(e*r)/r}else if(2==n)return Number(e).toFixed(t);else return Number(e)};var i=e.getNumber=function(e){var t=parseFloat(e);return e-t>=0?t:null};return e.refineNumber=function(e){for(var t=[],n=0,r=e.length;r>n;n++){var o=i(e[n]);null!=o&&t.push(o)}return t},e.validateNumeric=function(e){return e-parseFloat(e)>=0},e.isInteger=function(t){return e.validateNumeric(t)&&t%1===0},e.isPxStr=function(e){return t.test(e)},e.parsePxStr=function(e){return t.test(e)?parseFloat(RegExp.$1):null},e.isPercentStr=function(e){return n.test(e)},e.parsePercentStr=function(e){return n.test(e)?parseFloat(RegExp.$1):null},e}),define("dt/lib/htmlCleaner",["require"],function(){function e(t,n){switch(t.nodeType){case 1:var r=t.tagName,o=t.attributes,s=n[r.toLowerCase()];if(!s)return i;for(var a=document.createElement(r),l=0,u=o.length;u>l;l++)if(~s.indexOf(o[l].name))a.setAttribute(o[l].name,o[l].value);for(var c=t.childNodes,l=0,u=c.length;u>l;l++){var f=e(c[l],n);if(f!==i)a.appendChild(f)}return a;case 3:return document.createTextNode(t.nodeValue);default:return i}}function t(e){try{return(new DOMParser).parseFromString(e,"text/html")}catch(t){var n=new ActiveXObject("MSXML2.DOMDocument");return n.loadXML(e)}}function n(n,o){o=o||{};var s=t(n),a=o.htmlAllow||r.BASE,l=o.targetEl||document.createElement("div"),u=s.body.childNodes;l.innerHTML="";for(var c=0,f=u.length;f>c;c++){var h=e(u[c],a);if(h!==i)l.appendChild(h)}return l.innerHTML}var i,r={BASE:{a:["title","alt","href","class","style"],b:["class","style"],em:["class","style"],strong:["class","style"],i:["class","style"],img:["src","class","style"],div:["class","style"],p:["class","style"],br:[]},EC_FORMATTER:{a:["title","alt","href","class","style"],b:["class","style"],em:["class","style"],strong:["class","style"],i:["class","style"],img:["src","class","style"],div:["class","style"],p:["class","style"],br:[]}};return{htmlClean:n,HTMLCleanAllow:r}}),define("dt/lib/codeStringify",["require","jquery"],function(require){function e(r,s,a,l){var u,c=l.singleLineDepth,f=null!=c?a>=c?"single":"multiple":"auto",p=l.quotationMark,d=l.indentBase,g=l.lineBreak,v=l.inlineDelimiterSpace,m=o.type(r),y=new Array(a*d+1).join(" "),b=new Array((a+1)*d+1).join(" "),w=!1,C=null!=s?t(s,p)+": ":"";switch(m){case"function":w="single"!==f,u=C+h.printFunction(r,a,d);break;case"regexp":u=C+p+r+p;break;case"date":u=C+i(r,p);break;case"array":for(var _=[],S=0,T=r.length;T>S;S++){var E=e(r[S],null,a+1,l);if(_.push(E.str),E.hasLineBreak)w=!0}if("multiple"===f)w=!0;var x=w?g:"",O=","+(w?g+b:v),A=w?b:"",R=w?y:"";u=""+C+"["+x+A+_.join(O)+x+R+"]";break;case"object":var _=[];for(var S in r)if(r.hasOwnProperty(S)){var E=e(r[S],S,a+1,l);_.push(E.str)}w="single"!==f;var x=w?g:"",O=","+(w?g+b:v),A=w?b:"",R=w?y:"";u=""+C+"{"+x+A+_.join(O)+x+R+"}";break;case"boolean":case"null":case"undefined":u=C+String(r);break;case"number":u=C+(isFinite(r)?String(r):"null");break;case"string":u=C+n(r,p);break;default:throw new Error('Illegal type "'+m+'" at "'+r+'"')}return{str:u,hasLineBreak:w}}function t(e,t){if(h.jsReservedWordsMap[e])return t+e+t;else if(!/^[a-zA-Z_$][a-zA-Z0-9_$]*$/.test(e))return n(e,t);else return e}function n(e,t){var n=u[t];n.lastIndex=0;var i=f[t],r=n.test(e)?e.replace(n,function(e){var t=i[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}):e;return t+r+t}function i(e,t){return isFinite(e.valueOf())?n(e.getUTCFullYear()+"-"+r(e.getUTCMonth()+1)+"-"+r(e.getUTCDate())+"T"+r(e.getUTCHours())+":"+r(e.getUTCMinutes())+":"+r(e.getUTCSeconds())+"Z",t):"null"}function r(e){return 10>e?"0"+e:e}var o=require("jquery"),s=4,a="\n",l='"',u={'"':/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,"'":/[\\\'\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g},c={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r","\\":"\\\\"},f={'"':o.extend({},c,{'"':'\\"'}),"'":o.extend({},c,{"'":"\\'"})},h={};return h.jsReservedWords=["break","delete","function","return","typeof","case","do","if","switch","var","catch","else","in","this","void","continue","false","instanceof","throw","while","debugger","finally","new","true","with","default","for","null","try","abstract","double","goto","native","static","boolean","enum","implements","package","super","byte","export","import","private","synchronized","char","extends","int","protected","throws","class","final","interface","public","transient","const","float","long","short","volatile"],h.jsReservedWordsMap=function(e){for(var t={},n=0,i=e.length;i>n;n++)t[e[n]]=1;return t}(h.jsReservedWords),h.stringifyJSObject=function(t,n){if(n=n||{},null==n.indentBase)n.indentBase=s;if(null==n.lineBreak)n.lineBreak=a;if(null==n.quotationMark)n.quotationMark=l;if('"'!==n.quotationMark&&"'"!==n.quotationMark)throw new Error("Illegal quotation mark: "+n.quotationMark);if(n.compress)n.indentBase=0,n.lineBreak="";n.inlineDelimiterSpace=n.compress?"":" ";try{var i=e(t,null,0,n);return i.str}catch(r){return n.errorMessage||""}},h.stringifyJSObject2HTML=function(e,t,n){return"<pre>"+h.stringifyJSObject(e,t,n)+"</pre>"},h.printFunction=function(e,t,n){var i=new Array((t+1)*n).join(" "),r=(e+"").split("\n"),s="";if(r.length>1&&"}"===o.trim(r[r.length-1]))r.pop(),s="\n"+new Array(t*n).join(" ")+"}";return r.join("\n"+i)+s},h}),define("dt/lib/others",["require","jquery","./base"],function(require){var e=require("jquery"),t=require("./base"),n={},i=/#\{(.+?)\}/g;n.parseURL=function(e){var t=[];if(!e)return t;var n=document.createElement("a");n.href=e;for(var i=(n.search||"").replace(/^\?/,"").split("&"),r=0,o=i.length;o>r;r++){var s=(i[r]||"").split("=");if(s.length>1&&s[0])t.push({name:s[0],value:s[1]})}return t},n.loadLazyImg=function(t,n){!n&&(n="src-origin"),t.each(function(t,i){i=e(i);var r=i.data(n);if(r)i.attr("src",r),i.data(n,"")})},n.parseInlineCss=function(t){t=t||"";for(var n={},i=t.split(";"),r=0,o=i.length;o>r;r++){var s=i[r].split(":");n[e.trim(s[0])]=e.trim(s[1])}return n},n.showBalloonTip=function(){var t,i,r="BAIDUHUI_BALLOON_TIP_SHOWN",o="DNOT_SHOW_WHEN_CLOSE";return function(s,a,l,u){function c(){if(t)t.hide();i===o&&n.cookie(r,1),i=null}if(s===!1)c();else{if(i=u,i===o&&n.cookie(r))return;if(!t)t=e(['<div class="balloon-tip">','<div class="content"></div>','<div class="triangle"><i></i><em></em></div>','<div class="close-btn">X</div>',"</div>"].join("")).hide().appendTo(document.body),e(".close-btn",t).click(c);e(".content",t).html(s),t.css({position:"absolute",left:a,top:l}).show()}}}(),n.cookie=function(e,t){if(null!=t)return document.cookie=e+"="+encodeURIComponent(t),t;else{var n=new RegExp("(^| )"+e+"=([^;]*)(;|$)"),i=n.exec(document.cookie);return i?decodeURIComponent(i[2]):null}},function(){var t=!1;n.enableWindowScroll=function(e){t=!e},e(window).scroll(function(e){if(t)e.preventDefault(),e.stopPropagation()})}(),n.linkTargetBlank=function(e){var t=document,n=t.body,i=t.createElement("a");i.style.display="none",i.href=e||"#",i.target="_blank",n.appendChild(i),i.click(),n.removeChild(i)};var r=n.appendParam=function(e,t){return e+(e.indexOf("?")<0?"?":"&")+t};return n.replaceIntoParam=function(e,n,i){if(!e||t.isBlank(e))return e;i=null!=i?encodeURIComponent(i):"";var o=new RegExp("([&~?])"+n+"=[^&]*"),s=n+"="+i;if(o.test(e))e=e.replace(o,"$1"+s);else e=r(e,s);return e},n.strTemplate=function(n,r){n=String(n);var o=Array.prototype.slice.call(arguments,1);if(o.length)return o=1===o.length?t.isObject(r)?r:o:o,n.replace(i,function(t,n){var i=o[n];if(e.isFunction(i))i=i(n);return null==i?"":i});else return n},n.enhanceContentEditable=function(e){e.keypress(function(e){13===(e.keyCode||e.witch)&&e.preventDefault()})},n.getOpposite=function(t){var n=["top","right","bottom","left"],i=e.inArray(t,n);if(0>i)return null;if(i+2<n.length)return n[i+2];else return n[n.length-i-2]},function(){var e=[],i=!1;n.enableBeforeUnloadCheck=function(){if(!i)i=!0,window.onbeforeunload=function(){for(var t,n,i,r=0;n=e[r];r++)if(i=n())t=i;if(t)window.event.returnValue=t}},n.addBeforeUnloadChecker=function(t){e.push(t)},n.removeBeforeUnloadChecker=function(n){var i=t.arrayIndexOf(e,n);return~i&&e.splice(i,1),!!~i}}(),n}),define("dt/ui/tooltip",["require","jquery","../lib/base","../lib/model"],function(require){function e(e){var n=t(),i=e.x,r=e.y;null==i&&(i=0),null==r&&(r=0);var o=e.xAnchor||"center",s=e.yAnchor||"top",a="left"===o?0:n.outerWidth(),l="top"===s?0:n.outerHeight();n.css({left:Math.round("left"===o?i:"center"===o?i-a/2:i-a)+"px",top:Math.round("top"===s?r:"center"===s?r-l/2:r-l)+"px"})}function t(){if(!h)h=n('<div class="'+l+'" style="display:none;"></div>').appendTo(document.body);return h}var n=require("jquery"),i=require("../lib/base"),r=require("../lib/model"),o=n.isFunction,s=n.extend,a=".dtui-global-tooltip-namespace",l="dtui-global-tooltip",u={x:0,y:-5,xAnchor:"center",yAnchor:"bottom"},c={x:0,y:-15,xAnchor:"center",yAnchor:"bottom"},f={},h=null,p=!1;return f.showTooltip=function(n){if(!p){n=n||{};var r=n.text;if(null==r)return void f.hideTooltip();
r=n.encodeHTML!==!1?i.encodeHTML(r):r,t().html(r).show(),e(n.location)}},f.hideTooltip=function(){t().hide()},f.disableTooltip=function(){f.hideTooltip(),p=!0},f.enableTooltip=function(){p=!1},f.bindTooltip=function(t){function l(e){v={currentTarget:e.currentTarget,pageX:e.pageX,pageY:e.pageY}}function h(e){var n=t.text;return o(n)?n(e.currentTarget):n}function p(e){var t=o(d)?d(e.currentTarget):s({},d||(g?c:u));if(g)t.x+=e.pageX,t.y+=e.pageY;else if(!d){var i=n(e.currentTarget),r=i.offset();t.x+=r.left+i.outerWidth()/2,t.y+=r.top}return t}t=r.merge({},t,{clone:!0,assignWhenCannotClone:!0});var d=t.location,g=t.followMouse;i.assert(!i.isJQuery(t.bindEl));var v,m=n(t.bindEl),y=["mouseenter"+a,function(e){l(e),f.showTooltip({text:h(v),encodeHTML:t.encodeHTML,location:p(v)})}],b=["mouseleave"+a,function(){v=null,f.hideTooltip()}],w=["mousemove"+a,function(t){l(t),e(p(v))}],C=t.selector;if(C)y.splice(1,0,C),b.splice(1,0,C),w.splice(1,0,C);m.on.apply(m,y).on.apply(m,b),g&&m.on.apply(m,w);var _={refresh:function(){if(v)f.showTooltip({text:h(v),encodeHTML:t.encodeHTML,location:p(v)})},setText:function(e){if(v)f.showTooltip({text:e,encodeHTML:t.encodeHTML,location:p(v)})},hide:function(){if(v)f.hideTooltip()},dispose:function(){if(v)f.hideTooltip(),v=null;m.off(a)}};return _},f}),define("dt/lib",["require","./lib/Set","./lib/base","./lib/json","./lib/dataDriven","./lib/objectAccess","./lib/objectOriented","./lib/model","./lib/event","./lib/enumeration","./lib/disable","./lib/number","./lib/throttle","./lib/htmlCleaner","./lib/codeStringify","./lib/others","./ui/tooltip"],function(require){function e(e){for(var t=1,n=arguments.length;n>t;t++){var i=arguments[t];for(var r in i)if(i.hasOwnProperty(r)){if(e[r])throw new Error("Duplicate key: "+r);e[r]=i[r]}}return e}var t={Set:require("./lib/Set")};return e(t,require("./lib/base"),require("./lib/json"),require("./lib/dataDriven"),require("./lib/objectAccess"),require("./lib/objectOriented"),require("./lib/model"),require("./lib/event"),require("./lib/enumeration"),require("./lib/disable"),require("./lib/number"),require("./lib/throttle"),require("./lib/htmlCleaner"),require("./lib/codeStringify"),require("./lib/others"),require("./ui/tooltip")),t}),!function(e){function t(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function n(){this.raw=[],this.length=0}function i(){return"___"+R++}function r(e,t){var n=new Function;n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}function o(e){return D[e]}function s(e){return'"'+e.replace(/\x5C/g,"\\\\").replace(/"/g,'\\"').replace(/\x0A/g,"\\n").replace(/\x09/g,"\\t").replace(/\x0D/g,"\\r")+'"'}function a(e){return e.replace(/[\^\[\]\$\(\)\{\}\?\*\.\+]/g,function(e){return"\\"+e})}function l(e){var t=arguments;return e.replace(/\{([0-9]+)\}/g,function(e,n){return t[n-0+1]})}function u(e){return e=e.replace(/^\s*\*/,""),l('gv({0},["{1}"])',s(e),e.replace(/\[['"]?([^'"]+)['"]?\]/g,function(e,t){return"."+t}).split(".").join('","'))}function c(e,t,n,i,r,o){for(var s=n.length,a=e.split(t),l=0,u=[],c=0,f=a.length;f>c;c++){var h=a[c];if(c){var p=1;for(l++;;){var d=h.indexOf(n);if(0>d){u.push(l>1&&p?t:"",h);break}if(l=i?l-1:0,u.push(l>0&&p?t:"",h.slice(0,d),l>0?n:""),h=h.slice(d+s),p=0,0===l)break}0===l&&(r(u.join("")),o(h),u=[])}else h&&o(h)}l>0&&u.length>0&&(o(t),o(u.join("")))}function f(e,t,n){var i,r=[],o=t.options,a="",l="",h="",p="";return n&&(a="ts(",l=")",h=P,p=M,i=o.defaultFilter),c(e,o.variableOpen,o.variableClose,1,function(e){n&&e.indexOf("|")<0&&i&&(e+="|"+i);var o=e.indexOf("|"),s=(o>0?e.slice(0,o):e).replace(/^\s+/,"").replace(/\s+$/,""),c=o>0?e.slice(o+1):"",d=0===s.indexOf("*"),g=[d?"":a,u(s),d?"":l];if(c){c=f(c,t);for(var v=c.split("|"),m=0,y=v.length;y>m;m++){var b=v[m];/^\s*([a-z0-9_-]+)(\((.*)\))?\s*$/i.test(b)&&(g.unshift('fs["'+RegExp.$1+'"]('),RegExp.$3&&g.push(",",RegExp.$3),g.push(")"))}}r.push(h,g.join(""),p)},function(e){r.push(h,n?s(e):e,p)}),r.join("")}function h(e,t){this.value=e,this.engine=t}function p(e,t){this.value=e,this.engine=t,this.children=[],this.cloneProps=[]}function d(e,t){var n=e.stack,i=t?n.find(function(e){return e instanceof t}):n.bottom();if(i){for(var r;(r=n.top())!==i;){if(!r.autoClose)throw new Error(r.type+" must be closed manually: "+r.value);r.autoClose(e)}i.close(e)}return i}function g(e,t){if(!/^\s*([a-z0-9\/_-]+)\s*(\(\s*master\s*=\s*([a-z0-9\/_-]+)\s*\))?\s*/i.test(e))throw new Error("Invalid "+this.type+" syntax: "+e);this.master=RegExp.$3,this.name=RegExp.$1,p.call(this,e,t),this.blocks={}}function v(e,t){if(!/^\s*([a-z0-9\/_-]+)\s*$/i.test(e))throw new Error("Invalid "+this.type+" syntax: "+e);this.name=RegExp.$1,p.call(this,e,t),this.cloneProps=["name"]}function m(e,t){if(!/^\s*([a-z0-9\/_-]+)\s*$/i.test(e))throw new Error("Invalid "+this.type+" syntax: "+e);this.name=RegExp.$1,p.call(this,e,t),this.cloneProps=["name","state","blocks"],this.blocks={}}function y(e,t){if(!/^\s*([a-z0-9_]+)\s*=([\s\S]*)$/i.test(e))throw new Error("Invalid "+this.type+" syntax: "+e);this.name=RegExp.$1,this.expr=RegExp.$2,p.call(this,e,t),this.cloneProps=["name","expr"]}function b(e,t){if(!/^\s*([a-z0-9_-]+)\s*(\(([\s\S]*)\))?\s*$/i.test(e))throw new Error("Invalid "+this.type+" syntax: "+e);this.name=RegExp.$1,this.args=RegExp.$3,p.call(this,e,t),this.cloneProps=["name","args"]}function w(e,t){if(!/^\s*([a-z0-9\/_-]+)\s*(\(([\s\S]*)\))?\s*$/i.test(e))throw new Error("Invalid "+this.type+" syntax: "+e);this.name=RegExp.$1,this.args=RegExp.$3,p.call(this,e,t),this.cloneProps=["name","args"]}function C(e,t){var n=new RegExp(l("^\\s*({0}[\\s\\S]+{1})\\s+as\\s+{0}([0-9a-z_]+){1}\\s*(,\\s*{0}([0-9a-z_]+){1})?\\s*$",a(t.options.variableOpen),a(t.options.variableClose)),"i");if(!n.test(e))throw new Error("Invalid "+this.type+" syntax: "+e);this.list=RegExp.$1,this.item=RegExp.$2,this.index=RegExp.$4,p.call(this,e,t),this.cloneProps=["list","item","index"]}function _(e,t){p.call(this,e,t)}function S(e,t){_.call(this,e,t)}function T(e,t){p.call(this,e,t)}function E(e,t){t.target=e;var n=t.engine,i=e.name;if(n.targets[i])switch(n.options.namingConflict){case"override":n.targets[i]=e,t.targets.push(i);case"ignore":break;default:throw new Error("Target exists: "+i)}else n.targets[i]=e,t.targets.push(i)}function x(e,t){j[e]=t,t.prototype.type=e}function O(e){this.options={commandOpen:"<!--",commandClose:"-->",commandSyntax:/^\s*(\/)?([a-z]+)\s*(?::([\s\S]*))?$/,variableOpen:"${",variableClose:"}",defaultFilter:"html"},this.config(e),this.targets={},this.filters=t({},k)}function A(e,t){function i(){var e;if(f.length>0&&(e=f.join(""))){var n=new h(e,t);n.beforeAdd(u),l.top().addChild(n),f=[],t.options.strip&&u.current instanceof p&&(n.value=e.replace(/^[\x20\t\r]*\n/,"")),u.current=n}}var r,o=t.options.commandOpen,s=t.options.commandClose,a=t.options.commandSyntax,l=new n,u={engine:t,targets:[],stack:l,target:null},f=[];return c(e,o,s,0,function(e){var n=a.exec(e);if(n&&(r=j[n[2].toLowerCase()])&&"function"==typeof r){i();var l=u.current;t.options.strip&&l instanceof h&&(l.value=l.value.replace(/\r?\n[\x20\t]*$/,"\n")),n[1]?l=d(u,r):(l=new r(n[3],t),"function"==typeof l.beforeOpen&&l.beforeOpen(u),l.open(u)),u.current=l}else/^\s*\/\//.test(e)||f.push(o,e,s);r=null},function(e){f.push(e)}),i(),d(u),u.targets}n.prototype={push:function(e){this.raw[this.length++]=e},pop:function(){if(this.length>0){var e=this.raw[--this.length];return this.raw.length=this.length,e}},top:function(){return this.raw[this.length-1]},bottom:function(){return this.raw[0]},find:function(e){for(var t=this.length;t--;){var n=this.raw[t];if(e(n))return n}}};var R=178245,D={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},k={html:function(e){return e.replace(/[&<>"']/g,o)},url:encodeURIComponent,raw:function(e){return e}},I='var r="";',P="r+=",M=";",N="return r;";"undefined"!=typeof navigator&&/msie\s*([0-9]+)/i.test(navigator.userAgent)&&RegExp.$1-0<8&&(I="var r=[],ri=0;",P="r[ri++]=",N='return r.join("");'),h.prototype={getRendererBody:function(){var e=this.value,t=this.engine.options;return!e||t.strip&&/^\s*$/.test(e)?"":f(e,this.engine,1)},clone:function(){return this}},p.prototype={addChild:function(e){this.children.push(e)},open:function(e){var t=e.stack.top();t&&t.addChild(this),e.stack.push(this)},close:function(e){e.stack.top()===this&&e.stack.pop()},getRendererBody:function(){for(var e=[],t=this.children,n=0;n<t.length;n++)e.push(t[n].getRendererBody());return e.join("")},clone:function(){for(var e=new this.constructor(this.value,this.engine),t=0,n=this.children.length;n>t;t++)e.addChild(this.children[t].clone());for(var t=0,n=this.cloneProps.length;n>t;t++){var i=this.cloneProps[t];e[i]=this[i]}return e}};var H='data=data||{};var v={},fs=engine.filters,hg=typeof data.get=="function",gv=function(n,ps){var p=ps[0],d=v[p];if(d==null){if(hg){return data.get(n);}d=data[p];}for(var i=1,l=ps.length;i<l;i++)if(d!=null)d = d[ps[i]];return d;},ts=function(s){if(typeof s==="string"){return s;}if(s==null){s="";}return ""+s;};';r(g,p),r(v,p),r(m,p),r(y,p),r(b,p),r(w,p),r(C,p),r(_,p),r(S,_),r(T,_);var L={READING:1,READED:2,APPLIED:3,READY:4};m.prototype.applyMaster=g.prototype.applyMaster=function(e){function t(e){var i=e.children;if(i instanceof Array)for(var r=0,o=i.length;o>r;r++){var s=i[r];s instanceof v&&n[s.name]&&(s=i[r]=n[s.name]),t(s)}}if(this.state>=L.APPLIED)return 1;var n=this.blocks,i=this.engine.targets[e];return i&&i.applyMaster(i.master)?(this.children=i.clone().children,t(this),this.state=L.APPLIED,1):void 0},g.prototype.isReady=function(){function e(i){for(var r=0,o=i.children.length;o>r;r++){var s=i.children[r];if(s instanceof m){var a=t.targets[s.name];n=n&&a&&a.isReady(t)}else s instanceof p&&e(s)}}if(this.state>=L.READY)return 1;var t=this.engine,n=1;return this.applyMaster(this.master)?(e(this),n&&(this.state=L.READY),n):void 0},g.prototype.getRenderer=function(){if(this.renderer)return this.renderer;if(this.isReady()){var e=new Function("data","engine",[H,I,this.getRendererBody(),N].join("\n")),t=this.engine;return this.renderer=function(n){return e(n,t)},this.renderer}return null},g.prototype.open=function(e){d(e),p.prototype.open.call(this,e),this.state=L.READING,E(this,e)},y.prototype.open=w.prototype.open=function(e){e.stack.top().addChild(this)},v.prototype.open=function(e){p.prototype.open.call(this,e),(e.imp||e.target).blocks[this.name]=this},S.prototype.open=function(e){var t=new T;t.open(e);var n=d(e,_);n.addChild(this),e.stack.push(this)},T.prototype.open=function(e){var t=d(e,_);t.addChild(this),e.stack.push(this)},m.prototype.open=function(e){this.parent=e.stack.top(),this.target=e.target,p.prototype.open.call(this,e),this.state=L.READING,e.imp=this},w.prototype.close=y.prototype.close=function(){},m.prototype.close=function(e){p.prototype.close.call(this,e),this.state=L.READED,e.imp=null},g.prototype.close=function(e){p.prototype.close.call(this,e),this.state=this.master?L.READED:L.APPLIED,e.target=null},m.prototype.autoClose=function(e){var t=this.parent.children;t.push.apply(t,this.children),this.children.length=0;for(var n in this.blocks)this.target.blocks[n]=this.blocks[n];this.blocks={},this.close(e)},w.prototype.beforeOpen=m.prototype.beforeOpen=y.prototype.beforeOpen=C.prototype.beforeOpen=b.prototype.beforeOpen=v.prototype.beforeOpen=_.prototype.beforeOpen=h.prototype.beforeAdd=function(e){if(!e.stack.bottom()){var t=new g(i(),e.engine);t.open(e)}},m.prototype.getRendererBody=function(){return this.applyMaster(this.name),p.prototype.getRendererBody.call(this)},w.prototype.getRendererBody=function(){return l("{0}engine.render({2},{{3}}){1}",P,M,s(this.name),f(this.args,this.engine).replace(/(^|,)\s*([a-z0-9_]+)\s*=/gi,function(e,t,n){return(t||"")+s(n)+":"}))},y.prototype.getRendererBody=function(){return this.expr?l("v[{0}]={1};",s(this.name),f(this.expr,this.engine)):""},_.prototype.getRendererBody=function(){return l("if({0}){{1}}",f(this.value,this.engine),p.prototype.getRendererBody.call(this))},T.prototype.getRendererBody=function(){return l("}else{{0}",p.prototype.getRendererBody.call(this))},C.prototype.getRendererBody=function(){return l('var {0}={1};if({0} instanceof Array)for (var {4}=0,{5}={0}.length;{4}<{5};{4}++){v[{2}]={4};v[{3}]={0}[{4}];{6}}else if(typeof {0}==="object")for(var {4} in {0}){v[{2}]={4};v[{3}]={0}[{4}];{6}}',i(),f(this.list,this.engine),s(this.index||i()),s(this.item),i(),i(),p.prototype.getRendererBody.call(this))},b.prototype.getRendererBody=function(){var e=this.args;return l("{2}fs[{5}]((function(){{0}{4}{1}})(){6}){3}",I,N,P,M,p.prototype.getRendererBody.call(this),s(this.name),e?","+f(e,this.engine):"")};var j={};x("target",g),x("block",v),x("import",m),x("use",w),x("var",y),x("for",C),x("if",_),x("elif",S),x("else",T),x("filter",b),O.prototype.config=function(e){t(this.options,e)},O.prototype.compile=O.prototype.parse=function(e){if(e){var t=A(e,this);if(t.length)return this.targets[t[0]].getRenderer()}return new Function('return ""')},O.prototype.getRenderer=function(e){var t=this.targets[e];return t?t.getRenderer():void 0},O.prototype.render=function(e,t){var n=this.getRenderer(e);return n?n(t):""},O.prototype.addFilter=function(e,t){"function"==typeof t&&(this.filters[e]=t)};var V=new O;V.Engine=O,"object"==typeof exports&&"object"==typeof module?exports=module.exports=V:"function"==typeof define&&define.amd?define("etpl",[],V):e.etpl=V}(this),define("dt/tpl",["require","etpl","./lib"],function(require){function e(e){for(var t=!1,n=!1,r=1;r<arguments.length;r++)"raw"===arguments[r]&&(t=!0),"null"===arguments[r]&&(n=!0);if(null==e&&!n)e="";if(i.obTypeOf(e))e=e();return e=String(e),t?e:i.encodeHTML(e)}function t(e){if(null==e)e="";return String(e).replace(/^option\./,"")}var n=require("etpl"),i=require("./lib"),r={};return n.config({commandOpen:"{{",commandClose:"}}",defaultFilter:"ob"}),n.addFilter("ob",e),n.addFilter("dsp",t),r.render=function(e,t,i){if(!n.getRenderer(e)&&i)n.compile(i);return n.render(e,t||{})},r}),define("dt/ui/Component",["require","jquery","dt/lib","dt/tpl"],function(require){function e(){function e(e){t.disabled(e)}var t=this._viewModel();t.visible=g.ob(!0);var n=t.disabled;if(t.disabled=g.ob(!1),null!=n)this._disposable(n.subscribe(e,this))}function t(e){if(e){var t=b(this);e=t.$el=d(e),t.el=e[0],g.bindComponent(e,this),e.addClass(this.getFullCss().join(" "));var r=this._viewModel(),o=r.disabled,s=r.visible;this._disposable(o.subscribe(n,this)),this._disposable(s.subscribe(i,this)),n.call(this,o()),s("none"!==e[0].style.display)}}function n(e){this.$el()[e?"addClass":"removeClass"](this.getFullCss("-disabled").join(" "))}function i(e){this.$el()[e?"show":"hide"]()}function r(){var e=b(this).cptDef.tplTarget||this._getDefineProperty("tplTarget"),t=this.$el();if(e&&t&&t.length)this._renderTpl(e,null,t);if(!this._getDefineProperty("suppressConstructSub")&&t&&t.length)this._constructSub(t)}function o(){var e=this.$el(),t=b(this);e.off(t.eventNamespace),e.removeClass(this.getFullCss().join(" ")),t.viewModel=null,t.el=null,t.$el=null,t.subComponents=null,t.sub$Els=null,g.bindComponent(e,!1)}function s(e,t,n){if(!n&&g.isComponent(e)||n&&g.isJQuery(e))t(e);else if("object"===d.type(e)&&!g.isAtom(e))for(var i in e)if(e.hasOwnProperty(i)&&null!=e[i])s(e[i],t,n)}function a(e){var t=b(this),n=t.viewModel={},i=this;return this._traverseFromAncestor(function(e){n=g.merge(n,e.defineProperties.viewModel.call(i),{onlyMergeOwnPropertyInTarget:!1,levelOneNeedMerge:null,clone:!1})}),n=g.merge(n,e,{onlyMergeOwnPropertyInTarget:!!this._getDefineProperty("viewModelOnlyAccessDeclaredProperties"),levelOneNeedMerge:t.viewModelMergeMap||{}}),t.viewModel=n,n}function l(){var e=b(this),t=e.viewModelPublicMap={},n=e.viewModelMergeMap={};this._traverseFromAncestor(function(e){for(var i=e.defineProperties.viewModelPublic||[],r=0,o=i.length;o>r;r++)t[i[r]]=1;for(var s=e.defineProperties.viewModelMerge||[],r=0,o=s.length;o>r;r++)n[s[r]]=1})}function u(){var e=this._viewModel(),t=b(this),n=[];this._traverseFromAncestor(function(e){var t=e.defineProperties.css;if(d.isArray(t))n.push.apply(n,t);else if(t)n.push(t)}),t.basicCss=n;var i=e&&e.css||[];if(!d.isArray(i))i=[i];t.extraCss=i}function c(e){return e=m.normalizePath(e),!!b(this).viewModelPublicMap[e]}function f(e){if(e&&d.isFunction(e.dispose))try{e.dispose()}catch(t){if(_.debug)throw t;else if(_.printLog)_.printLog.error(t)}else if(e&&g.isJQuery(e))e.off(this._event())}function h(e){if(e=e||b(this).subComponents,s(e,function(e){try{e.dispose()}catch(t){if(_.debug)throw t;else if(_.printLog)_.printLog.error(t)}}),!g.isAtom(e))for(var t in e)if(e.hasOwnProperty(t))e[t]=null}function p(e){e=e||b(this).sub$els;var t=this._event();if(s(e,function(e){e.off(t)},!0),!g.isAtom(e))for(var n in e)if(e.hasOwnProperty(n))e[n]=null}var d=require("jquery"),g=require("dt/lib"),v=require("dt/tpl"),m=g.getByPath,y=g.setByPath,b=g.makeInner(),w="dtui-cpt",C="__originalHTML",_=b.attach(g.newClass(g.enableEvent({_define:{tpl:"",tplTarget:"",css:"",viewModel:function(){return{disabled:null,visible:null,css:"",tplTarget:null,tplRenderMode:"html"}},viewModelPublic:["disabled","visible"],viewModelMerge:[],viewModelOnlyAccessDeclaredProperties:!0,suppressConstructSub:!1},_prepare:d.noop,_init:d.noop,_dispose:d.noop,_disposeFinally:d.noop,_run:d.noop,_event:function(e){var t=b(this).eventNamespace;return(null!=e?e:"")+t},_parseViewModel:function(e){return e},_parseCptDef:function(e){return e},_construct:function(n,i,o){if(arguments.length>0&&g.assert(null!=n),!n||d.isPlainObject(n))o=i,i=n,n=null;else n=d(n);o=d.extend({},o),g.isComponent(this,!0);var s=b(this);s.cptDef=o,s.eventNamespace=".namespace"+g.localUID(),s.subComponents={},s.sub$Els={},s.disposed=!1,s.cptDisposableArea={},s.cptInstanceUID="cpt-instance-"+g.localUID(),l.call(this),i=this._parseViewModel(i||{},o)||{},a.call(this,i),u.call(this),e.call(this),t.call(this,n),this._prepare(),r.call(this),this._init()},dispose:function(){var e=b(this);if(!e.disposed){var t=this.el(),n=this[C]||"";this._dispose(),h.call(this),p.call(this),this._disposable(!1),o.call(this),this._disposeFinally(),t.innerHTML=n,e.disposed=!0}},isDisposed:function(){return!!b(this).disposed},isFrozen:function(){return this._viewModel().disabled()||this.isDisposed()},_disposable:function(e,t){g.assert(null!=e);var n=b(this).cptDisposableArea;if(null==e)return e;else if(e===!1){for(var i in n)if(n.hasOwnProperty(i))f.call(this,n[i]),n[i]=null}else if("string"===d.type(e))f.call(this,n[e]),n[e]=null;else g.assert(d.isFunction(e.dispose)||g.isJQuery(e),"No dispose method nor not jQuery!"),t=t||"-component-anonymouse-disposable"+g.localUID(),n[t]=e;return e},resize:d.noop,_manuInitView:function(e){t.call(this,e),this._constructSub(e)},_applyTpl:function(e,t){if(t)this._renderTpl(t,null,e),this._constructSub(e)},_renderTpl:function(e,t,n){var i={viewModel:t||this._viewModel(),lang:this.getLang(),constant:this.getConstant()},r=v.render(e,i,this._getDefineProperty("tpl"))||"";return n&&d(n)[this._viewModel().tplRenderMode](r),r},_constructSub:function(e,t){var n=d(e);if(g.assert(n.length),t&&n.data("cpt"))this._constructSubCpt.call(this,e);var i=this;d("*[data-cpt]",n).each(function(e,t){i._constructSubCpt(t)})},_constructSubCpt:function(e){var t=d(e),n=e.innerHTML,i=this._viewModel(),r=this._parseCptDef(new Function("viewModel","lib","lang","constant","return {"+t.data("cpt")+"};").call(this,i,g,this.getLang(),this.getConstant())),o=this.getCptClass(r.type),s=r.viewModelGet?m(r.viewModelGet,i):r.viewModel,a=new o(e,s,r);return a[C]=n,this._sub(r.name||"-sub-cpt-name-"+g.localUID(),a)},recreateSubCpt:function(e){var t=this._sub(e);if(t){var n=t.el();t.dispose(),this._sub(e,null),this._constructSubCpt(n)}},traversalRun:function(e){s(b(this).subComponents,function(t){t.traversalRun(e)}),this._run(e)},_sub:function(e,t,n){var i=b(this).subComponents;if(arguments.length<2)return m(e,i,m.actionChoice.notPlainReturn);else return y(e,t,i,n?y.actionChoice.notPlainOverlap:y.actionChoice.notPlainThrow),t},_getDefineProperty:function(e){return this.constructor.defineProperties[e]},el:function(){return b(this).el},$el:function(e,t,n){var i=b(this);if(0===arguments.length)return i.$el;if(1===arguments.length)return m(e,i.sub$Els,m.actionChoice.notPlainReturn);else return y(e,t,i.sub$Els,n?y.actionChoice.notPlainOverlap:y.actionChoice.notPlainThrow),t},css:function(){return this._getDefineProperty("css")||""},viewModel:function(e){if(c.call(this,e))return m(e,b(this).viewModel);else throw new Error(e+" is private!")},_viewModel:function(){return b(this).viewModel},getCptClass:function(e){return _.cptClasses[e]},getCptDef:function(e){return b(this).cptDef[e]},uid:function(){return b(this).cptInstanceUID},getFullCss:function(e){var t=[w],n=b(this);return t.push.apply(t,n.basicCss||[]),t.push.apply(t,n.extraCss||[]),d.map(t,function(t){return t+(e||"")})},isDisabled:function(){return!!g.peek(this._viewModel().disabled)},getLang:function(){return _.defaultLanguageSet},getConstant:function(){return _.defaultConstant},clone:d.noop,_traverseFromAncestor:function(e){for(var t=[],n=this.constructor;n;n=n.prototype._superClass)t.push(n);for(var i=t.length;i--;)e.call(this,t[i])},localOb:function(e,t){var n,i=b(this),r=i.localObRepo||(i.localObRepo={});if(arguments.length>1)if(t===!1)n=r[e],delete r[e];else g.assert(null==r[e]),n=r[e]=t;else n=r[e];return n},getAncestorLocalOb:function(e){for(var t,n,i=this.$el();(i=i&&i.parent())[0]&&!(n=(t=g.getComponent(i))&&t.localOb(e))&&i[0]!==document.body;);return n}})));return _.cptClasses={},_.defaultLanguageSet={},_.defaultConstant={},_.consoleLog=function(e){var t=window.console;if(g.isObject(t)&&"function"==typeof t.log)t.log(g.stringifyJSON(e))},_}),define("spreadsheet/lang",["require","jquery"],function(require){var e=require("jquery"),t={langCode:"cn",pageTitle:"表格数据转换工具",pageDescHTML:"使用说明：在<strong>左侧</strong>贴入数据&nbsp;&nbsp;<strong>下方</strong>立刻产生结果",typeSetting:"类型设置：",emptyValueSetting:"空值设置：",quotationMarkSetting:"引号设置：",quotationMarks:{singleQuotes:"单引号",doubleQuotes:"双引号"},dimensionSetting:"维度设置：",attributeSetting:"属性设置：",codeFormatSetting:"结果格式设置：",codeFormat:{compressed:"压缩",expanded2Indent:"展开（2空格缩进）",expanded4Indent:"展开（4空格缩进）"},convertResult:"转换结果：",dimDesc:{dim1to1:"每一列转换为一个一维数组",dimallto2:"总体转换成一个二维数组",dim1to2:"每一列转换成一个二维数组",dim2to2:"每二列转换成一个二维数组",dim3to2:"每三列转换成一个二维数组",dim4to2:"每四列转换成一个二维数组",dim5to2:"每五列转换成一个二维数组"},codeInputTitle:"#{rangeDesc} 列转换结果：",attrInfoTitle:"列 #{colName} ",attrInfoAttrName:"属性名：",attrInfoType:"类型：",ecEmptyValue:"ECharts标准空值（中划线：'-'）",jsDataTypeDimArray:"纯数组",jsDataTypeArrayObject:"数组+对象"},n={langCode:"en",pageTitle:"Spreadsheet Data Convert Tool",pageDescHTML:"Tip: Paste data on the <strong>left</strong>, and get result <strong>below</strong> immediately.",typeSetting:"Type: ",emptyValueSetting:"Empty Value: ",quotationMarkSetting:"Quotation Mark: ",quotationMarks:{singleQuotes:"single qutation mark",doubleQuotes:"double qutation mark"},dimensionSetting:"Dimension: ",dimDesc:{dim1to1:"Convert each column to 1-dimension array.",dimallto2:"Convert all of the data converted to 2-dimension array.",dim1to2:"Convert each column converted to 2-dimension array.",dim2to2:"Convert each two column converted to 2-dimension array.",dim3to2:"Convert each three column converted to 2-dimension array.",dim4to2:"Convert each fore column converted to 2-dimension array.",dim5to2:"Convert each five column converted to 2-dimension array."},attributeSetting:"Attributes: ",codeFormatSetting:"Formatting Result: ",codeFormat:{compressed:"compress",expanded2Indent:"expand and indent with 2 space",expanded4Indent:"expand and indent with 4 space"},convertResult:"Result: ",codeInputTitle:"Result from Column #{rangeDesc}:",attrInfoTitle:"Column #{colName} ",attrInfoAttrName:"Attr name: ",attrInfoType:"Type: ",ecEmptyValue:"ECharts Empty Value ('-')",jsDataTypeDimArray:"Array",jsDataTypeArrayObject:"Array + Object"};return"en"===e("html").attr("lang").toLowerCase()?n:t}),define("spreadsheet/constant",["require"],function(){var e={};return e.EC_EMPTY_VALUE="-",e.JSDATA_UPDATE_DELAY=700,e.JSDATA_DIM_ARRAY="dimArray",e.JSDATA_ARRAY_OBJECT="arrayObject",e.UI_DATA_TABLE="dataTable",e.UI_CODE_INPUTS="codeInputs",e}),define("spreadsheet/helper",["require","jquery"],function(require){var e=require("jquery"),t={};return t.formatJSDataToEditorData=function(e,t,n){var i=t.getEmptyValue();if(e===i)return n.getEmptyValue();else return e},t.formatEditorDataToJSData=function(e,t,n){var i=n.getEmptyValue();if(e===i)return t.getEmptyValue();else return e},t.objectPropertyCount=function(e){e=e||{};var t=0;for(var n in e)if(e.hasOwnProperty(n))t++;return t},t.parseToArray=function(t){var n;try{n=new Function("return ("+t+")")()}catch(i){}if(!e.isArray(n))n=null;return n},t}),function(){function e(e){this._n=e}function t(e,t,n){var i,r=Math.pow(10,t);if(i=(Math.round(e*r)/r).toFixed(t),n){var o=new RegExp("0{1,"+n+"}$");i=i.replace(o,"")}return i}function n(e,t){var n;return n=t.indexOf("$")>-1?r(e,t):t.indexOf("%")>-1?o(e,t):t.indexOf(":")>-1?s(e,t):l(e,t)}function i(e,t){if(t.indexOf(":")>-1)e._n=a(t);else if(t===d)e._n=0;else{var n=t;"."!==h[p].delimiters.decimal&&(t=t.replace(/\./g,"").replace(h[p].delimiters.decimal,"."));for(var i=new RegExp(h[p].abbreviations.thousand+"(?:\\)|(\\"+h[p].currency.symbol+")?(?:\\))?)?$"),r=new RegExp(h[p].abbreviations.million+"(?:\\)|(\\"+h[p].currency.symbol+")?(?:\\))?)?$"),o=new RegExp(h[p].abbreviations.billion+"(?:\\)|(\\"+h[p].currency.symbol+")?(?:\\))?)?$"),s=new RegExp(h[p].abbreviations.trillion+"(?:\\)|(\\"+h[p].currency.symbol+")?(?:\\))?)?$"),l=["KB","MB","GB","TB","PB","EB","ZB","YB"],u=!1,c=0;c<=l.length&&!(u=t.indexOf(l[c])>-1?Math.pow(1024,c+1):!1);c++);e._n=(u?u:1)*(n.match(i)?Math.pow(10,3):1)*(n.match(r)?Math.pow(10,6):1)*(n.match(o)?Math.pow(10,9):1)*(n.match(s)?Math.pow(10,12):1)*(t.indexOf("%")>-1?.01:1)*Number((t.indexOf("(")>-1?"-":"")+t.replace(/[^0-9\.-]+/g,"")),e._n=u?Math.ceil(e._n):e._n}return e._n}function r(e,t){var i=t.indexOf("$")<=1?!0:!1,r="";t.indexOf(" $")>-1?(r=" ",t=t.replace(" $","")):t.indexOf("$ ")>-1?(r=" ",t=t.replace("$ ","")):t=t.replace("$","");var o=n(e,t);return i?o.indexOf("(")>-1||o.indexOf("-")>-1?(o=o.split(""),o.splice(1,0,h[p].currency.symbol+r),o=o.join("")):o=h[p].currency.symbol+r+o:o.indexOf(")")>-1?(o=o.split(""),o.splice(-1,0,r+h[p].currency.symbol),o=o.join("")):o=o+r+h[p].currency.symbol,o}function o(e,t){var i="";t.indexOf(" %")>-1?(i=" ",t=t.replace(" %","")):t=t.replace("%",""),e._n=100*e._n;var r=n(e,t);return r.indexOf(")")>-1?(r=r.split(""),r.splice(-1,0,i+"%"),r=r.join("")):r=r+i+"%",r}function s(e){var t=Math.floor(e._n/60/60),n=Math.floor((e._n-60*t*60)/60),i=Math.round(e._n-60*t*60-60*n);return t+":"+(10>n?"0"+n:n)+":"+(10>i?"0"+i:i)}function a(e){var t=e.split(":"),n=0;return 3===t.length?(n+=60*Number(t[0])*60,n+=60*Number(t[1]),n+=Number(t[2])):2===t.lenght&&(n+=60*Number(t[0]),n+=Number(t[1])),Number(n)}function l(e,n){var i=!1,r=!1,o="",s="",a="",l=Math.abs(e._n);if(0===e._n&&null!==d)return d;if(n.indexOf("(")>-1&&(i=!0,n=n.slice(1,-1)),n.indexOf("a")>-1&&(n.indexOf(" a")>-1?(o=" ",n=n.replace(" a","")):n=n.replace("a",""),l>=Math.pow(10,12)?(o+=h[p].abbreviations.trillion,e._n=e._n/Math.pow(10,12)):l<Math.pow(10,12)&&l>=Math.pow(10,9)?(o+=h[p].abbreviations.billion,e._n=e._n/Math.pow(10,9)):l<Math.pow(10,9)&&l>=Math.pow(10,6)?(o+=h[p].abbreviations.million,e._n=e._n/Math.pow(10,6)):l<Math.pow(10,6)&&l>=Math.pow(10,3)&&(o+=h[p].abbreviations.thousand,e._n=e._n/Math.pow(10,3))),n.indexOf("b")>-1){n.indexOf(" b")>-1?(s=" ",n=n.replace(" b","")):n=n.replace("b","");for(var u,c,f=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],g=0;g<=f.length;g++)if(u=Math.pow(1024,g),c=Math.pow(1024,g+1),e._n>=u&&e._n<c){s+=f[g],u>0&&(e._n=e._n/u);break}}n.indexOf("o")>-1&&(n.indexOf(" o")>-1?(a=" ",n=n.replace(" o","")):n=n.replace("o",""),a+=h[p].ordinal(e._n)),n.indexOf("[.]")>-1&&(r=!0,n=n.replace("[.]","."));var v=e._n.toString().split(".")[0],m=n.split(".")[1],y=n.indexOf(","),b="",w=!1;return m?(m.indexOf("[")>-1?(m=m.replace("]",""),m=m.split("["),b=t(e._n,m[0].length+m[1].length,m[1].length)):b=t(e._n,m.length),v=b.split(".")[0],b=b.split(".")[1].length?h[p].delimiters.decimal+b.split(".")[1]:"",r&&0===Number(b)&&(b="")):v=t(e._n,null),v.indexOf("-")>-1&&(v=v.slice(1),w=!0),y>-1&&(v=v.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+h[p].delimiters.thousands)),0===n.indexOf(".")&&(v=""),(i&&w?"(":"")+(!i&&w?"-":"")+v+b+(a?a:"")+(o?o:"")+(s?s:"")+(i&&w?")":"")}function u(e,t){h[e]=t}var c,f="1.4.7",h={},p="en",d=null,g="undefined"!=typeof module&&module.exports;c=function(t){return c.isNumeral(t)?t=t.value():Number(t)||(t=0),new e(Number(t))},c.version=f,c.isNumeral=function(t){return t instanceof e},c.language=function(e,t){return e?(e&&!t&&(p=e),(t||!h[e])&&u(e,t),c):p},c.language("en",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(e){var t=e%10;return 1===~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th"},currency:{symbol:"$"}}),c.zeroFormat=function(e){d="string"==typeof e?e:null},c.fn=e.prototype={clone:function(){return c(this)},format:function(e){return n(this,e?e:c.defaultFormat)},unformat:function(e){return i(this,e?e:c.defaultFormat)},value:function(){return this._n},valueOf:function(){return this._n},set:function(e){return this._n=Number(e),this},add:function(e){return this._n=this._n+Number(e),this},subtract:function(e){return this._n=this._n-Number(e),this},multiply:function(e){return this._n=this._n*Number(e),this},divide:function(e){return this._n=this._n/Number(e),this},difference:function(e){var t=this._n-Number(e);return 0>t&&(t=-t),t}},g&&(module.exports=c),"undefined"==typeof ender&&(this.numeral=c),"function"==typeof define&&define.amd&&define("numeral",[],function(){return c})}.call(this),define("jqueryhandsontable",["require","jquery","numeral"],function(require){var e=require("jquery"),t=require("numeral"),n={extension:{},plugins:{},helper:{}};return function(n,i,r){"use strict";function o(){this.refCounter=0,this.init()}function s(){function e(){var e=this;e.registerTimeout("enableObserveChanges",function(){e.updateSettings({observeChanges:!0})},0)}function t(e){return function(t,n){return t[1]===n[1]?0:null===t[1]?1:null===n[1]?-1:t[1]<n[1]?e?-1:1:t[1]>n[1]?e?1:-1:0}}function n(e){return function(t,n){if(t[1]===n[1])return 0;if(null===t[1])return 1;if(null===n[1])return-1;var i=new Date(t[1]),r=new Date(n[1]);return r>i?e?-1:1:i>r?e?1:-1:0}}function i(e){return"undefined"!=typeof e.sortColumn}var r=this;this.init=function(t){var n,i,o=this,l=o.getSettings().columnSorting;if(o.sortingEnabled=!!l,o.sortingEnabled){o.sortIndex=[];var u=s.call(o);"undefined"!=typeof u?(n=u.sortColumn,i=u.sortOrder):(n=l.column,i=l.sortOrder),r.sortByColumn.call(o,n,i),o.sort=function(){var e=Array.prototype.slice.call(arguments);return r.sortByColumn.apply(o,e)},"undefined"==typeof o.getSettings().observeChanges&&e.call(o),"afterInit"==t&&(a.call(o),o.addHook("afterCreateRow",r.afterCreateRow),o.addHook("afterRemoveRow",r.afterRemoveRow),o.addHook("afterLoadData",r.init))}else delete o.sort,o.removeHook("afterCreateRow",r.afterCreateRow),o.removeHook("afterRemoveRow",r.afterRemoveRow),o.removeHook("afterLoadData",r.init)},this.setSortingColumn=function(e,t){var n=this;return"undefined"==typeof e?(delete n.sortColumn,void delete n.sortOrder):(n.sortColumn===e&&"undefined"==typeof t?n.sortOrder=!n.sortOrder:n.sortOrder="undefined"!=typeof t?t:!0,void(n.sortColumn=e))},this.sortByColumn=function(e,t){var n=this;r.setSortingColumn.call(n,e,t),"undefined"!=typeof n.sortColumn&&(n.PluginHooks.run("beforeColumnSort",n.sortColumn,n.sortOrder),r.sort.call(n),n.render(),o.call(n),n.PluginHooks.run("afterColumnSort",n.sortColumn,n.sortOrder))};var o=function(){var e=this,t={};"undefined"!=typeof e.sortColumn&&(t.sortColumn=e.sortColumn),"undefined"!=typeof e.sortOrder&&(t.sortOrder=e.sortOrder),(t.hasOwnProperty("sortColumn")||t.hasOwnProperty("sortOrder"))&&e.PluginHooks.run("persistentStateSave","columnSorting",t)
},s=function(){var e=this,t={};return e.PluginHooks.run("persistentStateLoad","columnSorting",t),t.value},a=function(){function e(){var e=n.view.TBODY.querySelector("tr").querySelectorAll("th");return e.length}function t(t){var i=n.view.wt.wtDom.closest(t,"TH");return n.view.wt.wtDom.index(i)-e()}var n=this;n.rootElement.on("click.handsontable",".columnSorting",function(e){if(n.view.wt.wtDom.hasClass(e.target,"columnSorting")){var i=t(e.target);r.sortByColumn.call(n,i)}})};this.sort=function(){var e=this;if("undefined"!=typeof e.sortOrder){e.sortingEnabled=!1,e.sortIndex.length=0;for(var i=this.colOffset(),r=0,o=this.countRows()-e.getSettings().minSpareRows;o>r;r++)this.sortIndex.push([r,e.getDataAtCell(r,this.sortColumn+i)]);var s,a=e.getCellMeta(0,e.sortColumn);switch(a.type){case"date":s=n;break;default:s=t}this.sortIndex.sort(s(e.sortOrder));for(var r=this.sortIndex.length;r<e.countRows();r++)this.sortIndex.push([r,e.getDataAtCell(r,this.sortColumn+i)]);e.sortingEnabled=!0}},this.translateRow=function(e){var t=this;return t.sortingEnabled&&t.sortIndex&&t.sortIndex.length&&t.sortIndex[e]?t.sortIndex[e][0]:e},this.onBeforeGetSet=function(e){var t=this;e.row=r.translateRow.call(t,e.row)},this.untranslateRow=function(e){var t=this;if(t.sortingEnabled&&t.sortIndex&&t.sortIndex.length)for(var n=0;n<t.sortIndex.length;n++)if(t.sortIndex[n][0]==e)return n},this.getColHeader=function(e,t){this.getSettings().columnSorting&&this.view.wt.wtDom.addClass(t.querySelector(".colHeader"),"columnSorting")},this.afterCreateRow=function(e,t){var n=this;if(i(n)){for(var r=0;r<n.sortIndex.length;r++)n.sortIndex[r][0]>=e&&(n.sortIndex[r][0]+=t);for(var r=0;t>r;r++)n.sortIndex.splice(e+r,0,[e+r,n.getData()[e+r][n.sortColumn+n.colOffset()]]);o.call(n)}},this.afterRemoveRow=function(e,t){var n=this;if(i(n)){var s=r.translateRow.call(n,e);n.sortIndex.splice(e,t);for(var a=0;a<n.sortIndex.length;a++)n.sortIndex[a][0]>s&&(n.sortIndex[a][0]-=t);o.call(n)}},this.afterChangeSort=function(e){var t=this,n=!1,i={};if(e){for(var o=0;o<e.length;o++)if(e[o][1]==t.sortColumn){n=!0,i.row=r.translateRow.call(t,e[o][0]),i.col=e[o][1];break}n&&setTimeout(function(){r.sort.call(t),t.render(),t.selectCell(r.untranslateRow.call(t,i.row),i.col)},0)}}}function a(){var e,t,i,r,o,s=document.createElement("DIV"),a=s.style;s.className="ghost",a.position="absolute",a.top="25px",a.left=0,a.width="10px",a.height="10px",a.backgroundColor="#CCC",a.opacity=.7;var l=function(){var e=this;e.PluginHooks.run("persistentStateSave","manualColumnPositions",e.manualColumnPositions)},u=function(){var e=this,t={};return e.PluginHooks.run("persistentStateLoad","manualColumnPositions",t),t.value},c=function(){var u=this;u.rootElement.on("mousemove.manualColumnMove",function(t){e&&(a.left=o+t.pageX-r+6+"px","none"===a.display&&(a.display="block"))}),u.rootElement.on("mouseup.manualColumnMove",function(){e&&(i>t&&i--,u.getSettings().rowHeaders&&(t--,i--),u.manualColumnPositions.splice(i,0,u.manualColumnPositions.splice(t,1)[0]),n(".manualColumnMover.active").removeClass("active"),e=!1,u.forceFullRender=!0,u.view.render(),a.display="none",l.call(u),u.PluginHooks.run("afterColumnMove",t,i))}),u.rootElement.on("mousedown.manualColumnMove",".manualColumnMover",function(n){var l=n.currentTarget,c=u.view.wt.wtDom.closest(l,"TH");t=u.view.wt.wtDom.index(c)+u.colOffset(),i=t,e=!0,r=n.pageX;var f=u.$table[0];f.parentNode.appendChild(s),a.width=u.view.wt.wtDom.outerWidth(c)+"px",a.height=u.view.wt.wtDom.outerHeight(f)+"px",o=parseInt(u.view.wt.wtDom.offset(c).left-u.view.wt.wtDom.offset(f).left,10),a.left=o+6+"px"}),u.rootElement.on("mouseenter.manualColumnMove","td, th",function(){if(e){var t=u.view.THEAD.querySelector(".manualColumnMover.active");t&&u.view.wt.wtDom.removeClass(t,"active"),i=u.view.wt.wtDom.index(this)+u.colOffset();var n=u.view.THEAD.querySelectorAll("th"),r=n[i].querySelector(".manualColumnMover");u.view.wt.wtDom.addClass(r,"active")}}),u.addHook("afterDestroy",f)},f=function(){var e=this;e.rootElement.off("mouseup.manualColumnMove"),e.rootElement.off("mousemove.manualColumnMove"),e.rootElement.off("mousedown.manualColumnMove"),e.rootElement.off("mouseenter.manualColumnMove")};this.beforeInit=function(){this.manualColumnPositions=[]},this.init=function(e){var t=this,n=!!this.getSettings().manualColumnMove;if(n){var i=this.getSettings().manualColumnMove,r=u.call(t);"undefined"!=typeof r?this.manualColumnPositions=r:i instanceof Array?this.manualColumnPositions=i:this.manualColumnPositions=[],t.forceFullRender=!0,"afterInit"==e&&(c.call(this),this.manualColumnPositions.length>0&&(this.forceFullRender=!0,this.render()))}else f.call(this),this.manualColumnPositions=[]},this.modifyCol=function(e){return this.getSettings().manualColumnMove?("undefined"==typeof this.manualColumnPositions[e]&&(this.manualColumnPositions[e]=e),this.manualColumnPositions[e]):e},this.getColHeader=function(e,t){if(this.getSettings().manualColumnMove){var n=document.createElement("DIV");n.className="manualColumnMover",t.firstChild.appendChild(n)}}}function l(){function e(e){a=this,r=e;var t=this.view.wt.wtTable.getCoords(e)[1];if(t>=0){o=t;var n=this.view.wt.wtDom.offset(this.rootElement[0]).left,i=this.view.wt.wtDom.offset(e).left;f=i-n-6,h.style.left=f+parseInt(this.view.wt.wtDom.outerWidth(e),10)+"px",this.rootElement[0].appendChild(h)}}function t(){var e=this;c=parseInt(this.view.wt.wtDom.outerWidth(r),10),e.view.wt.wtDom.addClass(h,"active"),g.height=e.view.wt.wtDom.outerHeight(e.$table[0])+"px",i=e}var i,r,o,s,a,l,u,c,f,h=document.createElement("DIV"),p=document.createElement("DIV"),d=document.createElement("DIV"),g=d.style;h.className="manualColumnResizer",p.className="manualColumnResizerHandle",h.appendChild(p),d.className="manualColumnResizerLine",h.appendChild(d);var v=n(document);v.mousemove(function(e){i&&(s=c+(e.pageX-u),l=w(o,s),h.style.left=f+s+"px")}),v.mouseup(function(){i&&(a.view.wt.wtDom.removeClass(h,"active"),i=!1,l!=c&&(a.forceFullRender=!0,a.view.render(),m.call(a),a.PluginHooks.run("afterColumnResize",o,l)),e.call(a,r))});var m=function(){var e=this;e.PluginHooks.run("persistentStateSave","manualColumnWidths",e.manualColumnWidths)},y=function(){var e=this,t={};return e.PluginHooks.run("persistentStateLoad","manualColumnWidths",t),t.value},b=function(){var n=this,r=0,s=null;this.rootElement.on("mouseenter.handsontable","th",function(t){i||e.call(n,t.currentTarget)}),this.rootElement.on("mousedown.handsontable",".manualColumnResizer",function(){null==s&&(s=setTimeout(function(){r>=2&&(l=n.determineColumnWidth.call(n,o),w(o,l),n.forceFullRender=!0,n.view.render(),n.PluginHooks.run("afterColumnResize",o,l)),r=0,s=null},500)),r++}),this.rootElement.on("mousedown.handsontable",".manualColumnResizer",function(e){u=e.pageX,t.call(n),l=c})};this.beforeInit=function(){this.manualColumnWidths=[]},this.init=function(e){var t=this,n=!!this.getSettings().manualColumnResize;if(n){var i=this.getSettings().manualColumnResize,r=y.call(t);"undefined"!=typeof r?this.manualColumnWidths=r:i instanceof Array?this.manualColumnWidths=i:this.manualColumnWidths=[],"afterInit"==e&&(b.call(this),t.forceFullRender=!0,t.render())}};var w=function(e,t){return t=Math.max(t,20),e=a.PluginHooks.execute("modifyCol",e),a.manualColumnWidths[e]=t,t};this.getColWidth=function(e,t){this.getSettings().manualColumnResize&&this.manualColumnWidths[e]&&(t.width=this.manualColumnWidths[e])}}function u(e){var t,n=function(){i.localStorage[e+"__persistentStateKeys"]=JSON.stringify(t)},r=function(){var n=i.localStorage[e+"__persistentStateKeys"],r="string"==typeof n?JSON.parse(n):void 0;t=r?r:[]},o=function(){t=[],n()};r(),this.saveValue=function(r,o){i.localStorage[e+"_"+r]=JSON.stringify(o),-1==t.indexOf(r)&&(t.push(r),n())},this.loadValue=function(t,n){t="undefined"!=typeof t?t:n;var r=i.localStorage[e+"_"+t];return"undefined"==typeof r?void 0:JSON.parse(r)},this.reset=function(t){i.localStorage.removeItem(e+"_"+t)},this.resetAll=function(){for(var n=0;n<t.length;n++)i.localStorage.removeItem(e+"_"+t[n]);o()}}function c(){this.boundaries=null,this.callback=null}function f(){this.maxOuts=10}function h(e,t){var i;this.instance=e,this.settings=t,this.wtDom=this.instance.wtDom,this.main=document.createElement("div"),i=this.main.style,i.position="absolute",i.top=0,i.left=0;for(var r=0;5>r;r++){var o=document.createElement("DIV");o.className="wtBorder "+(t.className||""),i=o.style,i.backgroundColor=t.border.color,i.height=t.border.width+"px",i.width=t.border.width+"px",this.main.appendChild(o)}this.top=this.main.childNodes[0],this.left=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.right=this.main.childNodes[3],this.topStyle=this.top.style,this.leftStyle=this.left.style,this.bottomStyle=this.bottom.style,this.rightStyle=this.right.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width="5px",this.cornerStyle.height="5px",this.cornerStyle.border="2px solid #FFF",this.disappear(),e.wtTable.bordersHolder||(e.wtTable.bordersHolder=document.createElement("div"),e.wtTable.bordersHolder.className="htBorders",e.wtTable.hider.appendChild(e.wtTable.bordersHolder)),e.wtTable.bordersHolder.appendChild(this.main);var s=!1,a=n(document.body);a.on("mousedown.walkontable."+e.guid,function(){s=!0}),a.on("mouseup.walkontable."+e.guid,function(){s=!1}),n(this.main.childNodes).on("mouseenter",function(t){if(s&&e.getSetting("hideBorderOnMouseDownOver")){t.preventDefault(),t.stopImmediatePropagation();var i=this.getBoundingClientRect(),r=n(this);r.hide();var o=function(e){return e.clientY<Math.floor(i.top)?!0:e.clientY>Math.ceil(i.top+i.height)?!0:e.clientX<Math.floor(i.left)?!0:e.clientX>Math.ceil(i.left+i.width)?!0:void 0};a.on("mousemove.border."+e.guid,function(t){o(t)&&(a.off("mousemove.border."+e.guid),r.show())})}})}function p(){this.offset=0,this.total=0,this.fixedCount=0}function d(e){this.instance=e}function g(){this.cache=[]}function v(){this.countTH=0}function m(e,t,n,i){var r,o=0;for(d.apply(this,arguments),this.containerSizeFn=t,this.cellSizesSum=0,this.cellSizes=[],this.cellStretch=[],this.cellCount=0,this.remainingSize=0,this.strategy=i;(r=n(o),void 0!==r)&&!(this.cellSizesSum>=this.getContainerSize(this.cellSizesSum+r));)this.cellSizes.push(r),this.cellSizesSum+=r,this.cellCount++,o++;var s=this.getContainerSize(this.cellSizesSum);this.remainingSize=this.cellSizesSum-s}function y(e){var t=this,n=[];if(this.guid="wt_"+_(),this.wtDom=new w,e.cloneSource?(this.cloneSource=e.cloneSource,this.cloneOverlay=e.cloneOverlay,this.wtSettings=e.cloneSource.wtSettings,this.wtTable=new P(this,e.table),this.wtScroll=new E(this),this.wtViewport=e.cloneSource.wtViewport):(this.wtSettings=new I(this,e),this.wtTable=new P(this,e.table),this.wtScroll=new E(this),this.wtViewport=new M(this),this.wtScrollbars=new D(this),this.wtWheel=new N(this),this.wtEvent=new C(this)),this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(var i=0,r=this.wtTable.THEAD.childNodes[0].childNodes.length;r>i;i++)n.push(this.wtTable.THEAD.childNodes[0].childNodes[i].innerHTML);this.getSetting("columnHeaders").length||this.update("columnHeaders",[function(e,i){t.wtDom.fastInnerText(i,n[e])}])}this.selections={};var o=this.getSetting("selections");if(o)for(var s in o)o.hasOwnProperty(s)&&(this.selections[s]=new k(this,o[s]));this.drawn=!1,this.drawInterrupted=!1}function b(e){this.instance=e,this.init(),this.clone=this.makeClone("debug"),this.clone.wtTable.holder.style.opacity=.4,this.clone.wtTable.holder.style.textShadow="0 0 2px #ff0000";var t,i=this,r=0,o=0,s=i.clone.wtTable.holder.parentNode;n(document.body).on("mousemove."+this.instance.guid,function(e){i.instance.wtTable.holder.parentNode&&(e.clientX-r>-5&&e.clientX-r<5&&e.clientY-o>-5&&e.clientY-o<5||(r=e.clientX,o=e.clientY,w.prototype.addClass(s,"wtDebugHidden"),w.prototype.removeClass(s,"wtDebugVisible"),clearTimeout(t),t=setTimeout(function(){w.prototype.removeClass(s,"wtDebugHidden"),w.prototype.addClass(s,"wtDebugVisible")},1e3)))})}function w(){}function C(e){var t=this;this.instance=e,this.wtDom=this.instance.wtDom;var i,r=[null,null],o=[null,null],s=function(e){var n=t.parentCell(e.target);t.wtDom.hasClass(e.target,"corner")?t.instance.getSetting("onCellCornerMouseDown",e,e.target):n.TD&&"TD"===n.TD.nodeName&&t.instance.hasSetting("onCellMouseDown")&&t.instance.getSetting("onCellMouseDown",e,n.coords,n.TD),2!==e.button&&n.TD&&"TD"===n.TD.nodeName&&(r[0]=n.TD,clearTimeout(o[0]),o[0]=setTimeout(function(){r[0]=null},1e3))},a=function(e){if(t.instance.hasSetting("onCellMouseOver")){var n=t.instance.wtTable.TABLE,r=t.wtDom.closest(e.target,["TD","TH"],n);r&&r!==i&&t.wtDom.isChildOf(r,n)&&(i=r,"TD"===r.nodeName&&t.instance.getSetting("onCellMouseOver",e,t.instance.wtTable.getCoords(r),r))}},l=function(e){if(2!==e.button){var n=t.parentCell(e.target);n.TD===r[0]&&n.TD===r[1]?(t.wtDom.hasClass(e.target,"corner")?t.instance.getSetting("onCellCornerDblClick",e,n.coords,n.TD):n.TD&&t.instance.getSetting("onCellDblClick",e,n.coords,n.TD),r[0]=null,r[1]=null):n.TD===r[0]&&(r[1]=n.TD,clearTimeout(o[1]),o[1]=setTimeout(function(){r[1]=null},500))}};n(this.instance.wtTable.holder).on("mousedown",s),n(this.instance.wtTable.TABLE).on("mouseover",a),n(this.instance.wtTable.holder).on("mouseup",l)}function _(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+e()+e()}function S(){}function T(e,t,n){d.apply(this,arguments),this.containerSizeFn=t,this.sizeAtIndex=n,this.cellSizesSum=0,this.cellSizes=[],this.cellCount=0,this.remainingSize=-(1/0)}function E(e){this.instance=e}function x(){}function O(e){this.instance=e,this.init(),this.clone=this.makeClone("corner")}function A(e){this.instance=e,this.type="horizontal",this.cellSize=50,this.init(),this.clone=this.makeClone("left")}function R(e){this.instance=e,this.type="vertical",this.cellSize=23,this.init(),this.clone=this.makeClone("top")}function D(e){this.instance=e,e.getSetting("nativeScrollbars")?(e.update("scrollbarWidth",e.wtDom.getScrollbarWidth()),e.update("scrollbarHeight",e.wtDom.getScrollbarWidth()),this.vertical=new R(e),this.horizontal=new A(e),this.corner=new O(e),e.getSetting("debug")&&(this.debug=new b(e)),this.registerListeners()):(this.vertical=new K(e),this.horizontal=new Y(e))}function k(e,t){this.instance=e,this.settings=t,this.selected=[],t.border&&(this.border=new h(e,t))}function I(e,t){var n=this;this.instance=e,this.defaults={table:void 0,debug:!1,scrollH:"auto",scrollV:"auto",nativeScrollbars:!1,stretchH:"hybrid",currentRowClassName:null,currentColumnClassName:null,data:void 0,offsetRow:0,offsetColumn:0,fixedColumnsLeft:0,fixedRowsTop:0,rowHeaders:function(){return[]},columnHeaders:function(){return[]},totalRows:void 0,totalColumns:void 0,width:null,height:null,cellRenderer:function(e,t,i){var r=n.getSetting("data",e,t);n.instance.wtDom.fastInnerText(i,void 0===r||null===r?"":r)},columnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,onCellMouseDown:null,onCellMouseOver:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onScrollVertically:null,onScrollHorizontally:null,scrollbarWidth:10,scrollbarHeight:10},this.settings={};for(var i in this.defaults)if(this.defaults.hasOwnProperty(i))if(void 0!==t[i])this.settings[i]=t[i];else{if(void 0===this.defaults[i])throw new Error('A required setting "'+i+'" was not provided');this.settings[i]=this.defaults[i]}}function P(e,t){this.instance=e,this.TABLE=t,this.wtDom=this.instance.wtDom,this.wtDom.removeTextNodes(this.TABLE);var n=this.TABLE.parentNode;if(!n||1!==n.nodeType||!this.wtDom.hasClass(n,"wtHolder")){var i=document.createElement("DIV");i.className="wtSpreader",n&&n.insertBefore(i,this.TABLE),i.appendChild(this.TABLE)}if(this.spreader=this.TABLE.parentNode,n=this.spreader.parentNode,!n||1!==n.nodeType||!this.wtDom.hasClass(n,"wtHolder")){var r=document.createElement("DIV");r.className="wtHider",n&&n.insertBefore(r,this.spreader),r.appendChild(this.spreader)}if(this.hider=this.spreader.parentNode,this.hiderStyle=this.hider.style,this.hiderStyle.position="relative",n=this.hider.parentNode,!n||1!==n.nodeType||!this.wtDom.hasClass(n,"wtHolder")){var o=document.createElement("DIV");o.style.position="relative",o.className="wtHolder",n&&n.insertBefore(o,this.hider),o.appendChild(this.hider)}if(this.holder=this.hider.parentNode,this.TBODY=this.TABLE.getElementsByTagName("TBODY")[0],this.TBODY||(this.TBODY=document.createElement("TBODY"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.getElementsByTagName("THEAD")[0],this.THEAD||(this.THEAD=document.createElement("THEAD"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.getElementsByTagName("COLGROUP")[0],this.COLGROUP||(this.COLGROUP=document.createElement("COLGROUP"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD)),this.instance.getSetting("columnHeaders").length&&!this.THEAD.childNodes.length){var s=document.createElement("TR");this.THEAD.appendChild(s)}this.colgroupChildrenLength=this.COLGROUP.childNodes.length,this.theadChildrenLength=this.THEAD.firstChild?this.THEAD.firstChild.childNodes.length:0,this.tbodyChildrenLength=this.TBODY.childNodes.length,this.oldCellCache=new g,this.currentCellCache=new g,this.rowFilter=new S,this.columnFilter=new v,this.verticalRenderReverse=!1}function M(e){if(this.instance=e,this.resetSettings(),this.instance.getSetting("nativeScrollbars")){var t=this;n(i).on("resize",function(){t.clientHeight=t.getWorkspaceHeight()})}}function N(e){e.getSetting("nativeScrollbars")||n(e.wtTable.spreader).on("mousewheel",function(t,n,i,r){i||r||!n||(r=n),(i||r)&&(r>0&&0===e.getSetting("offsetRow")||0>r&&e.wtTable.isLastRowFullyVisible()||0>i&&0===e.getSetting("offsetColumn")||i>0&&e.wtTable.isLastColumnFullyVisible()||(clearTimeout(e.wheelTimeout),e.wheelTimeout=setTimeout(function(){r?e.wtScrollbars.vertical.visible&&e.scrollVertical(-Math.ceil(r)).draw():i&&e.wtScrollbars.horizontal.visible&&e.scrollHorizontal(Math.ceil(i)).draw()},0),t.preventDefault()))})}Array.prototype.indexOf||(Array.prototype.indexOf=function(e){var t=this.length>>>0,n=Number(arguments[1])||0;for(n=0>n?Math.ceil(n):Math.floor(n),0>n&&(n+=t);t>n;n++)if(n in this&&this[n]===e)return n;return-1}),Array.prototype.filter||(Array.prototype.filter=function(e,t){function n(e){return/NodeList/i.test(e.item)}function i(e){for(var t=[],n=0,i=e.length;i>n;n++)t[n]=e[n];return t}if("undefined"==typeof this||null===this)throw new TypeError;if("function"!=typeof e)throw new TypeError;t=t||this,n(t)&&(t=i(t));var r,o,s=t.length,a=[];for(r=0;s>r;r+=1)t.hasOwnProperty(r)&&(o=t[r],e.call(t,o,r,t)&&a.push(o));return a}),"undefined"==typeof WeakMap&&!function(){var e=Object.defineProperty;try{var t=!0;e(function(){},"foo",{})}catch(n){t=!1}var r=+new Date%1e9,o=function(){this.name="__st"+(1e9*Math.random()>>>0)+(r++ +"__"),t||(this._wmCache=[])};t?o.prototype={set:function(t,n){var i=t[this.name];i&&i[0]===t?i[1]=n:e(t,this.name,{value:[t,n],writable:!0})},get:function(e){var t;return(t=e[this.name])&&t[0]===e?t[1]:void 0},"delete":function(e){this.set(e,void 0)}}:o.prototype={set:function(e,t){if("undefined"!=typeof e&&"undefined"!=typeof t){for(var n=0,i=this._wmCache.length;i>n;n++)if(this._wmCache[n].key==e)return void(this._wmCache[n].value=t);this._wmCache.push({key:e,value:t})}},get:function(e){if("undefined"!=typeof e)for(var t=0,n=this._wmCache.length;n>t;t++)if(this._wmCache[t].key==e)return this._wmCache[t].value},"delete":function(e){if("undefined"!=typeof e)for(var t=0,n=this._wmCache.length;n>t;t++)this._wmCache[t].key==e&&Array.prototype.slice.call(this._wmCache,t,1)}},i.WeakMap=o}(),r.activeGuid=null,r.Core=function(e,o){function s(){var e=!1;return{validatorsInQueue:0,addValidatorToQueue:function(){this.validatorsInQueue++,e=!1},removeValidatorFormQueue:function(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty:function(){},checkIfQueueIsEmpty:function(){0==this.validatorsInQueue&&0==e&&(e=!0,this.onQueueEmpty())}}}function a(e,i,r){function o(){var t;e.length&&(t=m.PluginHooks.execute("beforeChange",e,i),"function"==typeof t?n.when(result).then(function(){r()}):t===!1&&e.splice(0,e.length)),"function"!=typeof t&&r()}var a=new s;a.onQueueEmpty=o;for(var l=e.length-1;l>=0;l--)if(null===e[l])e.splice(l,1);else{var u=e[l][0],c=h.propToCol(e[l][1]),f=m.runHooksAndReturn("modifyCol",c),p=m.getCellMeta(u,f);"numeric"===p.type&&"string"==typeof e[l][3]&&e[l][3].length>0&&/^-?[\d\s]*\.?\d*$/.test(e[l][3])&&(e[l][3]=t().unformat(e[l][3]||"0")),m.getCellValidator(p)&&(a.addValidatorToQueue(),m.validateCell(e[l][3],p,function(t,n){return function(i){if("boolean"!=typeof i)throw new Error("Validation error: result is not boolean");i===!1&&n.allowInvalid===!1&&(e.splice(t,1),n.valid=!0,--t),a.removeValidatorFormQueue()}}(l,p),i))}a.checkIfQueueIsEmpty()}function l(e,t){var n=e.length-1;if(!(0>n)){for(;n>=0;n--)if(null!==e[n]){if(f.settings.minSpareRows)for(;e[n][0]>m.countRows()-1;)h.createRow();if("array"===m.dataType&&f.settings.minSpareCols)for(;h.propToCol(e[n][1])>m.countCols()-1;)h.createCol();h.set(e[n][0],e[n][1],e[n][3])}else e.splice(n,1);m.forceFullRender=!0,p.adjustRowsAndCols(),d.refreshBorders(null,!0),m.PluginHooks.run("afterChange",e,t||"edit")}}function u(e,t,i){return"object"==typeof e?e:n.isPlainObject(i)?i:[[e,t,i]]}function c(e){if(e.hasOwnProperty("type")){var t,n={};if("object"==typeof e.type)t=e.type;else if("string"==typeof e.type&&(t=r.cellTypes[e.type],void 0===t))throw new Error('You declared cell type "'+e.type+'" as a string that is not mapped to a known object. Cell type must be an object or a string mapped to an object in Handsontable.cellTypes');for(var i in t)t.hasOwnProperty(i)&&!e.hasOwnProperty(i)&&(n[i]=t[i]);return n}}var f,h,p,d,g,v,m=this,y=function(){};r.helper.extend(y.prototype,H.prototype),r.helper.extend(y.prototype,o),r.helper.extend(y.prototype,c(o)),this.rootElement=e;var b=n(document.documentElement),w=n(document.body);this.guid="ht_"+r.helper.randomString(),this.rootElement[0].id||(this.rootElement[0].id=this.guid),f={cellSettings:[],columnSettings:[],columnsSettingConflicts:["data","width"],settings:new y,settingsFromDOM:{},selStart:new r.SelectionPoint,selEnd:new r.SelectionPoint,isPopulated:null,scrollable:null,extensions:{},firstRun:!0},p={alter:function(e,t,n,i,o){var s;switch(n=n||1,e){case"insert_row":s=h.createRow(t,n),s&&(f.selStart.exists()&&f.selStart.row()>=t?(f.selStart.row(f.selStart.row()+s),d.transformEnd(s,0)):d.refreshBorders());break;case"insert_col":if(s=h.createCol(t,n)){if(r.helper.isArray(m.getSettings().colHeaders)){var a=[t,0];a.length+=s,Array.prototype.splice.apply(m.getSettings().colHeaders,a)}f.selStart.exists()&&f.selStart.col()>=t?(f.selStart.col(f.selStart.col()+s),d.transformEnd(0,s)):d.refreshBorders()}break;case"remove_row":h.removeRow(t,n),f.cellSettings.splice(t,n),p.adjustRowsAndCols(),d.refreshBorders();break;case"remove_col":h.removeCol(t,n);for(var l=0,u=h.getAll().length;u>l;l++)l in f.cellSettings&&f.cellSettings[l].splice(t,n);r.helper.isArray(m.getSettings().colHeaders)&&("undefined"==typeof t&&(t=-1),m.getSettings().colHeaders.splice(t,n)),f.columnSettings.splice(t,n),p.adjustRowsAndCols(),d.refreshBorders();break;default:throw new Error('There is no such action "'+e+'"')}o||p.adjustRowsAndCols()},adjustRowsAndCols:function(){var e,t,n,i=m.countEmptyRows(!0);if(t=m.countRows(),t<f.settings.minRows)for(e=0;e<f.settings.minRows-t;e++)h.createRow(m.countRows(),1,!0);if(i<f.settings.minSpareRows)for(;i<f.settings.minSpareRows&&m.countRows()<f.settings.maxRows;i++)h.createRow(m.countRows(),1,!0);if(n=m.countEmptyCols(!0),!f.settings.columns&&m.countCols()<f.settings.minCols)for(;m.countCols()<f.settings.minCols;n++)h.createCol(m.countCols(),1,!0);if(!f.settings.columns&&"array"===m.dataType&&n<f.settings.minSpareCols)for(;n<f.settings.minSpareCols&&m.countCols()<f.settings.maxCols;n++)h.createCol(m.countCols(),1,!0);if(f.settings.enterBeginsEditing)for(;(f.settings.minRows||f.settings.minSpareRows)&&m.countRows()>f.settings.minRows&&f.settings.minSpareRows&&i>f.settings.minSpareRows;i--)h.removeRow();if(f.settings.enterBeginsEditing&&!f.settings.columns)for(;(f.settings.minCols||f.settings.minSpareCols)&&m.countCols()>f.settings.minCols&&f.settings.minSpareCols&&n>f.settings.minSpareCols;n--)h.removeCol();var r=m.countRows(),o=m.countCols();if((0===r||0===o)&&d.deselect(),f.selStart.exists()){var s,a=f.selStart.row(),l=f.selStart.col(),u=f.selEnd.row(),c=f.selEnd.col();a>r-1?(a=r-1,s=!0,u>a&&(u=a)):u>r-1&&(u=r-1,s=!0,a>u&&(a=u)),l>o-1?(l=o-1,s=!0,c>l&&(c=l)):c>o-1&&(c=o-1,s=!0,l>c&&(l=c)),s&&m.selectCell(a,l,u,c)}},populateFromArray:function(e,t,n,i,o){var s,a,l,u,c=[],h={};if(a=t.length,0===a)return!1;var p,d,g,v;switch(o){case"shift_down":for(p=n?n.col-e.col+1:0,d=n?n.row-e.row+1:0,t=r.helper.translateRowsToColumns(t),l=0,u=t.length,g=Math.max(u,p);g>l;l++)if(u>l){for(s=0,a=t[l].length;d-a>s;s++)t[l].push(t[l][s%a]);t[l].unshift(e.col+l,e.row,0),m.spliceCol.apply(m,t[l])}else t[l%u][0]=e.col+l,m.spliceCol.apply(m,t[l%u]);break;case"shift_right":for(p=n?n.col-e.col+1:0,d=n?n.row-e.row+1:0,s=0,a=t.length,v=Math.max(a,d);v>s;s++)if(a>s){for(l=0,u=t[s].length;p-u>l;l++)t[s].push(t[s][l%u]);t[s].unshift(e.row+s,e.col,0),m.spliceRow.apply(m,t[s])}else t[s%a][0]=e.row+s,m.spliceRow.apply(m,t[s%a]);break;case"overwrite":default:for(h.row=e.row,h.col=e.col,s=0;a>s&&!(n&&h.row>n.row||!f.settings.minSpareRows&&h.row>m.countRows()-1||h.row>=f.settings.maxRows);s++){for(h.col=e.col,u=t[s]?t[s].length:0,l=0;u>l&&!(n&&h.col>n.col||!f.settings.minSpareCols&&h.col>m.countCols()-1||h.col>=f.settings.maxCols);l++)m.getCellMeta(h.row,h.col).readOnly||c.push([h.row,h.col,t[s][l]]),h.col++,n&&l===u-1&&(l=-1);h.row++,n&&s===a-1&&(s=-1)}m.setDataAtCell(c,null,null,i||"populateFromArray")}},getCornerCoords:function(e){function t(e,t,i){function r(e){return e[i]}return Array.prototype.map?e.apply(Math,t.map(r)):e.apply(Math,n.map(t,r))}return{TL:{row:t(Math.min,e,"row"),col:t(Math.min,e,"col")},BR:{row:t(Math.max,e,"row"),col:t(Math.max,e,"col")}}},getCellsAtCoords:function(e,t){var n,i,r=p.getCornerCoords([e,t]),o=[];for(n=r.TL.row;n<=r.BR.row;n++)for(i=r.TL.col;i<=r.BR.col;i++)o.push(m.view.getCellAtCoords({row:n,col:i}));return o}},this.selection=d={inProgress:!1,begin:function(){m.selection.inProgress=!0},finish:function(){var e=m.getSelected();m.PluginHooks.run("afterSelectionEnd",e[0],e[1],e[2],e[3]),m.PluginHooks.run("afterSelectionEndByProp",e[0],m.colToProp(e[1]),e[2],m.colToProp(e[3])),m.selection.inProgress=!1},isInProgress:function(){return m.selection.inProgress},setRangeStart:function(e){f.selStart.coords(e),d.setRangeEnd(e)},setRangeEnd:function(e,t){m.selection.begin(),f.selEnd.coords(e),f.settings.multiSelect||f.selStart.coords(e),m.view.wt.selections.current.clear(),m.view.wt.selections.current.add(f.selStart.arr()),m.view.wt.selections.area.clear(),d.isMultiple()&&(m.view.wt.selections.area.add(f.selStart.arr()),m.view.wt.selections.area.add(f.selEnd.arr())),(f.settings.currentRowClassName||f.settings.currentColClassName)&&(m.view.wt.selections.highlight.clear(),m.view.wt.selections.highlight.add(f.selStart.arr()),m.view.wt.selections.highlight.add(f.selEnd.arr())),m.PluginHooks.run("afterSelection",f.selStart.row(),f.selStart.col(),f.selEnd.row(),f.selEnd.col()),m.PluginHooks.run("afterSelectionByProp",f.selStart.row(),h.colToProp(f.selStart.col()),f.selEnd.row(),h.colToProp(f.selEnd.col())),t!==!1&&m.view.scrollViewport(e),d.refreshBorders()},refreshBorders:function(e,t){t||g.destroyEditor(e),m.view.render(),d.isSelected()&&!t&&g.prepareEditor()},isMultiple:function(){return!(f.selEnd.col()===f.selStart.col()&&f.selEnd.row()===f.selStart.row())},transformStart:function(e,t,n){f.selStart.row()+e>m.countRows()-1?n&&f.settings.minSpareRows>0?m.alter("insert_row",m.countRows()):f.settings.autoWrapCol&&(e=1-m.countRows(),t=f.selStart.col()+t==m.countCols()-1?1-m.countCols():1):f.settings.autoWrapCol&&f.selStart.row()+e<0&&f.selStart.col()+t>=0&&(e=m.countRows()-1,t=f.selStart.col()+t==0?m.countCols()-1:-1),f.selStart.col()+t>m.countCols()-1?n&&f.settings.minSpareCols>0?m.alter("insert_col",m.countCols()):f.settings.autoWrapRow&&(e=f.selStart.row()+e==m.countRows()-1?1-m.countRows():1,t=1-m.countCols()):f.settings.autoWrapRow&&f.selStart.col()+t<0&&f.selStart.row()+e>=0&&(e=f.selStart.row()+e==0?m.countRows()-1:-1,t=m.countCols()-1);var i=m.countRows(),r=m.countCols(),o={row:f.selStart.row()+e,col:f.selStart.col()+t};o.row<0?o.row=0:o.row>0&&o.row>=i&&(o.row=i-1),o.col<0?o.col=0:o.col>0&&o.col>=r&&(o.col=r-1),d.setRangeStart(o)},transformEnd:function(e,t){if(f.selEnd.exists()){var n=m.countRows(),i=m.countCols(),r={row:f.selEnd.row()+e,col:f.selEnd.col()+t};r.row<0?r.row=0:r.row>0&&r.row>=n&&(r.row=n-1),r.col<0?r.col=0:r.col>0&&r.col>=i&&(r.col=i-1),d.setRangeEnd(r)}},isSelected:function(){return f.selEnd.exists()},inInSelection:function(e){if(!d.isSelected())return!1;var t=p.getCornerCoords([f.selStart.coords(),f.selEnd.coords()]);return t.TL.row<=e.row&&t.BR.row>=e.row&&t.TL.col<=e.col&&t.BR.col>=e.col},deselect:function(){d.isSelected()&&(m.selection.inProgress=!1,f.selEnd=new r.SelectionPoint,m.view.wt.selections.current.clear(),m.view.wt.selections.area.clear(),g.destroyEditor(),d.refreshBorders(),m.PluginHooks.run("afterDeselect"))},selectAll:function(){f.settings.multiSelect&&(d.setRangeStart({row:0,col:0}),d.setRangeEnd({row:m.countRows()-1,col:m.countCols()-1},!1))},empty:function(){if(d.isSelected()){var e,t,n=p.getCornerCoords([f.selStart.coords(),f.selEnd.coords()]),i=[];for(e=n.TL.row;e<=n.BR.row;e++)for(t=n.TL.col;t<=n.BR.col;t++)m.getCellMeta(e,t).readOnly||i.push([e,t,""]);m.setDataAtCell(i)}}},this.autofill=v={handle:null,init:function(){v.handle?v.handle.disabled=!1:v.handle={}},disable:function(){v.handle.disabled=!0},selectAdjacent:function(){var e,t,n,i,r;e=d.isMultiple()?m.view.wt.selections.area.getCorners():m.view.wt.selections.current.getCorners(),t=h.getAll();e:for(n=e[2]+1;n<m.countRows();n++){for(r=e[1];r<=e[3];r++)if(t[n][r])break e;(t[n][e[1]-1]||t[n][e[3]+1])&&(i=n)}i&&(m.view.wt.selections.fill.clear(),m.view.wt.selections.fill.add([e[0],e[1]]),m.view.wt.selections.fill.add([i,e[3]]),v.apply())},apply:function(){var e,t,n,i,r;v.handle.isDragged=0,e=m.view.wt.selections.fill.getCorners(),e&&(m.view.wt.selections.fill.clear(),t=d.isMultiple()?m.view.wt.selections.area.getCorners():m.view.wt.selections.current.getCorners(),e[0]===t[0]&&e[1]<t[1]?(n={row:e[0],col:e[1]},i={row:e[2],col:t[1]-1}):e[0]===t[0]&&e[3]>t[3]?(n={row:e[0],col:t[3]+1},i={row:e[2],col:e[3]}):e[0]<t[0]&&e[1]===t[1]?(n={row:e[0],col:e[1]},i={row:t[0]-1,col:e[3]}):e[2]>t[2]&&e[1]===t[1]&&(n={row:t[2]+1,col:e[1]},i={row:e[2],col:e[3]}),n&&(r=SheetClip.parse(h.getText(f.selStart.coords(),f.selEnd.coords())),m.PluginHooks.run("beforeAutofill",n,i,r),p.populateFromArray(n,r,i,"autofill"),d.setRangeStart({row:e[0],col:e[1]}),d.setRangeEnd({row:e[2],col:e[3]})))},showBorder:function(e){e.row=e[0],e.col=e[1];var t=p.getCornerCoords([f.selStart.coords(),f.selEnd.coords()]);if("horizontal"!==f.settings.fillHandle&&(t.BR.row<e.row||t.TL.row>e.row))e=[e.row,t.BR.col];else{if("vertical"===f.settings.fillHandle)return;e=[t.BR.row,e.col]}m.view.wt.selections.fill.clear(),m.view.wt.selections.fill.add([f.selStart.coords().row,f.selStart.coords().col]),m.view.wt.selections.fill.add([f.selEnd.coords().row,f.selEnd.coords().col]),m.view.wt.selections.fill.add(e),m.view.render()}},this.init=function(){m.PluginHooks.run("beforeInit"),this.view=new r.TableView(this),g=new r.EditorManager(m,f,d,h),this.updateSettings(f.settings,!0),this.parseSettingsFromDOM(),this.forceFullRender=!0,this.view.render(),"object"==typeof f.firstRun&&(m.PluginHooks.run("afterChange",f.firstRun[0],f.firstRun[1]),f.firstRun=!1),m.PluginHooks.run("afterInit")
},this.validateCell=function(e,t,n,i){var r=m.getCellValidator(t);"[object RegExp]"===Object.prototype.toString.call(r)&&(r=function(e){return function(t,n){n(e.test(t))}}(r)),"function"==typeof r?(e=m.PluginHooks.execute("beforeValidate",e,t.row,t.prop,i),setTimeout(function(){r.call(t,e,function(r){t.valid=r,r=m.PluginHooks.execute("afterValidate",r,e,t.row,t.prop,i),n(r)})})):(t.valid=!0,n(!0))},this.setDataAtCell=function(e,t,n,i){var r,o,s,c=u(e,t,n),f=[];for(r=0,o=c.length;o>r;r++){if("object"!=typeof c[r])throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if("number"!=typeof c[r][1])throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");s=h.colToProp(c[r][1]),f.push([c[r][0],s,h.get(c[r][0],s),c[r][2]])}i||"object"!=typeof e||(i=t),a(f,i,function(){l(f,i)})},this.setDataAtRowProp=function(e,t,n,i){var r,o,s=u(e,t,n),c=[];for(r=0,o=s.length;o>r;r++)c.push([s[r][0],s[r][1],h.get(s[r][0],s[r][1]),s[r][2]]);i||"object"!=typeof e||(i=t),a(c,i,function(){l(c,i)})},this.listen=function(){r.activeGuid=m.guid,document.activeElement&&document.activeElement!==document.body?document.activeElement.blur():document.activeElement||document.body.focus()},this.unlisten=function(){r.activeGuid=null},this.isListening=function(){return r.activeGuid===m.guid},this.destroyEditor=function(e){d.refreshBorders(e)},this.populateFromArray=function(e,t,n,i,r,o,s){if("object"!=typeof n||"object"!=typeof n[0])throw new Error("populateFromArray parameter `input` must be an array of arrays");return p.populateFromArray({row:e,col:t},n,"number"==typeof i?{row:i,col:r}:null,o,s)},this.spliceCol=function(){return h.spliceCol.apply(h,arguments)},this.spliceRow=function(){return h.spliceRow.apply(h,arguments)},this.getCornerCoords=function(e){return p.getCornerCoords(e)},this.getSelected=function(){return d.isSelected()?[f.selStart.row(),f.selStart.col(),f.selEnd.row(),f.selEnd.col()]:void 0},this.parseSettingsFromDOM=function(){var e=this.rootElement.css("overflow");if("scroll"===e||"auto"===e?(this.rootElement[0].style.overflow="visible",f.settingsFromDOM.overflow=e):(void 0===f.settings.width||void 0===f.settings.height)&&(f.settingsFromDOM.overflow="auto"),void 0===f.settings.width?f.settingsFromDOM.width=this.rootElement.width():f.settingsFromDOM.width=void 0,f.settingsFromDOM.height=void 0,void 0===f.settings.height&&("scroll"===f.settingsFromDOM.overflow||"auto"===f.settingsFromDOM.overflow)){var t=this.rootElement[0].cloneNode(!1),n=this.rootElement[0].parentNode;if(n){t.removeAttribute("id"),n.appendChild(t);var r=parseInt(t.clientHeight,10),o=parseInt(i.getComputedStyle(t,null).getPropertyValue("paddingTop"),10)||0,s=parseInt(i.getComputedStyle(t,null).getPropertyValue("paddingBottom"),10)||0,a=r-o-s;isNaN(a)&&t.currentStyle&&(a=parseInt(t.currentStyle.height,10)),a>0&&(f.settingsFromDOM.height=a),n.removeChild(t)}}},this.render=function(){m.view&&(m.forceFullRender=!0,m.parseSettingsFromDOM(),d.refreshBorders(null,!0))},this.loadData=function(e){function t(){f.cellSettings.length=0}if("object"==typeof e&&null!==e)e.push&&e.splice||(e=[e]);else{if(null!==e)throw new Error("loadData only accepts array of objects or array of arrays ("+typeof e+" given)");e=[];for(var n,i=0,o=f.settings.startRows;o>i;i++){n=[];for(var s=0,a=f.settings.startCols;a>s;s++)n.push(null);e.push(n)}}f.isPopulated=!1,y.prototype.data=e,f.settings.dataSchema instanceof Array||e[0]instanceof Array?m.dataType="array":"function"==typeof f.settings.dataSchema?m.dataType="function":m.dataType="object",h=new r.DataMap(m,f,y),t(),p.adjustRowsAndCols(),m.PluginHooks.run("afterLoadData"),f.firstRun?f.firstRun=[null,"loadData"]:(m.PluginHooks.run("afterChange",null,"loadData"),m.render()),f.isPopulated=!0},this.getData=function(e,t,n,i){return"undefined"==typeof e?h.getAll():h.getRange({row:e,col:t},{row:n,col:i},h.DESTINATION_RENDERER)},this.getCopyableData=function(e,t,n,i){return h.getCopyableText({row:e,col:t},{row:n,col:i})},this.updateSettings=function(e,t){var n,i;if("undefined"!=typeof e.rows)throw new Error("'rows' setting is no longer supported. do you mean startRows, minRows or maxRows?");if("undefined"!=typeof e.cols)throw new Error("'cols' setting is no longer supported. do you mean startCols, minCols or maxCols?");for(n in e)"data"!==n&&(void 0!==m.PluginHooks.hooks[n]||void 0!==m.PluginHooks.legacy[n]?("function"==typeof e[n]||r.helper.isArray(e[n]))&&m.PluginHooks.add(n,e[n]):(!t&&e.hasOwnProperty(n)&&(y.prototype[n]=e[n]),r.extension[n]&&(f.extensions[n]=new r.extension[n](m,e[n]))));if(void 0===e.data&&void 0===f.settings.data?m.loadData(null):void 0!==e.data?m.loadData(e.data):void 0!==e.columns&&h.createMap(),i=m.countCols(),f.cellSettings.length=0,i>0){var o,s;for(n=0;i>n;n++)f.columnSettings[n]=r.helper.columnFactory(y,f.columnsSettingConflicts),o=f.columnSettings[n].prototype,y.prototype.columns&&(s=y.prototype.columns[n],r.helper.extend(o,s),r.helper.extend(o,c(s)))}"undefined"!=typeof e.fillHandle&&(v.handle&&e.fillHandle===!1?v.disable():v.handle||e.fillHandle===!1||v.init()),"undefined"!=typeof e.className&&(y.prototype.className&&m.rootElement.removeClass(y.prototype.className),e.className&&m.rootElement.addClass(e.className)),t||m.PluginHooks.run("afterUpdateSettings"),p.adjustRowsAndCols(),m.view&&!f.firstRun&&(m.forceFullRender=!0,d.refreshBorders(null,!0))},this.getValue=function(){var e=m.getSelected();if(y.prototype.getValue){if("function"==typeof y.prototype.getValue)return y.prototype.getValue.call(m);if(e)return m.getData()[e[0]][y.prototype.getValue]}else if(e)return m.getDataAtCell(e[0],e[1])},this.getSettings=function(){return f.settings},this.getSettingsFromDOM=function(){return f.settingsFromDOM},this.clear=function(){d.selectAll(),d.empty()},this.alter=function(e,t,n,i,r){p.alter(e,t,n,i,r)},this.getCell=function(e,t){return m.view.getCellAtCoords({row:e,col:t})},this.colToProp=function(e){return h.colToProp(e)},this.propToCol=function(e){return h.propToCol(e)},this.getDataAtCell=function(e,t){return h.get(e,h.colToProp(t))},this.getDataAtRowProp=function(e,t){return h.get(e,t)},this.getDataAtCol=function(e){return[].concat.apply([],h.getRange({row:0,col:e},{row:f.settings.data.length-1,col:e},h.DESTINATION_RENDERER))},this.getDataAtProp=function(e){return[].concat.apply([],h.getRange({row:0,col:h.propToCol(e)},{row:f.settings.data.length-1,col:h.propToCol(e)},h.DESTINATION_RENDERER))},this.getDataAtRow=function(e){return f.settings.data[e]},this.getCellMeta=function(e,t){function n(e){var t={row:e};return m.PluginHooks.execute("beforeGet",t),t.row}function i(e){return r.PluginHooks.execute(m,"modifyCol",e)}var o,s=h.colToProp(t);if(e=n(e),t=i(t),"undefined"==typeof f.columnSettings[t]&&(f.columnSettings[t]=r.helper.columnFactory(y,f.columnsSettingConflicts)),f.cellSettings[e]||(f.cellSettings[e]=[]),f.cellSettings[e][t]||(f.cellSettings[e][t]=new f.columnSettings[t]),o=f.cellSettings[e][t],o.row=e,o.col=t,o.prop=s,o.instance=m,m.PluginHooks.run("beforeGetCellMeta",e,t,o),r.helper.extend(o,c(o)),o.cells){var a=o.cells.call(o,e,t,s);a&&(r.helper.extend(o,a),r.helper.extend(o,c(a)))}return m.PluginHooks.run("afterGetCellMeta",e,t,o),o};var C=r.helper.cellMethodLookupFactory("renderer");this.getCellRenderer=function(e,t){var n=C.call(this,e,t);return r.renderers.getRenderer(n)},this.getCellEditor=r.helper.cellMethodLookupFactory("editor"),this.getCellValidator=r.helper.cellMethodLookupFactory("validator"),this.validateCells=function(e){var t=new s;t.onQueueEmpty=e;for(var n=m.countRows()-1;n>=0;){for(var i=m.countCols()-1;i>=0;)t.addValidatorToQueue(),m.validateCell(m.getDataAtCell(n,i),m.getCellMeta(n,i),function(){t.removeValidatorFormQueue()},"validateCells"),i--;n--}t.checkIfQueueIsEmpty()},this.getRowHeader=function(e){if(void 0===e){for(var t=[],n=0,i=m.countRows();i>n;n++)t.push(m.getRowHeader(n));return t}return"[object Array]"===Object.prototype.toString.call(f.settings.rowHeaders)&&void 0!==f.settings.rowHeaders[e]?f.settings.rowHeaders[e]:"function"==typeof f.settings.rowHeaders?f.settings.rowHeaders(e):f.settings.rowHeaders&&"string"!=typeof f.settings.rowHeaders&&"number"!=typeof f.settings.rowHeaders?e+1:f.settings.rowHeaders},this.hasRowHeaders=function(){return!!f.settings.rowHeaders},this.hasColHeaders=function(){if(void 0!==f.settings.colHeaders&&null!==f.settings.colHeaders)return!!f.settings.colHeaders;for(var e=0,t=m.countCols();t>e;e++)if(m.getColHeader(e))return!0;return!1},this.getColHeader=function(e){if(void 0===e){for(var t=[],n=0,i=m.countCols();i>n;n++)t.push(m.getColHeader(n));return t}return e=r.PluginHooks.execute(m,"modifyCol",e),f.settings.columns&&f.settings.columns[e]&&f.settings.columns[e].title?f.settings.columns[e].title:"[object Array]"===Object.prototype.toString.call(f.settings.colHeaders)&&void 0!==f.settings.colHeaders[e]?f.settings.colHeaders[e]:"function"==typeof f.settings.colHeaders?f.settings.colHeaders(e):f.settings.colHeaders&&"string"!=typeof f.settings.colHeaders&&"number"!=typeof f.settings.colHeaders?r.helper.spreadsheetColumnLabel(e):f.settings.colHeaders},this._getColWidthFromSettings=function(e){var t=m.getCellMeta(0,e),n=t.width;if((void 0===n||n===f.settings.width)&&(n=t.colWidths),void 0!==n&&null!==n){switch(typeof n){case"object":n=n[e];break;case"function":n=n(e)}"string"==typeof n&&(n=parseInt(n,10))}return n},this.getColWidth=function(e){e=r.PluginHooks.execute(m,"modifyCol",e);var t={width:m._getColWidthFromSettings(e)};return t.width||(t.width=50),m.PluginHooks.run("afterGetColWidth",e,t),t.width},this.countRows=function(){return f.settings.data.length},this.countCols=function(){return"object"===m.dataType||"function"===m.dataType?f.settings.columns&&f.settings.columns.length?f.settings.columns.length:h.colToPropCache.length:"array"===m.dataType?f.settings.columns&&f.settings.columns.length?f.settings.columns.length:f.settings.data&&f.settings.data[0]&&f.settings.data[0].length?f.settings.data[0].length:0:void 0},this.rowOffset=function(){return m.view.wt.getSetting("offsetRow")},this.colOffset=function(){return m.view.wt.getSetting("offsetColumn")},this.countVisibleRows=function(){return m.view.wt.drawn?m.view.wt.wtTable.rowStrategy.countVisible():-1},this.countVisibleCols=function(){return m.view.wt.drawn?m.view.wt.wtTable.columnStrategy.countVisible():-1},this.countEmptyRows=function(e){for(var t=m.countRows()-1,n=0;t>=0;){if(h.get(t,0),m.isEmptyRow(h.getVars.row))n++;else if(e)break;t--}return n},this.countEmptyCols=function(e){if(m.countRows()<1)return 0;for(var t=m.countCols()-1,n=0;t>=0;){if(m.isEmptyCol(t))n++;else if(e)break;t--}return n},this.isEmptyRow=function(e){return f.settings.isEmptyRow.call(m,e)},this.isEmptyCol=function(e){return f.settings.isEmptyCol.call(m,e)},this.selectCell=function(e,t,n,i,r){if("number"!=typeof e||0>e||e>=m.countRows())return!1;if("number"!=typeof t||0>t||t>=m.countCols())return!1;if("undefined"!=typeof n){if("number"!=typeof n||0>n||n>=m.countRows())return!1;if("number"!=typeof i||0>i||i>=m.countCols())return!1}return f.selStart.coords({row:e,col:t}),document.activeElement&&document.activeElement!==document.documentElement&&document.activeElement!==document.body&&document.activeElement.blur(),m.listen(),"undefined"==typeof n?d.setRangeEnd({row:e,col:t},r):d.setRangeEnd({row:n,col:i},r),m.selection.finish(),!0},this.selectCellByProp=function(){return arguments[1]=h.propToCol(arguments[1]),"undefined"!=typeof arguments[3]&&(arguments[3]=h.propToCol(arguments[3])),m.selectCell.apply(m,arguments)},this.deselectCell=function(){d.deselect()},this.destroy=function(){m.clearTimeouts(),m.view&&m.view.wt.destroy(),m.rootElement.empty(),m.rootElement.removeData("handsontable"),m.rootElement.off(".handsontable"),n(i).off("."+m.guid),b.off("."+m.guid),w.off("."+m.guid),m.PluginHooks.run("afterDestroy")},this.getActiveEditor=function(){return g.getActiveEditor()},this.getInstance=function(){return m.rootElement.data("handsontable")},function(){m.PluginHooks=new r.PluginHookClass;var e=m.PluginHooks.run,t=m.PluginHooks.execute;m.PluginHooks.run=function(t,n,i,o,s,a){e.call(this,m,t,n,i,o,s,a),r.PluginHooks.run(m,t,n,i,o,s,a)},m.PluginHooks.execute=function(e,n,i,o,s,a){var l=r.PluginHooks.execute(m,e,n,i,o,s,a),u=t.call(this,m,e,l,i,o,s,a);return"undefined"==typeof u?l:u},m.addHook=function(){m.PluginHooks.add.apply(m.PluginHooks,arguments)},m.addHookOnce=function(){m.PluginHooks.once.apply(m.PluginHooks,arguments)},m.removeHook=function(){m.PluginHooks.remove.apply(m.PluginHooks,arguments)},m.runHooks=function(){m.PluginHooks.run.apply(m.PluginHooks,arguments)},m.runHooksAndReturn=function(){return m.PluginHooks.execute.apply(m.PluginHooks,arguments)}}(),this.timeouts={},this.registerTimeout=function(e,t,n){clearTimeout(this.timeouts[e]),this.timeouts[e]=setTimeout(t,n||0)},this.clearTimeouts=function(){for(var e in this.timeouts)this.timeouts.hasOwnProperty(e)&&clearTimeout(this.timeouts[e])},this.version="0.10.5"};var H=function(){};H.prototype={data:void 0,width:void 0,height:void 0,startRows:5,startCols:5,rowHeaders:null,colHeaders:null,minRows:0,minCols:0,maxRows:1/0,maxCols:1/0,minSpareRows:0,minSpareCols:0,multiSelect:!0,fillHandle:!0,fixedRowsTop:0,fixedColumnsLeft:0,outsideClickDeselects:!0,enterBeginsEditing:!0,enterMoves:{row:1,col:0},tabMoves:{row:0,col:1},autoWrapRow:!1,autoWrapCol:!1,copyRowsLimit:1e3,copyColsLimit:1e3,trimWhitespace:!1,pasteMode:"overwrite",currentRowClassName:void 0,currentColClassName:void 0,stretchH:"hybrid",isEmptyRow:function(e){for(var t,n=0,i=this.countCols();i>n;n++)if(t=this.getDataAtCell(e,n),""!==t&&null!==t&&"undefined"!=typeof t)return!1;return!0},isEmptyCol:function(e){for(var t,n=0,i=this.countRows();i>n;n++)if(t=this.getDataAtCell(n,e),""!==t&&null!==t&&"undefined"!=typeof t)return!1;return!0},observeDOMVisibility:!0,allowInvalid:!0,invalidCellClassName:"htInvalid",placeholderCellClassName:"htPlaceholder",readOnlyCellClassName:"htDimmed",fragmentSelection:!1,readOnly:!1,nativeScrollbars:!1,type:"text",copyable:!0,debug:!1},r.DefaultSettings=H,n.fn.handsontable=function(e){var t,n,i,o,s,a=this.first(),l=a.data("handsontable");if("string"!=typeof e)return s=e||{},l?l.updateSettings(s):(l=new r.Core(a,s),a.data("handsontable",l),l.init()),a;if(i=[],arguments.length>1)for(t=1,n=arguments.length;n>t;t++)i.push(arguments[t]);if(l){if("undefined"==typeof l[e])throw new Error("Handsontable do not provide action: "+e);o=l[e].apply(l,i)}return o},function(e){function t(){function e(e){return null!==e&&!n(e)&&("string"==typeof e||"number"==typeof e)}function t(e){return null!==e&&("object"==typeof e||"function"==typeof e)}function n(e){return e!==e}var i={arrayMap:[],weakMap:new WeakMap};return{get:function(n){return e(n)?i.arrayMap[n]:t(n)?i.weakMap.get(n):void 0},set:function(n,r){if(e(n))i.arrayMap[n]=r;else{if(!t(n))throw new Error("Invalid key type");i.weakMap.set(n,r)}},"delete":function(n){e(n)?delete i.arrayMap[n]:t(n)&&i.weakMap["delete"](n)}}}e.MultiMap||(e.MultiMap=t)}(i),r.TableView=function(e){var t=this,o=n(i),s=n(document.documentElement);this.instance=e,this.settings=e.getSettings(),this.settingsFromDOM=e.getSettingsFromDOM(),e.rootElement.data("originalStyle",e.rootElement[0].getAttribute("style")),e.rootElement.addClass("handsontable");var a=document.createElement("TABLE");a.className="htCore",this.THEAD=document.createElement("THEAD"),a.appendChild(this.THEAD),this.TBODY=document.createElement("TBODY"),a.appendChild(this.TBODY),e.$table=n(a),e.rootElement.prepend(e.$table),e.rootElement.on("mousedown.handsontable",function(e){t.isTextSelectionAllowed(e.target)||(u(),e.preventDefault(),i.focus())}),s.on("keyup."+e.guid,function(t){e.selection.isInProgress()&&!t.shiftKey&&e.selection.finish()});var l;s.on("mouseup."+e.guid,function(t){e.selection.isInProgress()&&1===t.which&&e.selection.finish(),l=!1,e.autofill.handle&&e.autofill.handle.isDragged&&(e.autofill.handle.isDragged>1&&e.autofill.apply(),e.autofill.handle.isDragged=0),r.helper.isOutsideInput(document.activeElement)&&e.unlisten()}),s.on("mousedown."+e.guid,function(n){var i=n.target;if(i!==t.wt.wtTable.spreader)for(;i!==document.documentElement;){if(null===i)return;if(i===e.rootElement[0]||"HANDSONTABLE-TABLE"===i.nodeName)return;i=i.parentNode}t.settings.outsideClickDeselects?e.deselectCell():e.destroyEditor()}),e.rootElement.on("mousedown.handsontable",".dragdealer",function(){e.destroyEditor()}),e.$table.on("selectstart",function(e){t.settings.fragmentSelection||e.preventDefault()});var u=function(){i.getSelection?i.getSelection().empty?i.getSelection().empty():i.getSelection().removeAllRanges&&i.getSelection().removeAllRanges():document.selection&&document.selection.empty()},c={debug:function(){return t.settings.debug},table:a,stretchH:this.settings.stretchH,data:e.getDataAtCell,totalRows:e.countRows,totalColumns:e.countCols,nativeScrollbars:this.settings.nativeScrollbars,offsetRow:0,offsetColumn:0,width:this.getWidth(),height:this.getHeight(),fixedColumnsLeft:function(){return t.settings.fixedColumnsLeft},fixedRowsTop:function(){return t.settings.fixedRowsTop},rowHeaders:function(){return e.hasRowHeaders()?[function(e,n){t.appendRowHeader(e,n)}]:[]},columnHeaders:function(){return e.hasColHeaders()?[function(e,n){t.appendColHeader(e,n)}]:[]},columnWidth:e.getColWidth,cellRenderer:function(e,n,i){var r=t.instance.colToProp(n),o=t.instance.getCellMeta(e,n),s=t.instance.getCellRenderer(o),a=t.instance.getDataAtRowProp(e,r);s(t.instance,i,e,n,r,a,o),t.instance.PluginHooks.run("afterRenderer",i,e,n,r,a,o)},selections:{current:{className:"current",border:{width:2,color:"#5292F7",style:"solid",cornerVisible:function(){return t.settings.fillHandle&&!t.isCellEdited()&&!e.selection.isMultiple()}}},area:{className:"area",border:{width:1,color:"#89AFF9",style:"solid",cornerVisible:function(){return t.settings.fillHandle&&!t.isCellEdited()&&e.selection.isMultiple()}}},highlight:{highlightRowClassName:t.settings.currentRowClassName,highlightColumnClassName:t.settings.currentColClassName},fill:{className:"fill",border:{width:1,color:"red",style:"solid"}}},hideBorderOnMouseDownOver:function(){return t.settings.fragmentSelection},onCellMouseDown:function(t,n,i){e.listen(),l=!0;var r={row:n[0],col:n[1]};2===t.button&&e.selection.inInSelection(r)||(t.shiftKey?e.selection.setRangeEnd(r):e.selection.setRangeStart(r)),e.PluginHooks.run("afterOnCellMouseDown",t,n,i)},onCellMouseOver:function(t,n,i){var r={row:n[0],col:n[1]};l?e.selection.setRangeEnd(r):e.autofill.handle&&e.autofill.handle.isDragged&&(e.autofill.handle.isDragged++,e.autofill.showBorder(n)),e.PluginHooks.run("afterOnCellMouseOver",t,n,i)},onCellCornerMouseDown:function(t){e.autofill.handle.isDragged=1,t.preventDefault(),e.PluginHooks.run("afterOnCellCornerMouseDown",t)},onCellCornerDblClick:function(){e.autofill.selectAdjacent()},beforeDraw:function(e){t.beforeRender(e)},onDraw:function(e){t.onDraw(e)},onScrollVertically:function(){e.runHooks("afterScrollVertically")},onScrollHorizontally:function(){e.runHooks("afterScrollHorizontally")}};e.PluginHooks.run("beforeInitWalkontable",c),this.wt=new y(c),o.on("resize."+e.guid,function(){e.registerTimeout("resizeTimeout",function(){e.parseSettingsFromDOM();var n=t.getWidth(),i=t.getHeight();(c.width!==n||c.height!==i)&&(e.forceFullRender=!0,t.render(),c.width=n,c.height=i)},60)}),n(t.wt.wtTable.spreader).on("mousedown.handsontable, contextmenu.handsontable",function(e){e.target===t.wt.wtTable.spreader&&3===e.which&&e.stopPropagation()}),s.on("click."+e.guid,function(){t.settings.observeDOMVisibility&&t.wt.drawInterrupted&&(t.instance.forceFullRender=!0,t.render())})},r.TableView.prototype.isTextSelectionAllowed=function(e){return r.helper.isInput(e)?!0:this.settings.fragmentSelection&&this.wt.wtDom.isChildOf(e,this.TBODY)?!0:!1},r.TableView.prototype.isCellEdited=function(){var e=this.instance.getActiveEditor();return e&&e.isOpened()},r.TableView.prototype.getWidth=function(){var e=void 0!==this.settings.width?this.settings.width:this.settingsFromDOM.width;return"function"==typeof e?e():e},r.TableView.prototype.getHeight=function(){var e=void 0!==this.settings.height?this.settings.height:this.settingsFromDOM.height;return"function"==typeof e?e():e},r.TableView.prototype.beforeRender=function(e){e&&(this.instance.PluginHooks.run("beforeRender",this.instance.forceFullRender),this.wt.update("width",this.getWidth()),this.wt.update("height",this.getHeight()))},r.TableView.prototype.onDraw=function(e){e&&this.instance.PluginHooks.run("afterRender",this.instance.forceFullRender)},r.TableView.prototype.render=function(){this.wt.draw(!this.instance.forceFullRender),this.instance.forceFullRender=!1,this.instance.rootElement.triggerHandler("render.handsontable")},r.TableView.prototype.getCellAtCoords=function(e){var t=this.wt.wtTable.getCell([e.row,e.col]);return 0>t?null:t},r.TableView.prototype.scrollViewport=function(e){this.wt.scrollViewport([e.row,e.col])},r.TableView.prototype.appendRowHeader=function(e,t){if(e>-1)this.wt.wtDom.fastInnerHTML(t,this.instance.getRowHeader(e));else{var n=document.createElement("DIV");n.className="relative",this.wt.wtDom.fastInnerText(n," "),this.wt.wtDom.empty(t),t.appendChild(n)}},r.TableView.prototype.appendColHeader=function(e,t){var n=document.createElement("DIV"),i=document.createElement("SPAN");n.className="relative",i.className="colHeader",this.wt.wtDom.fastInnerHTML(i,this.instance.getColHeader(e)),n.appendChild(i),this.wt.wtDom.empty(t),t.appendChild(n),this.instance.PluginHooks.run("afterGetColHeader",e,t)},r.TableView.prototype.maximumVisibleElementWidth=function(e){var t=this.wt.wtViewport.getWorkspaceWidth();return this.settings.nativeScrollbars?t:t-e},r.TableView.prototype.maximumVisibleElementHeight=function(e){var t=this.wt.wtViewport.getWorkspaceHeight();return this.settings.nativeScrollbars?t:t-e},function(e){function t(e){var t,n;n={},t=e,this.getInstance=function(e){return e.guid in n||(n[e.guid]=new t(e)),n[e.guid]}}var n={},i=new WeakMap;e.editors={registerEditor:function(e,r){var o=new t(r);"string"==typeof e&&(n[e]=o),i.set(r,o)},getEditor:function(e,t){var r;if("function"==typeof e)i.get(e)||this.registerEditor(null,e),r=i.get(e);else{if("string"!=typeof e)throw Error('Only strings and functions can be passed as "editor" parameter ');r=n[e]}if(!r)throw Error('No editor registered under name "'+e+'"');return r.getInstance(t)}}}(r),function(e){e.EditorManager=function(t,i,r){var o,s=this,a=n(document),l=e.helper.keyCode,u=function(){function n(n){if(t.isListening()&&(i.settings.beforeOnKeyDown&&i.settings.beforeOnKeyDown.call(t,n),t.PluginHooks.run("beforeKeyDown",n),!n.isImmediatePropagationStopped()&&(i.lastKeyCode=n.keyCode,r.isSelected()))){var a=(n.ctrlKey||n.metaKey)&&!n.altKey;if(!(o.isWaiting()||e.helper.isMetaKey(n.keyCode)||a||s.isEditorOpened()))return s.openEditor(""),void n.stopPropagation();var u=n.shiftKey?r.setRangeEnd:r.setRangeStart;switch(n.keyCode){case l.A:if(a){r.selectAll(),n.preventDefault(),n.stopPropagation();break}case l.ARROW_UP:s.isEditorOpened()&&!o.isWaiting()&&s.closeEditorAndSaveChanges(a),f(n.shiftKey),n.preventDefault(),n.stopPropagation();break;case l.ARROW_DOWN:s.isEditorOpened()&&!o.isWaiting()&&s.closeEditorAndSaveChanges(a),h(n.shiftKey),n.preventDefault(),n.stopPropagation();break;case l.ARROW_RIGHT:s.isEditorOpened()&&!o.isWaiting()&&s.closeEditorAndSaveChanges(a),p(n.shiftKey),n.preventDefault(),n.stopPropagation();break;case l.ARROW_LEFT:s.isEditorOpened()&&!o.isWaiting()&&s.closeEditorAndSaveChanges(a),d(n.shiftKey),n.preventDefault(),n.stopPropagation();break;case l.TAB:var g="function"==typeof i.settings.tabMoves?i.settings.tabMoves(n):i.settings.tabMoves;n.shiftKey?r.transformStart(-g.row,-g.col):r.transformStart(g.row,g.col,!0),n.preventDefault(),n.stopPropagation();break;case l.BACKSPACE:case l.DELETE:r.empty(n),s.prepareEditor(),n.preventDefault();break;case l.F2:s.openEditor(),n.preventDefault();break;case l.ENTER:s.isEditorOpened()?(o.state!==e.EditorState.WAITING&&s.closeEditorAndSaveChanges(a),c(n.shiftKey)):t.getSettings().enterBeginsEditing?s.openEditor():c(n.shiftKey),n.preventDefault(),n.stopImmediatePropagation();break;case l.ESCAPE:s.isEditorOpened()&&s.closeEditorAndRestoreOriginalValue(a),n.preventDefault();break;case l.HOME:u(n.ctrlKey||n.metaKey?{row:0,col:i.selStart.col()}:{row:i.selStart.row(),col:0}),n.preventDefault(),n.stopPropagation();break;case l.END:u(n.ctrlKey||n.metaKey?{row:t.countRows()-1,col:i.selStart.col()}:{row:i.selStart.row(),col:t.countCols()-1}),n.preventDefault(),n.stopPropagation();break;case l.PAGE_UP:r.transformStart(-t.countVisibleRows(),0),t.view.wt.scrollVertical(-t.countVisibleRows()),t.view.render(),n.preventDefault(),n.stopPropagation();break;case l.PAGE_DOWN:r.transformStart(t.countVisibleRows(),0),t.view.wt.scrollVertical(t.countVisibleRows()),t.view.render(),n.preventDefault(),n.stopPropagation()}}}function u(){s.openEditor()}function c(e){var t="function"==typeof i.settings.enterMoves?i.settings.enterMoves(event):i.settings.enterMoves;e?r.transformStart(-t.row,-t.col):r.transformStart(t.row,t.col,!0)}function f(e){e?r.transformEnd(-1,0):r.transformStart(-1,0)}function h(e){e?r.transformEnd(1,0):r.transformStart(1,0)}function p(e){e?r.transformEnd(0,1):r.transformStart(0,1)}function d(e){e?r.transformEnd(0,-1):r.transformStart(0,-1)}a.on("keydown.handsontable."+t.guid,n),t.view.wt.update("onCellDblClick",u),t.addHook("afterDestroy",function(){a.off("keydown.handsontable."+t.guid)})};this.destroyEditor=function(e){this.closeEditor(e)},this.getActiveEditor=function(){return o},this.prepareEditor=function(){if(o&&o.isWaiting())return void this.closeEditor(!1,!1,function(e){e&&s.prepareEditor()});var n=i.selStart.row(),r=i.selStart.col(),a=t.colToProp(r),l=t.getCell(n,r),u=t.getDataAtCell(n,r),c=t.getCellMeta(n,r),f=t.getCellEditor(c);o=e.editors.getEditor(f,t),o.prepare(n,r,a,l,u,c)},this.isEditorOpened=function(){return o.isOpened()},this.openEditor=function(e){o.cellProperties.readOnly||o.beginEditing(e)},this.closeEditor=function(e,t,n){o?o.finishEditing(e,t,n):n&&n(!1)},this.closeEditorAndSaveChanges=function(e){return this.closeEditor(!1,e)},this.closeEditorAndRestoreOriginalValue=function(e){return this.closeEditor(!0,e)},u()}}(r),function(e){var t={};e.renderers={registerRenderer:function(e,n){t[e]=n},getRenderer:function(e){if("function"==typeof e)return e;if("string"!=typeof e)throw Error('Only strings and functions can be passed as "renderer" parameter ');if(!(e in t))throw Error('No editor registered under name "'+e+'"');return t[e]}}}(r),r.Dom=new w,r.helper.isPrintableChar=function(e){return 32==e||e>=48&&57>=e||e>=96&&111>=e||e>=186&&192>=e||e>=219&&222>=e||e>=226||e>=65&&90>=e},r.helper.isMetaKey=function(e){var t=r.helper.keyCode,n=[t.ARROW_DOWN,t.ARROW_UP,t.ARROW_LEFT,t.ARROW_RIGHT,t.HOME,t.END,t.DELETE,t.BACKSPACE,t.F1,t.F2,t.F3,t.F4,t.F5,t.F6,t.F7,t.F8,t.F9,t.F10,t.F11,t.F12,t.TAB,t.PAGE_DOWN,t.PAGE_UP,t.ENTER,t.ESCAPE,t.SHIFT,t.CAPS_LOCK,t.ALT];return-1!=n.indexOf(e)},r.helper.isCtrlKey=function(e){var t=r.helper.keyCode;return-1!=[t.CONTROL_LEFT,224,t.COMMAND_LEFT,t.COMMAND_RIGHT].indexOf(e)},r.helper.stringify=function(e){switch(typeof e){case"string":case"number":return e+"";case"object":return null===e?"":e.toString();case"undefined":return"";default:return e.toString()}},r.helper.spreadsheetColumnLabel=function(e){for(var t,n=e+1,i="";n>0;)t=(n-1)%26,i=String.fromCharCode(65+t)+i,n=parseInt((n-t)/26,10);return i},r.helper.isNumeric=function(e){var t=typeof e;return"number"==t?!isNaN(e)&&isFinite(e):"string"==t?e.length?1==e.length?/\d/.test(e):/^\s*[+-]?\s*(?:(?:\d+(?:\.\d+)?(?:e[+-]?\d+)?)|(?:0x[a-f\d]+))\s*$/i.test(e):!1:"object"==t?!(!e||"number"!=typeof e.valueOf()||e instanceof Date):!1},r.helper.isArray=function(e){return null!==Object.prototype.toString.call(e).match(/array/i)},r.helper.isDescendant=function(e,t){for(var n=t.parentNode;null!=n;){if(n==e)return!0;n=n.parentNode}return!1},r.helper.randomString=function(){return _()},r.helper.inherit=function(e,t){return t.prototype.constructor=t,e.prototype=new t,e.prototype.constructor=e,e},r.helper.extend=function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},r.helper.getPrototypeOf=function(e){var t;if("object"==typeof e.__proto__)t=e.__proto__;else{var n,i=e.constructor;"function"==typeof e.constructor&&(n=i,delete e.constructor&&(i=e.constructor,e.constructor=n)),t=i?i.prototype:null}return t},r.helper.columnFactory=function(e,t){function n(){}r.helper.inherit(n,e);for(var i=0,o=t.length;o>i;i++)n.prototype[t[i]]=void 0;return n},r.helper.translateRowsToColumns=function(e){var t,n,i,r,o=[],s=0;for(t=0,n=e.length;n>t;t++)for(i=0,r=e[t].length;r>i;i++)i==s&&(o.push([]),s++),o[i].push(e[t][i]);return o},r.helper.to2dArray=function(e){for(var t=0,n=e.length;n>t;)e[t]=[e[t]],t++},r.helper.extendArray=function(e,t){for(var n=0,i=t.length;i>n;)e.push(t[n]),n++},r.helper.isInput=function(e){var t=["INPUT","SELECT","TEXTAREA"];return t.indexOf(e.nodeName)>-1},r.helper.isOutsideInput=function(e){return r.helper.isInput(e)&&-1==e.className.indexOf("handsontableInput")},r.helper.keyCode={MOUSE_LEFT:1,MOUSE_RIGHT:3,MOUSE_MIDDLE:2,BACKSPACE:8,COMMA:188,DELETE:46,END:35,ENTER:13,ESCAPE:27,CONTROL_LEFT:91,COMMAND_LEFT:17,COMMAND_RIGHT:93,ALT:18,HOME:36,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,SPACE:32,SHIFT:16,CAPS_LOCK:20,TAB:9,ARROW_RIGHT:39,ARROW_LEFT:37,ARROW_UP:38,ARROW_DOWN:40,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,A:65,X:88,C:67,V:86},r.helper.isObject=function(e){return"[object Object]"==Object.prototype.toString.call(e)},r.helper.isArray=function(e){return Array.isArray?Array.isArray(e):"[object Array]"==Object.prototype.toString.call(e)},r.helper.pivot=function(e){var t=[];if(!e||0==e.length||!e[0]||0==e[0].length)return t;for(var n=e.length,i=e[0].length,r=0;n>r;r++)for(var o=0;i>o;o++)t[o]||(t[o]=[]),t[o][r]=e[r][o];return t},r.helper.proxy=function(e,t){return function(){return e.apply(t,arguments)}},r.helper.cellMethodLookupFactory=function(e,t){function n(e){var t=r.cellTypes[e];if("undefined"==typeof t)throw new Error('You declared cell type "'+e+'" as a string that is not mapped to a known object. Cell type must be an object or a string mapped to an object in Handsontable.cellTypes');return t}return t="undefined"==typeof t?!0:t,function(i,o){return function s(i){if(i){if(i.hasOwnProperty(e)&&i[e])return i[e];if(i.hasOwnProperty("type")&&i.type){var o;if("string"!=typeof i.type)throw new Error("Cell type must be a string ");if(o=n(i.type),o.hasOwnProperty(e))return o[e];if(t)return}return s(r.helper.getPrototypeOf(i))}}("number"==typeof i?this.getCellMeta(i,o):i)}},r.helper.toString=function(e){return""+e},r.SelectionPoint=function(){this._row=null,this._col=null},r.SelectionPoint.prototype.exists=function(){return null!==this._row},r.SelectionPoint.prototype.row=function(e){return void 0!==e&&(this._row=e),this._row},r.SelectionPoint.prototype.col=function(e){return void 0!==e&&(this._col=e),this._col},r.SelectionPoint.prototype.coords=function(e){return void 0!==e&&(this._row=e.row,this._col=e.col),{row:this._row,col:this._col}},r.SelectionPoint.prototype.arr=function(e){return void 0!==e&&(this._row=e[0],this._col=e[1]),[this._row,this._col]},function(e){e.DataMap=function(e,t,n){this.instance=e,this.priv=t,this.GridSettings=n,this.dataSource=this.instance.getSettings().data,this.dataSource[0]?this.duckSchema=this.recursiveDuckSchema(this.dataSource[0]):this.duckSchema={},this.createMap(),this.getVars={},this.setVars={}},e.DataMap.prototype.DESTINATION_RENDERER=1,e.DataMap.prototype.DESTINATION_CLIPBOARD_GENERATOR=2,e.DataMap.prototype.recursiveDuckSchema=function(e){var t;if(n.isPlainObject(e)){t={};for(var i in e)e.hasOwnProperty(i)&&(n.isPlainObject(e[i])?t[i]=this.recursiveDuckSchema(e[i]):t[i]=null)
}else t=[];return t},e.DataMap.prototype.recursiveDuckColumns=function(e,t,i){var r,o;if("undefined"==typeof t&&(t=0,i=""),n.isPlainObject(e))for(o in e)e.hasOwnProperty(o)&&(null===e[o]?(r=i+o,this.colToPropCache.push(r),this.propToColCache.set(r,t),t++):t=this.recursiveDuckColumns(e[o],t,o+"."));return t},e.DataMap.prototype.createMap=function(){if("undefined"==typeof this.getSchema())throw new Error("trying to create `columns` definition but you didnt' provide `schema` nor `data`");var e,t,n=this.getSchema();this.colToPropCache=[],this.propToColCache=new MultiMap;var i=this.instance.getSettings().columns;if(i)for(e=0,t=i.length;t>e;e++)"undefined"!=typeof i[e].data&&(this.colToPropCache[e]=i[e].data,this.propToColCache.set(i[e].data,e));else this.recursiveDuckColumns(n)},e.DataMap.prototype.colToProp=function(t){return t=e.PluginHooks.execute(this.instance,"modifyCol",t),this.colToPropCache&&"undefined"!=typeof this.colToPropCache[t]?this.colToPropCache[t]:t},e.DataMap.prototype.propToCol=function(t){var n;return n="undefined"!=typeof this.propToColCache.get(t)?this.propToColCache.get(t):t,n=e.PluginHooks.execute(this.instance,"modifyCol",n)},e.DataMap.prototype.getSchema=function(){var e=this.instance.getSettings().dataSchema;return e?"function"==typeof e?e():e:this.duckSchema},e.DataMap.prototype.createRow=function(e,t,i){var r,o,s=this.instance.countCols(),a=0;t||(t=1),("number"!=typeof e||e>=this.instance.countRows())&&(e=this.instance.countRows()),o=e;for(var l=this.instance.getSettings().maxRows;t>a&&this.instance.countRows()<l;){if("array"===this.instance.dataType){r=[];for(var u=0;s>u;u++)r.push(null)}else r="function"===this.instance.dataType?this.instance.getSettings().dataSchema(e):n.extend(!0,{},this.getSchema());e===this.instance.countRows()?this.dataSource.push(r):this.dataSource.splice(e,0,r),a++,o++}return this.instance.PluginHooks.run("afterCreateRow",e,a,i),this.instance.forceFullRender=!0,a},e.DataMap.prototype.createCol=function(t,n,i){if("object"===this.instance.dataType||this.instance.getSettings().columns)throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");var r,o,s=this.instance.countRows(),a=this.dataSource,l=0;n||(n=1),o=t;for(var u=this.instance.getSettings().maxCols;n>l&&this.instance.countCols()<u;){if(r=e.helper.columnFactory(this.GridSettings,this.priv.columnsSettingConflicts),"number"!=typeof t||t>=this.instance.countCols()){for(var c=0;s>c;c++)"undefined"==typeof a[c]&&(a[c]=[]),a[c].push(null);this.priv.columnSettings.push(r)}else{for(var c=0;s>c;c++)a[c].splice(o,0,null);this.priv.columnSettings.splice(o,0,r)}l++,o++}return this.instance.PluginHooks.run("afterCreateCol",t,l,i),this.instance.forceFullRender=!0,l},e.DataMap.prototype.removeRow=function(e,t){t||(t=1),"number"!=typeof e&&(e=-t),e=(this.instance.countRows()+e)%this.instance.countRows();var n=this.physicalRowsToLogical(e,t),i=this.instance.PluginHooks.execute("beforeRemoveRow",e,t);if(i!==!1){var r=this.dataSource,o=r.filter(function(e,t){return-1==n.indexOf(t)});r.length=0,Array.prototype.push.apply(r,o),this.instance.PluginHooks.run("afterRemoveRow",e,t),this.instance.forceFullRender=!0}},e.DataMap.prototype.removeCol=function(e,t){if("object"===this.instance.dataType||this.instance.getSettings().columns)throw new Error("cannot remove column with object data source or columns option specified");t||(t=1),"number"!=typeof e&&(e=-t),e=(this.instance.countCols()+e)%this.instance.countCols();var n=this.instance.PluginHooks.execute("beforeRemoveCol",e,t);if(n!==!1){for(var i=this.dataSource,r=0,o=this.instance.countRows();o>r;r++)i[r].splice(e,t);this.priv.columnSettings.splice(e,t),this.instance.PluginHooks.run("afterRemoveCol",e,t),this.instance.forceFullRender=!0}},e.DataMap.prototype.spliceCol=function(t,n,i){var r=4<=arguments.length?[].slice.call(arguments,3):[],o=this.instance.getDataAtCol(t),s=o.slice(n,n+i),a=o.slice(n+i);e.helper.extendArray(r,a);for(var l=0;i>l;)r.push(null),l++;return e.helper.to2dArray(r),this.instance.populateFromArray(n,t,r,null,null,"spliceCol"),s},e.DataMap.prototype.spliceRow=function(t,n,i){var r=4<=arguments.length?[].slice.call(arguments,3):[],o=this.instance.getDataAtRow(t),s=o.slice(n,n+i),a=o.slice(n+i);e.helper.extendArray(r,a);for(var l=0;i>l;)r.push(null),l++;return this.instance.populateFromArray(t,n,[r],null,null,"spliceRow"),s},e.DataMap.prototype.get=function(e,t){if(this.getVars.row=e,this.getVars.prop=t,this.instance.PluginHooks.run("beforeGet",this.getVars),"string"==typeof this.getVars.prop&&this.getVars.prop.indexOf(".")>-1){var n=this.getVars.prop.split("."),i=this.dataSource[this.getVars.row];if(!i)return null;for(var r=0,o=n.length;o>r;r++)if(i=i[n[r]],"undefined"==typeof i)return null;return i}return"function"==typeof this.getVars.prop?this.getVars.prop(this.dataSource.slice(this.getVars.row,this.getVars.row+1)[0]):this.dataSource[this.getVars.row]?this.dataSource[this.getVars.row][this.getVars.prop]:null};var t=e.helper.cellMethodLookupFactory("copyable",!1);e.DataMap.prototype.getCopyable=function(e,n){return t.call(this.instance,e,this.propToCol(n))?this.get(e,n):""},e.DataMap.prototype.set=function(e,t,n,i){if(this.setVars.row=e,this.setVars.prop=t,this.setVars.value=n,this.instance.PluginHooks.run("beforeSet",this.setVars,i||"datamapGet"),"string"==typeof this.setVars.prop&&this.setVars.prop.indexOf(".")>-1){for(var r=this.setVars.prop.split("."),o=this.dataSource[this.setVars.row],s=0,a=r.length-1;a>s;s++)o=o[r[s]];o[r[s]]=this.setVars.value}else"function"==typeof this.setVars.prop?this.setVars.prop(this.dataSource.slice(this.setVars.row,this.setVars.row+1)[0],this.setVars.value):this.dataSource[this.setVars.row][this.setVars.prop]=this.setVars.value},e.DataMap.prototype.physicalRowsToLogical=function(e,t){for(var n=this.instance.countRows(),i=(n+e)%n,r=[],o=t;n>i&&o;)this.get(i,0),r.push(this.getVars.row),o--,i++;return r},e.DataMap.prototype.clear=function(){for(var e=0;e<this.instance.countRows();e++)for(var t=0;t<this.instance.countCols();t++)this.set(e,this.colToProp(t),"")},e.DataMap.prototype.getAll=function(){return this.dataSource},e.DataMap.prototype.getRange=function(e,t,n){var i,r,o,s,a,l=[],u=n===this.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get;for(r=Math.max(e.row,t.row),s=Math.max(e.col,t.col),i=Math.min(e.row,t.row);r>=i;i++){for(a=[],o=Math.min(e.col,t.col);s>=o;o++)a.push(u.call(this,i,this.colToProp(o)));l.push(a)}return l},e.DataMap.prototype.getText=function(e,t){return SheetClip.stringify(this.getRange(e,t,this.DESTINATION_RENDERER))},e.DataMap.prototype.getCopyableText=function(e,t){return SheetClip.stringify(this.getRange(e,t,this.DESTINATION_CLIPBOARD_GENERATOR))}}(r),function(e){e.renderers.cellDecorator=function(e,t,n,i,r,o,s){s.readOnly&&e.view.wt.wtDom.addClass(t,s.readOnlyCellClassName),s.valid===!1&&s.invalidCellClassName&&e.view.wt.wtDom.addClass(t,s.invalidCellClassName),!o&&s.placeholder&&e.view.wt.wtDom.addClass(t,s.placeholderCellClassName)}}(r),function(e){var t=function(t,n,i,r,o,s,a){e.renderers.cellDecorator.apply(this,arguments),!s&&a.placeholder&&(s=a.placeholder);var l=e.helper.stringify(s);if(a.rendererTemplate){t.view.wt.wtDom.empty(n);var u=document.createElement("TEMPLATE");u.setAttribute("bind","{{}}"),u.innerHTML=a.rendererTemplate,HTMLTemplateElement.decorate(u),u.model=t.getDataAtRow(i),n.appendChild(u)}else t.view.wt.wtDom.fastInnerText(n,l)};e.renderers.TextRenderer=t,e.renderers.registerRenderer("text",t)}(r),function(e){var t=document.createElement("DIV");t.className="htAutocompleteWrapper";var n=document.createElement("DIV");n.className="htAutocompleteArrow",n.appendChild(document.createTextNode("▼"));var i=function(i,r,o,s,a,l,u){var c=(t.cloneNode(!0),n.cloneNode(!0));e.renderers.TextRenderer(i,r,o,s,a,l,u),r.appendChild(c),e.Dom.addClass(r,"htAutocomplete"),r.firstChild||r.appendChild(document.createTextNode(" ")),i.acArrowListener||(i.acArrowListener=function(){i.view.wt.getSetting("onCellDblClick")},i.rootElement.on("mousedown.htAutocompleteArrow",".htAutocompleteArrow",i.acArrowListener),i.addHookOnce("afterDestroy",function(){this.rootElement.off("mousedown.htAutocompleteArrow")}))};e.AutocompleteRenderer=i,e.renderers.AutocompleteRenderer=i,e.renderers.registerRenderer("autocomplete",i)}(r),function(e){var t=document.createElement("INPUT");t.className="htCheckboxRendererInput",t.type="checkbox",t.setAttribute("autocomplete","off");var i=function(i,r,o,s,a,l,u){"undefined"==typeof u.checkedTemplate&&(u.checkedTemplate=!0),"undefined"==typeof u.uncheckedTemplate&&(u.uncheckedTemplate=!1),i.view.wt.wtDom.empty(r);var c=t.cloneNode(!1);l===u.checkedTemplate||l===e.helper.stringify(u.checkedTemplate)?(c.checked=!0,r.appendChild(c)):l===u.uncheckedTemplate||l===e.helper.stringify(u.uncheckedTemplate)?r.appendChild(c):null===l?(c.className+=" noValue",r.appendChild(c)):i.view.wt.wtDom.fastInnerText(r,"#bad value#");var f=n(c);u.readOnly?f.on("click",function(e){e.preventDefault()}):(f.on("mousedown",function(e){e.stopPropagation()}),f.on("mouseup",function(e){e.stopPropagation()}),f.on("change",function(){this.checked?i.setDataAtRowProp(o,a,u.checkedTemplate):i.setDataAtRowProp(o,a,u.uncheckedTemplate)})),i.CheckboxRenderer&&i.CheckboxRenderer.beforeKeyDownHookBound||(i.CheckboxRenderer={beforeKeyDownHookBound:!0},i.addHook("beforeKeyDown",function(t){if(t.keyCode==e.helper.keyCode.SPACE)for(var r,o,s,a=i.getSelected(),l={row:Math.min(a[0],a[2]),col:Math.min(a[1],a[3])},u={row:Math.max(a[0],a[2]),col:Math.max(a[1],a[3])},c=l.row;c<=u.row;c++)for(var f=u.col;f<=u.col;f++)if(r=i.getCell(c,f),s=i.getCellMeta(c,f),o=r.querySelectorAll("input[type=checkbox]"),o.length>0&&!s.readOnly){t.isImmediatePropagationStopped()||(t.stopImmediatePropagation(),t.preventDefault());for(var h=0,p=o.length;p>h;h++)o[h].checked=!o[h].checked,n(o[h]).trigger("change")}}))};e.CheckboxRenderer=i,e.renderers.CheckboxRenderer=i,e.renderers.registerRenderer("checkbox",i)}(r),function(e){var n=function(n,i,r,o,s,a,l){e.helper.isNumeric(a)&&("undefined"!=typeof l.language&&t.language(l.language),a=t(a).format(l.format||"0"),n.view.wt.wtDom.addClass(i,"htNumeric")),e.renderers.TextRenderer(n,i,r,o,s,a,l)};e.NumericRenderer=n,e.renderers.NumericRenderer=n,e.renderers.registerRenderer("numeric",n)}(r),function(e){var t=function(e,t,n,i,o,s,a){r.renderers.TextRenderer.apply(this,arguments),s=t.innerHTML;var l,u=a.hashLength||s.length,c=a.hashSymbol||"*";for(l="";l.split(c).length-1<u;l+=c);e.view.wt.wtDom.fastInnerHTML(t,l)};e.PasswordRenderer=t,e.renderers.PasswordRenderer=t,e.renderers.registerRenderer("password",t)}(r),function(e){function t(t,n,i,r,o,s){e.renderers.cellDecorator.apply(this,arguments),e.Dom.fastInnerHTML(n,s)}e.renderers.registerRenderer("html",t),e.renderers.HtmlRenderer=t}(r),function(e){function t(t){this.instance=t,this.state=e.EditorState.VIRGIN,this._opened=!1,this._closeCallback=null,this.init()}e.EditorState={VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"},t.prototype._fireCallbacks=function(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)},t.prototype.init=function(){},t.prototype.getValue=function(){throw Error("Editor getValue() method unimplemented")},t.prototype.setValue=function(){throw Error("Editor setValue() method unimplemented")},t.prototype.open=function(){throw Error("Editor open() method unimplemented")},t.prototype.close=function(){throw Error("Editor close() method unimplemented")},t.prototype.prepare=function(t,n,i,r,o,s){this.TD=r,this.row=t,this.col=n,this.prop=i,this.originalValue=o,this.cellProperties=s,this.state=e.EditorState.VIRGIN},t.prototype.extend=function(){function e(){n.apply(this,arguments)}function t(e,t){function n(){}return n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e,e}var n=this.constructor;return t(e,n)},t.prototype.saveValue=function(e,t){if(t){var n=this.instance.getSelected();this.instance.populateFromArray(n[0],n[1],e,n[2],n[3],"edit")}else this.instance.populateFromArray(this.row,this.col,e,null,null,"edit")},t.prototype.beginEditing=function(t){this.state==e.EditorState.VIRGIN&&(this.instance.view.scrollViewport({row:this.row,col:this.col}),this.instance.view.render(),this.state=e.EditorState.EDITING,t="string"==typeof t?t:this.originalValue,this.setValue(e.helper.stringify(t)),this.open(),this._opened=!0,this.focus(),this.instance.view.render())},t.prototype.finishEditing=function(t,n,i){if(i){var r=this._closeCallback;this._closeCallback=function(e){r&&r(e),i(e)}}if(!this.isWaiting()){if(this.state==e.EditorState.VIRGIN){var o=this;return void setTimeout(function(){o._fireCallbacks(!0)})}if(this.state==e.EditorState.EDITING){if(t)return void this.cancelChanges();var s=[this.instance.getSettings().trimWhitespace?[this.getValue()+""]:[String.prototype.trim.call(this.getValue())]];if(this.state=e.EditorState.WAITING,this.saveValue(s,n),this.instance.getCellValidator(this.cellProperties)){var o=this;this.instance.addHookOnce("afterValidate",function(t){o.state=e.EditorState.FINISHED,o.discardEditor(t)})}else this.state=e.EditorState.FINISHED,this.discardEditor(!0)}}},t.prototype.cancelChanges=function(){this.state=e.EditorState.FINISHED,this.discardEditor()},t.prototype.discardEditor=function(t){this.state===e.EditorState.FINISHED&&(t===!1&&this.cellProperties.allowInvalid!==!0?(this.instance.selectCell(this.row,this.col),this.focus(),this.state=e.EditorState.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this.state=e.EditorState.VIRGIN,this._fireCallbacks(!0)))},t.prototype.isOpened=function(){return this._opened},t.prototype.isWaiting=function(){return this.state===e.EditorState.WAITING},e.editors.BaseEditor=t}(r),function(e){var t=e.editors.BaseEditor.prototype.extend();t.prototype.init=function(){this.createElements(),this.bindEvents()},t.prototype.getValue=function(){return this.TEXTAREA.value},t.prototype.setValue=function(e){this.TEXTAREA.value=e};var i=function(t){var n=this,i=n.getActiveEditor(),r=e.helper.keyCode,o=(t.ctrlKey||t.metaKey)&&!t.altKey;if(t.target===i.TEXTAREA&&!t.isImmediatePropagationStopped()){if(17===t.keyCode||224===t.keyCode||91===t.keyCode||93===t.keyCode)return void t.stopImmediatePropagation();switch(t.keyCode){case r.ARROW_RIGHT:i.wtDom.getCaretPosition(i.TEXTAREA)!==i.TEXTAREA.value.length&&t.stopImmediatePropagation();break;case r.ARROW_LEFT:0!==i.wtDom.getCaretPosition(i.TEXTAREA)&&t.stopImmediatePropagation();break;case r.ENTER:var s=i.instance.getSelected(),a=!(s[0]===s[2]&&s[1]===s[3]);(o&&!a||t.altKey)&&(i.isOpened()?(i.setValue(i.getValue()+"\n"),i.focus()):i.beginEditing(i.originalValue+"\n"),t.stopImmediatePropagation()),t.preventDefault();break;case r.A:case r.X:case r.C:case r.V:if(o){t.stopImmediatePropagation();break}case r.BACKSPACE:case r.DELETE:case r.HOME:case r.END:t.stopImmediatePropagation()}}};t.prototype.open=function(){this.refreshDimensions(),this.instance.addHook("beforeKeyDown",i)},t.prototype.close=function(){this.textareaParentStyle.display="none",document.activeElement===this.TEXTAREA&&this.instance.listen(),this.instance.removeHook("beforeKeyDown",i)},t.prototype.focus=function(){this.TEXTAREA.focus(),this.wtDom.setCaretPosition(this.TEXTAREA,this.TEXTAREA.value.length)},t.prototype.createElements=function(){this.$body=n(document.body),this.wtDom=new w,this.TEXTAREA=document.createElement("TEXTAREA"),this.$textarea=n(this.TEXTAREA),this.wtDom.addClass(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.TEXTAREA_PARENT=document.createElement("DIV"),this.wtDom.addClass(this.TEXTAREA_PARENT,"handsontableInputHolder"),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.textareaParentStyle.top=0,this.textareaParentStyle.left=0,this.textareaParentStyle.display="none",this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.instance.rootElement[0].appendChild(this.TEXTAREA_PARENT);var t=this;e.PluginHooks.add("afterRender",function(){t.instance.registerTimeout("refresh_editor_dimensions",function(){t.refreshDimensions()},0)})},t.prototype.refreshDimensions=function(){if(this.state===e.EditorState.EDITING&&(this.TD=this.instance.getCell(this.row,this.col),this.TD)){var t=n(this.TD),i=this.wtDom.offset(this.TD),r=this.wtDom.offset(this.instance.rootElement[0]),o=this.instance.rootElement.scrollTop(),s=this.instance.rootElement.scrollLeft(),a=i.top-r.top+o-1,l=i.left-r.left+s-1,u=this.instance.getSettings(),c=u.rowHeaders===!1?0:1,f=u.colHeaders===!1?0:1;0>a&&(a=0),0>l&&(l=0),c>0&&parseInt(t.css("border-top-width"),10)>0&&(a+=1),f>0&&parseInt(t.css("border-left-width"),10)>0&&(l+=1),this.textareaParentStyle.top=a+"px",this.textareaParentStyle.left=l+"px";var h=t.width(),p=this.instance.view.maximumVisibleElementWidth(l)-10,d=t.outerHeight()-4,g=this.instance.view.maximumVisibleElementHeight(a)-5;parseInt(t.css("border-top-width"),10)>0&&(d-=1),parseInt(t.css("border-left-width"),10)>0&&c>0&&(h-=1),this.$textarea.autoResize({minHeight:Math.min(d,g),maxHeight:g,minWidth:Math.min(h,p),maxWidth:p,animate:!1,extraSpace:0}),this.textareaParentStyle.display="block"}},t.prototype.bindEvents=function(){this.$textarea.on("cut.editor",function(e){e.stopPropagation()}),this.$textarea.on("paste.editor",function(e){e.stopPropagation()})},e.editors.TextEditor=t,e.editors.registerEditor("text",e.editors.TextEditor)}(r),function(e){var t=e.editors.BaseEditor.prototype.extend();t.prototype.beginEditing=function(){var e=this.TD.querySelector('input[type="checkbox"]');e&&n(e).trigger("click")},t.prototype.finishEditing=function(){},t.prototype.init=function(){},t.prototype.open=function(){},t.prototype.close=function(){},t.prototype.getValue=function(){},t.prototype.setValue=function(){},t.prototype.focus=function(){},e.editors.CheckboxEditor=t,e.editors.registerEditor("checkbox",t)}(r),function(e){var t=e.editors.TextEditor.prototype.extend();t.prototype.init=function(){if(!n.datepicker)throw new Error("jQuery UI Datepicker dependency not found. Did you forget to include jquery-ui.custom.js or its substitute?");e.editors.TextEditor.prototype.init.apply(this,arguments),this.isCellEdited=!1;var t=this;this.instance.addHook("afterDestroy",function(){t.destroyElements()})},t.prototype.createElements=function(){e.editors.TextEditor.prototype.createElements.apply(this,arguments),this.datePicker=document.createElement("DIV"),this.instance.view.wt.wtDom.addClass(this.datePicker,"htDatepickerHolder"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=99,document.body.appendChild(this.datePicker),this.$datePicker=n(this.datePicker);var t=this,i={dateFormat:"yy-mm-dd",showButtonPanel:!0,changeMonth:!0,changeYear:!0,onSelect:function(e){t.setValue(e),t.finishEditing(!1)}};this.$datePicker.datepicker(i),this.$datePicker.on("mousedown",function(e){e.stopPropagation()}),this.hideDatepicker()},t.prototype.destroyElements=function(){this.$datePicker.datepicker("destroy"),this.$datePicker.remove()},t.prototype.open=function(){e.editors.TextEditor.prototype.open.call(this),this.showDatepicker()},t.prototype.finishEditing=function(){this.hideDatepicker(),e.editors.TextEditor.prototype.finishEditing.apply(this,arguments)},t.prototype.showDatepicker=function(){var e=n(this.TD),t=e.offset();this.datePickerStyle.top=t.top+e.height()+"px",this.datePickerStyle.left=t.left+"px";var i={defaultDate:this.originalValue||void 0};n.extend(i,this.cellProperties),this.$datePicker.datepicker("option",i),this.originalValue&&this.$datePicker.datepicker("setDate",this.originalValue),this.datePickerStyle.display="block"},t.prototype.hideDatepicker=function(){this.datePickerStyle.display="none"},e.editors.DateEditor=t,e.editors.registerEditor("date",t)}(r),function(e){var t=e.editors.TextEditor.prototype.extend();t.prototype.createElements=function(){e.editors.TextEditor.prototype.createElements.apply(this,arguments);var t=document.createElement("DIV");t.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(t),this.$htContainer=n(t),this.$htContainer.handsontable()},t.prototype.prepare=function(t,i,r,o,s,a){e.editors.TextEditor.prototype.prepare.apply(this,arguments);var l=this,u={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,cells:function(){return{readOnly:!0}},fillHandle:!1,afterOnCellMouseDown:function(){var e=this.getValue();void 0!==e&&l.setValue(e),l.instance.destroyEditor()},beforeOnKeyDown:function(t){var n=this;switch(t.keyCode){case e.helper.keyCode.ESCAPE:l.instance.destroyEditor(!0),t.stopImmediatePropagation(),t.preventDefault();break;case e.helper.keyCode.ENTER:var i=n.getSelected(),r=this.getDataAtCell(i[0],i[1]);void 0!==r&&l.setValue(r),l.instance.destroyEditor();break;case e.helper.keyCode.ARROW_UP:n.getSelected()&&0==n.getSelected()[0]&&!l.cellProperties.strict&&(n.deselectCell(),l.instance.listen(),l.focus(),t.preventDefault(),t.stopImmediatePropagation())}}};this.cellProperties.handsontable&&(u=n.extend(u,a.handsontable)),this.$htContainer.handsontable("destroy"),this.$htContainer.handsontable(u)};var i=function(t){if(!t.isImmediatePropagationStopped()){var n=this.getActiveEditor(),i=n.$htContainer.handsontable("getInstance");if(t.keyCode==e.helper.keyCode.ARROW_DOWN){if(i.getSelected()){var r=i.getSelected()[0],o=r<i.countRows()-1?r+1:r;i.selectCell(o,0)}else i.selectCell(0,0);t.preventDefault(),t.stopImmediatePropagation()}}};t.prototype.open=function(){this.instance.addHook("beforeKeyDown",i),e.editors.TextEditor.prototype.open.apply(this,arguments),this.$htContainer.handsontable("render"),this.cellProperties.strict?(this.$htContainer.handsontable("selectCell",0,0),this.$textarea[0].style.visibility="hidden"):(this.$htContainer.handsontable("deselectCell"),this.$textarea[0].style.visibility="visible"),this.wtDom.setCaretPosition(this.$textarea[0],0,this.$textarea[0].value.length)},t.prototype.close=function(){this.instance.removeHook("beforeKeyDown",i),this.instance.listen(),e.editors.TextEditor.prototype.close.apply(this,arguments)},t.prototype.focus=function(){this.instance.listen(),e.editors.TextEditor.prototype.focus.apply(this,arguments)},t.prototype.beginEditing=function(){var t=this.instance.getSettings().onBeginEditing;t&&t()===!1||e.editors.TextEditor.prototype.beginEditing.apply(this,arguments)},t.prototype.finishEditing=function(){if(this.$htContainer.handsontable("isListening")&&this.instance.listen(),this.$htContainer.handsontable("getSelected")){var t=this.$htContainer.handsontable("getInstance").getValue();void 0!==t&&this.setValue(t)}return e.editors.TextEditor.prototype.finishEditing.apply(this,arguments)},e.editors.HandsontableEditor=t,e.editors.registerEditor("handsontable",t)}(r),function(e){var t=e.editors.HandsontableEditor.prototype.extend();t.prototype.init=function(){e.editors.HandsontableEditor.prototype.init.apply(this,arguments),this.query=null,this.choices=[]},t.prototype.createElements=function(){e.editors.HandsontableEditor.prototype.createElements.apply(this,arguments),this.$htContainer.addClass("autocompleteEditor")},t.prototype.bindEvents=function(){var t=this;this.$textarea.on("keydown.autocompleteEditor",function(n){e.helper.isMetaKey(n.keyCode)&&-1==[e.helper.keyCode.BACKSPACE,e.helper.keyCode.DELETE].indexOf(n.keyCode)?n.keyCode==e.helper.keyCode.ENTER&&t.cellProperties.strict!==!0&&t.$htContainer.handsontable("deselectCell"):setTimeout(function(){t.queryChoices(t.$textarea.val())})}),this.$htContainer.on("mouseleave",function(){t.cellProperties.strict===!0&&t.highlightBestMatchingChoice()}),this.$htContainer.on("mouseenter",function(){t.$htContainer.handsontable("deselectCell")}),e.editors.HandsontableEditor.prototype.bindEvents.apply(this,arguments)};var n;t.prototype.open=function(){e.editors.HandsontableEditor.prototype.open.apply(this,arguments),this.$textarea[0].style.visibility="visible",this.focus();var t=this.$htContainer.handsontable("getInstance"),i=this;t.updateSettings({colWidths:[this.wtDom.outerWidth(this.TEXTAREA)-2],afterRenderer:function(e,t,n,r,o){var s=this.getCellMeta(t,n).filteringCaseSensitive===!0,a=s?o.indexOf(this.query):o.toLowerCase().indexOf(i.query.toLowerCase());if(-1!=a){var l=o.substr(a,i.query.length);e.innerHTML=o.replace(l,"<strong>"+l+"</strong>")}}}),n=function(t){var n=this;t.keyCode==e.helper.keyCode.ARROW_UP&&n.getSelected()&&0==n.getSelected()[0]&&(parent.cellProperties.strict||n.deselectCell(),parent.instance.listen(),parent.focus(),t.preventDefault(),t.stopImmediatePropagation())},t.addHook("beforeKeyDown",n),this.queryChoices(this.TEXTAREA.value)},t.prototype.close=function(){this.$htContainer.handsontable("getInstance").removeHook("beforeKeyDown",n),e.editors.HandsontableEditor.prototype.close.apply(this,arguments)},t.prototype.queryChoices=function(t){if(this.query=t,"function"==typeof this.cellProperties.source){var n=this;this.cellProperties.source(t,function(e){n.updateChoicesList(e)})}else if(e.helper.isArray(this.cellProperties.source)){var i;if(t&&this.cellProperties.filter!==!1){var r=this.cellProperties.filteringCaseSensitive===!0,o=t.toLowerCase();i=this.cellProperties.source.filter(function(e){return r?-1!=e.indexOf(t):-1!=e.toLowerCase().indexOf(o)})}else i=this.cellProperties.source;this.updateChoicesList(i)}else this.updateChoicesList([])},t.prototype.updateChoicesList=function(t){this.choices=t,this.$htContainer.handsontable("loadData",e.helper.pivot([t])),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(),this.focus()},t.prototype.highlightBestMatchingChoice=function(){var e=this.findBestMatchingChoice();"undefined"==typeof e&&this.cellProperties.allowInvalid===!1&&(e=0),"undefined"==typeof e?this.$htContainer.handsontable("deselectCell"):this.$htContainer.handsontable("selectCell",e,0)},t.prototype.findBestMatchingChoice=function(){for(var e,t,n,i={},r=this.getValue().length,o=0,s=this.choices.length;s>o;o++)e=this.choices[o],t=r>0?e.indexOf(this.getValue()):e===this.getValue()?0:-1,-1!=t&&(n=e.length-t-r,("undefined"==typeof i.indexOfValue||i.indexOfValue>t||i.indexOfValue==t&&i.charsLeft>n)&&(i.indexOfValue=t,i.charsLeft=n,i.index=o));return i.index},e.editors.AutocompleteEditor=t,e.editors.registerEditor("autocomplete",t)}(r),function(e){var t=e.editors.TextEditor.prototype.extend(),i=new w;t.prototype.createElements=function(){e.editors.TextEditor.prototype.createElements.apply(this,arguments),this.TEXTAREA=document.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.$textarea=n(this.TEXTAREA),i.empty(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)},e.editors.PasswordEditor=t,e.editors.registerEditor("password",t)}(r),function(e){var t=e.editors.BaseEditor.prototype.extend();t.prototype.init=function(){this.select=document.createElement("SELECT"),e.Dom.addClass(this.select,"htSelectEditor"),this.select.style.display="none",this.instance.rootElement[0].appendChild(this.select)},t.prototype.prepare=function(){e.editors.BaseEditor.prototype.prepare.apply(this,arguments);var t,n=this.cellProperties.selectOptions;t="function"==typeof n?this.prepareOptions(n(this.row,this.col,this.prop)):this.prepareOptions(n),e.Dom.empty(this.select);for(var i in t)if(t.hasOwnProperty(i)){var r=document.createElement("OPTION");r.value=i,e.Dom.fastInnerHTML(r,t[i]),this.select.appendChild(r)}},t.prototype.prepareOptions=function(t){var n={};if(e.helper.isArray(t))for(var i=0,r=t.length;r>i;i++)n[t[i]]=t[i];else"object"==typeof t&&(n=t);return n},t.prototype.getValue=function(){return this.select.value},t.prototype.setValue=function(e){this.select.value=e};var n=function(t){var n=this,i=n.getActiveEditor();switch(t.keyCode){case e.helper.keyCode.ARROW_UP:var r=i.select.find("option:selected").prev();1==r.length&&r.prop("selected",!0),t.stopImmediatePropagation(),t.preventDefault();break;case e.helper.keyCode.ARROW_DOWN:var o=i.select.find("option:selected").next();1==o.length&&o.prop("selected",!0),t.stopImmediatePropagation(),t.preventDefault()}};t.prototype.open=function(){var t=e.Dom.outerWidth(this.TD),i=e.Dom.outerHeight(this.TD),r=e.Dom.offset(this.instance.rootElement[0]),o=e.Dom.offset(this.TD);this.select.style.height=i+"px",this.select.style.minWidth=t+"px",this.select.style.top=o.top-r.top+"px",this.select.style.left=o.left-r.left-2+"px",this.select.style.display="",this.instance.addHook("beforeKeyDown",n)},t.prototype.close=function(){this.select.style.display="none",this.instance.removeHook("beforeKeyDown",n)},t.prototype.focus=function(){this.select.focus()},e.editors.SelectEditor=t,e.editors.registerEditor("select",t)}(r),function(e){var t=e.editors.AutocompleteEditor.prototype.extend();t.prototype.prepare=function(){e.editors.AutocompleteEditor.prototype.prepare.apply(this,arguments),this.cellProperties.filter=!1,this.cellProperties.strict=!0},e.editors.DropdownEditor=t,e.editors.registerEditor("dropdown",t)}(r),r.NumericValidator=function(e,t){null===e&&(e=""),t(/^-?\d*\.?\d*$/.test(e))};var L=function(e,t){var n=e,i="string"==typeof n?n.toLowerCase():null;return function(e){for(var r=!1,o=0,s=e.length;s>o;o++){if(n===e[o]){r=!0;break}if(i===e[o].toLowerCase()){r=!0;break}}t(r)}};r.AutocompleteValidator=function(e,t){this.strict&&this.source?"function"==typeof this.source?this.source(e,L(e,t)):L(e,t)(this.source):t(!0)},r.AutocompleteCell={editor:r.editors.AutocompleteEditor,renderer:r.renderers.AutocompleteRenderer,validator:r.AutocompleteValidator},r.CheckboxCell={editor:r.editors.CheckboxEditor,renderer:r.renderers.CheckboxRenderer},r.TextCell={editor:r.editors.TextEditor,renderer:r.renderers.TextRenderer},r.NumericCell={editor:r.editors.TextEditor,renderer:r.renderers.NumericRenderer,validator:r.NumericValidator,dataType:"number"},r.DateCell={editor:r.editors.DateEditor,renderer:r.renderers.AutocompleteRenderer},r.HandsontableCell={editor:r.editors.HandsontableEditor,renderer:r.renderers.AutocompleteRenderer},r.PasswordCell={editor:r.editors.PasswordEditor,renderer:r.renderers.PasswordRenderer,copyable:!1},r.DropdownCell={editor:r.editors.DropdownEditor,renderer:r.renderers.AutocompleteRenderer,validator:r.AutocompleteValidator},r.cellTypes={text:r.TextCell,date:r.DateCell,numeric:r.NumericCell,checkbox:r.CheckboxCell,autocomplete:r.AutocompleteCell,handsontable:r.HandsontableCell,password:r.PasswordCell,dropdown:r.DropdownCell},r.cellLookup={validator:{numeric:r.NumericValidator,autocomplete:r.AutocompleteValidator}},function(e){function t(i){return this.filter(t.resizableFilterSelector).each(function(){new n(e(this),i)}),this}function n(n,i){this.clones||(this.config=e.extend({},t.defaults,i),this.el=n,this.nodeName=n[0].nodeName.toLowerCase(),this.previousScrollTop=null,"original"===i.maxWidth&&(i.maxWidth=n.width()),"original"===i.minWidth&&(i.minWidth=n.width()),"original"===i.maxHeight&&(i.maxHeight=n.height()),"original"===i.minHeight&&(i.minHeight=n.height()),"textarea"===this.nodeName&&n.css({resize:"none",overflowY:"none"}),n.data("AutoResizer",this),this.createClone(),this.injectClone(),this.bind())}t.defaults={onResize:function(){},animate:{duration:200,complete:function(){}},extraSpace:50,minHeight:"original",maxHeight:500,minWidth:"original",maxWidth:500},t.cloneCSSProperties=["lineHeight","textDecoration","letterSpacing","fontSize","fontFamily","fontStyle","fontWeight","textTransform","textAlign","direction","wordSpacing","fontSizeAdjust","padding"],t.cloneCSSValues={position:"absolute",top:-9999,left:-9999,opacity:0,overflow:"hidden",overflowX:"hidden",overflowY:"hidden",border:"1px solid black",padding:"0.49em"},t.resizableFilterSelector="textarea,input:not(input[type]),input[type=text],input[type=password]",t.AutoResizer=n,e.fn.autoResize=t,n.prototype={bind:function(){var t=e.proxy(function(){return this.check(),!0
},this);this.unbind(),this.el.bind("keyup.autoResize",t).bind("change.autoResize",t),this.check(null,!0)},unbind:function(){this.el.unbind(".autoResize")},createClone:function(){var n=this.el,i=this,r=this.config;this.clones=e(),("original"!==r.minHeight||"original"!==r.maxHeight)&&(this.hClone=n.clone().height("auto"),this.clones=this.clones.add(this.hClone)),("original"!==r.minWidth||"original"!==r.maxWidth)&&(this.wClone=e("<div/>").width("auto").css({whiteSpace:"nowrap","float":"left"}),this.clones=this.clones.add(this.wClone)),e.each(t.cloneCSSProperties,function(e,t){i.clones.css(t,n.css(t))}),this.clones.removeAttr("name").removeAttr("id").attr("tabIndex",-1).css(t.cloneCSSValues).css("overflowY","scroll")},check:function(e,t){var n=this.config,i=this.wClone,r=this.hClone,o=this.el,s=o.val();if(i){i.text(s);var a=i.outerWidth(),l=a+n.extraSpace>=n.minWidth?a+n.extraSpace:n.minWidth,u=o.width();l=Math.min(l,n.maxWidth),(u>l&&l>=n.minWidth||l>=n.minWidth&&l<=n.maxWidth)&&(n.onResize.call(o),o.scrollLeft(0),n.animate&&!t?o.stop(1,1).animate({width:l},n.animate):o.width(l))}if(r){l&&r.width(l),r.height(0).val(s).scrollTop(1e4);var c=r[0].scrollTop+n.extraSpace;if(this.previousScrollTop===c)return;this.previousScrollTop=c,c>=n.maxHeight&&(c=n.maxHeight),c<n.minHeight&&(c=n.minHeight),c==n.maxHeight&&l==n.maxWidth?o.css("overflowY","scroll"):o.css("overflowY","hidden"),n.onResize.call(o),n.animate&&!t?o.stop(1,1).animate({height:c},n.animate):o.height(c)}},destroy:function(){this.unbind(),this.el.removeData("AutoResizer"),this.clones.remove(),delete this.el,delete this.hClone,delete this.wClone,delete this.clones},injectClone:function(){(t.cloneContainer||(t.cloneContainer=e("<arclones/>").appendTo("body"))).empty().append(this.clones)}}}(e),function(e){function t(e){return e.split('"').length-1}e.SheetClip={parse:function(e){var n,i,r,o,s,a,l,u=[],c=0;for(r=e.split("\n"),r.length>1&&""===r[r.length-1]&&r.pop(),n=0,i=r.length;i>n;n+=1){for(r[n]=r[n].split("	"),o=0,s=r[n].length;s>o;o+=1)u[c]||(u[c]=[]),a&&0===o?(l=u[c].length-1,u[c][l]=u[c][l]+"\n"+r[n][0],a&&1&t(r[n][0])&&(a=!1,u[c][l]=u[c][l].substring(0,u[c][l].length-1).replace(/""/g,'"'))):o===s-1&&0===r[n][o].indexOf('"')?(u[c].push(r[n][o].substring(1).replace(/""/g,'"')),a=!0):(u[c].push(r[n][o].replace(/""/g,'"')),a=!1);a||(c+=1)}return u},stringify:function(e){var t,n,i,r,o,s="";for(t=0,n=e.length;n>t;t+=1){for(i=0,r=e[t].length;r>i;i+=1)i>0&&(s+="	"),o=e[t][i],s+="string"==typeof o?o.indexOf("\n")>-1?'"'+o.replace(/"/g,'""')+'"':o:null===o||void 0===o?"":o;s+="\n"}return s}}}(i);var j=function(){var e;return{getInstance:function(){return e?e.hasBeenDestroyed()&&e.init():e=new o,e.refCounter++,e}}}();o.prototype.init=function(){var e,t,i=this;this.copyCallbacks=[],this.cutCallbacks=[],this.pasteCallbacks=[],this.listenerElement=document.documentElement,t=document.body,document.getElementById("CopyPasteDiv")?(this.elDiv=document.getElementById("CopyPasteDiv"),this.elTextarea=this.elDiv.firstChild):(this.elDiv=document.createElement("DIV"),this.elDiv.id="CopyPasteDiv",e=this.elDiv.style,e.position="fixed",e.top="-10000px",e.left="-10000px",t.appendChild(this.elDiv),this.elTextarea=document.createElement("TEXTAREA"),this.elTextarea.className="copyPaste",e=this.elTextarea.style,e.width="10000px",e.height="10000px",e.overflow="hidden",this.elDiv.appendChild(this.elTextarea),"undefined"!=typeof e.opacity&&(e.opacity=0)),this.keydownListener=function(e){var t=!1;if(e.metaKey?t=!0:e.ctrlKey&&-1===navigator.userAgent.indexOf("Mac")&&(t=!0),t){if(document.activeElement!==i.elTextarea&&(""!=i.getSelectionText()||-1!=["INPUT","SELECT","TEXTAREA"].indexOf(document.activeElement.nodeName)||"true"===n(document.activeElement).prop("contentEditable")))return;i.selectNodeText(i.elTextarea),setTimeout(function(){i.selectNodeText(i.elTextarea)},0)}!t||67!==e.keyCode&&86!==e.keyCode&&88!==e.keyCode||(88===e.keyCode?setTimeout(function(){i.triggerCut(e)},0):86===e.keyCode&&setTimeout(function(){i.triggerPaste(e)},0))},this._bindEvent(this.listenerElement,"keydown",this.keydownListener)},o.prototype.selectNodeText=function(e){e.select()},o.prototype.getSelectionText=function(){var e="";return i.getSelection?e=i.getSelection().toString():document.selection&&"Control"!=document.selection.type&&(e=document.selection.createRange().text),e},o.prototype.copyable=function(e){if("string"!=typeof e&&void 0===e.toString)throw new Error("copyable requires string parameter");this.elTextarea.value=e},o.prototype.onCut=function(e){this.cutCallbacks.push(e)},o.prototype.onPaste=function(e){this.pasteCallbacks.push(e)},o.prototype.removeCallback=function(e){var t,n;for(t=0,n=this.copyCallbacks.length;n>t;t++)if(this.copyCallbacks[t]===e)return this.copyCallbacks.splice(t,1),!0;for(t=0,n=this.cutCallbacks.length;n>t;t++)if(this.cutCallbacks[t]===e)return this.cutCallbacks.splice(t,1),!0;for(t=0,n=this.pasteCallbacks.length;n>t;t++)if(this.pasteCallbacks[t]===e)return this.pasteCallbacks.splice(t,1),!0;return!1},o.prototype.triggerCut=function(e){var t=this;t.cutCallbacks&&setTimeout(function(){for(var n=0,i=t.cutCallbacks.length;i>n;n++)t.cutCallbacks[n](e)},50)},o.prototype.triggerPaste=function(e,t){var n=this;n.pasteCallbacks&&setTimeout(function(){for(var i=(t||n.elTextarea.value).replace(/\n$/,""),r=0,o=n.pasteCallbacks.length;o>r;r++)n.pasteCallbacks[r](i,e)},50)},o.prototype.destroy=function(){this.hasBeenDestroyed()||0!=--this.refCounter||(this.elDiv&&this.elDiv.parentNode&&this.elDiv.parentNode.removeChild(this.elDiv),this._unbindEvent(this.listenerElement,"keydown",this.keydownListener))},o.prototype.hasBeenDestroyed=function(){return!this.refCounter},o.prototype._bindEvent=function(){return i.jQuery?function(e,t,i){n(e).on(t+".copypaste",i)}:function(e,t,n){e.addEventListener(t,n,!1)}}(),o.prototype._unbindEvent=function(){return i.jQuery?function(e,t,i){n(e).off(t+".copypaste",i)}:function(e,t,n){e.removeEventListener(t,n,!1)}}();var V;!function(e){function t(e){return-1===e.indexOf("/")&&-1===e.indexOf("~")?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function n(e,i){var r;for(var o in e)if(e.hasOwnProperty(o)){if(e[o]===i)return t(o)+"/";if("object"==typeof e[o]&&(r=n(e[o],i),""!=r))return t(o)+"/"+r}return""}function r(e,t){if(e===t)return"/";var i=n(e,t);if(""===i)throw new Error("Object not found in root");return"/"+i}function o(e){for(var t=0,n=y.length;n>t;t++)if(y[t].obj===e)return y[t]}function s(e,t){for(var n=0,i=e.observers.length;i>n;n++)if(e.observers[n].callback===t)return e.observers[n].observer}function a(e,t){for(var n=0,i=e.observers.length;i>n;n++)if(e.observers[n].observer===t)return void e.observers.splice(n,1)}function l(e,t){h(t),Object.observe?f(t,e):clearTimeout(t.next);var n=o(e);a(n,t)}function u(e,t){var n,a=[],l=e,u=o(e);if(u?n=s(u,t):(u=new b(e),y.push(u)),n)return n;if(Object.observe)n=function(i){f(n,e),c(n,e);for(var o=0,s=i.length;s>o;){if(("length"!==i[o].name||!_(i[o].object))&&"__Jasmine_been_here_before__"!==i[o].name){var u=i[o].type;switch(u){case"new":u="add";break;case"deleted":u="delete";break;case"updated":u="update"}m[u].call(i[o],a,r(l,i[o].object))}o++}a&&t&&t(a),n.patches=a,a=[]};else if(n={},u.value=JSON.parse(JSON.stringify(e)),t){n.callback=t,n.next=null;var p=this.intervals||[100,1e3,1e4,6e4],d=0,g=function(){h(n)},v=function(){clearTimeout(n.next),n.next=setTimeout(function(){g(),d=0,n.next=setTimeout(C,p[d++])},0)},C=function(){g(),d==p.length&&(d=p.length-1),n.next=setTimeout(C,p[d++])};"undefined"!=typeof i&&(i.addEventListener?(i.addEventListener("mousedown",v),i.addEventListener("mouseup",v),i.addEventListener("keydown",v)):(i.attachEvent("onmousedown",v),i.attachEvent("onmouseup",v),i.attachEvent("onkeydown",v))),n.next=setTimeout(C,p[d++])}return n.patches=a,n.object=e,u.observers.push(new w(t,n)),c(n,e)}function c(e,t){if(Object.observe){Object.observe(t,e);for(var n in t)if(t.hasOwnProperty(n)){var i=t[n];i&&"object"==typeof i&&c(e,i)}}return e}function f(e,t){if(Object.observe){Object.unobserve(t,e);for(var n in t)if(t.hasOwnProperty(n)){var i=t[n];i&&"object"==typeof i&&f(e,i)}}return e}function h(e){if(Object.observe)Object.deliverChangeRecords(e);else{for(var t,n=0,i=y.length;i>n;n++)if(y[n].obj===e.object){t=y[n];break}p(t.value,e.object,e.patches,"")}var r=e.patches;return r.length>0&&(e.patches=[],e.callback&&e.callback(r)),r}function p(e,n,i,r){for(var o=C(n),s=C(e),a=!1,l=!1,u=s.length-1;u>=0;u--){var c=s[u],f=e[c];if(n.hasOwnProperty(c)){var h=n[c];f instanceof Object?p(f,h,i,r+"/"+t(c)):f!=h&&(a=!0,i.push({op:"replace",path:r+"/"+t(c),value:h}),e[c]=h)}else i.push({op:"remove",path:r+"/"+t(c)}),delete e[c],l=!0}if(l||o.length!=s.length)for(var u=0;u<o.length;u++){var c=o[u];e.hasOwnProperty(c)||(i.push({op:"add",path:r+"/"+t(c),value:n[c]}),e[c]=JSON.parse(JSON.stringify(n[c])))}}function d(e,t){for(var n,i=!1,r=0,o=t.length;o>r;){n=t[r];for(var s=n.path.split("/"),a=e,l=1,u=s.length;;)if(_(a)){var c=parseInt(s[l],10);if(l++,l>=u){i=v[n.op].call(n,a,c,e);break}a=a[c]}else{var f=s[l];if(-1!=f.indexOf("~")&&(f=f.replace(/~1/g,"/").replace(/~0/g,"~")),l++,l>=u){i=g[n.op].call(n,a,f,e);break}a=a[f]}r++}return i}var g={add:function(e,t){return e[t]=this.value,!0},remove:function(e,t){return delete e[t],!0},replace:function(e,t){return e[t]=this.value,!0},move:function(e,t,n){var i={op:"_get",path:this.from};return d(n,[i]),d(n,[{op:"remove",path:this.from}]),d(n,[{op:"add",path:this.path,value:i.value}]),!0},copy:function(e,t,n){var i={op:"_get",path:this.from};return d(n,[i]),d(n,[{op:"add",path:this.path,value:i.value}]),!0},test:function(e,t){return JSON.stringify(e[t])===JSON.stringify(this.value)},_get:function(e,t){this.value=e[t]}},v={add:function(e,t){return e.splice(t,0,this.value),!0},remove:function(e,t){return e.splice(t,1),!0},replace:function(e,t){return e[t]=this.value,!0},move:g.move,copy:g.copy,test:g.test,_get:g._get},m={add:function(e,n){var i={op:"add",path:n+t(this.name),value:this.object[this.name]};e.push(i)},"delete":function(e,n){var i={op:"remove",path:n+t(this.name)};e.push(i)},update:function(e,n){var i={op:"replace",path:n+t(this.name),value:this.object[this.name]};e.push(i)}},y=[];e.intervals;var b=function(){function e(e){this.observers=[],this.obj=e}return e}(),w=function(){function e(e,t){this.callback=e,this.observer=t}return e}();e.unobserve=l,e.observe=u,e.generate=h;var C;C=Object.keys?Object.keys:function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t};var _;_=Array.isArray?Array.isArray:function(e){return e.push&&"number"==typeof e.length},e.apply=d}(V||(V={})),"undefined"!=typeof exports&&(exports.apply=V.apply,exports.observe=V.observe,exports.unobserve=V.unobserve,exports.generate=V.generate),r.PluginHookClass=function(){function e(){this.hooks=t(),this.legacy=n}var t=function(){return{beforeInitWalkontable:[],beforeInit:[],beforeRender:[],beforeChange:[],beforeRemoveCol:[],beforeRemoveRow:[],beforeValidate:[],beforeGet:[],beforeSet:[],beforeGetCellMeta:[],beforeAutofill:[],beforeKeyDown:[],beforeColumnSort:[],afterInit:[],afterLoadData:[],afterUpdateSettings:[],afterRender:[],afterRenderer:[],afterChange:[],afterValidate:[],afterGetCellMeta:[],afterGetColHeader:[],afterGetColWidth:[],afterDestroy:[],afterRemoveRow:[],afterCreateRow:[],afterRemoveCol:[],afterCreateCol:[],afterColumnResize:[],afterColumnMove:[],afterColumnSort:[],afterDeselect:[],afterSelection:[],afterSelectionByProp:[],afterSelectionEnd:[],afterSelectionEndByProp:[],afterCopyLimit:[],afterOnCellMouseDown:[],afterOnCellMouseOver:[],afterOnCellCornerMouseDown:[],afterScrollVertically:[],afterScrollHorizontally:[],modifyCol:[]}},n={onBeforeChange:"beforeChange",onChange:"afterChange",onCreateRow:"afterCreateRow",onCreateCol:"afterCreateCol",onSelection:"afterSelection",onCopyLimit:"afterCopyLimit",onSelectionEnd:"afterSelectionEnd",onSelectionByProp:"afterSelectionByProp",onSelectionEndByProp:"afterSelectionEndByProp"};return e.prototype.add=function(e,t){if(r.helper.isArray(t))for(var i=0,o=t.length;o>i;i++)this.add(e,t[i]);else e in n&&(e=n[e]),"undefined"==typeof this.hooks[e]&&(this.hooks[e]=[]),-1==this.hooks[e].indexOf(t)&&this.hooks[e].push(t);return this},e.prototype.once=function(e,t){if(r.helper.isArray(t))for(var n=0,i=t.length;i>n;n++)t[n].runOnce=!0,this.add(e,t[n]);else t.runOnce=!0,this.add(e,t)},e.prototype.remove=function(e,t){var i=!1;if(e in n&&(e=n[e]),"undefined"!=typeof this.hooks[e])for(var r=0,o=this.hooks[e].length;o>r;r++)if(this.hooks[e][r]==t){delete this.hooks[e][r].runOnce,this.hooks[e].splice(r,1),i=!0;break}return i},e.prototype.run=function(e,t,i,r,o,s,a){if(t in n&&(t=n[t]),"undefined"!=typeof this.hooks[t])for(var l=Array.prototype.slice.call(this.hooks[t]),u=0,c=l.length;c>u;u++)l[u].call(e,i,r,o,s,a),l[u].runOnce&&this.remove(t,l[u])},e.prototype.execute=function(e,t,i,r,o,s,a){var l,u;if(t in n&&(t=n[t]),"undefined"!=typeof this.hooks[t]){u=Array.prototype.slice.call(this.hooks[t]);for(var c=0,f=u.length;f>c;c++)if(l=u[c].call(e,i,r,o,s,a),void 0!==l&&(i=l),u[c].runOnce&&this.remove(t,u[c]),l===!1)return!1}return i},e}(),r.PluginHooks=new r.PluginHookClass,function(e){function t(){function t(e){var t=document,n=this;n.table=t.createElement("table"),n.theadTh=t.createElement("th"),n.table.appendChild(t.createElement("thead")).appendChild(t.createElement("tr")).appendChild(n.theadTh),n.tableStyle=n.table.style,n.tableStyle.tableLayout="auto",n.tableStyle.width="auto",n.tbody=t.createElement("tbody"),n.table.appendChild(n.tbody),n.container=t.createElement("div"),n.container.className=e.rootElement[0].className+" hidden",n.containerStyle=n.container.style,n.container.appendChild(n.table)}var i=this,r=5;this.beforeInit=function(){var e=this;e.autoColumnWidths=[],e.getSettings().autoColumnSize!==!1?e.autoColumnSizeTmp||(e.autoColumnSizeTmp={table:null,tableStyle:null,theadTh:null,tbody:null,container:null,containerStyle:null,determineBeforeNextRender:!0},e.addHook("beforeRender",n.determineIfChanged),e.addHook("afterGetColWidth",n.getColWidth),e.addHook("afterDestroy",n.afterDestroy),e.determineColumnWidth=i.determineColumnWidth):e.autoColumnSizeTmp&&(e.removeHook("beforeRender",n.determineIfChanged),e.removeHook("afterGetColWidth",n.getColWidth),e.removeHook("afterDestroy",n.afterDestroy),delete e.determineColumnWidth,i.afterDestroy.call(e))},this.determineIfChanged=function(e){e&&n.determineColumnsWidth.apply(this,arguments)},this.determineColumnWidth=function(n){var i=this,o=i.autoColumnSizeTmp;o.container||t.call(o,i),o.container.className=i.rootElement[0].className+" htAutoColumnSize",o.table.className=i.$table[0].className;for(var s=i.countRows(),a={},l=0,u=0;s>u;u++){var c=e.helper.stringify(i.getDataAtCell(u,n)),f=c.length;f>l&&(l=f),a[f]||(a[f]={needed:r,strings:[]}),a[f].needed&&(a[f].strings.push({value:c,row:u}),a[f].needed--)}var h=i.getSettings();h.colHeaders&&i.view.appendColHeader(n,o.theadTh),i.view.wt.wtDom.empty(o.tbody);for(var p in a)if(a.hasOwnProperty(p))for(var d=0,g=a[p].strings.length;g>d;d++){var v=a[p].strings[d].row,m=i.getCellMeta(v,n);m.col=n,m.row=v;var y=i.getCellRenderer(m),b=document.createElement("tr"),w=document.createElement("td");y(i,w,v,n,i.colToProp(n),a[p].strings[d].value,m),u++,b.appendChild(w),o.tbody.appendChild(b)}var C=i.rootElement[0].parentNode;C.appendChild(o.container);var _=i.view.wt.wtDom.outerWidth(o.table);if(C.removeChild(o.container),!h.nativeScrollbars){var S=i.view.wt.wtViewport.getViewportWidth()-2;_>S&&(_=S)}return _},this.determineColumnsWidth=function(){var e=this,t=this.getSettings();if(t.autoColumnSize||!t.colWidths)for(var n=this.countCols(),r=0;n>r;r++)e._getColWidthFromSettings(r)||(this.autoColumnWidths[r]=i.determineColumnWidth.call(e,r))},this.getColWidth=function(e,t){this.autoColumnWidths[e]&&this.autoColumnWidths[e]>t.width&&(t.width=this.autoColumnWidths[e])},this.afterDestroy=function(){var e=this;e.autoColumnSizeTmp&&e.autoColumnSizeTmp.container&&e.autoColumnSizeTmp.container.parentNode&&e.autoColumnSizeTmp.container.parentNode.removeChild(e.autoColumnSizeTmp.container),e.autoColumnSizeTmp=null}}var n=new t;e.PluginHooks.add("beforeInit",n.beforeInit),e.PluginHooks.add("afterUpdateSettings",n.beforeInit)}(r);var B=new s;r.PluginHooks.add("afterInit",function(){B.init.call(this,"afterInit")}),r.PluginHooks.add("afterUpdateSettings",function(){B.init.call(this,"afterUpdateSettings")}),r.PluginHooks.add("beforeGet",B.onBeforeGetSet),r.PluginHooks.add("beforeSet",B.onBeforeGetSet),r.PluginHooks.add("afterGetColHeader",B.getColHeader),function(e){function t(i,r){function o(){var t=n("body > .htContextMenu")[0];return t||(t=document.createElement("DIV"),e.Dom.addClass(t,"htContextMenu"),document.getElementsByTagName("body")[0].appendChild(t)),t}this.instance=i;var s=this;this.menu=o(),this.enabled=!0,this.bindMouseEvents(),this.bindTableEvents(),this.instance.addHook("afterDestroy",function(){s.destroy()}),this.defaultOptions={items:{row_above:{name:"Insert row above",callback:function(e,t){this.alter("insert_row",t.start.row())},disabled:function(){return this.countRows()>=this.getSettings().maxRows}},row_below:{name:"Insert row below",callback:function(e,t){this.alter("insert_row",t.end.row()+1)},disabled:function(){return this.countRows()>=this.getSettings().maxRows}},hsep1:t.SEPARATOR,col_left:{name:"Insert column on the left",callback:function(e,t){this.alter("insert_col",t.start.col())},disabled:function(){return this.countCols()>=this.getSettings().maxCols}},col_right:{name:"Insert column on the right",callback:function(e,t){this.alter("insert_col",t.end.col()+1)},disabled:function(){return this.countCols()>=this.getSettings().maxCols}},hsep2:t.SEPARATOR,remove_row:{name:"Remove row",callback:function(e,t){var n=t.end.row()-t.start.row()+1;this.alter("remove_row",t.start.row(),n)}},remove_col:{name:"Remove column",callback:function(e,t){var n=t.end.col()-t.start.col()+1;this.alter("remove_col",t.start.col(),n)}},hsep3:t.SEPARATOR,undo:{name:"Undo",callback:function(){this.undo()},disabled:function(){return this.undoRedo&&!this.undoRedo.isUndoAvailable()}},redo:{name:"Redo",callback:function(){this.redo()},disabled:function(){return this.undoRedo&&!this.undoRedo.isRedoAvailable()}}}},this.options={},e.helper.extend(this.options,this.defaultOptions),this.updateOptions(r)}function i(){var n=this,i=n.getSettings().contextMenu,r=e.helper.isObject(i)?i:{};i?(n.contextMenu||(n.contextMenu=new t(n,r)),n.contextMenu.enable(),e.helper.isArray(i)&&n.contextMenu.filterItems(i)):n.contextMenu&&(n.contextMenu.destroy(),delete n.contextMenu)}t.prototype.bindMouseEvents=function(){function i(i){i.preventDefault(),("TD"==i.target.nodeName||e.Dom.hasClass(i.target,"current")&&e.Dom.hasClass(i.target,"wtBorder"))&&(this.show(i.pageY,i.pageX),n(document).on("mousedown.htContextMenu",e.helper.proxy(t.prototype.close,this)))}this.instance.rootElement.on("contextmenu.htContextMenu",e.helper.proxy(i,this))},t.prototype.bindTableEvents=function(){var e=this;this._afterScrollCallback=function(){e.close()},this.instance.addHook("afterScrollVertically",this._afterScrollCallback),this.instance.addHook("afterScrollHorizontally",this._afterScrollCallback)},t.prototype.unbindTableEvents=function(){this._afterScrollCallback&&(this.instance.removeHook("afterScrollVertically",this._afterScrollCallback),this.instance.removeHook("afterScrollHorizontally",this._afterScrollCallback),this._afterScrollCallback=null)},t.prototype.performAction=function(){var e=n(this.menu).handsontable("getInstance"),i=e.getSelected()[0],r=e.getData()[i];if(r.disabled!==!0&&("function"!=typeof r.disabled||r.disabled.call(this.instance)!==!0)&&"function"==typeof r.callback){var o=this.instance.getSelected(),s=t.utils.normalizeSelection(o);r.callback.call(this.instance,r.key,s)}},t.prototype.unbindMouseEvents=function(){this.instance.rootElement.off("contextmenu.htContextMenu"),n(document).off("mousedown.htContextMenu")},t.prototype.show=function(i,r){this.menu.style.display="block",n(this.menu).off("mousedown.htContextMenu").on("mousedown.htContextMenu",e.helper.proxy(this.performAction,this)),n(this.menu).handsontable({data:t.utils.convertItemsToArray(this.getItems()),colHeaders:!1,colWidths:[160],readOnly:!0,copyPaste:!1,columns:[{data:"name",renderer:e.helper.proxy(this.renderer,this)}],beforeKeyDown:e.helper.proxy(this.onBeforeKeyDown,this)}),this.bindTableEvents(),this.setMenuPosition(i,r),n(this.menu).handsontable("listen")},t.prototype.close=function(){this.hide(),n(document).off("mousedown.htContextMenu"),this.unbindTableEvents(),this.instance.listen()},t.prototype.hide=function(){this.menu.style.display="none",n(this.menu).handsontable("destroy")},t.prototype.renderer=function(i,r,o,s,a,l){function u(e){return new RegExp(t.SEPARATOR,"i").test(e.name)}function c(e){return e.disabled===!0||"function"==typeof e.disabled&&e.disabled.call(f.instance)===!0}var f=this,h=i.getData()[o],p=document.createElement("DIV");e.Dom.empty(r),r.appendChild(p),u(h)?e.Dom.addClass(r,"htSeparator"):e.Dom.fastInnerText(p,l),c(h,f.instance)?(e.Dom.addClass(r,"htDisabled"),n(p).on("mouseenter",function(){i.deselectCell()})):(e.Dom.removeClass(r,"htDisabled"),n(p).on("mouseenter",function(){i.selectCell(o,s)}))},t.prototype.onBeforeKeyDown=function(i){function r(e){var n=e.getCell(0,0);t.utils.isSeparator(n)||t.utils.isDisabled(n)?s(0,0,e):e.selectCell(0,0)}function o(e){var n=e.countRows()-1,i=e.getCell(n,0);t.utils.isSeparator(i)||t.utils.isDisabled(i)?a(n,0,e):e.selectCell(n,0)}function s(e,n,i){var r=e+1,o=r<i.countRows()?i.getCell(r,n):null;o&&(t.utils.isSeparator(o)||t.utils.isDisabled(o)?s(r,n,i):i.selectCell(r,n))}function a(e,n,i){var r=e-1,o=r>=0?i.getCell(r,n):null;o&&(t.utils.isSeparator(o)||t.utils.isDisabled(o)?a(r,n,i):i.selectCell(r,n))}var l=this,u=n(l.menu).handsontable("getInstance"),c=u.getSelected();switch(i.keyCode){case e.helper.keyCode.ESCAPE:l.close(),i.preventDefault(),i.stopImmediatePropagation();break;case e.helper.keyCode.ENTER:u.getSelected()&&(l.performAction(),l.close());break;case e.helper.keyCode.ARROW_DOWN:c?s(c[0],c[1],u):r(u),i.preventDefault(),i.stopImmediatePropagation();break;case e.helper.keyCode.ARROW_UP:c?a(c[0],c[1],u):o(u),i.preventDefault(),i.stopImmediatePropagation()}},t.prototype.getItems=function(){function t(t){"string"==typeof t?this.name=t:e.helper.extend(this,t)}var n={};t.prototype=this.options;for(var i in this.options.items)!this.options.items.hasOwnProperty(i)||this.itemsFilter&&-1==this.itemsFilter.indexOf(i)||(n[i]=new t(this.options.items[i]));return n},t.prototype.updateOptions=function(t){if(t=t||{},t.items)for(var n in t.items){var i={};t.items.hasOwnProperty(n)&&this.defaultOptions.items.hasOwnProperty(n)&&e.helper.isObject(t.items[n])&&(e.helper.extend(i,this.defaultOptions.items[n]),e.helper.extend(i,t.items[n]),t.items[n]=i)}e.helper.extend(this.options,t)},t.prototype.setMenuPosition=function(e,t){var n={top:e,topRelative:e-document.documentElement.scrollTop,left:t,leftRelative:t-document.documentElement.scrollLeft};this.menuFitsBelowCursor(n)?this.positionMenuBelowCursor(n):this.positionMenuAboveCursor(n),this.menuFitsOnRightOfCursor(n)?this.positionMenuOnRightOfCursor(n):this.positionMenuOnLeftOfCursor(n)},t.prototype.menuFitsBelowCursor=function(e){return e.topRelative+this.menu.offsetHeight<=document.documentElement.scrollTop+document.documentElement.clientHeight},t.prototype.menuFitsOnRightOfCursor=function(e){return e.leftRelative+this.menu.offsetWidth<=document.documentElement.scrollLeft+document.documentElement.clientWidth},t.prototype.positionMenuBelowCursor=function(e){this.menu.style.top=e.top+"px"},t.prototype.positionMenuAboveCursor=function(e){this.menu.style.top=e.top-this.menu.offsetHeight+"px"},t.prototype.positionMenuOnRightOfCursor=function(e){this.menu.style.left=e.left+"px"},t.prototype.positionMenuOnLeftOfCursor=function(e){this.menu.style.left=e.left-this.menu.offsetWidth+"px"},t.utils={},t.utils.convertItemsToArray=function(e){var t,n=[];for(var i in e)if(e.hasOwnProperty(i)){if("string"==typeof e[i])t={name:e[i]};else{if(e[i].visible===!1)continue;t=e[i]}t.key=i,n.push(t)}return n},t.utils.normalizeSelection=function(t){var n={start:new e.SelectionPoint,end:new e.SelectionPoint};return n.start.row(Math.min(t[0],t[2])),n.start.col(Math.min(t[1],t[3])),n.end.row(Math.max(t[0],t[2])),n.end.col(Math.max(t[1],t[3])),n},t.utils.isSeparator=function(t){return e.Dom.hasClass(t,"htSeparator")},t.utils.isDisabled=function(t){return e.Dom.hasClass(t,"htDisabled")},t.prototype.enable=function(){this.enabled||(this.enabled=!0,this.bindMouseEvents())},t.prototype.disable=function(){this.enabled&&(this.enabled=!1,this.close(),this.unbindMouseEvents(),this.unbindTableEvents())},t.prototype.destroy=function(){this.close(),this.unbindMouseEvents(),this.unbindTableEvents(),this.isMenuEnabledByOtherHotInstance()||this.removeMenu()},t.prototype.isMenuEnabledByOtherHotInstance=function(){for(var e=n(".handsontable"),t=!1,i=0,r=e.length;r>i;i++){var o=n(e[i]).handsontable("getInstance");if(o&&o.getSettings().contextMenu){t=!0;break}}return t},t.prototype.removeMenu=function(){this.menu.parentNode&&this.menu.parentNode.removeChild(this.menu)},t.prototype.filterItems=function(e){this.itemsFilter=e},t.SEPARATOR="---------",e.PluginHooks.add("afterInit",i),e.PluginHooks.add("afterUpdateSettings",i),e.ContextMenu=t}(r),r.PluginHooks.add("beforeGetCellMeta",function(e,t,n){if(n.isWritable=!n.readOnly,n.autoComplete)throw new Error("Support for legacy autocomplete syntax was removed in Handsontable 0.10.0. Please remove the property named 'autoComplete' from your config. For replacement instructions, see wiki page https://github.com/warpech/jquery-handsontable/wiki/Migration-guide-to-0.10.x")});var F=new a;r.PluginHooks.add("beforeInit",F.beforeInit),r.PluginHooks.add("afterInit",function(){F.init.call(this,"afterInit")}),r.PluginHooks.add("afterUpdateSettings",function(){F.init.call(this,"afterUpdateSettings")}),r.PluginHooks.add("afterGetColHeader",F.getColHeader),r.PluginHooks.add("modifyCol",F.modifyCol);var z=new l;r.PluginHooks.add("beforeInit",z.beforeInit),r.PluginHooks.add("afterInit",function(){z.init.call(this,"afterInit")}),r.PluginHooks.add("afterUpdateSettings",function(){z.init.call(this,"afterUpdateSettings")}),r.PluginHooks.add("afterGetColWidth",z.getColWidth),function(){function e(){var e=this,n=e.getSettings().observeChanges;n?(e.observer&&i.call(e),t.call(e),s.call(e)):n||i.call(e)}function t(){var e=this;e.observeChangesActive=!0,e.pauseObservingChanges=function(){e.observeChangesActive=!1},e.resumeObservingChanges=function(){e.observeChangesActive=!0},e.observedData=e.getData(),e.observer=V.observe(e.observedData,function(t){e.observeChangesActive&&(n.call(e,t),e.render()),e.runHooks("afterChangesObserved")})}function n(e){function t(e){var t;return t=i(e),t=n(t)}function n(e){var t=[];return e.filter(function(e){var n=r(e.path);if(-1!=["add","remove"].indexOf(e.op)&&!isNaN(n.col)){if(-1!=t.indexOf(n.col))return!1;t.push(n.col)}return!0})}function i(e){return e.filter(function(e){return!/[/]length/gi.test(e.path)})}function r(e){var t=e.match(/^\/(\d+)\/?(.*)?$/);return{row:parseInt(t[1],10),col:/^\d*$/.test(t[2])?parseInt(t[2],10):t[2]}}for(var o=this,s=t(e),a=0,l=s.length;l>a;a++){var u=s[a],c=r(u.path);switch(u.op){case"add":isNaN(c.col)?o.runHooks("afterCreateRow",c.row):o.runHooks("afterCreateCol",c.col);break;case"remove":isNaN(c.col)?o.runHooks("afterRemoveRow",c.row,1):o.runHooks("afterRemoveCol",c.col,1);break;case"replace":o.runHooks("afterChange",[c.row,c.col,null,u.value],"external")}}}function i(){var e=this;e.observer&&(o.call(e),a.call(e))}function o(){var e=this;V.unobserve(e.observedData,e.observer),delete e.observeChangesActive,delete e.pauseObservingChanges,delete e.resumeObservingChanges}function s(){var e=this;e.addHook("afterDestroy",i),e.addHook("afterCreateRow",l),e.addHook("afterRemoveRow",l),e.addHook("afterCreateCol",l),e.addHook("afterRemoveCol",l),e.addHook("afterChange",function(e,t){"loadData"!=t&&l.call(this)})}function a(){var e=this;e.removeHook("afterDestroy",i),e.removeHook("afterCreateRow",l),e.removeHook("afterRemoveRow",l),e.removeHook("afterCreateCol",l),e.removeHook("afterRemoveCol",l),e.removeHook("afterChange",l)}function l(){var e=this;e.pauseObservingChanges(),e.addHookOnce("afterChangesObserved",function(){e.resumeObservingChanges()})}r.PluginHooks.add("afterLoadData",e),r.PluginHooks.add("afterUpdateSettings",e)}(),function(e){function t(){function t(){var e=this;for(var t in o)o.hasOwnProperty(t)&&!i.call(e,t)&&e.PluginHooks.add(t,o[t])}function n(){var e=this;for(var t in o)o.hasOwnProperty(t)&&i.call(e,t)&&e.PluginHooks.remove(t,o[t])}function i(e){var t=this;return t.PluginHooks.hooks.hasOwnProperty(e)}var r=this;this.init=function(){var i=this,o=i.getSettings().persistentState;return r.enabled=!!o,r.enabled?(i.storage||(i.storage=new e(i.rootElement[0].id)),i.resetState=r.resetValue,void t.call(i)):void n.call(i)},this.saveValue=function(e,t){var n=this;n.storage.saveValue(e,t)},this.loadValue=function(e,t){var n=this;t.value=n.storage.loadValue(e)},this.resetValue=function(e){var t=this;"undefined"!=typeof e?t.storage.reset(e):t.storage.resetAll()};var o={persistentStateSave:r.saveValue,persistentStateLoad:r.loadValue,persistentStateReset:r.resetValue}}var n=new t;r.PluginHooks.add("beforeInit",n.init),r.PluginHooks.add("afterUpdateSettings",n.init)}(u),function(e){e.UndoRedo=function(t){var n=this;this.instance=t,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,t.addHook("afterChange",function(t){if(t){var i=new e.UndoRedo.ChangeAction(t);n.done(i)}}),t.addHook("afterCreateRow",function(t,i,r){if(!r){var o=new e.UndoRedo.CreateRowAction(t,i);n.done(o)}}),t.addHook("beforeRemoveRow",function(t,i){var r=n.instance.getData();t=(r.length+t)%r.length;var o=r.slice(t,t+i),s=new e.UndoRedo.RemoveRowAction(t,o);n.done(s)}),t.addHook("afterCreateCol",function(t,i,r){if(!r){var o=new e.UndoRedo.CreateColumnAction(t,i);n.done(o)}}),t.addHook("beforeRemoveCol",function(i,r){var o=n.instance.getData();i=(n.instance.countCols()+i)%n.instance.countCols();for(var s=[],a=0,l=o.length;l>a;a++)s[a]=o[a].slice(i,i+r);var u;e.helper.isArray(t.getSettings().colHeaders)&&(u=t.getSettings().colHeaders.slice(i,i+s.length));var c=new e.UndoRedo.RemoveColumnAction(i,s,u);n.done(c)})},e.UndoRedo.prototype.done=function(e){this.ignoreNewActions||(this.doneActions.push(e),this.undoneActions.length=0)},e.UndoRedo.prototype.undo=function(){if(this.isUndoAvailable()){var e=this.doneActions.pop();this.ignoreNewActions=!0;var t=this;e.undo(this.instance,function(){t.ignoreNewActions=!1,t.undoneActions.push(e)})}},e.UndoRedo.prototype.redo=function(){if(this.isRedoAvailable()){var e=this.undoneActions.pop();this.ignoreNewActions=!0;var t=this;e.redo(this.instance,function(){t.ignoreNewActions=!1,t.doneActions.push(e)})}},e.UndoRedo.prototype.isUndoAvailable=function(){return this.doneActions.length>0},e.UndoRedo.prototype.isRedoAvailable=function(){return this.undoneActions.length>0},e.UndoRedo.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0},e.UndoRedo.Action=function(){},e.UndoRedo.Action.prototype.undo=function(){},e.UndoRedo.Action.prototype.redo=function(){},e.UndoRedo.ChangeAction=function(e){this.changes=e},e.helper.inherit(e.UndoRedo.ChangeAction,e.UndoRedo.Action),e.UndoRedo.ChangeAction.prototype.undo=function(e,t){for(var i=n.extend(!0,[],this.changes),r=0,o=i.length;o>r;r++)i[r].splice(3,1);e.addHookOnce("afterChange",t),e.setDataAtRowProp(i,null,null,"undo")},e.UndoRedo.ChangeAction.prototype.redo=function(e,t){for(var i=n.extend(!0,[],this.changes),r=0,o=i.length;o>r;r++)i[r].splice(2,1);e.addHookOnce("afterChange",t),e.setDataAtRowProp(i,null,null,"redo")},e.UndoRedo.CreateRowAction=function(e,t){this.index=e,this.amount=t},e.helper.inherit(e.UndoRedo.CreateRowAction,e.UndoRedo.Action),e.UndoRedo.CreateRowAction.prototype.undo=function(e,t){e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.amount)
},e.UndoRedo.CreateRowAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateRow",t),e.alter("insert_row",this.index+1,this.amount)},e.UndoRedo.RemoveRowAction=function(e,t){this.index=e,this.data=t},e.helper.inherit(e.UndoRedo.RemoveRowAction,e.UndoRedo.Action),e.UndoRedo.RemoveRowAction.prototype.undo=function(e,t){var n=[this.index,0];Array.prototype.push.apply(n,this.data),Array.prototype.splice.apply(e.getData(),n),e.addHookOnce("afterRender",t),e.render()},e.UndoRedo.RemoveRowAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.data.length)},e.UndoRedo.CreateColumnAction=function(e,t){this.index=e,this.amount=t},e.helper.inherit(e.UndoRedo.CreateColumnAction,e.UndoRedo.Action),e.UndoRedo.CreateColumnAction.prototype.undo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount)},e.UndoRedo.CreateColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateCol",t),e.alter("insert_col",this.index+1,this.amount)},e.UndoRedo.RemoveColumnAction=function(e,t,n){this.index=e,this.data=t,this.amount=this.data[0].length,this.headers=n},e.helper.inherit(e.UndoRedo.RemoveColumnAction,e.UndoRedo.Action),e.UndoRedo.RemoveColumnAction.prototype.undo=function(e,t){for(var n,i,r=0,o=e.getData().length;o>r;r++)n=e.getDataAtRow(r),i=[this.index,0],Array.prototype.push.apply(i,this.data[r]),Array.prototype.splice.apply(n,i);"undefined"!=typeof this.headers&&(i=[this.index,0],Array.prototype.push.apply(i,this.headers),Array.prototype.splice.apply(e.getSettings().colHeaders,i)),e.addHookOnce("afterRender",t),e.render()},e.UndoRedo.RemoveColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount)}}(r),function(e){function t(){var t=this,s="undefined"==typeof t.getSettings().undo||t.getSettings().undo;s?t.undoRedo||(t.undoRedo=new e.UndoRedo(t),r(t),t.addHook("beforeKeyDown",n),t.addHook("afterChange",i)):t.undoRedo&&(delete t.undoRedo,o(t),t.removeHook("beforeKeyDown",n),t.removeHook("afterChange",i))}function n(e){var t=this,n=(e.ctrlKey||e.metaKey)&&!e.altKey;n&&(89===e.keyCode||e.shiftKey&&90===e.keyCode?(t.undoRedo.redo(),e.stopImmediatePropagation()):90===e.keyCode&&(t.undoRedo.undo(),e.stopImmediatePropagation()))}function i(e,t){var n=this;return"loadData"==t?n.undoRedo.clear():void 0}function r(e){e.undo=function(){return e.undoRedo.undo()},e.redo=function(){return e.undoRedo.redo()},e.isUndoAvailable=function(){return e.undoRedo.isUndoAvailable()},e.isRedoAvailable=function(){return e.undoRedo.isRedoAvailable()},e.clearUndo=function(){return e.undoRedo.clear()}}function o(e){delete e.undo,delete e.redo,delete e.isUndoAvailable,delete e.isRedoAvailable,delete e.clearUndo}e.PluginHooks.add("afterInit",t),e.PluginHooks.add("afterUpdateSettings",t)}(r),c.prototype.setBoundaries=function(e){this.boundaries=e},c.prototype.setCallback=function(e){this.callback=e},c.prototype.check=function(e,t){var n=0,i=0;t<this.boundaries.top?i=t-this.boundaries.top:t>this.boundaries.bottom&&(i=t-this.boundaries.bottom),e<this.boundaries.left?n=e-this.boundaries.left:e>this.boundaries.right&&(n=e-this.boundaries.right),this.callback(n,i)};var W,q=!1;if("undefined"!=typeof r){var $=function(e){var t=e.view.wt.wtScrollbars.vertical.scrollHandler;W=new c,t!==i&&(t?W.setBoundaries(t.getBoundingClientRect()):W.setBoundaries(e.$table[0].getBoundingClientRect()),W.setCallback(function(n,i){0>n?t?t.scrollLeft-=50:e.view.wt.scrollHorizontal(-1).draw():n>0&&(t?t.scrollLeft+=50:e.view.wt.scrollHorizontal(1).draw()),0>i?t?t.scrollTop-=20:e.view.wt.scrollVertical(-1).draw():i>0&&(t?t.scrollTop+=20:e.view.wt.scrollVertical(1).draw())}),q=!0)};r.PluginHooks.add("afterInit",function(){n(document).on("mouseup."+this.guid,function(){q=!1}),n(document).on("mousemove."+this.guid,function(e){q&&W.check(e.clientX,e.clientY)})}),r.PluginHooks.add("destroy",function(){n(document).off("."+this.guid)}),r.PluginHooks.add("afterOnCellMouseDown",function(){$(this)}),r.PluginHooks.add("afterOnCellCornerMouseDown",function(){$(this)}),r.plugins.DragToScroll=c}if(function(e,t,n){function i(i){function r(){i.isListening()&&i.selection.empty()}function o(e){if(i.isListening()&&i.selection.isSelected()){var t=e.replace(/^[\r\n]*/g,"").replace(/[\r\n]*$/g,""),r=n.parse(t),o=i.getSelected(),s=i.getCornerCoords([{row:o[0],col:o[1]},{row:o[2],col:o[3]}]),a=s.TL,l={row:Math.max(s.BR.row,r.length-1+s.TL.row),col:Math.max(s.BR.col,r[0].length-1+s.TL.col)};i.PluginHooks.once("afterChange",function(e){e&&e.length&&this.selectCell(a.row,a.col,l.row,l.col)}),i.populateFromArray(a.row,a.col,r,l.row,l.col,"paste",i.getSettings().pasteMode)}}function s(t){if(e.helper.isCtrlKey(t.keyCode)&&i.getSelected())return a.setCopyableText(),void t.stopImmediatePropagation();var n=(t.ctrlKey||t.metaKey)&&!t.altKey;t.keyCode==e.helper.keyCode.A&&n&&setTimeout(e.helper.proxy(a.setCopyableText,a))}this.copyPasteInstance=t.getInstance(),this.copyPasteInstance.onCut(r),this.copyPasteInstance.onPaste(o);var a=this;i.addHook("beforeKeyDown",s),this.destroy=function(){this.copyPasteInstance.removeCallback(r),this.copyPasteInstance.removeCallback(o),this.copyPasteInstance.destroy(),i.removeHook("beforeKeyDown",s)},i.addHook("afterDestroy",e.helper.proxy(this.destroy,this)),this.triggerPaste=e.helper.proxy(this.copyPasteInstance.triggerPaste,this.copyPasteInstance),this.triggerCut=e.helper.proxy(this.copyPasteInstance.triggerCut,this.copyPasteInstance),this.setCopyableText=function(){var e=i.getSelected(),t=i.getSettings(),n=t.copyRowsLimit,r=t.copyColsLimit,o=Math.min(e[0],e[2]),s=Math.min(e[1],e[3]),a=Math.max(e[0],e[2]),l=Math.max(e[1],e[3]),u=Math.min(a,o+n-1),c=Math.min(l,s+r-1);i.copyPaste.copyPasteInstance.copyable(i.getCopyableData(o,s,u,c)),(a!==u||l!==c)&&i.PluginHooks.run("afterCopyLimit",a-o+1,l-s+1,n,r)}}function r(){var e=this,t=e.getSettings().copyPaste!==!1;t&&!e.copyPaste?e.copyPaste=new i(e):!t&&e.copyPaste&&(e.copyPaste.destroy(),delete e.copyPaste)}e.PluginHooks.add("afterInit",r),e.PluginHooks.add("afterUpdateSettings",r)}(r,j,SheetClip),function(e){function t(){var t=this,n=!!t.getSettings().search;n?t.search=new e.Search(t):delete t.search}e.Search=function(t){this.query=function(n,i,r){var o=t.countRows(),s=t.countCols(),a=[];i||(i=e.Search.global.getDefaultCallback()),r||(r=e.Search.global.getDefaultQueryMethod());for(var l=0;o>l;l++)for(var u=0;s>u;u++){var c=t.getDataAtCell(l,u),f=t.getCellMeta(l,u),h=f.search.callback||i,p=f.search.queryMethod||r,d=p(n,c);if(d){var g={row:l,col:u,data:c};a.push(g)}h&&h(t,l,u,c,d)}return a}},e.Search.DEFAULT_CALLBACK=function(e,t,n,i,r){e.getCellMeta(t,n).isSearchResult=r},e.Search.DEFAULT_QUERY_METHOD=function(e,t){return"undefined"!=typeof e&&null!=e&&e.toLowerCase&&0!=e.length?-1!=t.toString().toLowerCase().indexOf(e.toLowerCase()):!1},e.Search.DEFAULT_SEARCH_RESULT_CLASS="htSearchResult",e.Search.global=function(){var t=e.Search.DEFAULT_CALLBACK,n=e.Search.DEFAULT_QUERY_METHOD,i=e.Search.DEFAULT_SEARCH_RESULT_CLASS;return{getDefaultCallback:function(){return t},setDefaultCallback:function(e){t=e},getDefaultQueryMethod:function(){return n},setDefaultQueryMethod:function(e){n=e},getDefaultSearchResultClass:function(){return i},setDefaultSearchResultClass:function(e){i=e}}}(),e.SearchCellDecorator=function(t,n,i,r,o,s,a){var l="object"==typeof a.search&&a.search.searchResultClass||e.Search.global.getDefaultSearchResultClass();a.isSearchResult?e.Dom.addClass(n,l):e.Dom.removeClass(n,l)};var n=e.renderers.cellDecorator;e.renderers.cellDecorator=function(){n.apply(this,arguments),e.SearchCellDecorator.apply(this,arguments)},e.PluginHooks.add("afterInit",t),e.PluginHooks.add("afterUpdateSettings",t)}(r),f.prototype.init=function(){this.TABLE=this.instance.wtTable.TABLE,this.fixed=this.instance.wtTable.hider,this.fixedContainer=this.instance.wtTable.holder,this.fixed.style.position="absolute",this.fixed.style.left="0",this.scrollHandler=this.getScrollableElement(this.TABLE),this.$scrollHandler=n(this.scrollHandler)},f.prototype.makeClone=function(e){var t=document.createElement("DIV");t.className="ht_clone_"+e+" handsontable",t.style.position="fixed",t.style.overflow="hidden";var n=document.createElement("TABLE");return n.className=this.instance.wtTable.TABLE.className,t.appendChild(n),this.instance.wtTable.holder.parentNode.appendChild(t),new y({cloneSource:this.instance,cloneOverlay:this,table:n})},f.prototype.getScrollableElement=function(e){for(var t=e.parentNode;t&&t.style;){if("visible"!==t.style.overflow&&""!==t.style.overflow)return t;if(this instanceof A&&"visible"!==t.style.overflowX&&""!==t.style.overflowX)return t;t=t.parentNode}return i},f.prototype.prepare=function(){},f.prototype.onScroll=function(e){this.windowScrollPosition=this.getScrollPosition(),this.readSettings(),e&&(this.windowScrollPosition=e),this.resetFixedPosition()},f.prototype.availableSize=function(){var e;return e=this.windowScrollPosition>this.tableParentOffset?this.instance.wtTable.getLastVisibleRow()===this.total-1?this.instance.wtDom.outerHeight(this.TABLE):this.windowSize:this.windowSize-this.tableParentOffset},f.prototype.refresh=function(e){var t=this.getLastCell();this.measureBefore=this.sumCellSizes(0,this.offset),-1===t?this.measureAfter=0:this.measureAfter=this.sumCellSizes(t,this.total-t),this.applyToDOM(),this.clone&&this.clone.draw(e)},f.prototype.destroy=function(){this.$scrollHandler.off("."+this.instance.guid),n(i).off("."+this.instance.guid),n(document).off("."+this.instance.guid)},h.prototype.appear=function(e){var t,n,i,r,o,s,a,l,u,c,f,h;if(!this.disabled){var p,d,g,v,m,y,b,w=this.instance,C=!1,_=!1,S=!1,T=!1;for(w.wtTable.isRowInViewport(e[0])||(C=!0),w.wtTable.isRowInViewport(e[2])||(S=!0),y=w.wtTable.rowStrategy.countVisible(),m=0;y>m;m++)if(b=w.wtTable.rowFilter.visibleToSource(m),b>=e[0]&&b<=e[2]){p=b;break}for(m=y-1;m>=0;m--)if(b=w.wtTable.rowFilter.visibleToSource(m),b>=e[0]&&b<=e[2]){g=b;break}if(C&&S)_=!0,T=!0;else{for(w.wtTable.isColumnInViewport(e[1])||(_=!0),w.wtTable.isColumnInViewport(e[3])||(T=!0),y=w.wtTable.columnStrategy.countVisible(),m=0;y>m;m++)if(b=w.wtTable.columnFilter.visibleToSource(m),b>=e[1]&&b<=e[3]){d=b;break}for(m=y-1;m>=0;m--)if(b=w.wtTable.columnFilter.visibleToSource(m),b>=e[1]&&b<=e[3]){v=b;break}}if(void 0===p||void 0===d)return void this.disappear();t=p!==g||d!==v,n=w.wtTable.getCell([p,d]),i=t?w.wtTable.getCell([g,v]):n,r=this.wtDom.offset(n),o=t?this.wtDom.offset(i):r,s=this.wtDom.offset(w.wtTable.TABLE),l=r.top,f=o.top+this.wtDom.outerHeight(i)-l,c=r.left,h=o.left+this.wtDom.outerWidth(i)-c,a=l-s.top-1,u=c-s.left-1;var E=this.wtDom.getComputedStyle(n);parseInt(E.borderTopWidth,10)>0&&(a+=1,f=f>0?f-1:0),parseInt(E.borderLeftWidth,10)>0&&(u+=1,h=h>0?h-1:0),C?this.topStyle.display="none":(this.topStyle.top=a+"px",this.topStyle.left=u+"px",this.topStyle.width=h+"px",this.topStyle.display="block"),_?this.leftStyle.display="none":(this.leftStyle.top=a+"px",this.leftStyle.left=u+"px",this.leftStyle.height=f+"px",this.leftStyle.display="block");var x=Math.floor(this.settings.border.width/2);S?this.bottomStyle.display="none":(this.bottomStyle.top=a+f-x+"px",this.bottomStyle.left=u+"px",this.bottomStyle.width=h+"px",this.bottomStyle.display="block"),T?this.rightStyle.display="none":(this.rightStyle.top=a+"px",this.rightStyle.left=u+h-x+"px",this.rightStyle.height=f+1+"px",this.rightStyle.display="block"),S||T||!this.hasSetting(this.settings.border.cornerVisible)?this.cornerStyle.display="none":(this.cornerStyle.top=a+f-4+"px",this.cornerStyle.left=u+h-4+"px",this.cornerStyle.display="block")}},h.prototype.disappear=function(){this.topStyle.display="none",this.leftStyle.display="none",this.bottomStyle.display="none",this.rightStyle.display="none",this.cornerStyle.display="none"},h.prototype.hasSetting=function(e){return"function"==typeof e?e():!!e},p.prototype.source=function(e){return e},p.prototype.offsetted=function(e){return e+this.offset},p.prototype.unOffsetted=function(e){return e-this.offset},p.prototype.fixed=function(e){return e<this.fixedCount?e-this.offset:e},p.prototype.unFixed=function(e){return e<this.fixedCount?e+this.offset:e},p.prototype.visibleToSource=function(e){return this.source(this.offsetted(this.fixed(e)))},p.prototype.sourceToVisible=function(e){return this.source(this.unOffsetted(this.unFixed(e)))},d.prototype.getSize=function(e){return this.cellSizes[e]},d.prototype.getContainerSize=function(e){return"function"==typeof this.containerSizeFn?this.containerSizeFn(e):this.containerSizeFn},d.prototype.countVisible=function(){return this.cellCount},d.prototype.isLastIncomplete=function(){if(this.instance.getSetting("nativeScrollbars")){var e=this.instance.cloneFrom?this.instance.cloneFrom.wtScrollbars.vertical:this.instance.wtScrollbars.vertical;return this.remainingSize>e.sumCellSizes(e.offset,e.offset+e.curOuts+1)}return this.remainingSize>0},g.prototype.add=function(e,t,n){this.cache[e]||(this.cache[e]=[]),this.cache[e][t]||(this.cache[e][t]=[]),this.cache[e][t][n]=!0},g.prototype.test=function(e,t,n){return this.cache[e]&&this.cache[e][t]&&this.cache[e][t][n]},v.prototype=new p,v.prototype.readSettings=function(e){this.offset=e.wtSettings.settings.offsetColumn,this.total=e.getSetting("totalColumns"),this.fixedCount=e.getSetting("fixedColumnsLeft"),this.countTH=e.getSetting("rowHeaders").length},v.prototype.offsettedTH=function(e){return e-this.countTH},v.prototype.unOffsettedTH=function(e){return e+this.countTH},v.prototype.visibleRowHeadedColumnToSourceColumn=function(e){return this.visibleToSource(this.offsettedTH(e))},v.prototype.sourceColumnToVisibleRowHeadedColumn=function(e){return this.unOffsettedTH(this.sourceToVisible(e))},m.prototype=new d,m.prototype.getSize=function(e){return this.cellSizes[e]+(this.cellStretch[e]||0)},m.prototype.stretch=function(){var e=this.getContainerSize(this.cellSizesSum),t=0;if(this.remainingSize=this.cellSizesSum-e,this.cellStretch.length=0,"all"===this.strategy){if(this.remainingSize<0){for(var n,i=e/this.cellSizesSum;t<this.cellCount-1;)n=Math.floor(i*this.cellSizes[t]),this.remainingSize+=n-this.cellSizes[t],this.cellStretch[t]=n-this.cellSizes[t],t++;this.cellStretch[this.cellCount-1]=-this.remainingSize,this.remainingSize=0}}else"last"===this.strategy&&this.remainingSize<0&&e!==1/0&&(this.cellStretch[this.cellCount-1]=-this.remainingSize,this.remainingSize=0)},y.prototype.draw=function(e){return this.drawInterrupted=!1,e||this.wtDom.isVisible(this.wtTable.TABLE)?(this.getSetting("beforeDraw",!e),e=e&&this.getSetting("offsetRow")===this.lastOffsetRow&&this.getSetting("offsetColumn")===this.lastOffsetColumn,this.drawn&&(this.scrollVertical(0),this.scrollHorizontal(0)),this.lastOffsetRow=this.getSetting("offsetRow"),this.lastOffsetColumn=this.getSetting("offsetColumn"),this.wtTable.draw(e),this.cloneSource||this.getSetting("onDraw",!e),this):void(this.drawInterrupted=!0)},y.prototype.update=function(e,t){return this.wtSettings.update(e,t)},y.prototype.scrollVertical=function(e){var t=this.wtScroll.scrollVertical(e);return this.getSetting("onScrollVertically"),t},y.prototype.scrollHorizontal=function(e){var t=this.wtScroll.scrollHorizontal(e);return this.getSetting("onScrollHorizontally"),t},y.prototype.scrollViewport=function(e){return this.wtScroll.scrollViewport(e),this},y.prototype.getViewport=function(){return[this.wtTable.rowFilter.visibleToSource(0),this.wtTable.columnFilter.visibleToSource(0),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]},y.prototype.getSetting=function(e,t,n,i){return this.wtSettings.getSetting(e,t,n,i)},y.prototype.hasSetting=function(e){return this.wtSettings.has(e)},y.prototype.destroy=function(){n(document.body).off("."+this.guid),this.wtScrollbars.destroy(),clearTimeout(this.wheelTimeout),this.wtEvent&&this.wtEvent.destroy()},b.prototype=new f,b.prototype.resetFixedPosition=function(){if(this.instance.wtTable.holder.parentNode){var e=this.clone.wtTable.holder.parentNode,t=this.instance.wtTable.holder.getBoundingClientRect();e.style.top=Math.ceil(t.top,10)+"px",e.style.left=Math.ceil(t.left,10)+"px"}},b.prototype.prepare=function(){},b.prototype.refresh=function(e){this.clone&&this.clone.draw(e)},b.prototype.getScrollPosition=function(){},b.prototype.getLastCell=function(){},b.prototype.applyToDOM=function(){},b.prototype.scrollTo=function(){},b.prototype.readWindowSize=function(){},b.prototype.readSettings=function(){},w.prototype.closest=function(e,t,n){for(;null!=e&&e!==n;){if(1===e.nodeType&&t.indexOf(e.nodeName)>-1)return e;e=e.parentNode}return null},w.prototype.isChildOf=function(e,t){for(var n=e.parentNode;null!=n;){if(n==t)return!0;n=n.parentNode}return!1},w.prototype.index=function(e){for(var t=0;e=e.previousSibling;)++t;return t},document.documentElement.classList?(w.prototype.hasClass=function(e,t){return e.classList.contains(t)},w.prototype.addClass=function(e,t){e.classList.add(t)},w.prototype.removeClass=function(e,t){e.classList.remove(t)}):(w.prototype.hasClass=function(e,t){return e.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))},w.prototype.addClass=function(e,t){this.hasClass(e,t)||(e.className+=" "+t)},w.prototype.removeClass=function(e,t){if(this.hasClass(e,t)){var n=new RegExp("(\\s|^)"+t+"(\\s|$)");e.className=e.className.replace(n," ").trim()}}),w.prototype.removeTextNodes=function(e,t){if(3===e.nodeType)t.removeChild(e);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(e.nodeName)>-1)for(var n=e.childNodes,i=n.length-1;i>=0;i--)this.removeTextNodes(n[i],e)},w.prototype.empty=function(e){for(var t;t=e.lastChild;)e.removeChild(t)},w.prototype.HTML_CHARACTERS=/(<(.*)>|&(.*);)/,w.prototype.fastInnerHTML=function(e,t){this.HTML_CHARACTERS.test(t)?e.innerHTML=t:this.fastInnerText(e,t)},document.createTextNode("test").textContent?w.prototype.fastInnerText=function(e,t){var n=e.firstChild;n&&3===n.nodeType&&null===n.nextSibling?n.textContent=t:(this.empty(e),e.appendChild(document.createTextNode(t)))}:w.prototype.fastInnerText=function(e,t){var n=e.firstChild;n&&3===n.nodeType&&null===n.nextSibling?n.data=t:(this.empty(e),e.appendChild(document.createTextNode(t)))},w.prototype.isVisible=function(e){for(var t=e;t!==document.documentElement;){if(null===t)return!1;if(11===t.nodeType){if(t.host){if(t.host.impl)return w.prototype.isVisible(t.host.impl);if(t.host)return w.prototype.isVisible(t.host);throw new Error("Lost in Web Components world")}return!1}if("none"===t.style.display)return!1;t=t.parentNode}return!0},w.prototype.offset=function(e){if(this.hasCaptionProblem()&&e.firstChild&&"CAPTION"===e.firstChild.nodeName){var t=e.getBoundingClientRect();return{top:t.top+(i.pageYOffset||document.documentElement.scrollTop)-(document.documentElement.clientTop||0),left:t.left+(i.pageXOffset||document.documentElement.scrollLeft)-(document.documentElement.clientLeft||0)}}for(var n=e.offsetLeft,r=e.offsetTop,o=e;(e=e.offsetParent)&&e!==document.body;)n+=e.offsetLeft,r+=e.offsetTop,o=e;return o&&"fixed"===o.style.position&&(n+=i.pageXOffset||document.documentElement.scrollLeft,r+=i.pageYOffset||document.documentElement.scrollTop),{left:n,top:r}},w.prototype.getComputedStyle=function(e){return e.currentStyle||document.defaultView.getComputedStyle(e)},w.prototype.outerWidth=function(e){return e.offsetWidth},w.prototype.outerHeight=function(e){return this.hasCaptionProblem()&&e.firstChild&&"CAPTION"===e.firstChild.nodeName?e.offsetHeight+e.firstChild.offsetHeight:e.offsetHeight},function(){function e(){var e=document.createElement("TABLE");e.style.borderSpacing=0,e.style.borderWidth=0,e.style.padding=0;var t=document.createElement("TBODY");e.appendChild(t),t.appendChild(document.createElement("TR")),t.firstChild.appendChild(document.createElement("TD")),t.firstChild.firstChild.innerHTML="<tr><td>t<br>t</td></tr>";var i=document.createElement("CAPTION");i.innerHTML="c<br>c<br>c<br>c",i.style.padding=0,i.style.margin=0,e.insertBefore(i,t),document.body.appendChild(e),n=e.offsetHeight<2*e.lastChild.offsetHeight,document.body.removeChild(e)}function t(){var e=document.createElement("p");e.style.width="100%",e.style.height="200px";var t=document.createElement("div");t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.visibility="hidden",t.style.width="200px",t.style.height="150px",t.style.overflow="hidden",t.appendChild(e),(document.body||document.documentElement).appendChild(t);var n=e.offsetWidth;t.style.overflow="scroll";var i=e.offsetWidth;return n==i&&(i=t.clientWidth),(document.body||document.documentElement).removeChild(t),n-i}var n;w.prototype.hasCaptionProblem=function(){return void 0===n&&e(),n},w.prototype.getCaretPosition=function(e){if(e.selectionStart)return e.selectionStart;if(document.selection){e.focus();var t=document.selection.createRange();if(null==t)return 0;var n=e.createTextRange(),i=n.duplicate();return n.moveToBookmark(t.getBookmark()),i.setEndPoint("EndToStart",n),i.text.length}return 0},w.prototype.setCaretPosition=function(e,t,n){if(void 0===n&&(n=t),e.setSelectionRange)e.focus(),e.setSelectionRange(t,n);else if(e.createTextRange){var i=e.createTextRange();i.collapse(!0),i.moveEnd("character",n),i.moveStart("character",t),i.select()}};var i;w.prototype.getScrollbarWidth=function(){return void 0===i&&(i=t()),i}}(),C.prototype.parentCell=function(e){var t={},n=this.instance.wtTable.TABLE,i=this.wtDom.closest(e,["TD","TH"],n);return i&&this.wtDom.isChildOf(i,n)?(t.coords=this.instance.wtTable.getCoords(i),t.TD=i):this.wtDom.hasClass(e,"wtBorder")&&this.wtDom.hasClass(e,"current")&&(t.coords=this.instance.selections.current.selected[0],t.TD=this.instance.wtTable.getCell(t.coords)),t},C.prototype.destroy=function(){clearTimeout(this.dblClickTimeout0),clearTimeout(this.dblClickTimeout1)},i.requestAnimFrame=function(){return i.requestAnimationFrame||i.webkitRequestAnimationFrame||i.mozRequestAnimationFrame||i.oRequestAnimationFrame||i.msRequestAnimationFrame||function(e){return i.setTimeout(e,1e3/60)}}(),i.cancelRequestAnimFrame=function(){return i.cancelAnimationFrame||i.webkitCancelRequestAnimationFrame||i.mozCancelRequestAnimationFrame||i.oCancelRequestAnimationFrame||i.msCancelRequestAnimationFrame||clearTimeout}(),i.getComputedStyle||!function(){var e,t={getPropertyValue:function(t){return"float"==t&&(t="styleFloat"),e.currentStyle[t.toUpperCase()]||null}};i.getComputedStyle=function(n){return e=n,t}}(),!String.prototype.trim){var U=/^\s+|\s+$/g;String.prototype.trim=function(){return this.replace(U,"")}}S.prototype=new p,S.prototype.readSettings=function(e){e.cloneOverlay instanceof b?this.offset=0:this.offset=e.wtSettings.settings.offsetRow,this.total=e.getSetting("totalRows"),this.fixedCount=e.getSetting("fixedRowsTop")},T.prototype=new d,T.prototype.add=function(e,t,n){if(!this.isLastIncomplete()&&0!=this.remainingSize){var i=this.sizeAtIndex(e,t);if(void 0===i)return!1;var r=this.getContainerSize(this.cellSizesSum+i);return n?this.cellSizes.unshift(i):this.cellSizes.push(i),this.cellSizesSum+=i,this.cellCount++,this.remainingSize=this.cellSizesSum-r,n&&this.isLastIncomplete()?!1:!0}return!1},T.prototype.remove=function(){var e=this.cellSizes.pop();this.cellSizesSum-=e,this.cellCount--,this.remainingSize-=e},T.prototype.removeOutstanding=function(){for(;this.cellCount>0&&this.cellSizes[this.cellCount-1]<this.remainingSize;)this.remove()},E.prototype.scrollVertical=function(e){if(!this.instance.drawn)throw new Error("scrollVertical can only be called after table was drawn to DOM");var t,n=this.instance,i=n.getSetting("offsetRow"),r=n.getSetting("fixedRowsTop"),o=n.getSetting("totalRows"),s=n.wtViewport.getViewportHeight();return t=o>0?this.scrollLogicVertical(e,i,o,r,s,function(e){return r>e-i&&e-i>=0?n.getSetting("rowHeight",e-i):n.getSetting("rowHeight",e)},function(e){n.wtTable.verticalRenderReverse=e}):0,t!==i&&this.instance.wtScrollbars.vertical.scrollTo(t),n},E.prototype.scrollHorizontal=function(e){if(!this.instance.drawn)throw new Error("scrollHorizontal can only be called after table was drawn to DOM");var t,n=this.instance,i=n.getSetting("offsetColumn"),r=n.getSetting("fixedColumnsLeft"),o=n.getSetting("totalColumns"),s=n.wtViewport.getViewportWidth();return t=o>0?this.scrollLogicHorizontal(e,i,o,r,s,function(e){return r>e-i&&e-i>=0?n.getSetting("columnWidth",e-i):n.getSetting("columnWidth",e)}):0,t!==i&&this.instance.wtScrollbars.horizontal.scrollTo(t),n},E.prototype.scrollLogicVertical=function(e,t,n,i,r,o,s){var a=t+e;return a>=n-i&&(a=n-i-1,s(!0)),0>a&&(a=0),a},E.prototype.scrollLogicHorizontal=function(e,t,n,i,r,o){var s,a=t+e,l=0;if(a>i){for(a>=n-i&&(a=n-i-1),s=a;r>l&&n>s;)l+=o(s),s++;if(r>l)for(;a>0&&(l+=o(a-1),r>l);)a--}else 0>a&&(a=0);return a},E.prototype.scrollViewport=function(e){if(this.instance.drawn){var t=this.instance.getSetting("offsetRow"),n=(this.instance.getSetting("offsetColumn"),this.instance.wtTable.getLastVisibleRow()),r=this.instance.getSetting("totalRows"),o=this.instance.getSetting("totalColumns"),s=this.instance.getSetting("fixedRowsTop"),a=this.instance.getSetting("fixedColumnsLeft");if(this.instance.getSetting("nativeScrollbars")){var l=this.instance.wtTable.getCell(e);if("object"==typeof l){var u=w.prototype.offset(l),c=w.prototype.outerWidth(l),f=w.prototype.outerHeight(l),h=this.instance.wtScrollbars.horizontal.getScrollPosition(),p=this.instance.wtScrollbars.vertical.getScrollPosition(),d=w.prototype.outerWidth(this.instance.wtScrollbars.horizontal.scrollHandler),g=w.prototype.outerHeight(this.instance.wtScrollbars.vertical.scrollHandler);return this.instance.wtScrollbars.horizontal.scrollHandler!==i&&(u.left=u.left-w.prototype.offset(this.instance.wtScrollbars.horizontal.scrollHandler).left),this.instance.wtScrollbars.vertical.scrollHandler!==i&&(u.top=u.top-w.prototype.offset(this.instance.wtScrollbars.vertical.scrollHandler).top),d-=20,g-=20,d>c&&(u.left<h?this.instance.wtScrollbars.horizontal.setScrollPosition(u.left):u.left+c>h+d&&this.instance.wtScrollbars.horizontal.setScrollPosition(u.left-d+c)),void(g>f&&(u.top<p?this.instance.wtScrollbars.vertical.setScrollPosition(u.top):u.top+f>p+g&&this.instance.wtScrollbars.vertical.setScrollPosition(u.top-g+f)))}}if(e[0]<0||e[0]>r-1)throw new Error("row "+e[0]+" does not exist");if(e[1]<0||e[1]>o-1)throw new Error("column "+e[1]+" does not exist");if(e[0]>n?(this.scrollVertical(e[0]-s-t),this.instance.wtTable.verticalRenderReverse=!0):e[0]===n&&this.instance.wtTable.rowStrategy.isLastIncomplete()?(this.scrollVertical(e[0]-s-t),this.instance.wtTable.verticalRenderReverse=!0):e[0]-s<t?this.scrollVertical(e[0]-s-t):this.scrollVertical(0),this.instance.wtTable.isColumnBeforeViewport(e[1]))this.instance.wtScrollbars.horizontal.scrollTo(e[1]-a);else if(this.instance.wtTable.isColumnAfterViewport(e[1])||this.instance.wtTable.getLastVisibleColumn()===e[1]&&!this.instance.wtTable.isLastColumnFullyVisible()){for(var v=0,m=0;a>m;m++)v+=this.instance.getSetting("columnWidth",m);var y=e[1];v+=this.instance.getSetting("columnWidth",y);var b=this.instance.wtViewport.getViewportWidth();if(b>v)for(var C=this.instance.getSetting("columnWidth",y-1);b>=v+C&&y>=a;)y--,v+=C,C=this.instance.getSetting("columnWidth",y-1);this.instance.wtScrollbars.horizontal.scrollTo(y-a)}return this.instance}},x.prototype.init=function(){var e=this;this.$table=n(this.instance.wtTable.TABLE),this.slider=document.createElement("DIV"),this.sliderStyle=this.slider.style,this.sliderStyle.position="absolute",this.sliderStyle.top="0",this.sliderStyle.left="0",this.sliderStyle.display="none",this.slider.className="dragdealer "+this.type,this.handle=document.createElement("DIV"),this.handleStyle=this.handle.style,this.handle.className="handle",this.slider.appendChild(this.handle),this.container=this.instance.wtTable.holder,this.container.appendChild(this.slider);var t=!0;this.dragTimeout=null;var i,r=function(){e.onScroll(i)};this.dragdealer=new Q(this.slider,{vertical:"vertical"===this.type,horizontal:"horizontal"===this.type,slide:!1,speed:100,animationCallback:function(n,o){return t?void(t=!1):(e.skipRefresh=!0,i="vertical"===e.type?o:n,void(null===e.dragTimeout&&(e.dragTimeout=setInterval(r,100),r())))},callback:function(t,n){e.skipRefresh=!1,clearInterval(e.dragTimeout),e.dragTimeout=null,i="vertical"===e.type?n:t,e.onScroll(i)}}),this.skipRefresh=!1},x.prototype.onScroll=function(e){if(this.instance.drawn&&(this.readSettings(),this.total>this.visibleCount)){var t=Math.round(this.handlePosition*this.total/this.sliderSize);1===e?"vertical"===this.type?this.instance.scrollVertical(1/0).draw():this.instance.scrollHorizontal(1/0).draw():t!==this.offset?"vertical"===this.type?this.instance.scrollVertical(t-this.offset).draw():this.instance.scrollHorizontal(t-this.offset).draw():this.refresh()}},x.prototype.getHandleSizeRatio=function(e,t){return!t||e>t||e==t?1:1/t},x.prototype.prepare=function(){if(!this.skipRefresh){var e=this.getHandleSizeRatio(this.visibleCount,this.total);(1===e||isNaN(e))&&"auto"===this.scrollMode||"none"===this.scrollMode?this.visible=!1:this.visible=!0}},x.prototype.refresh=function(){if(!this.skipRefresh){if(!this.visible)return void(this.sliderStyle.display="none");var e,t,n,i,r=this.visibleCount,o=this.instance.wtViewport.getWorkspaceWidth(),s=this.instance.wtViewport.getWorkspaceHeight();o===1/0&&(o=this.instance.wtViewport.getWorkspaceActualWidth()),s===1/0&&(s=this.instance.wtViewport.getWorkspaceActualHeight()),"vertical"===this.type?(this.instance.wtTable.rowStrategy.isLastIncomplete()&&r--,t=s-2,this.sliderStyle.top=this.instance.wtDom.offset(this.$table[0]).top-this.instance.wtDom.offset(this.container).top+"px",this.sliderStyle.left=o-1+"px",this.sliderStyle.height=Math.max(t,0)+"px"):(t=o-2,this.sliderStyle.left=this.instance.wtDom.offset(this.$table[0]).left-this.instance.wtDom.offset(this.container).left+"px",this.sliderStyle.top=s-1+"px",this.sliderStyle.width=Math.max(t,0)+"px"),e=this.getHandleSizeRatio(r,this.total),n=Math.round(t*e),10>n&&(n=15),i=Math.floor(t*(this.offset/this.total)),n+i>t&&(i=t-n),"vertical"===this.type?(this.handleStyle.height=n+"px",this.handleStyle.top=i+"px"):(this.handleStyle.width=n+"px",this.handleStyle.left=i+"px"),this.sliderStyle.display="block"}},x.prototype.destroy=function(){clearInterval(this.dragdealer.interval)};var K=function(e){this.instance=e,this.type="vertical",this.init()};K.prototype=new x,K.prototype.scrollTo=function(e){this.instance.update("offsetRow",e)},K.prototype.readSettings=function(){this.scrollMode=this.instance.getSetting("scrollV"),this.offset=this.instance.getSetting("offsetRow"),this.total=this.instance.getSetting("totalRows"),this.visibleCount=this.instance.wtTable.rowStrategy.countVisible(),this.visibleCount>1&&this.instance.wtTable.rowStrategy.isLastIncomplete()&&this.visibleCount--,this.handlePosition=parseInt(this.handleStyle.top,10),this.sliderSize=parseInt(this.sliderStyle.height,10),this.fixedCount=this.instance.getSetting("fixedRowsTop")};var Y=function(e){this.instance=e,this.type="horizontal",this.init()};Y.prototype=new x,Y.prototype.scrollTo=function(e){this.instance.update("offsetColumn",e)},Y.prototype.readSettings=function(){this.scrollMode=this.instance.getSetting("scrollH"),this.offset=this.instance.getSetting("offsetColumn"),this.total=this.instance.getSetting("totalColumns"),this.visibleCount=this.instance.wtTable.columnStrategy.countVisible(),this.visibleCount>1&&this.instance.wtTable.columnStrategy.isLastIncomplete()&&this.visibleCount--,this.handlePosition=parseInt(this.handleStyle.left,10),this.sliderSize=parseInt(this.sliderStyle.width,10),this.fixedCount=this.instance.getSetting("fixedColumnsLeft")},Y.prototype.getHandleSizeRatio=function(e,t){return!t||e>t||e==t?1:e/t},O.prototype=new f,O.prototype.resetFixedPosition=function(){if(this.instance.wtTable.holder.parentNode){var e,t=this.clone.wtTable.holder.parentNode;if(this.scrollHandler===i){e=this.instance.wtTable.hider.getBoundingClientRect();
var n=Math.ceil(e.top,10),r=Math.ceil(e.bottom,10);0>n&&r>0?t.style.top="0":t.style.top=n+"px";var o=Math.ceil(e.left,10),s=Math.ceil(e.right,10);0>o&&s>0?t.style.left="0":t.style.left=o+"px"}else e=this.scrollHandler.getBoundingClientRect(),t.style.top=Math.ceil(e.top,10)+"px",t.style.left=Math.ceil(e.left,10)+"px";t.style.width=w.prototype.outerWidth(this.clone.wtTable.TABLE)+4+"px",t.style.height=w.prototype.outerHeight(this.clone.wtTable.TABLE)+4+"px"}},O.prototype.prepare=function(){},O.prototype.refresh=function(e){this.measureBefore=0,this.measureAfter=0,this.clone&&this.clone.draw(e)},O.prototype.getScrollPosition=function(){},O.prototype.getLastCell=function(){},O.prototype.applyToDOM=function(){},O.prototype.scrollTo=function(){},O.prototype.readWindowSize=function(){},O.prototype.readSettings=function(){},A.prototype=new f,A.prototype.resetFixedPosition=function(){if(this.instance.wtTable.holder.parentNode){var e,t=this.clone.wtTable.holder.parentNode;if(this.scrollHandler===i){e=this.instance.wtTable.hider.getBoundingClientRect();var n=Math.ceil(e.left,10),r=Math.ceil(e.right,10);0>n&&r>0?t.style.left="0":t.style.left=n+"px"}else e=this.scrollHandler.getBoundingClientRect(),t.style.top=Math.ceil(e.top,10)+"px",t.style.left=Math.ceil(e.left,10)+"px"}},A.prototype.react=function(){if(this.instance.wtTable.holder.parentNode){var e=this.clone.wtTable.holder.parentNode;if(this.instance.wtScrollbars.vertical.scrollHandler===i){var t=this.instance.wtTable.hider.getBoundingClientRect();e.style.top=Math.ceil(t.top,10)+"px",e.style.height=w.prototype.outerHeight(this.clone.wtTable.TABLE)+"px"}else this.clone.wtTable.holder.style.top=-(this.instance.wtScrollbars.vertical.windowScrollPosition-this.instance.wtScrollbars.vertical.measureBefore)+"px",e.style.height=this.instance.wtViewport.getWorkspaceHeight()+"px";e.style.width=w.prototype.outerWidth(this.clone.wtTable.TABLE)+4+"px"}},A.prototype.prepare=function(){},A.prototype.refresh=function(e){this.measureBefore=0,this.measureAfter=0,this.clone&&this.clone.draw(e)},A.prototype.getScrollPosition=function(){return this.scrollHandler===i?this.scrollHandler.scrollX:this.scrollHandler.scrollLeft},A.prototype.setScrollPosition=function(e){this.scrollHandler.scrollLeft=e},A.prototype.onScroll=function(){f.prototype.onScroll.apply(this,arguments),this.instance.getSetting("onScrollHorizontally")},A.prototype.getLastCell=function(){return this.instance.wtTable.getLastVisibleColumn()},A.prototype.applyToDOM=function(){this.fixedContainer.style.paddingLeft=this.measureBefore+"px",this.fixedContainer.style.paddingRight=this.measureAfter+"px"},A.prototype.scrollTo=function(e){this.$scrollHandler.scrollLeft(this.tableParentOffset+e*this.cellSize)},A.prototype.readWindowSize=function(){this.scrollHandler===i?(this.windowSize=document.documentElement.clientWidth,this.tableParentOffset=this.instance.wtTable.holderOffset.left):(this.windowSize=w.prototype.outerWidth(this.scrollHandler),this.tableParentOffset=0),this.windowScrollPosition=this.getScrollPosition()},A.prototype.readSettings=function(){this.offset=this.instance.getSetting("offsetColumn"),this.total=this.instance.getSetting("totalColumns")},R.prototype=new f,R.prototype.resetFixedPosition=function(){if(this.instance.wtTable.holder.parentNode){var e,t=this.clone.wtTable.holder.parentNode;if(this.scrollHandler===i){e=this.instance.wtTable.hider.getBoundingClientRect();var n=Math.ceil(e.top,10),r=Math.ceil(e.bottom,10);0>n&&r>0?t.style.top="0":t.style.top=n+"px"}else e=this.instance.wtScrollbars.horizontal.scrollHandler.getBoundingClientRect(),t.style.top=Math.ceil(e.top,10)+"px",t.style.left=Math.ceil(e.left,10)+"px";this.instance.wtScrollbars.horizontal.scrollHandler===i?t.style.width=this.instance.wtViewport.getWorkspaceActualWidth()+"px":t.style.width=w.prototype.outerWidth(this.instance.wtTable.holder.parentNode)+"px",t.style.height=w.prototype.outerHeight(this.clone.wtTable.TABLE)+4+"px"}},R.prototype.react=function(){if(this.instance.wtTable.holder.parentNode&&this.instance.wtScrollbars.horizontal.scrollHandler!==i){var e=this.clone.wtTable.holder.parentNode;e.firstChild.style.left=-this.instance.wtScrollbars.horizontal.windowScrollPosition+"px"}},R.prototype.getScrollPosition=function(){return this.scrollHandler===i?this.scrollHandler.scrollY:this.scrollHandler.scrollTop},R.prototype.setScrollPosition=function(e){this.scrollHandler.scrollTop=e},R.prototype.onScroll=function(){f.prototype.onScroll.apply(this,arguments);var e,t=0;if(e=this.windowScrollPosition-this.tableParentOffset,G=0,e>0){for(var n,i=0,r=0;r<this.total&&(n=this.instance.getSetting("rowHeight",r),i+=n,!(i>e));r++);this.offset>0&&(G=i-e),t=r,t=Math.min(t,this.total)}this.curOuts=t>this.maxOuts?this.maxOuts:t,t-=this.curOuts,this.instance.update("offsetRow",t),this.readSettings(),this.instance.draw(),this.instance.getSetting("onScrollVertically")},R.prototype.getLastCell=function(){return this.instance.getSetting("offsetRow")+this.instance.wtTable.tbodyChildrenLength-1};var G=0;R.prototype.sumCellSizes=function(e,t){for(var n=0;t>e;)n+=this.instance.getSetting("rowHeight",e),e++;return n},R.prototype.applyToDOM=function(){var e=this.instance.wtViewport.getColumnHeaderHeight();this.fixedContainer.style.height=e+this.sumCellSizes(0,this.total)+4+"px",this.fixed.style.top=this.measureBefore+"px",this.fixed.style.bottom=""},R.prototype.scrollTo=function(e){var t=this.tableParentOffset+e*this.cellSize;this.$scrollHandler.scrollTop(t),this.onScroll(t)},R.prototype.readWindowSize=function(){this.scrollHandler===i?(this.windowSize=document.documentElement.clientHeight,this.tableParentOffset=this.instance.wtTable.holderOffset.top):(this.windowSize=this.scrollHandler.clientHeight,this.tableParentOffset=0),this.windowScrollPosition=this.getScrollPosition()},R.prototype.readSettings=function(){this.offset=this.instance.getSetting("offsetRow"),this.total=this.instance.getSetting("totalRows")},D.prototype.registerListeners=function(){function e(){return u.instance.wtTable.holder.parentNode?(u.vertical.windowScrollPosition=u.vertical.getScrollPosition(),u.horizontal.windowScrollPosition=u.horizontal.getScrollPosition(),u.box=u.instance.wtTable.hider.getBoundingClientRect(),u.box.width===a&&u.box.height===l||!u.instance.rowHeightCache||(a=u.box.width,l=u.box.height,u.instance.draw()),void((u.vertical.windowScrollPosition!==t||u.horizontal.windowScrollPosition!==r||u.box.top!==o||u.box.left!==s)&&(u.vertical.onScroll(),u.horizontal.onScroll(),u.vertical.react(),u.horizontal.react(),t=u.vertical.windowScrollPosition,r=u.horizontal.windowScrollPosition,o=u.box.top,s=u.box.left))):void u.destroy()}var t,r,o,s,a,l,u=this,c=n(i);this.vertical.$scrollHandler.on("scroll."+this.instance.guid,e),this.vertical.scrollHandler!==this.horizontal.scrollHandler&&this.horizontal.$scrollHandler.on("scroll."+this.instance.guid,e),this.vertical.scrollHandler!==i&&this.horizontal.scrollHandler!==i&&c.on("scroll."+this.instance.guid,e),c.on("load."+this.instance.guid,e),c.on("resize."+this.instance.guid,e),n(document).on("ready."+this.instance.guid,e),setInterval(e,100)},D.prototype.destroy=function(){this.vertical&&this.vertical.destroy(),this.horizontal&&this.horizontal.destroy()},D.prototype.refresh=function(e){this.horizontal&&this.horizontal.readSettings(),this.vertical&&this.vertical.readSettings(),this.horizontal&&this.horizontal.prepare(),this.vertical&&this.vertical.prepare(),this.horizontal&&this.horizontal.refresh(e),this.vertical&&this.vertical.refresh(e),this.corner&&this.corner.refresh(e),this.debug&&this.debug.refresh(e)},k.prototype.add=function(e){this.selected.push(e)},k.prototype.clear=function(){this.selected.length=0},k.prototype.getCorners=function(){var e,t,n,i,r,o=this.selected.length;if(o>0&&(e=n=this.selected[0][0],t=i=this.selected[0][1],o>1))for(r=1;o>r;r++)this.selected[r][0]<e?e=this.selected[r][0]:this.selected[r][0]>n&&(n=this.selected[r][0]),this.selected[r][1]<t?t=this.selected[r][1]:this.selected[r][1]>i&&(i=this.selected[r][1]);return[e,t,n,i]},k.prototype.draw=function(){var e,t,n,i,r,o=this.instance.wtTable.rowStrategy.countVisible(),s=this.instance.wtTable.columnStrategy.countVisible();if(this.selected.length){for(e=this.getCorners(),t=0;o>t;t++)for(n=0;s>n;n++)i=this.instance.wtTable.rowFilter.visibleToSource(t),r=this.instance.wtTable.columnFilter.visibleToSource(n),i>=e[0]&&i<=e[2]&&r>=e[1]&&r<=e[3]?this.instance.wtTable.currentCellCache.add(t,n,this.settings.className):i>=e[0]&&i<=e[2]?this.instance.wtTable.currentCellCache.add(t,n,this.settings.highlightRowClassName):r>=e[1]&&r<=e[3]&&this.instance.wtTable.currentCellCache.add(t,n,this.settings.highlightColumnClassName);this.border&&this.border.appear(e)}else this.border&&this.border.disappear()},I.prototype.update=function(e,t){if(void 0===t)for(var n in e)e.hasOwnProperty(n)&&(this.settings[n]=e[n]);else this.settings[e]=t;return this.instance},I.prototype.getSetting=function(e,t,n,i){return this[e]?this[e](t,n,i):this._getSetting(e,t,n,i)},I.prototype._getSetting=function(e,t,n,i){return"function"==typeof this.settings[e]?this.settings[e](t,n,i):void 0!==t&&"[object Array]"===Object.prototype.toString.call(this.settings[e])?this.settings[e][t]:this.settings[e]},I.prototype.has=function(e){return!!this.settings[e]},I.prototype.rowHeight=function(e,t){if(this.instance.rowHeightCache||(this.instance.rowHeightCache=[]),void 0===this.instance.rowHeightCache[e]){var n=23;return t&&(n=this.instance.wtDom.outerHeight(t),this.instance.rowHeightCache[e]=n),n}return this.instance.rowHeightCache[e]},P.prototype.refreshHiderDimensions=function(){var e=this.instance.wtViewport.getWorkspaceHeight(),t=this.instance.wtViewport.getWorkspaceWidth(),n=this.spreader.style;e===1/0&&t===1/0||this.instance.getSetting("nativeScrollbars")?(n.position="relative",n.width="auto",n.height="auto"):(e===1/0&&(e=this.instance.wtViewport.getWorkspaceActualHeight()),t===1/0&&(t=this.instance.wtViewport.getWorkspaceActualWidth()),this.hiderStyle.overflow="hidden",n.position="absolute",n.top="0",n.left="0",this.instance.getSetting("nativeScrollbars")||(n.height="4000px",n.width="4000px"),0>e&&(e=0),this.hiderStyle.height=e+"px",this.hiderStyle.width=t+"px")},P.prototype.refreshStretching=function(){if(!this.instance.cloneSource){var e=this.instance,t=e.getSetting("stretchH"),n=e.getSetting("totalRows"),i=e.getSetting("totalColumns"),r=e.getSetting("offsetColumn"),o=function(e){var t=s.instance.wtViewport.getViewportWidth(e);return e>t&&s.instance.getSetting("nativeScrollbars")?1/0:t},s=this,a=function(t){var n=s.columnFilter.visibleToSource(t);return i>n?e.getSetting("columnWidth",n):void 0};"hybrid"===t&&(t=r>0?"last":"none");var l=function(e){return s.instance.getSetting("nativeScrollbars")?s.instance.cloneOverlay instanceof b?1/0:2*s.instance.wtViewport.getViewportHeight(e):s.instance.wtViewport.getViewportHeight(e)},u=function(e,t){if(s.instance.getSetting("nativeScrollbars"))return 20;var i=s.rowFilter.visibleToSource(e);return n>i?s.verticalRenderReverse&&0===e?s.instance.getSetting("rowHeight",i,t)-1:s.instance.getSetting("rowHeight",i,t):void 0};this.columnStrategy=new m(e,o,a,t),this.rowStrategy=new T(e,l,u)}},P.prototype.adjustAvailableNodes=function(){for(var e,t,n,i,r=this.instance.getSetting("rowHeaders"),o=r.length,s=this.instance.getSetting("columnHeaders");this.colgroupChildrenLength<o;)this.COLGROUP.appendChild(document.createElement("COL")),this.colgroupChildrenLength++;for(this.refreshStretching(),e=this.instance.cloneSource&&(this.instance.cloneOverlay instanceof A||this.instance.cloneOverlay instanceof O)?this.instance.getSetting("fixedColumnsLeft"):this.columnStrategy.cellCount;this.colgroupChildrenLength<e+o;)this.COLGROUP.appendChild(document.createElement("COL")),this.colgroupChildrenLength++;for(;this.colgroupChildrenLength>e+o;)this.COLGROUP.removeChild(this.COLGROUP.lastChild),this.colgroupChildrenLength--;if(t=this.THEAD.firstChild,s.length){for(t||(t=document.createElement("TR"),this.THEAD.appendChild(t)),this.theadChildrenLength=t.childNodes.length;this.theadChildrenLength<e+o;)t.appendChild(document.createElement("TH")),this.theadChildrenLength++;for(;this.theadChildrenLength>e+o;)t.removeChild(t.lastChild),this.theadChildrenLength--}else t&&this.wtDom.empty(t);for(i=0;i<this.colgroupChildrenLength;i++)o>i?this.wtDom.addClass(this.COLGROUP.childNodes[i],"rowHeader"):this.wtDom.removeClass(this.COLGROUP.childNodes[i],"rowHeader");if(s.length&&(t=this.THEAD.firstChild,o))for(n=t.firstChild,i=0;o>i;i++)r[i](-o+i,n),n=n.nextSibling;for(i=0;e>i;i++)s.length&&s[0](this.columnFilter.visibleToSource(i),t.childNodes[o+i])},P.prototype.adjustColumns=function(e,t){for(var n=e.childNodes.length;t>n;){var i=document.createElement("TD");e.appendChild(i),n++}for(;n>t;)e.removeChild(e.lastChild),n--},P.prototype.draw=function(e){return this.instance.getSetting("nativeScrollbars")&&(this.verticalRenderReverse=!1),this.rowFilter.readSettings(this.instance),this.columnFilter.readSettings(this.instance),e?this.instance.wtScrollbars&&this.instance.wtScrollbars.refresh(!0):(this.instance.getSetting("nativeScrollbars")?this.instance.cloneSource?this.tableOffset=this.instance.cloneSource.wtTable.tableOffset:(this.holderOffset=this.wtDom.offset(this.holder),this.tableOffset=this.wtDom.offset(this.TABLE),this.instance.wtScrollbars.vertical.readWindowSize(),this.instance.wtScrollbars.horizontal.readWindowSize(),this.instance.wtViewport.resetSettings()):(this.tableOffset=this.wtDom.offset(this.TABLE),this.instance.wtViewport.resetSettings()),this._doDraw()),this.refreshPositions(e),e||this.instance.getSetting("nativeScrollbars")&&(this.instance.cloneSource||(this.instance.wtScrollbars.vertical.resetFixedPosition(),this.instance.wtScrollbars.horizontal.resetFixedPosition(),this.instance.wtScrollbars.corner.resetFixedPosition(),this.instance.wtScrollbars.debug&&this.instance.wtScrollbars.debug.resetFixedPosition())),this.instance.drawn=!0,this},P.prototype._doDraw=function(){var e,t,n,i,r,o,s,a,l,u,c=0,f=this.instance.getSetting("offsetRow"),h=this.instance.getSetting("totalRows"),p=this.instance.getSetting("totalColumns"),d=this.instance.getSetting("rowHeaders"),g=d.length,v=!1;this.verticalRenderReverse&&(l=f);var m=!1;if(this.verticalRenderReverse&&(f===h-this.rowFilter.fixedCount-1?m=!0:(this.instance.update("offsetRow",f+1),this.rowFilter.readSettings(this.instance))),this.instance.cloneSource&&(this.columnStrategy=this.instance.cloneSource.wtTable.columnStrategy,this.rowStrategy=this.instance.cloneSource.wtTable.rowStrategy),p>0){e=this.rowFilter.visibleToSource(c);var y,w=this.instance.getSetting("fixedRowsTop");for(this.instance.cloneSource&&(this.instance.cloneOverlay instanceof R||this.instance.cloneOverlay instanceof O?y=w:this.instance.cloneOverlay instanceof A&&(y=this.rowStrategy.countVisible())),this.adjustAvailableNodes(),v=!0,i=this.instance.cloneSource&&(this.instance.cloneOverlay instanceof A||this.instance.cloneOverlay instanceof O)?this.instance.getSetting("fixedColumnsLeft"):this.columnStrategy.cellCount,this.instance.cloneSource||(a=this.instance.wtViewport.getWorkspaceWidth(),this.columnStrategy.stretch()),t=0;i>t;t++)this.COLGROUP.childNodes[t+g].style.width=this.columnStrategy.getSize(t)+"px";for(;h>e&&e>=0;){if(c>1e3)throw new Error("Security brake: Too much TRs. Please define height for your table, which will enforce scrollbars.");if(void 0!==y&&c===y)break;if(c>=this.tbodyChildrenLength||this.verticalRenderReverse&&c>=this.rowFilter.fixedCount){for(r=document.createElement("TR"),t=0;g>t;t++)r.appendChild(document.createElement("TH"));this.verticalRenderReverse&&c>=this.rowFilter.fixedCount?this.TBODY.insertBefore(r,this.TBODY.childNodes[this.rowFilter.fixedCount]||this.TBODY.firstChild):this.TBODY.appendChild(r),this.tbodyChildrenLength++}else r=0===c?this.TBODY.firstChild:r.nextSibling;for(s=r.firstChild,t=0;g>t;t++)"TD"==s.nodeName&&(o=s,s=document.createElement("TH"),r.insertBefore(s,o),r.removeChild(o)),d[t](e,s),s=s.nextSibling;for(this.adjustColumns(r,i+g),t=0;i>t;t++)n=this.columnFilter.visibleToSource(t),o=0===t?r.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(n)]:o.nextSibling,"TH"==o.nodeName&&(s=o,o=document.createElement("TD"),r.insertBefore(o,s),r.removeChild(s)),o.className="",o.removeAttribute("style"),this.instance.getSetting("cellRenderer",e,n,o);if(f=this.instance.getSetting("offsetRow"),this.verticalRenderReverse&&m){if(-this.wtDom.outerHeight(r.firstChild)<this.rowStrategy.remainingSize){this.TBODY.removeChild(r),this.instance.update("offsetRow",f+1),this.tbodyChildrenLength--,this.rowFilter.readSettings(this.instance);break}this.instance.cloneSource||(u=this.rowStrategy.add(c,o,this.verticalRenderReverse),u===!1&&this.rowStrategy.removeOutstanding())}else if(!this.instance.cloneSource&&(u=this.rowStrategy.add(c,o,this.verticalRenderReverse),u===!1&&(this.instance.getSetting("nativeScrollbars")||this.rowStrategy.removeOutstanding()),this.rowStrategy.isLastIncomplete())){if(this.verticalRenderReverse&&!this.isRowInViewport(l))return this.verticalRenderReverse=!1,this.instance.update("offsetRow",l),void this.draw();break}if(this.instance.getSetting("nativeScrollbars")&&(this.instance.cloneSource?r.style.height=this.instance.getSetting("rowHeight",e)+"px":this.instance.getSetting("rowHeight",e,o)),this.verticalRenderReverse&&c>=this.rowFilter.fixedCount){if(0===f)break;this.instance.update("offsetRow",f-1),this.rowFilter.readSettings(this.instance)}else c++;e=this.rowFilter.visibleToSource(c)}}if(v||this.adjustAvailableNodes(),!(this.instance.cloneOverlay instanceof b))for(c=this.rowStrategy.countVisible();this.tbodyChildrenLength>c;)this.TBODY.removeChild(this.TBODY.lastChild),this.tbodyChildrenLength--;if(this.instance.wtScrollbars&&this.instance.wtScrollbars.refresh(!1),!this.instance.cloneSource&&a!==this.instance.wtViewport.getWorkspaceWidth())for(this.columnStrategy.stretch(),t=0;t<this.columnStrategy.cellCount;t++)this.COLGROUP.childNodes[t+g].style.width=this.columnStrategy.getSize(t)+"px";this.verticalRenderReverse=!1},P.prototype.refreshPositions=function(e){this.refreshHiderDimensions(),this.refreshSelections(e)},P.prototype.refreshSelections=function(e){var t,n,i,r,o,s,a=[],l=this.rowStrategy.countVisible(),u=this.columnStrategy.countVisible();if(this.oldCellCache=this.currentCellCache,this.currentCellCache=new g,this.instance.selections)for(n in this.instance.selections)this.instance.selections.hasOwnProperty(n)&&(this.instance.selections[n].draw(),this.instance.selections[n].settings.className&&a.push(this.instance.selections[n].settings.className),this.instance.selections[n].settings.highlightRowClassName&&a.push(this.instance.selections[n].settings.highlightRowClassName),this.instance.selections[n].settings.highlightColumnClassName&&a.push(this.instance.selections[n].settings.highlightColumnClassName));for(s=a.length,t=0;l>t;t++)for(i=0;u>i;i++)for(n=this.rowFilter.visibleToSource(t),r=this.columnFilter.visibleToSource(i),o=0;s>o;o++)this.currentCellCache.test(t,i,a[o])?this.wtDom.addClass(this.getCell([n,r]),a[o]):e&&this.oldCellCache.test(t,i,a[o])&&this.wtDom.removeClass(this.getCell([n,r]),a[o])},P.prototype.getCell=function(e){return this.isRowBeforeViewport(e[0])?-1:this.isRowAfterViewport(e[0])?-2:this.isColumnBeforeViewport(e[1])?-3:this.isColumnAfterViewport(e[1])?-4:this.TBODY.childNodes[this.rowFilter.sourceToVisible(e[0])].childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e[1])]},P.prototype.getCoords=function(e){return[this.rowFilter.visibleToSource(this.wtDom.index(e.parentNode)),this.columnFilter.visibleRowHeadedColumnToSourceColumn(e.cellIndex)]},P.prototype.getLastVisibleRow=function(){return this.rowFilter.visibleToSource(this.rowStrategy.cellCount-1)},P.prototype.getLastVisibleColumn=function(){return this.columnFilter.visibleToSource(this.columnStrategy.cellCount-1)},P.prototype.isRowBeforeViewport=function(e){return this.rowFilter.sourceToVisible(e)<this.rowFilter.fixedCount&&e>=this.rowFilter.fixedCount},P.prototype.isRowAfterViewport=function(e){return e>this.getLastVisibleRow()},P.prototype.isColumnBeforeViewport=function(e){return this.columnFilter.sourceToVisible(e)<this.columnFilter.fixedCount&&e>=this.columnFilter.fixedCount},P.prototype.isColumnAfterViewport=function(e){return e>this.getLastVisibleColumn()},P.prototype.isRowInViewport=function(e){return!this.isRowBeforeViewport(e)&&!this.isRowAfterViewport(e)},P.prototype.isColumnInViewport=function(e){return!this.isColumnBeforeViewport(e)&&!this.isColumnAfterViewport(e)},P.prototype.isLastRowFullyVisible=function(){return this.getLastVisibleRow()===this.instance.getSetting("totalRows")-1&&!this.rowStrategy.isLastIncomplete()},P.prototype.isLastColumnFullyVisible=function(){return this.getLastVisibleColumn()===this.instance.getSetting("totalColumns")-1&&!this.columnStrategy.isLastIncomplete()},M.prototype.getWorkspaceHeight=function(e){if(this.instance.getSetting("nativeScrollbars"))return this.instance.wtScrollbars.vertical.windowSize;var t=this.instance.getSetting("height");return(t===1/0||void 0===t||null===t||1>t)&&(t=this.instance.wtScrollbars.vertical instanceof f?this.instance.wtScrollbars.vertical.availableSize():1/0),t!==1/0&&(e>=t?t-=this.instance.getSetting("scrollbarHeight"):this.instance.wtScrollbars.horizontal.visible&&(t-=this.instance.getSetting("scrollbarHeight"))),t},M.prototype.getWorkspaceWidth=function(e){var t=this.instance.getSetting("width");return(t===1/0||void 0===t||null===t||1>t)&&(t=this.instance.wtScrollbars.horizontal instanceof f?this.instance.wtScrollbars.horizontal.availableSize():1/0),t!==1/0&&(e>=t?t-=this.instance.getSetting("scrollbarWidth"):this.instance.wtScrollbars.vertical.visible&&(t-=this.instance.getSetting("scrollbarWidth"))),t},M.prototype.getWorkspaceActualHeight=function(){return this.instance.wtDom.outerHeight(this.instance.wtTable.TABLE)},M.prototype.getWorkspaceActualWidth=function(){return this.instance.wtDom.outerWidth(this.instance.wtTable.TABLE)||this.instance.wtDom.outerWidth(this.instance.wtTable.TBODY)||this.instance.wtDom.outerWidth(this.instance.wtTable.THEAD)},M.prototype.getColumnHeaderHeight=function(){if(isNaN(this.columnHeaderHeight)){var e=this.instance.wtDom.offset(this.instance.wtTable.TBODY),t=this.instance.wtTable.tableOffset;this.columnHeaderHeight=e.top-t.top}return this.columnHeaderHeight},M.prototype.getViewportHeight=function(e){var t=this.getWorkspaceHeight(e);if(t===1/0)return t;var n=this.getColumnHeaderHeight();return n>0?t-n:t},M.prototype.getRowHeaderWidth=function(){if(this.instance.cloneSource)return this.instance.cloneSource.wtViewport.getRowHeaderWidth();if(isNaN(this.rowHeaderWidth)){var e=this.instance.getSetting("rowHeaders");if(e.length){var t=this.instance.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(var n=0,i=e.length;i>n;n++)t?(this.rowHeaderWidth+=this.instance.wtDom.outerWidth(t),t=t.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0}return this.rowHeaderWidth},M.prototype.getViewportWidth=function(e){var t=this.getWorkspaceWidth(e);if(t===1/0)return t;var n=this.getRowHeaderWidth();return n>0?t-n:t},M.prototype.resetSettings=function(){this.rowHeaderWidth=0/0,this.columnHeaderHeight=0/0};var X={x:0,y:0,init:function(){this.setEvent("mouse"),this.setEvent("touch")},setEvent:function(e){var t=document["on"+e+"move"]||function(){};document["on"+e+"move"]=function(e){t(e),X.refresh(e)}},refresh:function(e){e||(e=i.event),"mousemove"==e.type?this.set(e):e.touches&&this.set(e.touches[0])},set:function(e){e.pageX||e.pageY?(this.x=e.pageX,this.y=e.pageY):document.body&&(e.clientX||e.clientY)&&(this.x=e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,this.y=e.clientY+document.body.scrollTop+document.documentElement.scrollTop)}};X.init();var J={get:function(e){var t=0,n=0;if(e.offsetParent)do n+=e.offsetLeft,t+=e.offsetTop;while(e=e.offsetParent);return[n,t]}},Q=function(e,t){if("string"==typeof e&&(e=document.getElementById(e)),e){var n=e.getElementsByTagName("div")[0];n&&-1!=n.className.search(/(^|\s)handle(\s|$)/)&&(this.init(e,n,t||{}),this.setup())}};Q.prototype={init:function(e,t,n){this.wrapper=e,this.handle=t,this.options=n,this.disabled=this.getOption("disabled",!1),this.horizontal=this.getOption("horizontal",!0),this.vertical=this.getOption("vertical",!1),this.slide=this.getOption("slide",!0),this.steps=this.getOption("steps",0),this.snap=this.getOption("snap",!1),this.loose=this.getOption("loose",!1),this.speed=this.getOption("speed",10)/100,this.xPrecision=this.getOption("xPrecision",0),this.yPrecision=this.getOption("yPrecision",0),this.callback=n.callback||null,this.animationCallback=n.animationCallback||null,this.bounds={left:n.left||0,right:-(n.right||0),top:n.top||0,bottom:-(n.bottom||0),x0:0,x1:0,xRange:0,y0:0,y1:0,yRange:0},this.value={prev:[-1,-1],current:[n.x||0,n.y||0],target:[n.x||0,n.y||0]},this.offset={wrapper:[0,0],mouse:[0,0],prev:[-999999,-999999],current:[0,0],target:[0,0]},this.change=[0,0],this.activity=!1,this.dragging=!1,this.tapping=!1},getOption:function(e,t){return void 0!==this.options[e]?this.options[e]:t},setup:function(){this.setWrapperOffset(),this.setBoundsPadding(),this.setBounds(),this.setSteps(),this.addListeners()},setWrapperOffset:function(){this.offset.wrapper=J.get(this.wrapper)},setBoundsPadding:function(){this.bounds.left||this.bounds.right||(this.bounds.left=J.get(this.handle)[0]-this.offset.wrapper[0],this.bounds.right=-this.bounds.left),this.bounds.top||this.bounds.bottom||(this.bounds.top=J.get(this.handle)[1]-this.offset.wrapper[1],this.bounds.bottom=-this.bounds.top)},setBounds:function(){this.bounds.x0=this.bounds.left,this.bounds.x1=this.wrapper.offsetWidth+this.bounds.right,this.bounds.xRange=this.bounds.x1-this.bounds.x0-this.handle.offsetWidth,this.bounds.y0=this.bounds.top,this.bounds.y1=this.wrapper.offsetHeight+this.bounds.bottom,this.bounds.yRange=this.bounds.y1-this.bounds.y0-this.handle.offsetHeight,this.bounds.xStep=1/(this.xPrecision||Math.max(this.wrapper.offsetWidth,this.handle.offsetWidth)),this.bounds.yStep=1/(this.yPrecision||Math.max(this.wrapper.offsetHeight,this.handle.offsetHeight))},setSteps:function(){if(this.steps>1){this.stepRatios=[];for(var e=0;e<=this.steps-1;e++)this.stepRatios[e]=e/(this.steps-1)}},addListeners:function(){var e=this;this.wrapper.onselectstart=function(){return!1},this.handle.onmousedown=this.handle.ontouchstart=function(t){e.handleDownHandler(t)},this.wrapper.onmousedown=this.wrapper.ontouchstart=function(t){e.wrapperDownHandler(t)};var t=document.onmouseup||function(){};document.onmouseup=function(n){t(n),e.documentUpHandler(n)};var n=document.ontouchend||function(){};document.ontouchend=function(t){n(t),e.documentUpHandler(t)};var r=i.onresize||function(){};i.onresize=function(t){r(t),e.documentResizeHandler(t)},this.wrapper.onmousemove=function(){e.activity=!0},this.wrapper.onclick=function(){return!e.activity},this.interval=setInterval(function(){e.animate()},25),e.animate(!1,!0)},handleDownHandler:function(e){this.activity=!1,X.refresh(e),this.preventDefaults(e,!0),this.startDrag()},wrapperDownHandler:function(e){X.refresh(e),this.preventDefaults(e,!0),this.startTap()},documentUpHandler:function(){this.stopDrag(),this.stopTap()},documentResizeHandler:function(){this.setWrapperOffset(),this.setBounds(),this.update()},enable:function(){this.disabled=!1,this.handle.className=this.handle.className.replace(/\s?disabled/g,"")},disable:function(){this.disabled=!0,this.handle.className+=" disabled"},setStep:function(e,t,n){this.setValue(this.steps&&e>1?(e-1)/(this.steps-1):0,this.steps&&t>1?(t-1)/(this.steps-1):0,n)},setValue:function(e,t,n){this.setTargetValue([e,t||0]),n&&this.groupCopy(this.value.current,this.value.target)},startTap:function(e){this.disabled||(this.tapping=!0,this.setWrapperOffset(),this.setBounds(),void 0===e&&(e=[X.x-this.offset.wrapper[0]-this.handle.offsetWidth/2,X.y-this.offset.wrapper[1]-this.handle.offsetHeight/2]),this.setTargetOffset(e))},stopTap:function(){!this.disabled&&this.tapping&&(this.tapping=!1,this.setTargetValue(this.value.current),this.result())},startDrag:function(){this.disabled||(this.setWrapperOffset(),this.setBounds(),this.offset.mouse=[X.x-J.get(this.handle)[0],X.y-J.get(this.handle)[1]],this.dragging=!0)},stopDrag:function(){if(!this.disabled&&this.dragging){this.dragging=!1;var e=this.groupClone(this.value.current);if(this.slide){var t=this.change;e[0]+=4*t[0],e[1]+=4*t[1]}this.setTargetValue(e),this.result()}},feedback:function(){var e=this.value.current;this.snap&&this.steps>1&&(e=this.getClosestSteps(e)),this.groupCompare(e,this.value.prev)||("function"==typeof this.animationCallback&&this.animationCallback(e[0],e[1]),this.groupCopy(this.value.prev,e))},result:function(){"function"==typeof this.callback&&this.callback(this.value.target[0],this.value.target[1])},animate:function(e,t){if(!e||this.dragging){if(this.dragging){var n=this.groupClone(this.value.target),i=[X.x-this.offset.wrapper[0]-this.offset.mouse[0],X.y-this.offset.wrapper[1]-this.offset.mouse[1]];this.setTargetOffset(i,this.loose),this.change=[this.value.target[0]-n[0],this.value.target[1]-n[1]]}(this.dragging||t)&&this.groupCopy(this.value.current,this.value.target),(this.dragging||this.glide()||t)&&(this.update(),this.feedback())}},glide:function(){var e=[this.value.target[0]-this.value.current[0],this.value.target[1]-this.value.current[1]];return e[0]||e[1]?(Math.abs(e[0])>this.bounds.xStep||Math.abs(e[1])>this.bounds.yStep?(this.value.current[0]+=e[0]*this.speed,this.value.current[1]+=e[1]*this.speed):this.groupCopy(this.value.current,this.value.target),!0):!1},update:function(){this.snap?this.offset.current=this.getOffsetsByRatios(this.getClosestSteps(this.value.current)):this.offset.current=this.getOffsetsByRatios(this.value.current),this.show()},show:function(){this.groupCompare(this.offset.current,this.offset.prev)||(this.horizontal&&(this.handle.style.left=String(this.offset.current[0])+"px"),this.vertical&&(this.handle.style.top=String(this.offset.current[1])+"px"),this.groupCopy(this.offset.prev,this.offset.current))},setTargetValue:function(e,t){var n=t?this.getLooseValue(e):this.getProperValue(e);this.groupCopy(this.value.target,n),this.offset.target=this.getOffsetsByRatios(n)},setTargetOffset:function(e,t){var n=this.getRatiosByOffsets(e),i=t?this.getLooseValue(n):this.getProperValue(n);this.groupCopy(this.value.target,i),this.offset.target=this.getOffsetsByRatios(i)},getLooseValue:function(e){var t=this.getProperValue(e);return[t[0]+(e[0]-t[0])/4,t[1]+(e[1]-t[1])/4]},getProperValue:function(e){var t=this.groupClone(e);return t[0]=Math.max(t[0],0),t[1]=Math.max(t[1],0),t[0]=Math.min(t[0],1),t[1]=Math.min(t[1],1),(!this.dragging&&!this.tapping||this.snap)&&this.steps>1&&(t=this.getClosestSteps(t)),t},getRatiosByOffsets:function(e){return[this.getRatioByOffset(e[0],this.bounds.xRange,this.bounds.x0),this.getRatioByOffset(e[1],this.bounds.yRange,this.bounds.y0)]},getRatioByOffset:function(e,t,n){return t?(e-n)/t:0},getOffsetsByRatios:function(e){return[this.getOffsetByRatio(e[0],this.bounds.xRange,this.bounds.x0),this.getOffsetByRatio(e[1],this.bounds.yRange,this.bounds.y0)]},getOffsetByRatio:function(e,t,n){return Math.round(e*t)+n},getClosestSteps:function(e){return[this.getClosestStep(e[0]),this.getClosestStep(e[1])]},getClosestStep:function(e){for(var t=0,n=1,i=0;i<=this.steps-1;i++)Math.abs(this.stepRatios[i]-e)<n&&(n=Math.abs(this.stepRatios[i]-e),t=i);return this.stepRatios[t]},groupCompare:function(e,t){return e[0]==t[0]&&e[1]==t[1]},groupCopy:function(e,t){e[0]=t[0],e[1]=t[1]},groupClone:function(e){return[e[0],e[1]]},preventDefaults:function(e,t){e||(e=i.event),e.preventDefault&&e.preventDefault(),e.returnValue=!1,t&&document.selection&&document.selection.empty()},cancelEvent:function(e){e||(e=i.event),e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0
}}}(e,window,n),n}),define("spreadsheet/dataTableCellRenderers",["require","jquery","jqueryhandsontable"],function(require){var e=require("jquery"),t=require("jqueryhandsontable"),n=t.renderers.TextRenderer,i="#E5ECF2",r="#fff";return{high:function(t,r){n.apply(this,arguments),e(r).css("background",i)},normal:function(t,i){n.apply(this,arguments),e(i).css("background",r)}}}),define("spreadsheet/dataTableProcessor",["require","jquery","dt/lib","./dataTableCellRenderers","./helper","./constant"],function(require){var e=require("jquery"),t=require("dt/lib"),n=require("./dataTableCellRenderers"),i=require("./helper"),r=require("./constant"),o={};o.fillFromJSData=function(e){var t=e.getHTIns(),n=t.dtEditorData,i=e.getColCount(),r=e.getRowCount(),o=e(),a=e.getType();n.enlarge(i,r);for(var l=e.getSeriesInfo(a,i),u=0,c=o.length;c>u;u++)for(var f=o[u]||[],h=0,p=f.length;p>h;h++)s[a](h,u,f[h],l,e,n)},o.fillJSData=function(e){for(var n=e.getHTIns(),i=n.dtEditorData,o=[],s=i.getDataWindowSize(),l=e.getType(),u=e.getSeriesInfo(l,s.colCount),c=0;c<u.count;c++){for(var f=[],h=0;h<s.rowCount;h++){var p=a[l](h,c,u,e,i);f.push(p)}o.push(f)}e(o,t.valueInfoForConfirmed(r.UI_DATA_TABLE))},o.processCell=function(e,t,i,r){var o=t.getHTIns(),s=o.countCols(),a=t.getSeriesInfo(t.getType(),s);if(a.colStep>1)if(Math.floor(r/a.colStep)%2===0)e.renderer=n.high;else e.renderer=n.normal;else e.renderer=n.normal};var s={};s[r.JSDATA_DIM_ARRAY]=function(t,n,r,o,s,a){var l=n*o.colStep;if(e.isArray(r))for(var u=0,c=r.length;c>u;u++){var f=i.formatJSDataToEditorData(r[u],s,a);a.uncheckSet(t,u+l,f)}else{var f=i.formatJSDataToEditorData(r,s,a);a.uncheckSet(t,l,f)}},s[r.JSDATA_ARRAY_OBJECT]=function(e,t,n,r,o,s){for(var a=t*r.colStep,l=o.getPropertyMetas(),u=0,c=l.length;c>u;u++){var f=l[u],h=i.formatJSDataToEditorData(n[f.propertyName],o,s);s.uncheckSet(e,a,h)}};var a={};return a[r.JSDATA_DIM_ARRAY]=function(e,t,n,r,o){var s,a=t*n.colStep,l=r.getItemDataType();if(2===n.seriesDim){s=[];for(var u=0;u<n.colStep;u++){var c=o.get(e,u+a,l);c=i.formatEditorDataToJSData(c,r,o),s.push(c)}}else s=i.formatEditorDataToJSData(o.get(e,a,l),r,o);return s},a[r.JSDATA_ARRAY_OBJECT]=function(e,t,n,r,o){for(var s=t*n.colStep,a=r.getPropertyMetas(),l={},u=0,c=a.length;c>u;u++){var f=a[u],h=o.get(e,u+s,f.itemDataType);h=i.formatEditorDataToJSData(h,r,o),l[f.propertyName]=h}return l},o}),define("spreadsheet/codeInputsProcessor",["require","jquery","dt/lib","./helper","./lang","./constant"],function(require){var e=require("jquery"),t=require("dt/lib"),n=require("./helper"),i=require("./lang"),r=require("./constant"),o={};return o.fillFromJSData=function(e){function n(n,i){if(t.checkValueInfoForConfirmed(i))e.fillJSDataByCodeInputs()}var r=e(),s=e.getCodeInputsListViewModels(),a=e.getType();s.removeAll();for(var l=[],u=0,c=r.length;c>u;u++){var f=t.stringifyJSObject(r[u],e.getCodeStringifyParam()),h=t.ob(f),p=e.getColDescBySeries(u,a),d=p.single?p.start:p.start+" - "+p.end,g=t.strTemplate(i.codeInputTitle,{rangeDesc:d});l.push({codeTextOb:h,title:g}),h.subscribe(n,o)}l.length&&s.pushArray(l)},o.fillJSData=function(i){for(var o=[],s=i.getCodeInputsListViewModels()(),a=i.getColCount(),l=i.getType(),u=i.getSeriesInfo(l,a),c=0,f=s.length;f>c;c++){for(var h=n.parseToArray(s[c].codeTextOb(),!0)||[],p=[],d=0,g=h.length;g>d;d++){var v,m=h[d];if(l===r.JSDATA_DIM_ARRAY)v=2===u.seriesDim?!e.isArray(m)?[]:m:m;else v=e.isPlainObject(m)?m:{};p.push(v)}o.push(p)}i(o,t.valueInfoForConfirmed(r.UI_CODE_INPUTS))},o}),define("spreadsheet/jsDataFactory",["require","jquery","dt/lib","./helper","./constant","./dataTableProcessor","./codeInputsProcessor"],function(require){function e(e){var t=this._dataMeta||(this._dataMeta={});if(null!=t)i.merge(t,e,{clone:!0});if(!t.propertyMetas)t.propertyMetas=[];if(!t.itemDataType)t.itemDataType="auto";if(!t.hasOwnProperty("emptyValue"))t.emptyValue=o.EC_EMPTY_VALUE;this.setCodeInfo()}function t(e,t){return i.throttle(i.curry(e,t),o.JSDATA_UPDATE_DELAY,!0,!0)}var n=require("jquery"),i=require("dt/lib"),r=require("./helper"),o=require("./constant"),s=require("./dataTableProcessor"),a=require("./codeInputsProcessor"),l={};l.create=function(){var e=i.ob([]);return i.assign(e,u),e.setType(o.JSDATA_DIM_ARRAY,null,!0),e.fillJSDataByDataTable=t(s.fillJSData,e),e.fillJSDataByCodeInputs=t(a.fillJSData,e),e};var u=[];u.getType=function(){return this._type},u.setType=function(t,n,i){return this._type=t,e.call(this,n),!i&&this([]),this},u.fillJSDataByDataTable=n.noop,u.fillJSDataByCodeInputs=n.noop,u.bindDataTable=function(e){function t(t,n){if(!i.checkValueInfoForConfirmed(n,o.UI_TABLE_DATA))s.fillFromJSData(n),e.render()}this._htIns=e,this.subscribe(t,this)},u.bindCodeInputs=function(e){function t(e,t){if(!i.checkValueInfoForConfirmed(t,o.UI_CODE_INPUTS))a.fillFromJSData(t)}this._codeInputsListViewModels=e,this.subscribe(t,this)},u.getHTIns=function(){return this._htIns},u.getCodeInputsListViewModels=function(){return this._codeInputsListViewModels},u.getEmptyValue=function(){return this._dataMeta.emptyValue},u.setEmptyValue=function(e){this._dataMeta.emptyValue=e},u.setCodeInfo=function(e){if(null==e)this._dataMeta.codeInfo={quotationMark:"'",indentBase:4,compress:!1};i.assign(this._dataMeta.codeInfo,e,["quotationMark","indentBase","compress"])},u.getCodeStringifyParam=function(){return i.assign({errorMessage:"Error: illegal data!",singleLineDepth:2===this.getSeriesDim()?1:null},this._dataMeta.codeInfo)},u.getDimColStep=function(){return this._dataMeta.dimColStep},u.setDimColStep=function(e){return this._dataMeta.dimColStep=e,this},u.getItemDataType=function(){return this._dataMeta.itemDataType},u.setItemDataType=function(e){this._dataMeta.itemDataType=e},u.getSeriesInfo=function(e,t){if(null==t)t=this.getColCount();var n,r,s=this.getDimColStep();if(e===o.JSDATA_DIM_ARRAY)if("max"===s)r=t,n=t?1:0;else if(s)r=s,n=Math.ceil(t/r);else n=t,r=1;else if(e===o.JSDATA_ARRAY_OBJECT){var a=this.getPropertyMetas();r=a.length,n=Math.ceil(t/r)}else i.assert(!1,"MUST input jsDataType!");return{count:n,colStep:r,seriesDim:this.getSeriesDim()}},u.getSeriesDim=function(){return this.getType()===o.JSDATA_ARRAY_OBJECT?2:this.getDimColStep()?2:1},u.getPropertyMetas=function(){return i.clone(this._dataMeta.propertyMetas)},u.setPropertyMetas=function(e){for(var t=this._dataMeta.propertyMetas,n=0,r=e.length;r>n;n++){var o=t[n]||(t[n]={propertyName:"",itemDataType:"auto"});i.assign(o,e[n])}t.splice(n,t.length-n)},u.getRowCount=function(e){for(var t=0,n=this(),i=0,r=n.length;r>i;i++){var o=n[i]||[];if(t<o.length)t=o.length}if(null==e)e=2;return t+e},u.getColCount=function(e){var t=0,n=this.getSeriesDim(),i=this();if(1===n)t=i.length;else{var r=this.getDimColStep();t="max"===r?c[this.getType()](i):i.length*r}if(null==e)e=2;return t+e},u.getColDescBySeries=function(e,t){var n=this.getSeriesInfo(t),i=e*n.colStep,r=i+n.colStep-1;return{start:this.getColDesc(i),end:this.getColDesc(r),single:i===r}},u.getColDescInSeries=function(e,t,n){var i=this.getSeriesInfo(n);t%=i.colStep;for(var r=[],o=0,s=e.length;s>o;o++){var a=e[o]*i.colStep;r.push(this.getColDesc(a+t))}return r},u.getColDesc=function(e){return this._htIns.getColHeader(e)};var c={};return c[o.JSDATA_DIM_ARRAY]=function(e){for(var t=0,n=e[0]||[],i=0,r=n.length;r>i;i++){var o=n[i]||[];if(t<o.length)t=o.length}return t},c[o.JSDATA_ARRAY_OBJECT]=function(e){for(var t=0,n=e[0]||[],i=0,o=n.length;o>i;i++){var s=n[i]||{},a=r.objectPropertyCount(s);if(a>t)t=a}return t},l}),define("common/lang",["require","jquery"],function(require){var e=require("jquery"),t={langCode:"cn",feedback:{trigger:"意见反馈",title:"意见反馈",issueTips:"任何意见建议，请告诉我们",issuePlaceholder:"欢迎提出问题或宝贵建议（400字以内），感谢您的支持。",emailTips:"联系方式（选填）",emailPlaceholder:"欢迎留下您的邮箱或QQ，便于我们的沟通",cutFileTips:"可以上传问题图片，图片大小不超过3M",submitButton:"提交反馈",required:"（*必填）"}},n={langCode:"en",feedback:{trigger:"Feedback",title:"Feedback",issueTips:"Please feel free to contact us for any suggestions or questions.",issuePlaceholder:"Please describe your suggestions or questions here (within 400 charaters).",emailTips:"Contact Infomation (optional)",emailPlaceholder:"Please leave your email here.",cutFileTips:"Upload an image (less than 3MB)",submitButton:"Submit",required:" (*required)"}};return"en"===e("html").attr("lang").toLowerCase()?n:t}),define("common/feedback",["require","jquery","./lang"],function(require){function e(){var e=window.bds;if(e&&e.qa&&e.qa.ShortCut&&e.qa.ShortCut.initRightBar){var n={product_id:s,plugintitle:o.title,issueTips:o.issueTips,issuePlaceholder:o.issuePlaceholder,emailTips:o.emailTips,emailPlaceholder:o.emailPlaceholder,cutFileTips:o.cutFileTips,needIssueTips:!0,needIssue:!0,needCut:!0,needEmail:!0,needGuide:!1,showPosition:"right",onlyUpFile:!0},r={product_id:s,username:"(page: ecwww"+(i?"-"+i:"")+")"};e.qa.ShortCut._getProData(r),e.qa.ShortCut.initRightBar(n),t()}}function t(){r("#fb_baidu_right_dialog #fb_right_post_save").html(o.submitButton),r("#fb_baidu_right_dialog .fb-danger-tips").each(function(e,t){if(t.innerHTML.indexOf("必填")>=0)t.innerHTML=o.required})}function n(){var t=window.bds;if(t&&t.qa&&t.qa.ShortCut)e();else r.getScript(a).done(e);return!1}var i,r=require("jquery"),o=require("./lang").feedback,s=101,a="http://f3.baidu.com/feedback/js/feedback/feedback0.0.2.js",l={init:function(e){i=e,r('<div class="ec-feedback"><i>?</i>'+o.trigger+"</div>").appendTo(document.body).on("click",n)}};return l}),define("dt/ui/Text",["require","../lib","./Component"],function(require){var e=require("../lib"),t=require("./Component"),n=t.extend({_define:{css:"dtui-tx",viewModel:function(){return{value:e.ob(""),encodeHTML:e.ob(!0)}},viewModelPublic:["value","encodeHTML"]},_init:function(){function t(){var t=i();if(r())t=e.encodeHTML(this._stringify(t));this.el().innerHTML=t}var n=this._viewModel(),i=n.value,r=n.encodeHTML;n.value.subscribe(t,this),n.encodeHTML.subscribe(t,this),t.call(this)},_stringify:function(e){if(null==e)return"";else return String(e)},_dispose:function(){this.$el().html("")}});return n}),define("dt/ui/TextInput",["require","jquery","../lib","./Component"],function(require){var e=require("jquery"),t=require("../lib"),n=require("./Component"),i=n.extend({_define:{css:"dtui-txipt",viewModel:function(){return{value:t.ob(""),mouseEnterSelect:!1,type:"text",placeholder:t.ob(""),alert:t.ob(!1),confirmPoint:{pressEnter:!0,blur:!0}}},viewModelPublic:["value","placeholder","text","mouseEnterSelect","type","alert"]},_init:function(){var n=this._viewModel(),i=n.type=n.type||"text",r=this.$el();r.addClass(this.getFullCss("textarea"===i?"-type-textarea":"-type-text").join(" "));var o=""+("textarea"===i?"<textarea></textarea>":'<input type="text"/>')+'<span class="'+this.getFullCss("-alert-mark").join(" ")+'" style="display:none"></span><span class="'+this.getFullCss("-alert-text").join(" ")+'" style="display:none"></span>';this._$input=e(r.html(o)[0].firstChild),this._$input.on(this._event("mouseenter"),function(){if(t.peek(n.mouseEnterSelect))this.select&&this.select()}),this._initAlert(),this._initPlaceHolder(),this._initViewUpdater(),this._initModelUpdater()},focus:function(){this._$input.focus()},select:function(){this._$input.select()},_initAlert:function(){function n(n){var i=this.$el(),r=this.getFullCss("-alert").join(" ");if(n){if(i.addClass(r),"string"===e.type(n))u[0].innerHTML=t.encodeHTML(n),l.show()}else i.removeClass(r),l.hide()}function i(){u.show()}function r(){u.hide()}var o=this.$el(),s=this.getFullCss("-alert-mark"),a=this.getFullCss("-alert-text"),l=this.$el("alertMark",o.find("."+s[s.length-1])),u=this.$el("alertText",o.find("."+a[a.length-1]));l.on(this._event("mouseenter"),i),l.on(this._event("mouseleave"),r),this._disposable(this._viewModel().alert.subscribe(n,this))},_initPlaceHolder:function(){function e(e){this._$input.attr("placeholder",e)}var n=this._viewModel().placeholder;if("ob"===t.obTypeOf(n))n.subscribe(e,this),e.call(this,n());else if(null!=n)e.call(this,n)},_initViewUpdater:function(){function e(e){n.val(e)}var t=this._viewModel(),n=this._$input;this._disposable(t.disabled.subscribe(function(e){n[0].disabled=!!e},this)),this._disposable(t.value.subscribe(e,this)),e(t.value())},_initModelUpdater:function(){function e(e){if(!s.isDisabled())if("text"===i.type&&13===e.which)n(),e.preventDefault()}function n(){if(!s.isDisabled())i.value(o.val(),t.valueInfoForConfirmed(r),{force:!0}),o.val(i.value())}var i=this._viewModel(),r=this.uid(),o=this._$input,s=this,a=i.confirmPoint||{};if(a.blur)o.on(this._event("blur"),n);if(a.pressEnter)o.on(this._event("keypress"),e)},_dispose:function(){this._$input.off(this._event()),this._$input=null,this.$el().html("")}});return i}),define("dt/ui/CheckButton",["require","jquery","../lib","./Component"],function(require){var e=require("jquery"),t=require("../lib"),n=require("./Component"),i=t.encodeHTML,r="value-index",o=n.extend({_define:{css:"dtui-chkbtn",viewModel:function(){return{checked:t.ob(),dataList:[]}},viewModelPublic:["checked"]},getDataItem:function(n){var i=this._viewModel().dataList,r=t.arrayIndexOf(i,n,"value");return r>=0?e.extend({},i[r]):null},_init:function(){t.assert(t.obTypeOf(this._viewModel().checked)),this._initContent(),this._initTooltip(),this._initChange(),this._initMouse()},_getItemCss:function(e){var t={"":"-i",hover:"-i-hover",active:"-i-active"}[e||""];return this.css()+t},_initContent:function(){for(var e,t=this._viewModel().dataList,n=this._getItemCss(),o=[],s=0;e=t[s];s++)o.push('<span class="',n,'" data-',r,'="',s,'">',i(e.text),"</span>");this.el().innerHTML=o.join("")},_initTooltip:function(){function n(t){var n=o[e(t).data(r)],s=n.tooltip;if(null!=s)return n.tooltipEncodeHTML!==!1?i(s):s;else return void 0}var o=this._viewModel().dataList,s={x:0,y:-15,xAnchor:"center",yAnchor:"bottom"};this._disposable(t.bindTooltip({bindEl:this.el(),followMouse:!0,selector:"."+this._getItemCss(),location:s,text:n,encodeHTML:!1}))},_initChange:function(){function n(n){var a=t.obTypeOf(i.checked);o.each(function(){var o=e(this),l=i.dataList[o.data(r)].value;o[("obArray"===a?t.arrayIndexOf(n,l)>=0:l===n)?"addClass":"removeClass"](s)})}var i=this._viewModel(),o=this.$el().find("."+this._getItemCss()),s=this._getItemCss("active");this._disposable(t.obSubscribe(i.checked,n)),n(i.checked())},_initMouse:function(){function n(){if(!a.disabled())e(this).addClass(u)}function i(){e(this).removeClass(u)}function o(){if(!a.disabled()){var n=a.dataList[e(this).data(r)],i=n.value;if("obArray"===t.obTypeOf(a.checked)){var o=a.checked(),s=t.arrayIndexOf(o,i);if(s>=0)o.splice(s,1);else o.push(i);i=o}a.checked(i,t.valueInfoForConfirmed(c,{dataItem:n}))}}var s=this.$el(),a=this._viewModel(),l=this._getItemCss(),u=this._getItemCss("hover"),c=this.uid();s.on(this._event("mouseenter"),"."+l,n),s.on(this._event("mouseleave"),"."+l,i),s.on(this._event("click"),"."+l,o)}});return o}),define("dt/ui/TreeList",["require","jquery","../lib","./Component"],function(require){function e(e){return e}function t(e){return null!=e?e:""}var n,i=require("jquery"),r=require("../lib"),o=require("./Component"),s=r.encodeHTML,a="data-item-path",l="data-item-level",u="data-item-encode-html",c=500,f=o.extend({_define:{css:"dtui-treelist",viewModel:function(){return{selected:r.ob(),enhanceSelected:!0,hovered:r.ob(),enhanceHovered:!0,highlighted:r.obArray(),enhanceHighlighted:!0,datasource:[],resizeEvent:r.ob()}},viewModelPublic:["selected","hovered","highlighted","resizeEvent"]},_init:function(){var e=this._viewModel();r.assert(r.obTypeOf(e.selected)),r.assert("obArray"===r.obTypeOf(e.highlighted)),this._enhanceOb(),this._initContent(),this._initTooltip(),this._initChange(),this._initMouse(),this._initExpand()},_enhanceOb:function(){var e=this._viewModel();if(e.enhanceSelected){var t=e.selected;t.getTreeDataItem=i.proxy(this.findDataItemByOb,this,t)}if(e.enhanceHighlighted){var n=e.highlighted;n.getTreeDataItem=i.proxy(this.findDataItemByOb,this,n)}if(e.enhanceHovered){var r=e.hovered;r.getTreeDataItem=i.proxy(this.findDataItemByOb,this,r)}},_getCss:function(e){var t={item:"-i",thumb:"-thumb",text:"-text",textActive:"-text-active",textHover:"-text-hover",textHighlight:"-text-highlight",list:"-list",parent:"-parent",collapsed:"-collapsed",expanded:"-expanded",post:"-post"}[e||""];return this.css()+t},_initContent:function(){var n=this._getCss("item"),i=this._getCss("parent"),r=this._getCss("thumb"),o=this._getCss("collapsed"),c=this._getCss("text"),f=this._getCss("list"),h=this._getCss("post"),p=[];this._travelData(this._viewModel().datasource,{preList:function(e,t){var n=""===t?"":"display:none";p.push('<ul class="',f,'" style="',n,'">')},postList:function(){p.push("</ul>")},preChildren:function(f,h,d,g,v){var m=f.children&&f.children.length?i+" "+o:"",y=" "+a+'="'+h+'" ',b=" "+l+'="'+v+'" ',w=" "+u+'="'+(f.itemEncodeHTML!==!1?"1":"0")+'" ',C=f.anchor?' name="'+f.anchor+'" ':" ",_=f.itemEncodeHTML!==!1?s:e,S=_(t(f.text)),T=_(t(f.childrenPre)),E=_(t(f.childrenPost)),x=_(t(f.childrenBrief));p.push('<li class="',n," ",m,'" ',y,b,w,">",'<i class="',r,'"></i>',C,"<span ",' class="',c,'" ',y,">",S,T,x,E,"</span>")},postChildren:function(t,n,i,r){p.push("</li>");var o=t.itemEncodeHTML!==!1?s:e;if(r&&i&&i.childrenPost)p.push('<li class="',h,'">',o(i.childrenPost),"</li>")}}),this.el().innerHTML=p.join("")},_initTooltip:function(){function e(e){if(!o.isFrozen()){var n=o._findDataItemByPath(t,i(e).attr(a)),r=(n||{}).tooltip;if(null!=r)return n.tooltipEncodeHTML!==!1?s(r):r;else return void 0}}var t=this._viewModel().datasource,n={x:0,y:-15,xAnchor:"center",yAnchor:"bottom"},o=this;this._disposable(r.bindTooltip({bindEl:this.el(),followMouse:!0,selector:"."+this._getCss("text"),location:n,text:e,encodeHTML:!1}))},_initChange:function(){var e=this._viewModel(),t=e.selected;this._disposable(t.subscribe(this._updateSelectedByModel,this)),this._updateSelectedByModel(t(),t);var n=e.highlighted;this._disposable(n.subscribe(this._updateHighlightedByModel,this)),this._updateHighlightedByModel(n(),n)},_initMouse:function(){function e(){if(!d.isFrozen()){var e=i(this);e.addClass(f);var t=d._findDataItemByPath(u.datasource,e.attr(a),!0);u.hovered(t.value,{dataItem:t})}}function t(){if(!d.isFrozen())i(this).removeClass(f),u.hovered(n)}function o(){if(!d.isFrozen()){var e=r.obTypeOf(u.selected),t=d._findDataItemByPath(u.datasource,i(this).attr(a),!0),n=t.value;if("obArray"===e){var o=u.selected(),s=r.arrayIndexOf(o,n);if(s>=0)o.splice(s,1);else o.push(n);n=o}u.selected(n,{preventExpand:!0,dataItem:t})}}function s(){if(!d.isFrozen())d._toggleSingleItem(d._findItemEl(i(this)))}var l=this.$el(),u=this._viewModel(),c=this._getCss("item"),f=this._getCss("textHover"),h=this._getCss("text"),p=this._getCss("thumb"),d=this;l.on(this._event("mouseenter"),"."+h,"."+c,e),l.on(this._event("mouseleave"),"."+h,"."+c,t),l.on(this._event("click"),"."+h,o),l.on(this._event("click"),"."+p,s)},_initExpand:function(){var e=this,t=this._viewModel().datasource,n=this.$el().find("."+this._getCss("item")).filter(function(){return!!e._findDataItemByPath(t,i(this).attr(a)).expanded});this._expandOrCollapse(n,"expand",{noAnimation:!0})},_updateSelectedByModel:function(e,t){var n=this._viewModel(),o=r.obTypeOf(n.selected),s=this._getCss("textActive"),a=[],l=this;r.assert("obArray"!==o||i.isArray(e)),this._travelItemText(function(n,i){if("obArray"===o?r.arrayIndexOf(e,i)>=0:i===e){if(n.addClass(s),!t.peekValueInfo("preventExpand"))a.push(l._findItemEl(n))}else n.removeClass(s)}),this._showItems(i(a),{noAnimation:t.peekValueInfo("noAnimation"),collapseLevel:t.peekValueInfo("collapseLevel"),always:t.peekValueInfo("always"),scrollToTarget:t.peekValueInfo("scrollToTarget")})},_updateHighlightedByModel:function(e,t){var n=this._getCss("textHighlight"),o=[],s=this;this._travelItemText(function(i,a){if(r.arrayIndexOf(e,a)>=0){if(i.addClass(n),!t.peekValueInfo("preventExpand"))o.push(s._findItemEl(i))}else i.removeClass(n)}),this._showItems(i(o),{noAnimation:t.peekValueInfo("noAnimation"),collapseLevel:t.peekValueInfo("collapseLevel"),always:t.peekValueInfo("always"),scrollToTarget:t.peekValueInfo("scrollToTarget")})},_showItems:function(e,t){function n(){if(!this.isDisposed())this._expandOrCollapse(o,"expand",{noAnimation:t.noAnimation,always:i.proxy(r,this)})}function r(){if(!this.isDisposed()){var n=i(e[0]),r=t.scrollToTarget;if(r&&n.length)i("html,body").animate({scrollTop:n.offset().top-(r.clientX||30)});t.always&&t.always()}}t=t||{};var o=this._getAncestorItems(e);this._collapseAll({collapseLevel:t.collapseLevel,noAnimation:t.noAnimation,always:i.proxy(n,this)})},_getAncestorItems:function(e){var t=this,n=[];return e.each(function(){for(var e=i(this),r=t.css(),o=t._getCss("item"),s=e.parent();s&&s.length&&!s.hasClass(r);){if(s.hasClass(o))n.push(s[0]);s=s.parent()}}),i(n)},_getParentItem:function(e){return e.parent().closest("."+this._getCss("item"))},_travelItemText:function(e){var t=this._viewModel(),n=this.$el().find("."+this._getCss("text")),r=this;n.each(function(){var n=i(this),o=r._findDataItemByPath(t.datasource,n.attr(a)).value;e.call(r,n,o)})},_collapseAll:function(e){function t(){!r.isDisposed()&&e.always&&e.always()}var n=e.collapseLevel,r=this;if(null==n||0>n)setTimeout(t,0);else{var o="."+this._getCss("item"),s=this.$el().find(o).filter(function(){return i(this).attr(l)>=n});this._expandOrCollapse(s,"collapse",{noAnimation:e.noAnimation,always:t})}},_expandOrCollapse:function(e,t,n){function r(e){if(!d.isDisposed())d._findElInItem(i(v.withAnimation),"list")[u](n.noAnimation?0:c).promise().always(e)}function o(e){if(!d.isDisposed())d._findElInItem(i(v.withoutAnimation),"list")[u](0).promise().always(e)}function s(){if(!d.isDisposed()){if("collapse"===t)d._resetItemText(g);p.resizeEvent({}),n.always&&n.always()}}n=n||{};var a,l,u,f=this._getCss("collapsed"),h=this._getCss("expanded"),p=this._viewModel(),d=this;if("expand"===t)a=f,l=h,u="slideDown";else a=h,l=f,u="slideUp";var g=e.filter("."+a),v={withAnimation:[],withoutAnimation:[]};if(g.each(function(){if(d._getParentItem(i(this)).hasClass(h))v.withAnimation.push(this);else v.withoutAnimation.push(this)}),g.removeClass(a).addClass(l),"expand"===t)this._resetItemText(g);if("expand"===t)o(i.proxy(r,this,s));else r(i.proxy(o,this,s))},_toggleSingleItem:function(e){function t(t){if(!this.isDisposed())t&&this._resetItemText(e),o.resizeEvent({})}var n=this._getCss("collapsed"),r=this._getCss("expanded"),o=this._viewModel(),s=this._findElInItem(e,"list");if(e.hasClass(n))e.removeClass(n).addClass(r),s.slideDown(c,i.proxy(t,this,!1)),this._resetItemText(e);else if(e.hasClass(r))e.removeClass(r).addClass(n),s.slideUp(c,i.proxy(t,this,!0))},hasValue:function(e){function t(t){if(t.value===e)n=!0}var n=!1;return this._travelData(this._viewModel().datasource,{preChildren:t}),n},findDataItemByOb:function(e,t){var n="obArray"===r.obTypeOf(e)?e():[e()];return this.findDataItemByValues(n,t)},findDataItemByValues:function(e,t){function n(t){if(r.arrayIndexOf(e,t.value)>=0)i.push(r.assign({},t))}var i=[];return this._travelData(this._viewModel().datasource,{preChildren:n}),t?i[0]:i},travelData:function(e){return this._travelData(this._viewModel().datasource,e)},_travelData:function(e,t,n,i,r){if(n=null==n||""===n?"":n+",",null==r&&(r=0),e&&e.length){t.preList&&t.preList(e,n,i);for(var o=0,s=e.length;s>o;o++){var a=e[o],l=n+o,u=o===s-1;t.preChildren&&t.preChildren(a,l,i,u,r),this._travelData(a.children,t,l,a,r+1),t.postChildren&&t.postChildren(a,l,i,u,r)}t.postList&&t.postList(e,n,i)}},_findDataItemByPath:function(e,t,n){t=t.split(","),e=e||[];for(var i,o=0,s=t.length;s>o&&e;o++)i=e[t[o]],e=(i||{}).children;return n?r.assign({},i,null,["children"]):i},_findItemEl:function(e){for(var t=this.css(),n=this._getCss("item");!e.hasClass(n);){if(e.hasClass(t))return null;e=e.parent()}return e},_findElInItem:function(e,t){return e.find("> ."+this._getCss(t))},_resetItemText:function(n){var r=this,o=this._viewModel().datasource;n.each(function(){var n=i(this),l=r._findDataItemByPath(o,n.attr(a)),c="0"===n.attr(u)?e:s,f=r._findElInItem(n,"text");if(n.hasClass(r._getCss("collapsed")))f[0].innerHTML=c([t(l.text),t(l.childrenPre),t(l.childrenBrief),t(l.childrenPost)].join(""));else if(n.hasClass(r._getCss("expanded")))f[0].innerHTML=c([t(l.text),t(l.childrenPre)].join(""))})}});return f}),define("dt/config",["require"],function(){function e(e){if(n.hasOwnProperty(e))return n[e];else if(i[t].hasOwnProperty(e))return i[t][e]}var t="cn",n={panelBaseZIndex:9e5,panelMastOpacity:.7,winPanelAnimationDuration:300},i={cn:{langDialogConfirm:"确定",langDialogYes:"是",langDialogNo:"否",langDialogSave:"保存",langDialogDontSave:"不保存",langDialogCancel:"取消",langDialogSaveFail:"保存失败",langDialogRemove:"删除",langDialogConfirmRemove:"您确认要删除吗？一旦删除，不可恢复。"},en:{langDialogConfirm:"OK",langDialogYes:"Yes",langDialogNo:"No",langDialogSave:"Save",langDialogDontSave:"Don't Save",langDialogCancel:"Cancel",langDialogSaveFail:"Save Failed.",langDialogRemove:"Delete",langDialogConfirmRemove:"Confirm Deleting? Can not be restored when deleted."}};return e.setLang=function(e){e=e},e}),define("dt/ui/BasePanel",["require","jquery","../lib","./Component"],function(require){function e(e){o(this)[a]=e}function t(e){return~i.arrayIndexOf(e,this.getPanelState())}var n=require("jquery"),i=require("../lib"),r=require("./Component"),o=i.makeInner(),s=o.attach(r.extend({_define:{viewModel:function(){return{panelOpenStatus:null}},viewModelPublic:["panelOpenStatus"]},PanelState:{NONE:"NONE",CREATED:"CREATED",READY:"READY",DATA_FILLED:"DATA_FILLED",DISPOSED:"DISPOSED"},getPanelState:function(){return o(this)[a]},_construct:function(){e.call(this,this.PanelState.NONE);var t=this._applySuper("_construct",arguments);return e.call(this,this.PanelState.CREATED),t},dispose:function(){var t=this._applySuper("dispose",arguments);return e.call(this,this.PanelState.DISPOSED),t},enter:function(t){if(!this.isOpened())return!1;if(this.getPanelState()===this.PanelState.CREATED)this._fillContent(t),e.call(this,this.PanelState.READY);this._enter(t),e.call(this,this.PanelState.DATA_FILLED)},_fillContent:n.noop,_enter:n.noop,clear:function(){if(t.call(this,[this.PanelState.DATA_FILLED,this.PanelState.READY]))this._clear(),e.call(this,this.PanelState.READY)},_clear:n.noop,isOpened:function(){var e=this._viewModel().panelOpenStatus;return e?"opened"===e():!0}})),a="__panelState__"+s.uid;return s}),define("tpl",["require","exports","module","etpl"],function(require,exports,module){var e=require("etpl");return{load:function(t,n,i){var r=n.toUrl(t),o=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");o.open("GET",r,!0),o.onreadystatechange=function(){if(4===o.readyState){if(o.status>=200&&o.status<300){var t=o.responseText,n=module.config();if("undefined"==typeof n.autoCompile||n.autoCompile)e.compile(t);i(t)}o.onreadystatechange=new Function,o=null}},o.send(null)}}}),define("dt/tplLoader",["tpl"],function(e){return e}),define("dt/ui/WinPanel",["require","jquery","../lib","../config","./BasePanel","tpl!./ui.tpl.html"],function(require){var e,t=require("jquery"),n=require("../lib"),i=require("../config"),r=require("./BasePanel"),o=n.makeInner(),s="winPanel",a=".dtui-close-cross",l=".dtui-winpn-con",u="winpn",c=o.attach(r.extend({_define:{tpl:require("tpl!./ui.tpl.html"),tplTarget:"winPanel",closeWhenClickOther:!1},_init:function(){function n(){if(!this._onCloseBtnClick||this._onCloseBtnClick()!==!1)this.close()}var r=t(this._renderTpl(s)).appendTo(document.body).hide();if(null==e)e=i("panelBaseZIndex");this._manuInitView(r);var u=o(this);u.mainEl=r,u.isOpen=!1,this.$el("winPanel$content",r.find(l)),u.maskKey=Math.random()+"",r.on(this._event("click"),a,t.proxy(n,this)),this._afterInit(this.$content())},_disposeFinally:function(){var e=o(this);n.disposeGlobalMask(e.maskKey),e.mainEl.remove(),e.mainEl=null},open:function(r){function s(){if(this._getDefineProperty("closeWhenClickOther"))this.close()}if(!this.isOpen()){var a=this.$el(),l=this.$content(),c=o(this);n.globalMask(i("panelMastOpacity"),c.maskKey,u,{click:t.proxy(s,this)}),c.isOpen=!0,this._beforeShow(l,r),a.show(),this._afterShow(l,r),a.css({top:0-Math.round(a.outerHeight()),marginLeft:0-Math.round(a.outerWidth()/2),marginTop:0,"z-index":e++});var f=this._getDefineProperty("noAnimate");a.animate({top:"50%",marginTop:0-Math.round(a.outerHeight()/2)},f?0:i("winPanelAnimationDuration"))}},close:function(){if(this.isOpen()){var e=this.$el(),t=o(this);t.isOpen=!1,this._beforeHide(this.$content());var r=this,s=this._getDefineProperty("noAnimate");e.animate({top:0-Math.round(e.outerHeight()),marginTop:0},s?0:i("winPanelAnimationDuration"),"swing",function(){e.hide(),n.globalMask(!1,t.maskKey),r._afterHide(r.$content()),r.fire("close")})}},$content:function(){return this.$el("winPanel$content")},isOpen:function(){return o(this).isOpen},_afterInit:t.noop,_beforeShow:t.noop,_afterShow:t.noop,_beforeHide:t.noop,_afterHide:t.noop,_onCloseBtnClick:t.noop}));return c}),define("dt/ui/Button",["require","jquery","./Component","../lib"],function(require){var e=require("jquery"),t=require("./Component"),n=require("../lib"),i="dtui-btn",r=["click","mouseenter","mouseleave"],o=t.extend({_define:{viewModel:function(){return{text:n.ob(""),dontEncodeHTML:!1}},viewModelPublic:["text"],css:i},_init:function(){function t(){if(!l.disabled())if(u.addClass(f),p)u.addClass(h)}function i(){u.removeClass(f),u.removeClass(h)}function o(){if(!l.disabled())u.addClass(h),p=!0,d.one(c._event("mouseup"),function(){p=!1})}function s(){u.removeClass(h)}function a(e){u.html(l.dontEncodeHTML?e:n.encodeHTML(e))}var l=this._viewModel(),u=this.$el(),c=this,f=this.getFullCss("-hover").join(" "),h=this.getFullCss("-active").join(" "),p=!1,d=e(document);this._eventHandlerMap={},u.on(this._event("mouseenter"),t),u.on(this._event("mouseleave"),i),u.on(this._event("mousedown"),o),u.on(this._event("mouseup"),s);var g=this;if(e.each(r,function(e,t){u.on(g._event(t),function(e){g.trigger.call(g,t,e)})}),"ob"===n.obTypeOf(l.text))this._disposable(l.text.subscribe(a,this));var v=n.value(l.text);u.html(l.dontEncodeHTML?v:n.encodeHTML(v))},_parseViewModel:function(e,t){if(null!=t.text)e.text=t.text;if(null!=t.css)e.css=t.css;if(null!=t.dontEncodeHTML)e.dontEncodeHTML=t.dontEncodeHTML;return e},on:function(t,i){n.assert(t.indexOf(".")<0);var o=this._eventHandlerMap;if(e.inArray(t,r)>=0)o[t]=o[t]||[],o[t].push(i)},trigger:function(t,n){var i=this._viewModel(),r=this._eventHandlerMap[t];if(!i.disabled())if(r&&r.length)e.each(r,function(t,i){if(e.isFunction(i))i.call(this,n)})},_dispose:function(){this.$el().off(),this._eventHandlerMap=null}});return o}),define("dt/ui/Foreach",["require","jquery","../lib","./Component"],function(require){function e(e){h[e.key].call(this,e)}function t(e,t){for(var n=this._items(),i=this._getCommonConfig("itemTplTarget"),a=this._getCommonConfig("itemTplParam"),l=this._getCommonConfig("itemType"),u=l?this.getCptClass(l):this.Item,c=0,f=t.length;f>c;c++){var h=t[c],p=this.getCptDef("itemConfigAttr");if(p&&h){var d=h[p];d.itemType&&(u=this.getCptClass(d.itemType)),d.itemTplTarget&&(i=d.itemTplTarget),d.itemTplParam&&(a=d.itemTplParam)}var g=o(i?this._renderTpl(i,o.extend({index:e+c,itemTplParam:a},h)):"<div></div>");s.assert(1===g.length,"MUST be only one root element in item tpl!"),r.call(this,g,e+c);var v=new u(g,h);n.splice(e+c,0,v)}}function n(e,t){for(var n=this._items(),i=n.splice(e,t),r=0,o=i.length;o>r;r++){var s=i[r],a=s.$el();s.dispose(),a.remove()}}function i(e,t){var n=this._items(),i=n[e],r=i.$el(),o=n[t].$el();if(t>e)r.insertAfter(o);else r.insertBefore(o);n.splice(e,1)[0],n.splice(t,0,i)}function r(e,t){var n=this._items();if(!n.length||t>=n.length)return e.appendTo(u(this).$itemsContainer);else return e.insertBefore(n[t].el())}var o=require("jquery"),s=require("../lib"),a=require("./Component"),l=s.obArray.ChangeKey,u=s.makeInner(),c="-foreach-items-prop",f=u.attach(a.extend({_define:{viewModel:function(){return{data:s.obArray([])}},viewModelPublic:["data"],css:"cpt-foreach"},_prepare:function(){var t=this._viewModel().data;
this._sub(c,[]),this._setItemsContainer(),this._disposable(t.subscribe(e,this,"arrayChange"));for(var n={key:l.SPLICE,index:0,removeCount:0,added:[]},i=0,r=t.peek(),o=r.length;o>i;i++)n.added.push(r[i]);e.call(this,n)},_dispose:function(){this.foreach(function(e,t){t.dispose()})},_parseViewModel:function(e){return s.assert("obArray"===s.obTypeOf(e)),{data:e}},foreach:function(e){for(var t=this._items(),n=0,i=t.length;i>n;n++)e(n,t[n])},getItemAt:function(e){return this._items()[e]},count:function(){return this._viewModel().data.count()},_items:function(){return this._sub(c)},_setItemsContainer:function(){u(this).$itemsContainer=this.$el()},_getCommonConfig:function(e){return this.getCptDef(e)||this._getDefineProperty(e)}})),h={};return h[l.REMOVE]=function(e){for(var t=e.indexes,i=0,r=t.length;r>i;i++)n.call(this,t[i],1)},h[l.SPLICE]=function(e){if(e.removeCount)n.call(this,e.index,e.removeCount);if(e.added.length)t.call(this,e.index,e.added)},h[l.MOVE]=function(e){i.call(this,e.originIndex,e.finalIndex)},f.prototype.Item=a.extend({_define:{css:"dtui-foreach-item",viewModelOnlyAccessDeclaredProperties:!1}}),f}),define("dt/componentConfig",["require","./ui/Component","./ui/Text","./ui/TextInput","./ui/CheckButton","./ui/TreeList","./ui/WinPanel","./ui/Button","./ui/Foreach"],function(require){var e=require("./ui/Component"),t=e.cptClasses;t.Text=require("./ui/Text"),t.TextInput=require("./ui/TextInput"),t.CheckButton=require("./ui/CheckButton"),t.TreeList=require("./ui/TreeList"),t.WinPanel=require("./ui/WinPanel"),t.Button=require("./ui/Button"),t.Foreach=require("./ui/Foreach")}),define("spreadsheet/EditorData",["require","jquery","dt/lib"],function(require){var e=require("jquery"),t=require("dt/lib"),n=function(e){this._data=e.getData(),this._htIns=e},i=n.prototype;return i.clear=function(){for(var e=0,t=this._data,n=t.length;n>e;e++)for(var i=0,r=t[e].length;r>i;i++)t[e][i]=null},i.enlarge=function(e,t){var n=this._data,i=this._htIns.countCols();if(t=Math.max(t,i),t>i)for(var r=0,o=n.length;o>r;r++)n.length=t;if(e>n.length)for(var r=n.length;e>r;r++)n.push(new Array(t))},i.uncheckSet=function(e,t,n){this._data[e][t]=n},i.writeArray=function(t,n){var t=t||[[]],i=t.length,r=0;e.each(t,function(e,t){var t=t||[];r=Math.max(t.length,r)}),this.clear(),this.enlarge(i,r);var o=this;e.each(t,function(t,i){e.each(i||[],function(e,i){o.uncheckSet(t,e,n(i))})})},i.get=function(e,n,i){var r=this._data[e],o=r?r[n]:null;if(""===o)o=null;if("string"===i)o=null==o?"":String(o);else if("number"===i)o=t.getNumber(o);else if("auto"===i){var s=t.getNumber(o);if(null!=s)o=s}return o},i.isBlank=function(e,n){return t.isBlank(this.get(e,n))},i.getEmptyValue=function(){return null},i.getDataWindowSize=function(){for(var e=this._htIns,t=e.countCols(),n=e.countRows(),i=e.dtEditorData,r=n-1,o=0;r>=0;r--){for(var s=0;t>s;s++)if(null!=i.get(r,s)){o=r+1;break}if(o)break}for(var s=t-1,a=0;s>=0;s--){for(var r=0;o>r;r++){var l=i.get(r,s);if(null!=l&&""!==l){a=s+1;break}}if(a)break}return{colCount:a,rowCount:o}},n}),define("spreadsheet/DataTable",["require","jquery","dt/ui/Component","./dataTableProcessor","./EditorData","tpl!./spreadsheet.tpl.html"],function(require){function e(e,t){for(var n=e.view.wt.wtTable,i=n.THEAD.childNodes[0].childNodes,r=e.countRows(),o=0,s=i.length;s>o;o++)if(t===i[o]){var a=n.columnFilter.visibleRowHeadedColumnToSourceColumn(o);e.selectCell(0,a,r-1,a,!1);break}}function t(e,t){for(var n=e.view.wt.wtTable,i=n.TBODY.childNodes,r=e.countCols(),o=0,s=i.length;s>o;o++)if(t===i[o].childNodes[0]){var a=n.rowFilter.visibleToSource(o);e.selectCell(a,0,a,r-1,!1);break}}function n(e){i(e);var t=r(e),n=e.wtTable;if(t){for(var l=t.r;l<=t.r2;l++){var u=s(n,l);u&&a(u).addClass(f)}for(var l=t.c;l<=t.c2;l++){var c=o(n,l);c&&a(c).addClass(f)}}}function i(e){a("."+f,e.wtTable.TABLE).removeClass(f)}function r(e){var t,n={},i=e.selections.area.selected;if(i&&i.length>=2)n.r=i[0][0],n.c=i[0][1],n.r2=i[1][0],n.c2=i[1][1];else if(i=e.selections.current.selected,i&&i.length>=1)n.r=i[0][0],n.c=i[0][1],n.r2=n.r,n.c2=n.c;else return;return n.r>n.r2&&(t=n.r,n.r=n.r2,n.r2=t),n.c>n.c2&&(t=n.c,n.c=n.c2,n.c2=t),n}function o(e,t){if(!e.isColumnBeforeViewport(t)&&!e.isColumnAfterViewport(t))return e.THEAD.childNodes[0].childNodes[e.columnFilter.sourceColumnToVisibleRowHeadedColumn(t)];else return void 0}function s(e,t){if(!e.isRowBeforeViewport(t)&&!e.isRowAfterViewport(t))return e.TBODY.childNodes[e.rowFilter.sourceToVisible(t)].childNodes[0];else return void 0}var a=require("jquery"),l=require("dt/ui/Component"),u=require("./dataTableProcessor"),c=require("./EditorData"),f="rchead-highlight",h=".ecdoc-sprsht-ht",p=l.extend({_define:{tpl:require("tpl!./spreadsheet.tpl.html"),tplTarget:"DataTable",css:"ecdoc-sprsht-datatable",viewModel:function(){return{jsDataOb:null}}},_init:function(){this._htIns=null,this._createHandsontable()},clearContent:function(){if(this._htIns)this._htIns.dtEditorData.clear()},refresh:function(){if(this._htIns)this._htIns.render()},_dispose:function(){},_createHandsontable:function(){var n=this._makeHandsontableOptions();if(!n.data)n.data=[[]];var i=this.$el("dataTable",this.$el().find(h));i.handsontable(n);var r=this._htIns=i.handsontable("getInstance");r.dtEditorData=new c(r),i.on("click","table.htCore thead th",function(t){e(r,t.currentTarget)}),i.on("click","table.htCore tbody th",function(e){t(r,e.currentTarget)}),this._viewModel().jsDataOb.bindDataTable(r)},_makeHandsontableOptions:function(){function e(){t._viewModel().jsDataOb.fillJSDataByDataTable()}var t=this;return{cells:function(e,n){if(t._htIns)u.processCell(this,t._viewModel().jsDataOb,e,n)},afterChange:function(t,n){if("loadData"!==n)e()},afterCreateRow:e,afterCreateCol:e,afterRemoveRow:e,afterRemoveCol:e,afterSelection:function(){n(this.view.wt)},afterDeselect:function(){i(this.view.wt)},afterRender:function(){n(this.view.wt)},minSpareRows:1,minSpareCols:1,rowHeaders:!0,colHeaders:!0,contextMenu:!0,stretchH:"last",trimWhitespace:!0,minRows:50,minCols:15,manualColumnResize:!0,manualColumnMove:!1,fillHandle:!0,undo:!0,outsideClickDeselects:!0,enterBeginsEditing:!0,autoWrapCol:!1,autoWrapRow:!1,copyRowsLimit:6e5,copyColsLimit:6e5,pasteMode:"overwrite",columnSorting:!1,persistentState:!1}}});return p}),define("spreadsheet/CodeInputs",["require","dt/lib","dt/ui/Component","./codeInputsProcessor","tpl!./spreadsheet.tpl.html"],function(require){var e=require("dt/lib"),t=require("dt/ui/Component"),n=(require("./codeInputsProcessor"),t.extend({_define:{tpl:require("tpl!./spreadsheet.tpl.html"),tplTarget:"CodeInputs",css:"ecdoc-sprsht-codeinputs",viewModel:function(){return{jsDataOb:null,mainListViewModels:e.obArray([])}}},_init:function(){var e=this._viewModel();e.jsDataOb.bindCodeInputs(e.mainListViewModels)},_dispose:function(){}}));return n}),define("spreadsheet/componentConfig",["require","dt/ui/Component","./lang","./constant","dt/componentConfig","./DataTable","./CodeInputs"],function(require){var e=require("dt/ui/Component"),t=require("./lang"),n=require("./constant");require("dt/componentConfig");var i=e.cptClasses;i["spreadsheet/DataTable"]=require("./DataTable"),i["spreadsheet/CodeInputs"]=require("./CodeInputs"),e.defaultLanguageSet=t,e.defaultConstant=n}),!function(e){"function"==typeof define&&define.amd?define("jquerymousewheel",["jquery"],e):"object"==typeof exports?module.exports=e:e(jQuery)}(function(e){function t(t){var s=t||window.event,a=l.call(arguments,1),u=0,f=0,h=0,p=0,d=0,g=0;if(t=e.event.fix(s),t.type="mousewheel","detail"in s&&(h=-1*s.detail),"wheelDelta"in s&&(h=s.wheelDelta),"wheelDeltaY"in s&&(h=s.wheelDeltaY),"wheelDeltaX"in s&&(f=-1*s.wheelDeltaX),"axis"in s&&s.axis===s.HORIZONTAL_AXIS&&(f=-1*h,h=0),u=0===h?f:h,"deltaY"in s&&(h=-1*s.deltaY,u=h),"deltaX"in s&&(f=s.deltaX,0===h&&(u=-1*f)),0!==h||0!==f){if(1===s.deltaMode){var v=e.data(this,"mousewheel-line-height");u*=v,h*=v,f*=v}else if(2===s.deltaMode){var m=e.data(this,"mousewheel-page-height");u*=m,h*=m,f*=m}if(p=Math.max(Math.abs(h),Math.abs(f)),(!o||o>p)&&(o=p,i(s,p)&&(o/=40)),i(s,p)&&(u/=40,f/=40,h/=40),u=Math[u>=1?"floor":"ceil"](u/o),f=Math[f>=1?"floor":"ceil"](f/o),h=Math[h>=1?"floor":"ceil"](h/o),c.settings.normalizeOffset&&this.getBoundingClientRect){var y=this.getBoundingClientRect();d=t.clientX-y.left,g=t.clientY-y.top}return t.deltaX=f,t.deltaY=h,t.deltaFactor=o,t.offsetX=d,t.offsetY=g,t.deltaMode=0,a.unshift(t,u,f,h),r&&clearTimeout(r),r=setTimeout(n,200),(e.event.dispatch||e.event.handle).apply(this,a)}}function n(){o=null}function i(e,t){return c.settings.adjustOldDeltas&&"mousewheel"===e.type&&t%120===0}var r,o,s=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],a="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],l=Array.prototype.slice;if(e.event.fixHooks)for(var u=s.length;u;)e.event.fixHooks[s[--u]]=e.event.mouseHooks;var c=e.event.special.mousewheel={version:"3.1.11",setup:function(){if(this.addEventListener)for(var n=a.length;n;)this.addEventListener(a[--n],t,!1);else this.onmousewheel=t;e.data(this,"mousewheel-line-height",c.getLineHeight(this)),e.data(this,"mousewheel-page-height",c.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var n=a.length;n;)this.removeEventListener(a[--n],t,!1);else this.onmousewheel=null;e.removeData(this,"mousewheel-line-height"),e.removeData(this,"mousewheel-page-height")},getLineHeight:function(t){var n=e(t)["offsetParent"in e.fn?"offsetParent":"parent"]();return n.length||(n=e("body")),parseInt(n.css("fontSize"),10)},getPageHeight:function(t){return e(t).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};e.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}})}),define("spreadsheet/spreadsheet",["require","jquery","dt/ui/Component","dt/lib","./lang","./constant","./jsDataFactory","../common/feedback","./componentConfig","jqueryhandsontable","jquerymousewheel","tpl!./spreadsheet.tpl.html"],function(require){var e=require("jquery"),t=require("dt/ui/Component"),n=require("dt/lib"),i=require("./lang"),r=require("./constant"),o=require("./jsDataFactory"),s=require("../common/feedback");require("./componentConfig"),require("jqueryhandsontable"),require("jquerymousewheel");var a=4,l=["name","age","sex","class"],u=".ecdoc-sprsht-attr-setting",c=".ecdoc-sprsht-dim-setting",f="auto",h={};h.init=function(){new p(e(".ecdoc-sprsht"));s.init("spreadsheet")};var p=t.extend({_define:{tpl:require("tpl!./spreadsheet.tpl.html"),tplTarget:"SpreadsheetMain",css:"ecdoc-sprsht",viewModel:function(){return{jsDataOb:o.create(),attrInfoListOb:n.obArray([])}}},_init:function(){this._initDetailSetting(),this._initDimSetting(),this._initAttrSetting(),this._showHideSettingArea(r.JSDATA_DIM_ARRAY)},_initDetailSetting:function(){var e=this._viewModel().jsDataOb,t={emptyValue:function(t){e.setEmptyValue(t),e.fillJSDataByDataTable()},quotationMark:function(t){e.setCodeInfo({quotationMark:t}),e.fillJSDataByDataTable()},jsDataType:function(t){e.setType(t),e.fillJSDataByDataTable(),this._sub("dataTable").refresh(),this._showHideSettingArea(t)},codeFormat:function(t){var n={compressed:{compress:!0,indentBase:null},expanded2Indent:{compress:!1,indentBase:2},expanded4Indent:{compress:!1,indentBase:4}};e.setCodeInfo(n[t]),e.fillJSDataByDataTable()}};for(var n in t)if(t.hasOwnProperty(n))this._disposable(this._sub(n).viewModel("checked").subscribe(t[n],this))},_initDimSetting:function(){function e(e){t.setDimColStep(e),t.fillJSDataByDataTable(),this._sub("dataTable").refresh()}var t=this._viewModel().jsDataOb;this._disposable(this._sub("dimColStep").viewModel("checked").subscribe(e,this))},_initAttrSetting:function(){function t(){var e=p.count();p.push(s("attr"+e,e))}function o(){if(p.count()>1)p.pop()}function s(e){var t=n.ob(e);t.subscribe(u);var i=n.ob(f);return i.subscribe(u),{mouseEnterSelect:n.ob(!0),value:t,itemDataType:i,title:n.ob("")}}function u(){for(var e=p(),t=[],n=0,i=e.length;i>n;n++)t.push({propertyName:e[n].value(),itemDataType:e[n].itemDataType()});d.setPropertyMetas(t),d.fillJSDataByDataTable(),g._sub("dataTable").refresh(),c()}function c(){for(var e=p(),t=0,o=e.length;o>t;t++){var s=d.getColDescInSeries([0,1,2],t,r.JSDATA_ARRAY_OBJECT);e[t].title(n.strTemplate(i.attrInfoTitle,{colName:s.join("/")+"/..."}))}}var h=this._viewModel(),p=h.attrInfoListOb,d=h.jsDataOb,g=this;p.subscribe(u);for(var v=[],m=0;a>m;m++)v.push(s(l[m],m));p.pushArray(v),this._sub("addAttrInput").on("click",e.proxy(t,this)),this._sub("removeAttrInput").on("click",e.proxy(o,this))},_showHideSettingArea:function(e){var t=this.$el();t.find(u)[e===r.JSDATA_DIM_ARRAY?"hide":"show"](),t.find(c)[e===r.JSDATA_DIM_ARRAY?"show":"hide"]()}});return h});