require.config({baseUrl:"assets/js",paths:{jquery:"jquery.min","jquery-weui":"jquery-weui","jquery.fullPage":"jquery.fullPage.min"},shim:{"jquery.fullPage":{deps:["jquery"]},"jquery-weui":{deps:["jquery"]}}});var exam={loadComplete:!1,total:0,error:[],answerList:[],isAnswered:[],timeReleased:!1,isStarted:!1,timeLength:0,sourceList:[],scoresPerAnswer:0,isSubmit:!1,isLogin:!1,loginData:{},maxAnswerNum:20,answerTimes:20,examPaper:"party",tips:[]},lastPage;require(["jquery.fullPage","jquery-weui"],function(){function e(e,a){var i=[],s=[];s=t(e.question.length);var n=[];s.map(function(e,a){n[e]=a});var r='<div class="slide">';r+='<h1 class="answer-num title-hor blue-font" style="margin-top:100px;">第<span>'+a+"</span>题</h1>",r+='<div class="weui_cells_title blue-font" style="margin-top:-5px;line-height:1.2;">'+e.title+'</div><div class="weui_cells weui_cells_checkbox weui_cells_dark weui_cells_dark_myerr blue-font" data-id='+(a-1)+" data-answer="+(n[e.answer-1]+1)+">",e.question.map(function(e,t){i[t]="",i[t]+='    <label class="weui_cell weui_check_label" style="padding-top:5px;padding-bottom:5px;">',i[t]+='<div class="weui_cell_hd">',i[t]+='    <input type="radio" class="weui_check" name="radio'+(a-1)+'">',i[t]+='    <i class="weui_icon_checked"></i>',i[t]+="</div>",i[t]+='<div class="weui_cell_bd weui_cell_primary" data-value='+n[t]+">",i[t]+="    <p>"+e+"</p>",i[t]+="</div></label>"});for(var l="",o=0;o<e.question.length;o++)l+=i[s[o]];return r+=l+"</div>",r+='<div class="info-tips" name="fixed" style="top:80%;"><span style="color:#ed1515;">'+exam.tips[a-1].year+'</span><img class="years" src="./assets/img/years.png"><p style="color:#ed1515;margin-top:-5px;">'+exam.tips[a-1].tip+'</p></div><img name="fixed" src="./assets/img/mainTheme.jpg" class="background_dark" style="height:100%;top:0;position:absolute;display:block;margin:0 auto;z-index:-1;"></div>'}function a(e,a){return Math.random()>.5?-1:1}function t(e){for(var t=[],i=0;e>i;i++)t.push(i);return t.sort(a)}function i(){$.getJSON("./assets/data/"+exam.examPaper+".min.json",function(a){var i=a.length;exam.sourceList=t(i),i=i<=exam.maxAnswerNum?i:exam.maxAnswerNum,exam.maxAnswerNum=i,$('[name="nums"]').text(i),exam.scoresPerAnswer=100/i,$('[name="scores"]').text(exam.scoresPerAnswer.toFixed(0));for(var s=0;i>s;s++)$('[name="sucessInfo"]').before(e(a[exam.sourceList[s]],s+1)),exam.isAnswered[s]=0;$('[name="fixed"]').css("width",100/(3+exam.maxAnswerNum)+"%");var n='<div class="weui_opr_area"><p class="weui_btn_area"><a href="javascript:;" class="weui_btn weui_btn_primary weui_btn_primary_yellow" id="submit">交卷</a></p></div>';for($(".answer-num").last().parent().append(n),lastPage=i+3,s=0;lastPage>s;s++)r[s]=s%2?"#fff":"#445"}).done(function(){document.getElementById("autoplay").play(),l()})}function s(e,a){return e.substring(e.length-a,e.length)}function n(e){var a,t=new Date,i=t.getFullYear(),n=s("0"+(t.getMonth()+1),2),r=s("0"+t.getDate(),2),l=t.getHours(),o=t.getMinutes(),u=t.getSeconds();switch(e){case 0:a=i+"年"+n+"月"+r+"日";break;case 1:a=i+"-"+n+"-"+r+" "+l+":"+o+":"+u;break;case 2:a=i+"年"+n+"月"+r+"日"+l+"时"+o+"分"+u+"秒";break;case 3:a=i+"-"+n+"-"+r+" "+l+":"+o;break;case 4:a=i+"年"+n+"月"+r+"日  "+l+"时"+o+"分";break;case 5:a=n+"/"+r+"/"+i;break;case 6:a=i+"-"+n+"-"+r}return a}var r=[];$('[name="sucessInfo"] .weui_msg_title').hide(),$.getJSON("./assets/data/department.min.json",function(e){var a=(e.length,[]);e.map(function(e){a.push(e.name)}),$('[name="user_dpt"]').picker({title:"上下滑动选择您的部门",cols:[{textAlign:"center",values:a}]})}),$.getJSON("./assets/data/tips.min.json",function(e){exam.tips=e}).done(function(){i()});var l=function(){function e(){$.alert("答题时间到，系统将不再记录此后的得分，请提交当前成绩！","时间到！",function(){$.fn.fullpage.moveTo(lastPage)})}function a(e,a,t){var i=e-1;return"right"!=t||exam.isLogin||exam.timeReleased?("right"==t&&!exam.timeReleased&&i>0&&lastPage-2>i&&!exam.isAnswered[i-1]&&$.alert("第"+i+"题您还没有作答！","警告！",function(){$.fn.fullpage.moveTo(0,e)}),void(e>lastPage&&"right"==t&&$(".iSlider-arrow-blue-right").hide())):void setTimeout(function(){},200)}function t(e){var a=!0;return""==e.user_name?($('[name="userName"]').parents(".weui_cell").find("label").css("color","#fff"),a=!1):$('[name="userName"]').parents(".weui_cell").find("label").attr("style",""),""==e.user_dpt?($('[name="user_dpt"]').parents(".weui_cell").find("label").css("color","#fff"),a=!1):$('[name="user_dpt"]').parents(".weui_cell").find("label").attr("style",""),""==e.user_id?($('[name="userCard"]').parents(".weui_cell").find("label").css("color","#fff"),a=!1):$('[name="userCard"]').parents(".weui_cell").find("label").attr("style",""),a}function i(e,a){var t="";e>=80?t="恭喜您获奖！请根据部门通知领取答题奖品！":(1==exam.loginData.iTimes&&(t="您还有一次答题机台，退出页面重新进入即可，下次继续努力哦！"),t="下次继续努力哦！"),$('[name="sucessInfo"] .weui_msg_desc').html('提交成功，您一共得了<span name="totalScore" style="font-weight:bold;color:#445"> '+e+" </span>分"),$(".weui_icon_msg").last().addClass("weui_icon_success").removeClass("weui_icon_warn"),$('[name="scoreLink"]').attr("href","./safeScore.html?uid="+a),$('[name="sucessInfo"] .weui_msg_title').text(t).show()}function s(){var e=!0;exam.isAnswered.map(function(a,t){if(!a){var i=t+1;$.toast("第"+i+"题尚未作答，请先填写完所有题目再交卷"),e=!1}})}function r(e){$.ajax({url:"http://cbpc540.applinzi.com/index.php?s=/addon/GoodVoice/GoodVoice/setPartyData",data:e,dataType:"jsonp",callback:"JsonCallback",success:function(a){0==a.status?$('[name="sucessInfo"] .weui_msg_title').text("提交失败，请稍后重试"):-1==a.status?$('[name="sucessInfo"] .weui_msg_title').text("该用户已提交数据"):(i(e.score,e.uid),e.score==exam.loginData.oldScore?$.alert("本次得分"+e.score+"与上一次相同，系统将不保存此次得分","警告！"):e.score<exam.loginData.oldScore&&$.alert("系统检测到本次得分"+e.score+"比上次更低，系统将不保存此次得分","警告！")),$.fn.fullpage.moveSlideRight()},error:function(e){var a="提交失败，请退出页面重新进入";$('[name="sucessInfo"] .weui_msg_title').text(a).show()}}).always(function(){exam.isSubmit=!0,$("#submit").hide()})}$(".weui_check_label").on("click",function(e){if(exam.timeReleased)e.preventdefault(),$.fn.fullpage.moveTo(lastPage),$.alert("答题时间到，系统将不再记录此后的得分，请提交当前成绩！","时间到！");else{var a=$(this).parents(".weui_cells"),t=$(this).find(".weui_cell_primary"),i=t.data("value")+1==a.data("answer")?1:0,s=a.data("id");exam.answerList[s]=i,exam.isAnswered[s]=1,s<exam.maxAnswerNum-1&&setTimeout(function(){$.fn.fullpage.moveTo(0,s+3)},300)}}),$("#fullpage").fullpage({verticalCentered:!1,loopHorizontal:!1,onSlideLeave:function(t,i,s,n,r){exam.timeLength&&1==i&&!exam.timeReleased&&(exam.isStarted=!0,setTimeout(function(){exam.timeReleased=!0,e()},exam.timeLength),setTimeout(function(){$.toast("考试时间已过去三分之一")},.33*exam.timeLength),setTimeout(function(){$.toast("考试时间仅剩三分之一")},.67*exam.timeLength)),a(s,r,n)},afterSlideLoad:function(e,a,t,i){i==lastPage-2?$(".iSlider-arrow-blue-right").hide():i==lastPage-1?($(".iSlider-arrow-blue-right").hide(),exam.isSubmit||setTimeout(function(){$.fn.fullpage.moveSlideLeft()},500)):$(".iSlider-arrow-blue-right").show()}}),exam.loadComplete||($("#fakeLoader").hide(),exam.loadComplete=!0),$(".weui_msg").removeClass("hidden"),$('[name="login"] input').on("focus",function(){$(this).parents(".weui_cell").find("label").attr("style","")}),$("#login").on("click",function(){var e={user_name:$('[name="userName"]').val().trim(),user_id:$('[name="userCard"]').val().trim(),user_dpt:$('[name="user_dpt"]').val()};e.user_firstname=e.user_name.substr(0,1),t(e)?$.ajax({url:"http://cbpc540.applinzi.com/index.php?s=/addon/GoodVoice/GoodVoice/examPartyLogin",data:e,dataType:"jsonp",callback:"JsonCallback",success:function(a){0==a.id?$.alert("登录失败，请检查您的卡号及部门","警告！"):a.first_name.trim()!=e.user_firstname?$.alert("登录失败，您的姓名可能填写错误","警告！"):a.answer_times>=exam.answerTimes?$.alert("您已用完"+exam.answerTimes+"次答题机会","警告！",function(){window.location.href="./safeScore.html?uid="+a.id}):(exam.isLogin=!0,exam.loginData=e,exam.loginData.uid=a.id,exam.loginData.iTimes=Number.parseInt(a.answer_times)+1,exam.loginData.oldScore=exam.loginData.iTimes>=1?Number.parseInt(a.score):0,exam.loginData.loginTime=n(1),exam.loginData.iTimes>1?$.modal({title:"提示",text:"您已经提交过答案，是否继续作答?",buttons:[{text:"再做一遍",onClick:function(){$(this).parents(".slide").hide(),$.fn.fullpage.moveSlideRight()}},{text:"查看成绩",onClick:function(){window.location.href="./safeScore.html?uid="+a.id}}]}):($(this).parents(".slide").hide(),$.fn.fullpage.moveSlideRight()))},error:function(e){$.alert("登录失败，请刷新重试","警告！")}}):$.toast("请输入个人用户信息","cancel")}),$("#submit").on("click",function(e){if(exam.error=[],exam.total=0,exam.answerList.map(function(e,a){exam.total+=e,e||exam.error.push(exam.sourceList[a])}),s){var a="";exam.error.map(function(e){a+=e+","}),a=a.length?a.substring(0,a.length-1):"-1";var t={score:(exam.total*exam.scoresPerAnswer).toFixed(0),errors:a,rec_time:n(1),start_time:exam.loginData.loginTime,uid:exam.loginData.uid,iTimes:exam.loginData.iTimes,oldScore:exam.loginData.oldScore};$.modal({title:"提示",text:"您确定要交卷吗?",buttons:[{text:"交卷",onClick:function(){r(t)}},{text:"检查一遍",onClick:function(){$.fn.fullpage.moveTo(0,2)}}]})}})};(function(){var e=document.getElementById("autoplay"),a=document.getElementById("musicBtn"),t=document.getElementById("musicBtnTxt");e.volume=.5,document.getElementById("musicBtn").addEventListener("touchstart",function(){t.style.display="",e.paused?(e.play(),a.className="music-btn on",t.innerHTML="开始"):(e.pause(),a.className="music-btn",t.innerHTML="关闭"),setTimeout(function(){t.style.display="none"},1e3)},!1)})()});
//# sourceMappingURL=partyh2.min.js.map