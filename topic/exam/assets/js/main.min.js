require.config({baseUrl:"assets/js",paths:{jquery:"jquery.min","jquery-weui":"jquery-weui","jquery.fullPage":"jquery.fullPage.min"},shim:{"jquery.fullPage":{deps:["jquery"]},"jquery-weui":{deps:["jquery"]}}});var exam={total:0,error:[],answerList:[],isAnswered:[],timeReleased:!1,isStarted:!1,timeLength:3e6,sourceList:[],eachScore:0,isSubmit:!1},lastPage;require(["jquery","jquery.fullPage","jquery-weui"],function(e){function t(e,t){var a=[],n=[];n=s(e.question.length);var i=[];n.map(function(e,t){i[e]=t});var r='<div class="section">';r+='<h1 class="title answer-num">第<span>'+t+"</span>题</h1>",r+='<div class="weui_cells_title">'+e.title+"</div>",r+='<div class="weui_cells '+(t%2?"":"weui_cells_dark")+' weui_cells_checkbox" data-id='+(t-1)+" data-answer="+(i[e.answer-1]+1)+">",e.question.map(function(e,s){a[s]="",a[s]+='    <label class="weui_cell weui_check_label">',a[s]+='<div class="weui_cell_hd">',a[s]+='    <input type="radio" class="weui_check" name="radio'+(t-1)+'">',a[s]+='    <i class="weui_icon_checked"></i>',a[s]+="</div>",a[s]+='<div class="weui_cell_bd weui_cell_primary" data-value='+i[s]+">",a[s]+="    <p>"+e+"</p>",a[s]+="</div></label>"});for(var u="",o=0;o<e.question.length;o++)u+=a[n[o]];return r+=u+"</div>\n</div>"}function a(e,t){return Math.random()>.5?-1:1}function s(e){for(var t=[],s=0;e>s;s++)t.push(s);return t.sort(a)}function n(e,t){return e.substring(e.length-t,e.length)}function i(e){var t,a=new Date,s=a.getFullYear(),i=n("0"+(a.getMonth()+1),2),r=n("0"+a.getDate(),2),u=a.getHours(),o=a.getMinutes(),l=a.getSeconds();switch(e){case 0:t=s+"年"+i+"月"+r+"日";break;case 1:t=s+"-"+i+"-"+r+" "+u+":"+o+":"+l;break;case 2:t=s+"年"+i+"月"+r+"日"+u+"时"+o+"分"+l+"秒";break;case 3:t=s+"-"+i+"-"+r+" "+u+":"+o;break;case 4:t=s+"年"+i+"月"+r+"日  "+u+"时"+o+"分";break;case 5:t=i+"/"+r+"/"+s;break;case 6:t=s+"-"+i+"-"+r}return t}var r,u=[],o=-1==window.location.href.indexOf("?m=")?0:window.location.href.split("?m=")[1].split("&")[0];0==o?r="data":"1"==o&&(r="data_test"),e('[name="sucessInfo"] .weui_msg_title').hide(),e.getJSON("./assets/data/"+r+".min.json",function(a){var n=a.length;e('[name="nums"]').text(n),exam.eachScore=100/n,e('[name="scores"]').text(exam.eachScore.toFixed(0)),exam.sourceList=s(n);for(var i=0;n>i;i++)e('[name="form"]').before(t(a[exam.sourceList[i]],i+1)),exam.isAnswered[i]=0;for(lastPage=a.length+2,i=0;lastPage>i;i++)u[i]=i%2?"#fff":"#f3f3ff"}).done(function(){document.getElementById("autoplay").play(),l()});var l=function(){function t(){e.alert("答题时间到，系统将不再记录此后的得分，请提交当前成绩！","时间到！",function(){e.fn.fullpage.moveTo(lastPage)})}function a(t,a,s){var n=t-1;"down"==s&&!exam.timeReleased&&n>0&&lastPage-1>n&&!exam.isAnswered[n-1]&&e.alert("第"+n+"题您还没有作答！","警告！",function(){e.fn.fullpage.moveTo(n+1)}),1==t&&"down"==s?e(".iSlider-arrow").removeClass("iSlider-white"):1==a&&"up"==s&&e(".iSlider-arrow").addClass("iSlider-white"),t>=lastPage-1&&"down"==s&&e(".iSlider-arrow").hide()}function s(t){var a=!0;return""==t.user_name?(e('[name="userName"]').parents(".weui_cell").find("label").css("color","#e64340"),a=!1):e('[name="userName"]').parents(".weui_cell").find("label").attr("style",""),""==t.user_id?(e('[name="userCard"]').parents(".weui_cell").find("label").css("color","#e64340"),a=!1):e('[name="userCard"]').parents(".weui_cell").find("label").attr("style",""),a}function n(t,a){e('[name="sucessInfo"] .weui_msg_desc').text('您一共得了<span name="totalScore" style="font-weight:bold;color:#445"> '+t+" </span>分"),e(".weui_icon_msg").last().addClass("weui_icon_success").removeClass("weui_icon_warn"),e('[name="scoreLink"]').attr("href","./score.html?uid="+a),e('[name="sucessInfo"] .weui_msg_title').text("提交成功").show()}e(".weui_check_label").on("click",function(t){if(exam.timeReleased)t.preventdefault(),e.fn.fullpage.moveTo(lastPage),e.alert("答题时间到，系统将不再记录此后的得分，请提交当前成绩！","时间到！");else{var a=e(this).parents(".weui_cells"),s=e(this).find(".weui_cell_primary"),n=s.data("value")+1==a.data("answer")?1:0;exam.answerList[a.data("id")]=n,exam.isAnswered[a.data("id")]=1,setTimeout(function(){e.fn.fullpage.moveTo(a.data("id")+3)},200)}}),e("#fullpage").fullpage({sectionsColor:u,easingcss3:"cubic-bezier(0.25, 0.5, 0.35, 1.15)",onLeave:function(s,n,i){1!=s||exam.timeReleased||(exam.isStarted=!0,setTimeout(function(){exam.timeReleased=!0,t()},exam.timeLength),setTimeout(function(){e.toast("考试时间已过去三分之一")},.33*exam.timeLength),setTimeout(function(){e.toast("考试时间仅剩三分之一")},.67*exam.timeLength)),a(s,n,i)},afterLoad:function(t,a){a==lastPage?e(".iSlider-arrow").hide():a>lastPage?(e(".iSlider-arrow").hide(),exam.isSubmit||setTimeout(function(){e.fn.fullpage.moveSectionUp()},500)):e(".iSlider-arrow").show()}}),e('[name="form"] input').on("focus",function(){e(this).parents(".weui_cell").find("label").attr("style","")}),e('[name="form"] .weui_btn').on("click",function(t){exam.error=[],exam.total=0,exam.answerList.map(function(e,t){exam.total+=e,e||exam.error.push(exam.sourceList[t])});var a="";exam.error.map(function(e){a+=e+","}),a=a.length?a.substring(0,a.length-1):"-1";var r={user_name:e('[name="userName"]').val(),user_id:e('[name="userCard"]').val(),score:(exam.total*exam.eachScore).toFixed(0),errors:a,rec_time:i(1)};s(r)?(e('[name="totalScore"]').text(r.score),e('[name="sucessInfo"] .weui_msg_title').show(),e.ajax({url:"http://cbpc540.applinzi.com/index.php?s=/addon/GoodVoice/GoodVoice/setJZExamData",data:r,success:function(t){0==t.status?e('[name="sucessInfo"] .weui_msg_title').text("提交失败，请稍后重试"):-1==t.status?e('[name="sucessInfo"] .weui_msg_title').text("该用户已提交数据"):n(r.score,t.uid),0==t.status?e('[name="sucessInfo"] h1').text("提交失败，请稍后重试"):-1==t.status?e('[name="sucessInfo"] h1').text("该用户已提交数据"):n(r.score,t.uid)},error:function(t){var a;0==t.status?a="提交失败，请稍后重试":-1==t.status&&(a="该用户已提交数据"),e('[name="sucessInfo"] .weui_msg_title').text(a).show()}}).always(function(){exam.isSubmit=!0,e.fn.fullpage.moveSectionDown()})):e.toast("请输入个人用户信息","cancel")})};(function(){var e=document.getElementById("autoplay"),t=document.getElementById("musicBtn"),a=document.getElementById("musicBtnTxt");document.getElementById("musicBtn").addEventListener("touchstart",function(){a.style.display="",e.paused?(e.play(),t.className="music-btn on",a.innerHTML="开始"):(e.pause(),t.className="music-btn",a.innerHTML="关闭"),setTimeout(function(){a.style.display="none"},1e3)},!1)})()});
//# sourceMappingURL=main.min.js.map