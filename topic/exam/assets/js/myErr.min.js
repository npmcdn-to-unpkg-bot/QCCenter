var exam={loadComplete:!1,total:0,error:[],answerList:[],isAnswered:[],timeReleased:!1,sourceList:[],scoresPerAnswer:0,isSubmit:!1,maxAnswerNum:40,examPaper:"safe",answerNums:0,myErrNums:0,myError:[]},lastPage;!function(){function e(e){var a=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),r=encodeURI(window.location.search).substr(1).match(a);return null!==r?decodeURI(r[2]):-1}function a(e,a,r,s){var t=[],i=[],o=["A","B","C","D"];i=n(e.question.length);var m=[];i.map(function(e,a){m[e]=a});var l='<div class="section background_main"><h1 class="title answer-num ">第<span>'+r+"</span>题</h1>";a&&(l+='<h3 class="weui_cells_title">错误人数：<span>'+s.nums+"人 </span>( "+s.percent+"% )</h3>"),l+='<h3 class="weui_cells_title">正确答案:<span>'+o[Number.parseInt(m[e.answer-1])]+'</h3><div class="weui_cells_title ">'+e.title+'</div><div class="weui_cells weui_cells_checkbox weui_cells_dark weui_cells_dark_myerr" data-id='+(r-1)+" data-answer="+(m[e.answer-1]+1)+">",e.question.map(function(e,a){t[a]="",t[a]+='    <label class="weui_cell weui_check_label">',t[a]+='<div class="weui_cell_hd">',t[a]+='    <input type="radio" class="weui_check" name="radio'+(r-1)+'">',t[a]+='    <i class="weui_icon_checked"></i>',t[a]+="</div>",t[a]+='<div class="weui_cell_bd weui_cell_primary" data-value='+m[a]+">",t[a]+="    <p>"+e+"</p>",t[a]+="</div></label>"});for(var u="",c=0;c<e.question.length;c++)u+=t[i[c]];return l+=u+"</div></div>"}function r(e,a){return Math.random()>.5?-1:1}function n(e){for(var a=[],n=0;e>n;n++)a.push(n);return a.sort(r)}function s(){$.getJSON("./assets/data/"+exam.examPaper+".min.json",function(e){var r=exam.error.length;r=r<=exam.maxAnswerNum?r:exam.maxAnswerNum,exam.maxAnswerNum=r;for(var n=0;r>n;n++)$("#fullpage").append(a(e[exam.error[n].id],1,n+1,exam.error[n]));for(n=0;n<exam.myErrNums;n++)$('[name="allErr"]').before(a(e[exam.myError[n]],0,n+1));var s='<div class="weui_opr_area"><p class="weui_btn_area"><a href="javascript:$.fn.fullpage.moveTo(2);" class="weui_btn weui_btn_primary" >返回首页</a></p></div>';for($(".answer-num").last().parent().append(s),lastPage=r+1+exam.myErrNums,n=0;lastPage>n;n++)o[n]=n%2?"#fff":"#445"}).done(function(){m()})}function t(){$.ajax({url:"http://cbpc540.applinzi.com/index.php?s=/addon/GoodVoice/GoodVoice/getAllErrs",async:!1,dataType:"jsonp",callback:"JsonCallback"}).done(function(e){for(var a=0;a<e.errors.length;a++)exam.isAnswered[a]=0;exam.answerNums=e.nums;var r=[];e.errors.map(function(e){r.push(e)}),r.sort(function(e,a){return a-e});for(var n=0;n<exam.maxAnswerNum&&exam.error.length<exam.maxAnswerNum;n++)e.errors.map(function(a,s){e.errors[s]==r[n]&&0===exam.isAnswered[s]&&(exam.error.push({id:s,nums:e.errors[s],percent:Number.parseFloat(100*a/e.nums).toFixed(2)}),exam.isAnswered[s]=1)});s()})}var i=e("uid"),o=[],m=function(){$("#fullpage").fullpage({easingcss3:"cubic-bezier(0.25, 0.5, 0.35, 1.15)",onLeave:function(e,a,r){e-2>lastPage&&"down"==r&&$(".iSlider-arrow").hide()},afterLoad:function(e,a){a-2==lastPage?$(".iSlider-arrow").hide():$(".iSlider-arrow").show()}}),exam.loadComplete||($("#fakeLoader").hide(),document.getElementById("autoplay").play())};-1==i?($('[name="wPage"]').html('<span name="username">尊敬的同事</span>，您好：<p>2016年6月是全国的第十五个安全生产月,感谢您对本次安全月活动的关注。</p>'),t()):$.ajax({url:"http://cbpc540.applinzi.com/index.php?s=/addon/GoodVoice/GoodVoice/getMyErrs&uid="+i,async:!1,dataType:"jsonp",callback:"JsonCallback"}).done(function(e){$('[name="username"]').text(e.user_name),Number.parseInt(e.score)>100?$('[name="userscore"]').text("没有参与本次答题活动"):$('[name="userscore"]').text("获得了"+e.score+"分。"),exam.myErrNums=(100-Number.parseInt(e.score))/5,exam.myErrNums>0&&($('[name="errTips"]').text("做错"+exam.myErrNums+"道题,最终"),$('[name="myErrTips"]').text("接下来我们来看看这"+exam.myErrNums+"道题目的正确答案。"),exam.myError=e.errors.split(",")),t()});(function(){var e=document.getElementById("autoplay"),a=document.getElementById("musicBtn"),r=document.getElementById("musicBtnTxt");document.getElementById("musicBtn").addEventListener("touchstart",function(){r.style.display="",e.paused?(e.play(),a.className="music-btn on",r.innerHTML="开始"):(e.pause(),a.className="music-btn",r.innerHTML="关闭"),setTimeout(function(){r.style.display="none"},1e3)},!1)})()}();
//# sourceMappingURL=myErr.min.js.map