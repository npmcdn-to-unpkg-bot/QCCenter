!function(window){function getMetaKeyCode(e){var t=4096,n=8192,i=16384,r=0;return"string"==typeof e?e.toLowerCase().split(/\+\s*/).forEach(function(e){switch(e){case"ctrl":case"cmd":r|=t;break;case"alt":r|=n;break;case"shift":r|=i;break;default:r|=keymap[e]}}):((e.ctrlKey||e.metaKey)&&(r|=t),e.altKey&&(r|=n),e.shiftKey&&(r|=i),r|=e.keyCode),r}function updateCircle(e,t,n){var i=t.getStyle("padding-left"),r=t.getStyle("padding-right"),o=t.getStyle("padding-top"),a=t.getStyle("padding-bottom"),s=Math.max(n.width,n.height),l={x:n.x-i,y:n.y-o,width:s+i+r,height:s+o+a},u=t.isSelected()?"selected-":"";return s=Math.max(l.width,l.height),e.setPosition(l.x,l.y).setSize(s,s).setRadius(s/2).fill(t.getData("background")||t.getStyle(u+"background")||t.getStyle("background")).stroke(t.getStyle(u+"stroke"||t.getStyle("stroke")),t.getStyle(u+"stroke-width")),new kity.Box(l)}function asc(e,t){return e.getIndex()-t.getIndex()}function desc(e,t){return-asc(e,t)}function canArrange(e){var t=e.getSelectedNode();return t&&t.parent&&t.parent.children.length>1}!function(e,t){"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(e,t){function n(e){var t=e.length,n=Z.type(e);return"function"===n||Z.isWindow(e)?!1:1===e.nodeType&&t?!0:"array"===n||0===t||"number"==typeof t&&t>0&&t-1 in e}function i(e,t,n){if(Z.isFunction(t))return Z.grep(e,function(e,i){return!!t.call(e,i,e)!==n});if(t.nodeType)return Z.grep(e,function(e){return e===t!==n});if("string"==typeof t){if(se.test(t))return Z.filter(t,e,n);t=Z.filter(t,e)}return Z.grep(e,function(e){return K.call(t,e)>=0!==n})}function r(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}function o(e){var t=pe[e]={};return Z.each(e.match(fe)||[],function(e,n){t[n]=!0}),t}function a(){Q.removeEventListener("DOMContentLoaded",a,!1),e.removeEventListener("load",a,!1),Z.ready()}function s(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=Z.expando+Math.random()}function l(e,t,n){var i;if(void 0===n&&1===e.nodeType)if(i="data-"+t.replace(be,"-$1").toLowerCase(),n=e.getAttribute(i),"string"==typeof n){try{n="true"===n?!0:"false"===n?!1:"null"===n?null:+n+""===n?+n:_e.test(n)?Z.parseJSON(n):n}catch(r){}ye.set(e,t,n)}else n=void 0;return n}function u(){return!0}function c(){return!1}function h(){try{return Q.activeElement}catch(e){}}function d(e,t){return Z.nodeName(e,"table")&&Z.nodeName(11!==t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function f(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function p(e){var t=Be.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function g(e,t){for(var n=0,i=e.length;i>n;n++)ve.set(e[n],"globalEval",!t||ve.get(t[n],"globalEval"))}function m(e,t){var n,i,r,o,a,s,l,u;if(1===t.nodeType){if(ve.hasData(e)&&(o=ve.access(e),a=ve.set(t,o),u=o.events)){delete a.handle,a.events={};for(r in u)for(n=0,i=u[r].length;i>n;n++)Z.event.add(t,r,u[r][n])}ye.hasData(e)&&(s=ye.access(e),l=Z.extend({},s),ye.set(t,l))}}function v(e,t){var n=e.getElementsByTagName?e.getElementsByTagName(t||"*"):e.querySelectorAll?e.querySelectorAll(t||"*"):[];return void 0===t||t&&Z.nodeName(e,t)?Z.merge([e],n):n}function y(e,t){var n=t.nodeName.toLowerCase();"input"===n&&Ce.test(e.type)?t.checked=e.checked:("input"===n||"textarea"===n)&&(t.defaultValue=e.defaultValue)}function _(t,n){var i,r=Z(n.createElement(t)).appendTo(n.body),o=e.getDefaultComputedStyle&&(i=e.getDefaultComputedStyle(r[0]))?i.display:Z.css(r[0],"display");return r.detach(),o}function b(e){var t=Q,n=He[e];return n||(n=_(e,t),"none"!==n&&n||(We=(We||Z("<iframe frameborder='0' width='0' height='0'/>")).appendTo(t.documentElement),t=We[0].contentDocument,t.write(),t.close(),n=_(e,t),We.detach()),He[e]=n),n}function w(e,t,n){var i,r,o,a,s=e.style;return n=n||je(e),n&&(a=n.getPropertyValue(t)||n[t]),n&&(""!==a||Z.contains(e.ownerDocument,e)||(a=Z.style(e,t)),Ve.test(a)&&Ue.test(t)&&(i=s.width,r=s.minWidth,o=s.maxWidth,s.minWidth=s.maxWidth=s.width=a,a=n.width,s.width=i,s.minWidth=r,s.maxWidth=o)),void 0!==a?a+"":a}function x(e,t){return{get:function(){return e()?void delete this.get:(this.get=t).apply(this,arguments)}}}function k(e,t){if(t in e)return t;for(var n=t[0].toUpperCase()+t.slice(1),i=t,r=Xe.length;r--;)if(t=Xe[r]+n,t in e)return t;return i}function C(e,t,n){var i=$e.exec(t);return i?Math.max(0,i[1]-(n||0))+(i[2]||"px"):t}function S(e,t,n,i,r){for(var o=n===(i?"border":"content")?4:"width"===t?1:0,a=0;4>o;o+=2)"margin"===n&&(a+=Z.css(e,n+xe[o],!0,r)),i?("content"===n&&(a-=Z.css(e,"padding"+xe[o],!0,r)),"margin"!==n&&(a-=Z.css(e,"border"+xe[o]+"Width",!0,r))):(a+=Z.css(e,"padding"+xe[o],!0,r),"padding"!==n&&(a+=Z.css(e,"border"+xe[o]+"Width",!0,r)));return a}function T(e,t,n){var i=!0,r="width"===t?e.offsetWidth:e.offsetHeight,o=je(e),a="border-box"===Z.css(e,"boxSizing",!1,o);if(0>=r||null==r){if(r=w(e,t,o),(0>r||null==r)&&(r=e.style[t]),Ve.test(r))return r;i=a&&(Y.boxSizingReliable()||r===e.style[t]),r=parseFloat(r)||0}return r+S(e,t,n||(a?"border":"content"),i,o)+"px"}function M(e,t){for(var n,i,r,o=[],a=0,s=e.length;s>a;a++)i=e[a],i.style&&(o[a]=ve.get(i,"olddisplay"),n=i.style.display,t?(o[a]||"none"!==n||(i.style.display=""),""===i.style.display&&ke(i)&&(o[a]=ve.access(i,"olddisplay",b(i.nodeName)))):(r=ke(i),"none"===n&&r||ve.set(i,"olddisplay",r?n:Z.css(i,"display"))));for(a=0;s>a;a++)i=e[a],i.style&&(t&&"none"!==i.style.display&&""!==i.style.display||(i.style.display=t?o[a]||"":"none"));return e}function L(e,t,n,i,r){return new L.prototype.init(e,t,n,i,r)}function E(){return setTimeout(function(){Ye=void 0}),Ye=Z.now()}function P(e,t){var n,i=0,r={height:e};for(t=t?1:0;4>i;i+=2-t)n=xe[i],r["margin"+n]=r["padding"+n]=e;return t&&(r.opacity=r.width=e),r}function N(e,t,n){for(var i,r=(nt[t]||[]).concat(nt["*"]),o=0,a=r.length;a>o;o++)if(i=r[o].call(n,t,e))return i}function A(e,t,n){var i,r,o,a,s,l,u,c,h=this,d={},f=e.style,p=e.nodeType&&ke(e),g=ve.get(e,"fxshow");n.queue||(s=Z._queueHooks(e,"fx"),null==s.unqueued&&(s.unqueued=0,l=s.empty.fire,s.empty.fire=function(){s.unqueued||l()}),s.unqueued++,h.always(function(){h.always(function(){s.unqueued--,Z.queue(e,"fx").length||s.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(n.overflow=[f.overflow,f.overflowX,f.overflowY],u=Z.css(e,"display"),c="none"===u?ve.get(e,"olddisplay")||b(e.nodeName):u,"inline"===c&&"none"===Z.css(e,"float")&&(f.display="inline-block")),n.overflow&&(f.overflow="hidden",h.always(function(){f.overflow=n.overflow[0],f.overflowX=n.overflow[1],f.overflowY=n.overflow[2]}));for(i in t)if(r=t[i],Je.exec(r)){if(delete t[i],o=o||"toggle"===r,r===(p?"hide":"show")){if("show"!==r||!g||void 0===g[i])continue;p=!0}d[i]=g&&g[i]||Z.style(e,i)}else u=void 0;if(Z.isEmptyObject(d))"inline"===("none"===u?b(e.nodeName):u)&&(f.display=u);else{g?"hidden"in g&&(p=g.hidden):g=ve.access(e,"fxshow",{}),o&&(g.hidden=!p),p?Z(e).show():h.done(function(){Z(e).hide()}),h.done(function(){var t;ve.remove(e,"fxshow");for(t in d)Z.style(e,t,d[t])});for(i in d)a=N(p?g[i]:0,i,h),i in g||(g[i]=a.start,p&&(a.end=a.start,a.start="width"===i||"height"===i?1:0))}}function I(e,t){var n,i,r,o,a;for(n in e)if(i=Z.camelCase(n),r=t[i],o=e[n],Z.isArray(o)&&(r=o[1],o=e[n]=o[0]),n!==i&&(e[i]=o,delete e[n]),a=Z.cssHooks[i],a&&"expand"in a){o=a.expand(o),delete e[i];for(n in o)n in e||(e[n]=o[n],t[n]=r)}else t[i]=r}function O(e,t,n){var i,r,o=0,a=tt.length,s=Z.Deferred().always(function(){delete l.elem}),l=function(){if(r)return!1;for(var t=Ye||E(),n=Math.max(0,u.startTime+u.duration-t),i=n/u.duration||0,o=1-i,a=0,l=u.tweens.length;l>a;a++)u.tweens[a].run(o);return s.notifyWith(e,[u,o,n]),1>o&&l?n:(s.resolveWith(e,[u]),!1)},u=s.promise({elem:e,props:Z.extend({},t),opts:Z.extend(!0,{specialEasing:{}},n),originalProperties:t,originalOptions:n,startTime:Ye||E(),duration:n.duration,tweens:[],createTween:function(t,n){var i=Z.Tween(e,u.opts,t,n,u.opts.specialEasing[t]||u.opts.easing);return u.tweens.push(i),i},stop:function(t){var n=0,i=t?u.tweens.length:0;if(r)return this;for(r=!0;i>n;n++)u.tweens[n].run(1);return t?s.resolveWith(e,[u,t]):s.rejectWith(e,[u,t]),this}}),c=u.props;for(I(c,u.opts.specialEasing);a>o;o++)if(i=tt[o].call(u,e,c,u.opts))return i;return Z.map(c,N,u),Z.isFunction(u.opts.start)&&u.opts.start.call(e,u),Z.fx.timer(Z.extend(l,{elem:e,anim:u,queue:u.opts.queue})),u.progress(u.opts.progress).done(u.opts.done,u.opts.complete).fail(u.opts.fail).always(u.opts.always)}function D(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var i,r=0,o=t.toLowerCase().match(fe)||[];if(Z.isFunction(n))for(;i=o[r++];)"+"===i[0]?(i=i.slice(1)||"*",(e[i]=e[i]||[]).unshift(n)):(e[i]=e[i]||[]).push(n)}}function B(e,t,n,i){function r(s){var l;return o[s]=!0,Z.each(e[s]||[],function(e,s){var u=s(t,n,i);return"string"!=typeof u||a||o[u]?a?!(l=u):void 0:(t.dataTypes.unshift(u),r(u),!1)}),l}var o={},a=e===wt;return r(t.dataTypes[0])||!o["*"]&&r("*")}function R(e,t){var n,i,r=Z.ajaxSettings.flatOptions||{};for(n in t)void 0!==t[n]&&((r[n]?e:i||(i={}))[n]=t[n]);return i&&Z.extend(!0,e,i),e}function z(e,t,n){for(var i,r,o,a,s=e.contents,l=e.dataTypes;"*"===l[0];)l.shift(),void 0===i&&(i=e.mimeType||t.getResponseHeader("Content-Type"));if(i)for(r in s)if(s[r]&&s[r].test(i)){l.unshift(r);break}if(l[0]in n)o=l[0];else{for(r in n){if(!l[0]||e.converters[r+" "+l[0]]){o=r;break}a||(a=r)}o=o||a}return o?(o!==l[0]&&l.unshift(o),n[o]):void 0}function W(e,t,n,i){var r,o,a,s,l,u={},c=e.dataTypes.slice();if(c[1])for(a in e.converters)u[a.toLowerCase()]=e.converters[a];for(o=c.shift();o;)if(e.responseFields[o]&&(n[e.responseFields[o]]=t),!l&&i&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),l=o,o=c.shift())if("*"===o)o=l;else if("*"!==l&&l!==o){if(a=u[l+" "+o]||u["* "+o],!a)for(r in u)if(s=r.split(" "),s[1]===o&&(a=u[l+" "+s[0]]||u["* "+s[0]])){a===!0?a=u[r]:u[r]!==!0&&(o=s[0],c.unshift(s[1]));break}if(a!==!0)if(a&&e["throws"])t=a(t);else try{t=a(t)}catch(h){return{state:"parsererror",error:a?h:"No conversion from "+l+" to "+o}}}return{state:"success",data:t}}function H(e,t,n,i){var r;if(Z.isArray(t))Z.each(t,function(t,r){n||St.test(e)?i(e,r):H(e+"["+("object"==typeof r?t:"")+"]",r,n,i)});else if(n||"object"!==Z.type(t))i(e,t);else for(r in t)H(e+"["+r+"]",t[r],n,i)}function U(e){return Z.isWindow(e)?e:9===e.nodeType&&e.defaultView}var V=[],j=V.slice,F=V.concat,$=V.push,K=V.indexOf,q={},G=q.toString,X=q.hasOwnProperty,Y={},Q=e.document,J="2.1.1",Z=function(e,t){return new Z.fn.init(e,t)},ee=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,te=/^-ms-/,ne=/-([\da-z])/gi,ie=function(e,t){return t.toUpperCase()};Z.fn=Z.prototype={jquery:J,constructor:Z,selector:"",length:0,toArray:function(){return j.call(this)},get:function(e){return null!=e?0>e?this[e+this.length]:this[e]:j.call(this)},pushStack:function(e){var t=Z.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return Z.each(this,e,t)},map:function(e){return this.pushStack(Z.map(this,function(t,n){return e.call(t,n,t)}))},slice:function(){return this.pushStack(j.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(0>e?t:0);return this.pushStack(n>=0&&t>n?[this[n]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:$,sort:V.sort,splice:V.splice},Z.extend=Z.fn.extend=function(){var e,t,n,i,r,o,a=arguments[0]||{},s=1,l=arguments.length,u=!1;for("boolean"==typeof a&&(u=a,a=arguments[s]||{},s++),"object"==typeof a||Z.isFunction(a)||(a={}),s===l&&(a=this,s--);l>s;s++)if(null!=(e=arguments[s]))for(t in e)n=a[t],i=e[t],a!==i&&(u&&i&&(Z.isPlainObject(i)||(r=Z.isArray(i)))?(r?(r=!1,o=n&&Z.isArray(n)?n:[]):o=n&&Z.isPlainObject(n)?n:{},a[t]=Z.extend(u,o,i)):void 0!==i&&(a[t]=i));return a},Z.extend({expando:"jQuery"+(J+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isFunction:function(e){return"function"===Z.type(e)},isArray:Array.isArray,isWindow:function(e){return null!=e&&e===e.window},isNumeric:function(e){return!Z.isArray(e)&&e-parseFloat(e)>=0},isPlainObject:function(e){return"object"!==Z.type(e)||e.nodeType||Z.isWindow(e)?!1:e.constructor&&!X.call(e.constructor.prototype,"isPrototypeOf")?!1:!0},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?q[G.call(e)]||"object":typeof e},globalEval:function(e){var t,n=eval;e=Z.trim(e),e&&(1===e.indexOf("use strict")?(t=Q.createElement("script"),t.text=e,Q.head.appendChild(t).parentNode.removeChild(t)):n(e))},camelCase:function(e){return e.replace(te,"ms-").replace(ne,ie)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,i){var r,o=0,a=e.length,s=n(e);if(i){if(s)for(;a>o&&(r=t.apply(e[o],i),r!==!1);o++);else for(o in e)if(r=t.apply(e[o],i),r===!1)break}else if(s)for(;a>o&&(r=t.call(e[o],o,e[o]),r!==!1);o++);else for(o in e)if(r=t.call(e[o],o,e[o]),r===!1)break;return e},trim:function(e){return null==e?"":(e+"").replace(ee,"")},makeArray:function(e,t){var i=t||[];return null!=e&&(n(Object(e))?Z.merge(i,"string"==typeof e?[e]:e):$.call(i,e)),i},inArray:function(e,t,n){return null==t?-1:K.call(t,e,n)},merge:function(e,t){for(var n=+t.length,i=0,r=e.length;n>i;i++)e[r++]=t[i];return e.length=r,e},grep:function(e,t,n){for(var i,r=[],o=0,a=e.length,s=!n;a>o;o++)i=!t(e[o],o),i!==s&&r.push(e[o]);return r},map:function(e,t,i){var r,o=0,a=e.length,s=n(e),l=[];if(s)for(;a>o;o++)r=t(e[o],o,i),null!=r&&l.push(r);else for(o in e)r=t(e[o],o,i),null!=r&&l.push(r);return F.apply([],l)},guid:1,proxy:function(e,t){var n,i,r;return"string"==typeof t&&(n=e[t],t=e,e=n),Z.isFunction(e)?(i=j.call(arguments,2),r=function(){return e.apply(t||this,i.concat(j.call(arguments)))},r.guid=e.guid=e.guid||Z.guid++,r):void 0},now:Date.now,support:Y}),Z.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){q["[object "+t+"]"]=t.toLowerCase()});var re=function(e){function t(e,t,n,i){var r,o,a,s,l,u,h,f,p,g;if((t?t.ownerDocument||t:H)!==A&&N(t),t=t||A,n=n||[],!e||"string"!=typeof e)return n;if(1!==(s=t.nodeType)&&9!==s)return[];if(O&&!i){if(r=ye.exec(e))if(a=r[1]){if(9===s){if(o=t.getElementById(a),!o||!o.parentNode)return n;if(o.id===a)return n.push(o),n}else if(t.ownerDocument&&(o=t.ownerDocument.getElementById(a))&&z(t,o)&&o.id===a)return n.push(o),n}else{if(r[2])return Z.apply(n,t.getElementsByTagName(e)),n;if((a=r[3])&&w.getElementsByClassName&&t.getElementsByClassName)return Z.apply(n,t.getElementsByClassName(a)),n}if(w.qsa&&(!D||!D.test(e))){if(f=h=W,p=t,g=9===s&&e,1===s&&"object"!==t.nodeName.toLowerCase()){for(u=S(e),(h=t.getAttribute("id"))?f=h.replace(be,"\\$&"):t.setAttribute("id",f),f="[id='"+f+"'] ",l=u.length;l--;)u[l]=f+d(u[l]);p=_e.test(e)&&c(t.parentNode)||t,g=u.join(",")}if(g)try{return Z.apply(n,p.querySelectorAll(g)),n}catch(m){}finally{h||t.removeAttribute("id")}}}return M(e.replace(le,"$1"),t,n,i)}function n(){function e(n,i){return t.push(n+" ")>x.cacheLength&&delete e[t.shift()],e[n+" "]=i}var t=[];return e}function i(e){return e[W]=!0,e}function r(e){var t=A.createElement("div");try{return!!e(t)}catch(n){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function o(e,t){for(var n=e.split("|"),i=e.length;i--;)x.attrHandle[n[i]]=t}function a(e,t){var n=t&&e,i=n&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||G)-(~e.sourceIndex||G);if(i)return i;if(n)for(;n=n.nextSibling;)if(n===t)return-1;return e?1:-1}function s(e){return function(t){var n=t.nodeName.toLowerCase();return"input"===n&&t.type===e}}function l(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function u(e){return i(function(t){return t=+t,i(function(n,i){for(var r,o=e([],n.length,t),a=o.length;a--;)n[r=o[a]]&&(n[r]=!(i[r]=n[r]))})})}function c(e){return e&&typeof e.getElementsByTagName!==q&&e}function h(){}function d(e){for(var t=0,n=e.length,i="";n>t;t++)i+=e[t].value;return i}function f(e,t,n){var i=t.dir,r=n&&"parentNode"===i,o=V++;return t.first?function(t,n,o){for(;t=t[i];)if(1===t.nodeType||r)return e(t,n,o)}:function(t,n,a){var s,l,u=[U,o];if(a){for(;t=t[i];)if((1===t.nodeType||r)&&e(t,n,a))return!0}else for(;t=t[i];)if(1===t.nodeType||r){if(l=t[W]||(t[W]={}),(s=l[i])&&s[0]===U&&s[1]===o)return u[2]=s[2];if(l[i]=u,u[2]=e(t,n,a))return!0}}}function p(e){return e.length>1?function(t,n,i){for(var r=e.length;r--;)if(!e[r](t,n,i))return!1;return!0}:e[0]}function g(e,n,i){for(var r=0,o=n.length;o>r;r++)t(e,n[r],i);return i}function m(e,t,n,i,r){for(var o,a=[],s=0,l=e.length,u=null!=t;l>s;s++)(o=e[s])&&(!n||n(o,i,r))&&(a.push(o),u&&t.push(s));return a}function v(e,t,n,r,o,a){return r&&!r[W]&&(r=v(r)),o&&!o[W]&&(o=v(o,a)),i(function(i,a,s,l){var u,c,h,d=[],f=[],p=a.length,v=i||g(t||"*",s.nodeType?[s]:s,[]),y=!e||!i&&t?v:m(v,d,e,s,l),_=n?o||(i?e:p||r)?[]:a:y;if(n&&n(y,_,s,l),r)for(u=m(_,f),r(u,[],s,l),c=u.length;c--;)(h=u[c])&&(_[f[c]]=!(y[f[c]]=h));if(i){if(o||e){if(o){for(u=[],c=_.length;c--;)(h=_[c])&&u.push(y[c]=h);o(null,_=[],u,l)}for(c=_.length;c--;)(h=_[c])&&(u=o?te.call(i,h):d[c])>-1&&(i[u]=!(a[u]=h))}}else _=m(_===a?_.splice(p,_.length):_),o?o(null,a,_,l):Z.apply(a,_)})}function y(e){for(var t,n,i,r=e.length,o=x.relative[e[0].type],a=o||x.relative[" "],s=o?1:0,l=f(function(e){return e===t},a,!0),u=f(function(e){return te.call(t,e)>-1},a,!0),c=[function(e,n,i){return!o&&(i||n!==L)||((t=n).nodeType?l(e,n,i):u(e,n,i))}];r>s;s++)if(n=x.relative[e[s].type])c=[f(p(c),n)];else{if(n=x.filter[e[s].type].apply(null,e[s].matches),n[W]){for(i=++s;r>i&&!x.relative[e[i].type];i++);return v(s>1&&p(c),s>1&&d(e.slice(0,s-1).concat({value:" "===e[s-2].type?"*":""})).replace(le,"$1"),n,i>s&&y(e.slice(s,i)),r>i&&y(e=e.slice(i)),r>i&&d(e))}c.push(n)}return p(c)}function _(e,n){var r=n.length>0,o=e.length>0,a=function(i,a,s,l,u){var c,h,d,f=0,p="0",g=i&&[],v=[],y=L,_=i||o&&x.find.TAG("*",u),b=U+=null==y?1:Math.random()||.1,w=_.length;for(u&&(L=a!==A&&a);p!==w&&null!=(c=_[p]);p++){if(o&&c){for(h=0;d=e[h++];)if(d(c,a,s)){l.push(c);break}u&&(U=b)}r&&((c=!d&&c)&&f--,i&&g.push(c))}if(f+=p,r&&p!==f){for(h=0;d=n[h++];)d(g,v,a,s);if(i){if(f>0)for(;p--;)g[p]||v[p]||(v[p]=Q.call(l));v=m(v)}Z.apply(l,v),u&&!i&&v.length>0&&f+n.length>1&&t.uniqueSort(l)}return u&&(U=b,L=y),g};return r?i(a):a}var b,w,x,k,C,S,T,M,L,E,P,N,A,I,O,D,B,R,z,W="sizzle"+-new Date,H=e.document,U=0,V=0,j=n(),F=n(),$=n(),K=function(e,t){return e===t&&(P=!0),0},q="undefined",G=1<<31,X={}.hasOwnProperty,Y=[],Q=Y.pop,J=Y.push,Z=Y.push,ee=Y.slice,te=Y.indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(this[t]===e)return t;return-1},ne="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",ie="[\\x20\\t\\r\\n\\f]",re="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",oe=re.replace("w","w#"),ae="\\["+ie+"*("+re+")(?:"+ie+"*([*^$|!~]?=)"+ie+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+oe+"))|)"+ie+"*\\]",se=":("+re+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+ae+")*)|.*)\\)|)",le=new RegExp("^"+ie+"+|((?:^|[^\\\\])(?:\\\\.)*)"+ie+"+$","g"),ue=new RegExp("^"+ie+"*,"+ie+"*"),ce=new RegExp("^"+ie+"*([>+~]|"+ie+")"+ie+"*"),he=new RegExp("="+ie+"*([^\\]'\"]*?)"+ie+"*\\]","g"),de=new RegExp(se),fe=new RegExp("^"+oe+"$"),pe={ID:new RegExp("^#("+re+")"),CLASS:new RegExp("^\\.("+re+")"),TAG:new RegExp("^("+re.replace("w","w*")+")"),ATTR:new RegExp("^"+ae),PSEUDO:new RegExp("^"+se),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+ie+"*(even|odd|(([+-]|)(\\d*)n|)"+ie+"*(?:([+-]|)"+ie+"*(\\d+)|))"+ie+"*\\)|)","i"),bool:new RegExp("^(?:"+ne+")$","i"),needsContext:new RegExp("^"+ie+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+ie+"*((?:-\\d)?\\d*)"+ie+"*\\)|)(?=[^-]|$)","i")},ge=/^(?:input|select|textarea|button)$/i,me=/^h\d$/i,ve=/^[^{]+\{\s*\[native \w/,ye=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,_e=/[+~]/,be=/'|\\/g,we=new RegExp("\\\\([\\da-f]{1,6}"+ie+"?|("+ie+")|.)","ig"),xe=function(e,t,n){var i="0x"+t-65536;return i!==i||n?t:0>i?String.fromCharCode(i+65536):String.fromCharCode(i>>10|55296,1023&i|56320)};try{Z.apply(Y=ee.call(H.childNodes),H.childNodes),Y[H.childNodes.length].nodeType}catch(ke){Z={apply:Y.length?function(e,t){J.apply(e,ee.call(t))}:function(e,t){for(var n=e.length,i=0;e[n++]=t[i++];);e.length=n-1}}}w=t.support={},C=t.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?"HTML"!==t.nodeName:!1},N=t.setDocument=function(e){var t,n=e?e.ownerDocument||e:H,i=n.defaultView;return n!==A&&9===n.nodeType&&n.documentElement?(A=n,I=n.documentElement,O=!C(n),i&&i!==i.top&&(i.addEventListener?i.addEventListener("unload",function(){N()},!1):i.attachEvent&&i.attachEvent("onunload",function(){N()})),w.attributes=r(function(e){return e.className="i",!e.getAttribute("className")}),w.getElementsByTagName=r(function(e){return e.appendChild(n.createComment("")),!e.getElementsByTagName("*").length}),w.getElementsByClassName=ve.test(n.getElementsByClassName)&&r(function(e){return e.innerHTML="<div class='a'></div><div class='a i'></div>",e.firstChild.className="i",2===e.getElementsByClassName("i").length}),w.getById=r(function(e){return I.appendChild(e).id=W,!n.getElementsByName||!n.getElementsByName(W).length}),w.getById?(x.find.ID=function(e,t){if(typeof t.getElementById!==q&&O){var n=t.getElementById(e);return n&&n.parentNode?[n]:[]}},x.filter.ID=function(e){var t=e.replace(we,xe);return function(e){return e.getAttribute("id")===t}}):(delete x.find.ID,x.filter.ID=function(e){var t=e.replace(we,xe);return function(e){var n=typeof e.getAttributeNode!==q&&e.getAttributeNode("id");return n&&n.value===t}}),x.find.TAG=w.getElementsByTagName?function(e,t){return typeof t.getElementsByTagName!==q?t.getElementsByTagName(e):void 0}:function(e,t){var n,i=[],r=0,o=t.getElementsByTagName(e);if("*"===e){for(;n=o[r++];)1===n.nodeType&&i.push(n);return i}return o},x.find.CLASS=w.getElementsByClassName&&function(e,t){return typeof t.getElementsByClassName!==q&&O?t.getElementsByClassName(e):void 0},B=[],D=[],(w.qsa=ve.test(n.querySelectorAll))&&(r(function(e){e.innerHTML="<select msallowclip=''><option selected=''></option></select>",e.querySelectorAll("[msallowclip^='']").length&&D.push("[*^$]="+ie+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||D.push("\\["+ie+"*(?:value|"+ne+")"),e.querySelectorAll(":checked").length||D.push(":checked")}),r(function(e){var t=n.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&D.push("name"+ie+"*[*^$|!~]?="),e.querySelectorAll(":enabled").length||D.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),D.push(",.*:")})),(w.matchesSelector=ve.test(R=I.matches||I.webkitMatchesSelector||I.mozMatchesSelector||I.oMatchesSelector||I.msMatchesSelector))&&r(function(e){w.disconnectedMatch=R.call(e,"div"),R.call(e,"[s!='']:x"),B.push("!=",se)}),D=D.length&&new RegExp(D.join("|")),B=B.length&&new RegExp(B.join("|")),t=ve.test(I.compareDocumentPosition),z=t||ve.test(I.contains)?function(e,t){var n=9===e.nodeType?e.documentElement:e,i=t&&t.parentNode;return e===i||!(!i||1!==i.nodeType||!(n.contains?n.contains(i):e.compareDocumentPosition&&16&e.compareDocumentPosition(i)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},K=t?function(e,t){if(e===t)return P=!0,0;var i=!e.compareDocumentPosition-!t.compareDocumentPosition;return i?i:(i=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1,1&i||!w.sortDetached&&t.compareDocumentPosition(e)===i?e===n||e.ownerDocument===H&&z(H,e)?-1:t===n||t.ownerDocument===H&&z(H,t)?1:E?te.call(E,e)-te.call(E,t):0:4&i?-1:1)}:function(e,t){if(e===t)return P=!0,0;var i,r=0,o=e.parentNode,s=t.parentNode,l=[e],u=[t];if(!o||!s)return e===n?-1:t===n?1:o?-1:s?1:E?te.call(E,e)-te.call(E,t):0;if(o===s)return a(e,t);for(i=e;i=i.parentNode;)l.unshift(i);for(i=t;i=i.parentNode;)u.unshift(i);for(;l[r]===u[r];)r++;return r?a(l[r],u[r]):l[r]===H?-1:u[r]===H?1:0},n):A},t.matches=function(e,n){return t(e,null,null,n)},t.matchesSelector=function(e,n){if((e.ownerDocument||e)!==A&&N(e),n=n.replace(he,"='$1']"),w.matchesSelector&&O&&(!B||!B.test(n))&&(!D||!D.test(n)))try{var i=R.call(e,n);if(i||w.disconnectedMatch||e.document&&11!==e.document.nodeType)return i}catch(r){}return t(n,A,null,[e]).length>0},t.contains=function(e,t){return(e.ownerDocument||e)!==A&&N(e),z(e,t)},t.attr=function(e,t){(e.ownerDocument||e)!==A&&N(e);var n=x.attrHandle[t.toLowerCase()],i=n&&X.call(x.attrHandle,t.toLowerCase())?n(e,t,!O):void 0;return void 0!==i?i:w.attributes||!O?e.getAttribute(t):(i=e.getAttributeNode(t))&&i.specified?i.value:null},t.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},t.uniqueSort=function(e){var t,n=[],i=0,r=0;if(P=!w.detectDuplicates,E=!w.sortStable&&e.slice(0),e.sort(K),P){for(;t=e[r++];)t===e[r]&&(i=n.push(r));for(;i--;)e.splice(n[i],1)}return E=null,e},k=t.getText=function(e){var t,n="",i=0,r=e.nodeType;if(r){if(1===r||9===r||11===r){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=k(e)}else if(3===r||4===r)return e.nodeValue}else for(;t=e[i++];)n+=k(t);return n},x=t.selectors={cacheLength:50,createPseudo:i,match:pe,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(we,xe),e[3]=(e[3]||e[4]||e[5]||"").replace(we,xe),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||t.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&t.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return pe.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&de.test(n)&&(t=S(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(we,xe).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=j[e+" "];return t||(t=new RegExp("(^|"+ie+")"+e+"("+ie+"|$)"))&&j(e,function(e){return t.test("string"==typeof e.className&&e.className||typeof e.getAttribute!==q&&e.getAttribute("class")||"")})},ATTR:function(e,n,i){return function(r){var o=t.attr(r,e);return null==o?"!="===n:n?(o+="","="===n?o===i:"!="===n?o!==i:"^="===n?i&&0===o.indexOf(i):"*="===n?i&&o.indexOf(i)>-1:"$="===n?i&&o.slice(-i.length)===i:"~="===n?(" "+o+" ").indexOf(i)>-1:"|="===n?o===i||o.slice(0,i.length+1)===i+"-":!1):!0}},CHILD:function(e,t,n,i,r){var o="nth"!==e.slice(0,3),a="last"!==e.slice(-4),s="of-type"===t;return 1===i&&0===r?function(e){return!!e.parentNode}:function(t,n,l){var u,c,h,d,f,p,g=o!==a?"nextSibling":"previousSibling",m=t.parentNode,v=s&&t.nodeName.toLowerCase(),y=!l&&!s;if(m){if(o){for(;g;){for(h=t;h=h[g];)if(s?h.nodeName.toLowerCase()===v:1===h.nodeType)return!1;p=g="only"===e&&!p&&"nextSibling"}return!0}if(p=[a?m.firstChild:m.lastChild],a&&y){for(c=m[W]||(m[W]={}),u=c[e]||[],f=u[0]===U&&u[1],d=u[0]===U&&u[2],h=f&&m.childNodes[f];h=++f&&h&&h[g]||(d=f=0)||p.pop();)if(1===h.nodeType&&++d&&h===t){c[e]=[U,f,d];break}}else if(y&&(u=(t[W]||(t[W]={}))[e])&&u[0]===U)d=u[1];else for(;(h=++f&&h&&h[g]||(d=f=0)||p.pop())&&((s?h.nodeName.toLowerCase()!==v:1!==h.nodeType)||!++d||(y&&((h[W]||(h[W]={}))[e]=[U,d]),h!==t)););return d-=r,d===i||d%i===0&&d/i>=0}}},PSEUDO:function(e,n){var r,o=x.pseudos[e]||x.setFilters[e.toLowerCase()]||t.error("unsupported pseudo: "+e);return o[W]?o(n):o.length>1?(r=[e,e,"",n],x.setFilters.hasOwnProperty(e.toLowerCase())?i(function(e,t){for(var i,r=o(e,n),a=r.length;a--;)i=te.call(e,r[a]),e[i]=!(t[i]=r[a])}):function(e){return o(e,0,r)}):o}},pseudos:{not:i(function(e){var t=[],n=[],r=T(e.replace(le,"$1"));return r[W]?i(function(e,t,n,i){for(var o,a=r(e,null,i,[]),s=e.length;s--;)(o=a[s])&&(e[s]=!(t[s]=o))}):function(e,i,o){return t[0]=e,r(t,null,o,n),!n.pop()}}),has:i(function(e){return function(n){return t(e,n).length>0}}),contains:i(function(e){return function(t){return(t.textContent||t.innerText||k(t)).indexOf(e)>-1}}),lang:i(function(e){return fe.test(e||"")||t.error("unsupported lang: "+e),e=e.replace(we,xe).toLowerCase(),function(t){var n;do if(n=O?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return n=n.toLowerCase(),n===e||0===n.indexOf(e+"-");while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===I},focus:function(e){return e===A.activeElement&&(!A.hasFocus||A.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!x.pseudos.empty(e)},header:function(e){return me.test(e.nodeName)},input:function(e){return ge.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:u(function(){return[0]}),last:u(function(e,t){return[t-1]}),eq:u(function(e,t,n){return[0>n?n+t:n]}),even:u(function(e,t){for(var n=0;t>n;n+=2)e.push(n);return e}),odd:u(function(e,t){for(var n=1;t>n;n+=2)e.push(n);return e}),lt:u(function(e,t,n){for(var i=0>n?n+t:n;--i>=0;)e.push(i);return e}),gt:u(function(e,t,n){for(var i=0>n?n+t:n;++i<t;)e.push(i);return e})}},x.pseudos.nth=x.pseudos.eq;for(b in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})x.pseudos[b]=s(b);for(b in{submit:!0,reset:!0})x.pseudos[b]=l(b);return h.prototype=x.filters=x.pseudos,x.setFilters=new h,S=t.tokenize=function(e,n){var i,r,o,a,s,l,u,c=F[e+" "];if(c)return n?0:c.slice(0);for(s=e,l=[],u=x.preFilter;s;){(!i||(r=ue.exec(s)))&&(r&&(s=s.slice(r[0].length)||s),l.push(o=[])),i=!1,(r=ce.exec(s))&&(i=r.shift(),o.push({value:i,type:r[0].replace(le," ")}),s=s.slice(i.length));for(a in x.filter)!(r=pe[a].exec(s))||u[a]&&!(r=u[a](r))||(i=r.shift(),o.push({value:i,type:a,matches:r}),s=s.slice(i.length));if(!i)break}return n?s.length:s?t.error(e):F(e,l).slice(0)},T=t.compile=function(e,t){var n,i=[],r=[],o=$[e+" "];if(!o){for(t||(t=S(e)),n=t.length;n--;)o=y(t[n]),o[W]?i.push(o):r.push(o);o=$(e,_(r,i)),o.selector=e}return o},M=t.select=function(e,t,n,i){var r,o,a,s,l,u="function"==typeof e&&e,h=!i&&S(e=u.selector||e);if(n=n||[],1===h.length){if(o=h[0]=h[0].slice(0),o.length>2&&"ID"===(a=o[0]).type&&w.getById&&9===t.nodeType&&O&&x.relative[o[1].type]){if(t=(x.find.ID(a.matches[0].replace(we,xe),t)||[])[0],!t)return n;u&&(t=t.parentNode),e=e.slice(o.shift().value.length)}for(r=pe.needsContext.test(e)?0:o.length;r--&&(a=o[r],!x.relative[s=a.type]);)if((l=x.find[s])&&(i=l(a.matches[0].replace(we,xe),_e.test(o[0].type)&&c(t.parentNode)||t))){if(o.splice(r,1),e=i.length&&d(o),!e)return Z.apply(n,i),n;break}}return(u||T(e,h))(i,t,!O,n,_e.test(e)&&c(t.parentNode)||t),n},w.sortStable=W.split("").sort(K).join("")===W,w.detectDuplicates=!!P,N(),w.sortDetached=r(function(e){return 1&e.compareDocumentPosition(A.createElement("div"))}),r(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||o("type|href|height|width",function(e,t,n){
return n?void 0:e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),w.attributes&&r(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||o("value",function(e,t,n){return n||"input"!==e.nodeName.toLowerCase()?void 0:e.defaultValue}),r(function(e){return null==e.getAttribute("disabled")})||o(ne,function(e,t,n){var i;return n?void 0:e[t]===!0?t.toLowerCase():(i=e.getAttributeNode(t))&&i.specified?i.value:null}),t}(e);Z.find=re,Z.expr=re.selectors,Z.expr[":"]=Z.expr.pseudos,Z.unique=re.uniqueSort,Z.text=re.getText,Z.isXMLDoc=re.isXML,Z.contains=re.contains;var oe=Z.expr.match.needsContext,ae=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,se=/^.[^:#\[\.,]*$/;Z.filter=function(e,t,n){var i=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===i.nodeType?Z.find.matchesSelector(i,e)?[i]:[]:Z.find.matches(e,Z.grep(t,function(e){return 1===e.nodeType}))},Z.fn.extend({find:function(e){var t,n=this.length,i=[],r=this;if("string"!=typeof e)return this.pushStack(Z(e).filter(function(){for(t=0;n>t;t++)if(Z.contains(r[t],this))return!0}));for(t=0;n>t;t++)Z.find(e,r[t],i);return i=this.pushStack(n>1?Z.unique(i):i),i.selector=this.selector?this.selector+" "+e:e,i},filter:function(e){return this.pushStack(i(this,e||[],!1))},not:function(e){return this.pushStack(i(this,e||[],!0))},is:function(e){return!!i(this,"string"==typeof e&&oe.test(e)?Z(e):e||[],!1).length}});var le,ue=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,ce=Z.fn.init=function(e,t){var n,i;if(!e)return this;if("string"==typeof e){if(n="<"===e[0]&&">"===e[e.length-1]&&e.length>=3?[null,e,null]:ue.exec(e),!n||!n[1]&&t)return!t||t.jquery?(t||le).find(e):this.constructor(t).find(e);if(n[1]){if(t=t instanceof Z?t[0]:t,Z.merge(this,Z.parseHTML(n[1],t&&t.nodeType?t.ownerDocument||t:Q,!0)),ae.test(n[1])&&Z.isPlainObject(t))for(n in t)Z.isFunction(this[n])?this[n](t[n]):this.attr(n,t[n]);return this}return i=Q.getElementById(n[2]),i&&i.parentNode&&(this.length=1,this[0]=i),this.context=Q,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):Z.isFunction(e)?"undefined"!=typeof le.ready?le.ready(e):e(Z):(void 0!==e.selector&&(this.selector=e.selector,this.context=e.context),Z.makeArray(e,this))};ce.prototype=Z.fn,le=Z(Q);var he=/^(?:parents|prev(?:Until|All))/,de={children:!0,contents:!0,next:!0,prev:!0};Z.extend({dir:function(e,t,n){for(var i=[],r=void 0!==n;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(r&&Z(e).is(n))break;i.push(e)}return i},sibling:function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n}}),Z.fn.extend({has:function(e){var t=Z(e,this),n=t.length;return this.filter(function(){for(var e=0;n>e;e++)if(Z.contains(this,t[e]))return!0})},closest:function(e,t){for(var n,i=0,r=this.length,o=[],a=oe.test(e)||"string"!=typeof e?Z(e,t||this.context):0;r>i;i++)for(n=this[i];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(a?a.index(n)>-1:1===n.nodeType&&Z.find.matchesSelector(n,e))){o.push(n);break}return this.pushStack(o.length>1?Z.unique(o):o)},index:function(e){return e?"string"==typeof e?K.call(Z(e),this[0]):K.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(Z.unique(Z.merge(this.get(),Z(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),Z.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return Z.dir(e,"parentNode")},parentsUntil:function(e,t,n){return Z.dir(e,"parentNode",n)},next:function(e){return r(e,"nextSibling")},prev:function(e){return r(e,"previousSibling")},nextAll:function(e){return Z.dir(e,"nextSibling")},prevAll:function(e){return Z.dir(e,"previousSibling")},nextUntil:function(e,t,n){return Z.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return Z.dir(e,"previousSibling",n)},siblings:function(e){return Z.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return Z.sibling(e.firstChild)},contents:function(e){return e.contentDocument||Z.merge([],e.childNodes)}},function(e,t){Z.fn[e]=function(n,i){var r=Z.map(this,t,n);return"Until"!==e.slice(-5)&&(i=n),i&&"string"==typeof i&&(r=Z.filter(i,r)),this.length>1&&(de[e]||Z.unique(r),he.test(e)&&r.reverse()),this.pushStack(r)}});var fe=/\S+/g,pe={};Z.Callbacks=function(e){e="string"==typeof e?pe[e]||o(e):Z.extend({},e);var t,n,i,r,a,s,l=[],u=!e.once&&[],c=function(o){for(t=e.memory&&o,n=!0,s=r||0,r=0,a=l.length,i=!0;l&&a>s;s++)if(l[s].apply(o[0],o[1])===!1&&e.stopOnFalse){t=!1;break}i=!1,l&&(u?u.length&&c(u.shift()):t?l=[]:h.disable())},h={add:function(){if(l){var n=l.length;!function o(t){Z.each(t,function(t,n){var i=Z.type(n);"function"===i?e.unique&&h.has(n)||l.push(n):n&&n.length&&"string"!==i&&o(n)})}(arguments),i?a=l.length:t&&(r=n,c(t))}return this},remove:function(){return l&&Z.each(arguments,function(e,t){for(var n;(n=Z.inArray(t,l,n))>-1;)l.splice(n,1),i&&(a>=n&&a--,s>=n&&s--)}),this},has:function(e){return e?Z.inArray(e,l)>-1:!(!l||!l.length)},empty:function(){return l=[],a=0,this},disable:function(){return l=u=t=void 0,this},disabled:function(){return!l},lock:function(){return u=void 0,t||h.disable(),this},locked:function(){return!u},fireWith:function(e,t){return!l||n&&!u||(t=t||[],t=[e,t.slice?t.slice():t],i?u.push(t):c(t)),this},fire:function(){return h.fireWith(this,arguments),this},fired:function(){return!!n}};return h},Z.extend({Deferred:function(e){var t=[["resolve","done",Z.Callbacks("once memory"),"resolved"],["reject","fail",Z.Callbacks("once memory"),"rejected"],["notify","progress",Z.Callbacks("memory")]],n="pending",i={state:function(){return n},always:function(){return r.done(arguments).fail(arguments),this},then:function(){var e=arguments;return Z.Deferred(function(n){Z.each(t,function(t,o){var a=Z.isFunction(e[t])&&e[t];r[o[1]](function(){var e=a&&a.apply(this,arguments);e&&Z.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[o[0]+"With"](this===i?n.promise():this,a?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?Z.extend(e,i):i}},r={};return i.pipe=i.then,Z.each(t,function(e,o){var a=o[2],s=o[3];i[o[1]]=a.add,s&&a.add(function(){n=s},t[1^e][2].disable,t[2][2].lock),r[o[0]]=function(){return r[o[0]+"With"](this===r?i:this,arguments),this},r[o[0]+"With"]=a.fireWith}),i.promise(r),e&&e.call(r,r),r},when:function(e){var t,n,i,r=0,o=j.call(arguments),a=o.length,s=1!==a||e&&Z.isFunction(e.promise)?a:0,l=1===s?e:Z.Deferred(),u=function(e,n,i){return function(r){n[e]=this,i[e]=arguments.length>1?j.call(arguments):r,i===t?l.notifyWith(n,i):--s||l.resolveWith(n,i)}};if(a>1)for(t=new Array(a),n=new Array(a),i=new Array(a);a>r;r++)o[r]&&Z.isFunction(o[r].promise)?o[r].promise().done(u(r,i,o)).fail(l.reject).progress(u(r,n,t)):--s;return s||l.resolveWith(i,o),l.promise()}});var ge;Z.fn.ready=function(e){return Z.ready.promise().done(e),this},Z.extend({isReady:!1,readyWait:1,holdReady:function(e){e?Z.readyWait++:Z.ready(!0)},ready:function(e){(e===!0?--Z.readyWait:Z.isReady)||(Z.isReady=!0,e!==!0&&--Z.readyWait>0||(ge.resolveWith(Q,[Z]),Z.fn.triggerHandler&&(Z(Q).triggerHandler("ready"),Z(Q).off("ready"))))}}),Z.ready.promise=function(t){return ge||(ge=Z.Deferred(),"complete"===Q.readyState?setTimeout(Z.ready):(Q.addEventListener("DOMContentLoaded",a,!1),e.addEventListener("load",a,!1))),ge.promise(t)},Z.ready.promise();var me=Z.access=function(e,t,n,i,r,o,a){var s=0,l=e.length,u=null==n;if("object"===Z.type(n)){r=!0;for(s in n)Z.access(e,t,s,n[s],!0,o,a)}else if(void 0!==i&&(r=!0,Z.isFunction(i)||(a=!0),u&&(a?(t.call(e,i),t=null):(u=t,t=function(e,t,n){return u.call(Z(e),n)})),t))for(;l>s;s++)t(e[s],n,a?i:i.call(e[s],s,t(e[s],n)));return r?e:u?t.call(e):l?t(e[0],n):o};Z.acceptData=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType},s.uid=1,s.accepts=Z.acceptData,s.prototype={key:function(e){if(!s.accepts(e))return 0;var t={},n=e[this.expando];if(!n){n=s.uid++;try{t[this.expando]={value:n},Object.defineProperties(e,t)}catch(i){t[this.expando]=n,Z.extend(e,t)}}return this.cache[n]||(this.cache[n]={}),n},set:function(e,t,n){var i,r=this.key(e),o=this.cache[r];if("string"==typeof t)o[t]=n;else if(Z.isEmptyObject(o))Z.extend(this.cache[r],t);else for(i in t)o[i]=t[i];return o},get:function(e,t){var n=this.cache[this.key(e)];return void 0===t?n:n[t]},access:function(e,t,n){var i;return void 0===t||t&&"string"==typeof t&&void 0===n?(i=this.get(e,t),void 0!==i?i:this.get(e,Z.camelCase(t))):(this.set(e,t,n),void 0!==n?n:t)},remove:function(e,t){var n,i,r,o=this.key(e),a=this.cache[o];if(void 0===t)this.cache[o]={};else{Z.isArray(t)?i=t.concat(t.map(Z.camelCase)):(r=Z.camelCase(t),t in a?i=[t,r]:(i=r,i=i in a?[i]:i.match(fe)||[])),n=i.length;for(;n--;)delete a[i[n]]}},hasData:function(e){return!Z.isEmptyObject(this.cache[e[this.expando]]||{})},discard:function(e){e[this.expando]&&delete this.cache[e[this.expando]]}};var ve=new s,ye=new s,_e=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,be=/([A-Z])/g;Z.extend({hasData:function(e){return ye.hasData(e)||ve.hasData(e)},data:function(e,t,n){return ye.access(e,t,n)},removeData:function(e,t){ye.remove(e,t)},_data:function(e,t,n){return ve.access(e,t,n)},_removeData:function(e,t){ve.remove(e,t)}}),Z.fn.extend({data:function(e,t){var n,i,r,o=this[0],a=o&&o.attributes;if(void 0===e){if(this.length&&(r=ye.get(o),1===o.nodeType&&!ve.get(o,"hasDataAttrs"))){for(n=a.length;n--;)a[n]&&(i=a[n].name,0===i.indexOf("data-")&&(i=Z.camelCase(i.slice(5)),l(o,i,r[i])));ve.set(o,"hasDataAttrs",!0)}return r}return"object"==typeof e?this.each(function(){ye.set(this,e)}):me(this,function(t){var n,i=Z.camelCase(e);if(o&&void 0===t){if(n=ye.get(o,e),void 0!==n)return n;if(n=ye.get(o,i),void 0!==n)return n;if(n=l(o,i,void 0),void 0!==n)return n}else this.each(function(){var n=ye.get(this,i);ye.set(this,i,t),-1!==e.indexOf("-")&&void 0!==n&&ye.set(this,e,t)})},null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){ye.remove(this,e)})}}),Z.extend({queue:function(e,t,n){var i;return e?(t=(t||"fx")+"queue",i=ve.get(e,t),n&&(!i||Z.isArray(n)?i=ve.access(e,t,Z.makeArray(n)):i.push(n)),i||[]):void 0},dequeue:function(e,t){t=t||"fx";var n=Z.queue(e,t),i=n.length,r=n.shift(),o=Z._queueHooks(e,t),a=function(){Z.dequeue(e,t)};"inprogress"===r&&(r=n.shift(),i--),r&&("fx"===t&&n.unshift("inprogress"),delete o.stop,r.call(e,a,o)),!i&&o&&o.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return ve.get(e,n)||ve.access(e,n,{empty:Z.Callbacks("once memory").add(function(){ve.remove(e,[t+"queue",n])})})}}),Z.fn.extend({queue:function(e,t){var n=2;return"string"!=typeof e&&(t=e,e="fx",n--),arguments.length<n?Z.queue(this[0],e):void 0===t?this:this.each(function(){var n=Z.queue(this,e,t);Z._queueHooks(this,e),"fx"===e&&"inprogress"!==n[0]&&Z.dequeue(this,e)})},dequeue:function(e){return this.each(function(){Z.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,i=1,r=Z.Deferred(),o=this,a=this.length,s=function(){--i||r.resolveWith(o,[o])};for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";a--;)n=ve.get(o[a],e+"queueHooks"),n&&n.empty&&(i++,n.empty.add(s));return s(),r.promise(t)}});var we=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,xe=["Top","Right","Bottom","Left"],ke=function(e,t){return e=t||e,"none"===Z.css(e,"display")||!Z.contains(e.ownerDocument,e)},Ce=/^(?:checkbox|radio)$/i;!function(){var e=Q.createDocumentFragment(),t=e.appendChild(Q.createElement("div")),n=Q.createElement("input");n.setAttribute("type","radio"),n.setAttribute("checked","checked"),n.setAttribute("name","t"),t.appendChild(n),Y.checkClone=t.cloneNode(!0).cloneNode(!0).lastChild.checked,t.innerHTML="<textarea>x</textarea>",Y.noCloneChecked=!!t.cloneNode(!0).lastChild.defaultValue}();var Se="undefined";Y.focusinBubbles="onfocusin"in e;var Te=/^key/,Me=/^(?:mouse|pointer|contextmenu)|click/,Le=/^(?:focusinfocus|focusoutblur)$/,Ee=/^([^.]*)(?:\.(.+)|)$/;Z.event={global:{},add:function(e,t,n,i,r){var o,a,s,l,u,c,h,d,f,p,g,m=ve.get(e);if(m)for(n.handler&&(o=n,n=o.handler,r=o.selector),n.guid||(n.guid=Z.guid++),(l=m.events)||(l=m.events={}),(a=m.handle)||(a=m.handle=function(t){return typeof Z!==Se&&Z.event.triggered!==t.type?Z.event.dispatch.apply(e,arguments):void 0}),t=(t||"").match(fe)||[""],u=t.length;u--;)s=Ee.exec(t[u])||[],f=g=s[1],p=(s[2]||"").split(".").sort(),f&&(h=Z.event.special[f]||{},f=(r?h.delegateType:h.bindType)||f,h=Z.event.special[f]||{},c=Z.extend({type:f,origType:g,data:i,handler:n,guid:n.guid,selector:r,needsContext:r&&Z.expr.match.needsContext.test(r),namespace:p.join(".")},o),(d=l[f])||(d=l[f]=[],d.delegateCount=0,h.setup&&h.setup.call(e,i,p,a)!==!1||e.addEventListener&&e.addEventListener(f,a,!1)),h.add&&(h.add.call(e,c),c.handler.guid||(c.handler.guid=n.guid)),r?d.splice(d.delegateCount++,0,c):d.push(c),Z.event.global[f]=!0)},remove:function(e,t,n,i,r){var o,a,s,l,u,c,h,d,f,p,g,m=ve.hasData(e)&&ve.get(e);if(m&&(l=m.events)){for(t=(t||"").match(fe)||[""],u=t.length;u--;)if(s=Ee.exec(t[u])||[],f=g=s[1],p=(s[2]||"").split(".").sort(),f){for(h=Z.event.special[f]||{},f=(i?h.delegateType:h.bindType)||f,d=l[f]||[],s=s[2]&&new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=o=d.length;o--;)c=d[o],!r&&g!==c.origType||n&&n.guid!==c.guid||s&&!s.test(c.namespace)||i&&i!==c.selector&&("**"!==i||!c.selector)||(d.splice(o,1),c.selector&&d.delegateCount--,h.remove&&h.remove.call(e,c));a&&!d.length&&(h.teardown&&h.teardown.call(e,p,m.handle)!==!1||Z.removeEvent(e,f,m.handle),delete l[f])}else for(f in l)Z.event.remove(e,f+t[u],n,i,!0);Z.isEmptyObject(l)&&(delete m.handle,ve.remove(e,"events"))}},trigger:function(t,n,i,r){var o,a,s,l,u,c,h,d=[i||Q],f=X.call(t,"type")?t.type:t,p=X.call(t,"namespace")?t.namespace.split("."):[];if(a=s=i=i||Q,3!==i.nodeType&&8!==i.nodeType&&!Le.test(f+Z.event.triggered)&&(f.indexOf(".")>=0&&(p=f.split("."),f=p.shift(),p.sort()),u=f.indexOf(":")<0&&"on"+f,t=t[Z.expando]?t:new Z.Event(f,"object"==typeof t&&t),t.isTrigger=r?2:3,t.namespace=p.join("."),t.namespace_re=t.namespace?new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=i),n=null==n?[t]:Z.makeArray(n,[t]),h=Z.event.special[f]||{},r||!h.trigger||h.trigger.apply(i,n)!==!1)){if(!r&&!h.noBubble&&!Z.isWindow(i)){for(l=h.delegateType||f,Le.test(l+f)||(a=a.parentNode);a;a=a.parentNode)d.push(a),s=a;s===(i.ownerDocument||Q)&&d.push(s.defaultView||s.parentWindow||e)}for(o=0;(a=d[o++])&&!t.isPropagationStopped();)t.type=o>1?l:h.bindType||f,c=(ve.get(a,"events")||{})[t.type]&&ve.get(a,"handle"),c&&c.apply(a,n),c=u&&a[u],c&&c.apply&&Z.acceptData(a)&&(t.result=c.apply(a,n),t.result===!1&&t.preventDefault());return t.type=f,r||t.isDefaultPrevented()||h._default&&h._default.apply(d.pop(),n)!==!1||!Z.acceptData(i)||u&&Z.isFunction(i[f])&&!Z.isWindow(i)&&(s=i[u],s&&(i[u]=null),Z.event.triggered=f,i[f](),Z.event.triggered=void 0,s&&(i[u]=s)),t.result}},dispatch:function(e){e=Z.event.fix(e);var t,n,i,r,o,a=[],s=j.call(arguments),l=(ve.get(this,"events")||{})[e.type]||[],u=Z.event.special[e.type]||{};if(s[0]=e,e.delegateTarget=this,!u.preDispatch||u.preDispatch.call(this,e)!==!1){for(a=Z.event.handlers.call(this,e,l),t=0;(r=a[t++])&&!e.isPropagationStopped();)for(e.currentTarget=r.elem,n=0;(o=r.handlers[n++])&&!e.isImmediatePropagationStopped();)(!e.namespace_re||e.namespace_re.test(o.namespace))&&(e.handleObj=o,e.data=o.data,i=((Z.event.special[o.origType]||{}).handle||o.handler).apply(r.elem,s),void 0!==i&&(e.result=i)===!1&&(e.preventDefault(),e.stopPropagation()));return u.postDispatch&&u.postDispatch.call(this,e),e.result}},handlers:function(e,t){var n,i,r,o,a=[],s=t.delegateCount,l=e.target;if(s&&l.nodeType&&(!e.button||"click"!==e.type))for(;l!==this;l=l.parentNode||this)if(l.disabled!==!0||"click"!==e.type){for(i=[],n=0;s>n;n++)o=t[n],r=o.selector+" ",void 0===i[r]&&(i[r]=o.needsContext?Z(r,this).index(l)>=0:Z.find(r,this,null,[l]).length),i[r]&&i.push(o);i.length&&a.push({elem:l,handlers:i})}return s<t.length&&a.push({elem:this,handlers:t.slice(s)}),a},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var n,i,r,o=t.button;return null==e.pageX&&null!=t.clientX&&(n=e.target.ownerDocument||Q,i=n.documentElement,r=n.body,e.pageX=t.clientX+(i&&i.scrollLeft||r&&r.scrollLeft||0)-(i&&i.clientLeft||r&&r.clientLeft||0),e.pageY=t.clientY+(i&&i.scrollTop||r&&r.scrollTop||0)-(i&&i.clientTop||r&&r.clientTop||0)),e.which||void 0===o||(e.which=1&o?1:2&o?3:4&o?2:0),e}},fix:function(e){if(e[Z.expando])return e;var t,n,i,r=e.type,o=e,a=this.fixHooks[r];for(a||(this.fixHooks[r]=a=Me.test(r)?this.mouseHooks:Te.test(r)?this.keyHooks:{}),i=a.props?this.props.concat(a.props):this.props,e=new Z.Event(o),t=i.length;t--;)n=i[t],e[n]=o[n];return e.target||(e.target=Q),3===e.target.nodeType&&(e.target=e.target.parentNode),a.filter?a.filter(e,o):e},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==h()&&this.focus?(this.focus(),!1):void 0},delegateType:"focusin"},blur:{trigger:function(){return this===h()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&Z.nodeName(this,"input")?(this.click(),!1):void 0},_default:function(e){return Z.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,n,i){var r=Z.extend(new Z.Event,n,{type:e,isSimulated:!0,originalEvent:{}});i?Z.event.trigger(r,null,t):Z.event.dispatch.call(t,r),r.isDefaultPrevented()&&n.preventDefault()}},Z.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)},Z.Event=function(e,t){return this instanceof Z.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&e.returnValue===!1?u:c):this.type=e,t&&Z.extend(this,t),this.timeStamp=e&&e.timeStamp||Z.now(),void(this[Z.expando]=!0)):new Z.Event(e,t)},Z.Event.prototype={isDefaultPrevented:c,isPropagationStopped:c,isImmediatePropagationStopped:c,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=u,e&&e.preventDefault&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=u,e&&e.stopPropagation&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=u,e&&e.stopImmediatePropagation&&e.stopImmediatePropagation(),this.stopPropagation()}},Z.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,t){Z.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,i=this,r=e.relatedTarget,o=e.handleObj;return(!r||r!==i&&!Z.contains(i,r))&&(e.type=o.origType,n=o.handler.apply(this,arguments),e.type=t),n}}}),Y.focusinBubbles||Z.each({focus:"focusin",blur:"focusout"},function(e,t){var n=function(e){Z.event.simulate(t,e.target,Z.event.fix(e),!0)};Z.event.special[t]={setup:function(){var i=this.ownerDocument||this,r=ve.access(i,t);r||i.addEventListener(e,n,!0),ve.access(i,t,(r||0)+1)},teardown:function(){var i=this.ownerDocument||this,r=ve.access(i,t)-1;r?ve.access(i,t,r):(i.removeEventListener(e,n,!0),ve.remove(i,t))}}}),Z.fn.extend({on:function(e,t,n,i,r){var o,a;if("object"==typeof e){"string"!=typeof t&&(n=n||t,t=void 0);for(a in e)this.on(a,t,n,e[a],r);return this}if(null==n&&null==i?(i=t,n=t=void 0):null==i&&("string"==typeof t?(i=n,n=void 0):(i=n,n=t,t=void 0)),i===!1)i=c;else if(!i)return this;return 1===r&&(o=i,i=function(e){return Z().off(e),o.apply(this,arguments)},i.guid=o.guid||(o.guid=Z.guid++)),this.each(function(){Z.event.add(this,e,i,n,t)})},one:function(e,t,n,i){return this.on(e,t,n,i,1)},off:function(e,t,n){var i,r;if(e&&e.preventDefault&&e.handleObj)return i=e.handleObj,Z(e.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if("object"==typeof e){for(r in e)this.off(r,t,e[r]);return this}return(t===!1||"function"==typeof t)&&(n=t,t=void 0),n===!1&&(n=c),this.each(function(){Z.event.remove(this,e,n,t)})},trigger:function(e,t){return this.each(function(){Z.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];return n?Z.event.trigger(e,t,n,!0):void 0}});var Pe=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Ne=/<([\w:]+)/,Ae=/<|&#?\w+;/,Ie=/<(?:script|style|link)/i,Oe=/checked\s*(?:[^=]|=\s*.checked.)/i,De=/^$|\/(?:java|ecma)script/i,Be=/^true\/(.*)/,Re=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,ze={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};ze.optgroup=ze.option,ze.tbody=ze.tfoot=ze.colgroup=ze.caption=ze.thead,ze.th=ze.td,Z.extend({clone:function(e,t,n){var i,r,o,a,s=e.cloneNode(!0),l=Z.contains(e.ownerDocument,e);if(!(Y.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||Z.isXMLDoc(e)))for(a=v(s),o=v(e),i=0,r=o.length;r>i;i++)y(o[i],a[i]);if(t)if(n)for(o=o||v(e),a=a||v(s),i=0,r=o.length;r>i;i++)m(o[i],a[i]);else m(e,s);return a=v(s,"script"),a.length>0&&g(a,!l&&v(e,"script")),s},buildFragment:function(e,t,n,i){for(var r,o,a,s,l,u,c=t.createDocumentFragment(),h=[],d=0,f=e.length;f>d;d++)if(r=e[d],r||0===r)if("object"===Z.type(r))Z.merge(h,r.nodeType?[r]:r);else if(Ae.test(r)){for(o=o||c.appendChild(t.createElement("div")),a=(Ne.exec(r)||["",""])[1].toLowerCase(),s=ze[a]||ze._default,o.innerHTML=s[1]+r.replace(Pe,"<$1></$2>")+s[2],u=s[0];u--;)o=o.lastChild;Z.merge(h,o.childNodes),o=c.firstChild,o.textContent=""}else h.push(t.createTextNode(r));for(c.textContent="",d=0;r=h[d++];)if((!i||-1===Z.inArray(r,i))&&(l=Z.contains(r.ownerDocument,r),o=v(c.appendChild(r),"script"),l&&g(o),n))for(u=0;r=o[u++];)De.test(r.type||"")&&n.push(r);return c},cleanData:function(e){for(var t,n,i,r,o=Z.event.special,a=0;void 0!==(n=e[a]);a++){if(Z.acceptData(n)&&(r=n[ve.expando],r&&(t=ve.cache[r]))){if(t.events)for(i in t.events)o[i]?Z.event.remove(n,i):Z.removeEvent(n,i,t.handle);ve.cache[r]&&delete ve.cache[r]}delete ye.cache[n[ye.expando]]}}}),Z.fn.extend({text:function(e){return me(this,function(e){return void 0===e?Z.text(this):this.empty().each(function(){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&(this.textContent=e)})},null,e,arguments.length)},append:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=d(this,e);t.appendChild(e)}})},prepend:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=d(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){for(var n,i=e?Z.filter(e,this):this,r=0;null!=(n=i[r]);r++)t||1!==n.nodeType||Z.cleanData(v(n)),n.parentNode&&(t&&Z.contains(n.ownerDocument,n)&&g(v(n,"script")),n.parentNode.removeChild(n));return this},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(Z.cleanData(v(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null==e?!1:e,t=null==t?e:t,this.map(function(){return Z.clone(this,e,t)})},html:function(e){return me(this,function(e){var t=this[0]||{},n=0,i=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!Ie.test(e)&&!ze[(Ne.exec(e)||["",""])[1].toLowerCase()]){e=e.replace(Pe,"<$1></$2>");try{for(;i>n;n++)t=this[n]||{},1===t.nodeType&&(Z.cleanData(v(t,!1)),t.innerHTML=e);t=0}catch(r){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=arguments[0];return this.domManip(arguments,function(t){e=this.parentNode,Z.cleanData(v(this)),e&&e.replaceChild(t,this)}),e&&(e.length||e.nodeType)?this:this.remove()},detach:function(e){return this.remove(e,!0)},domManip:function(e,t){e=F.apply([],e);var n,i,r,o,a,s,l=0,u=this.length,c=this,h=u-1,d=e[0],g=Z.isFunction(d);if(g||u>1&&"string"==typeof d&&!Y.checkClone&&Oe.test(d))return this.each(function(n){var i=c.eq(n);g&&(e[0]=d.call(this,n,i.html())),i.domManip(e,t)});if(u&&(n=Z.buildFragment(e,this[0].ownerDocument,!1,this),i=n.firstChild,1===n.childNodes.length&&(n=i),i)){for(r=Z.map(v(n,"script"),f),o=r.length;u>l;l++)a=n,l!==h&&(a=Z.clone(a,!0,!0),o&&Z.merge(r,v(a,"script"))),t.call(this[l],a,l);if(o)for(s=r[r.length-1].ownerDocument,Z.map(r,p),l=0;o>l;l++)a=r[l],De.test(a.type||"")&&!ve.access(a,"globalEval")&&Z.contains(s,a)&&(a.src?Z._evalUrl&&Z._evalUrl(a.src):Z.globalEval(a.textContent.replace(Re,"")))}return this}}),Z.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){Z.fn[e]=function(e){for(var n,i=[],r=Z(e),o=r.length-1,a=0;o>=a;a++)n=a===o?this:this.clone(!0),Z(r[a])[t](n),$.apply(i,n.get());return this.pushStack(i)}});var We,He={},Ue=/^margin/,Ve=new RegExp("^("+we+")(?!px)[a-z%]+$","i"),je=function(e){return e.ownerDocument.defaultView.getComputedStyle(e,null)};!function(){function t(){a.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",a.innerHTML="",r.appendChild(o);var t=e.getComputedStyle(a,null);n="1%"!==t.top,i="4px"===t.width,r.removeChild(o)}var n,i,r=Q.documentElement,o=Q.createElement("div"),a=Q.createElement("div");a.style&&(a.style.backgroundClip="content-box",a.cloneNode(!0).style.backgroundClip="",Y.clearCloneStyle="content-box"===a.style.backgroundClip,o.style.cssText="border:0;width:0;height:0;top:0;left:-9999px;margin-top:1px;position:absolute",o.appendChild(a),e.getComputedStyle&&Z.extend(Y,{pixelPosition:function(){return t(),n},boxSizingReliable:function(){return null==i&&t(),i},reliableMarginRight:function(){var t,n=a.appendChild(Q.createElement("div"));return n.style.cssText=a.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",n.style.marginRight=n.style.width="0",a.style.width="1px",r.appendChild(o),t=!parseFloat(e.getComputedStyle(n,null).marginRight),r.removeChild(o),t}}))}(),Z.swap=function(e,t,n,i){var r,o,a={};for(o in t)a[o]=e.style[o],e.style[o]=t[o];r=n.apply(e,i||[]);for(o in t)e.style[o]=a[o];return r};var Fe=/^(none|table(?!-c[ea]).+)/,$e=new RegExp("^("+we+")(.*)$","i"),Ke=new RegExp("^([+-])=("+we+")","i"),qe={position:"absolute",visibility:"hidden",display:"block"},Ge={letterSpacing:"0",fontWeight:"400"},Xe=["Webkit","O","Moz","ms"];Z.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=w(e,"opacity");return""===n?"1":n}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(e,t,n,i){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var r,o,a,s=Z.camelCase(t),l=e.style;return t=Z.cssProps[s]||(Z.cssProps[s]=k(l,s)),a=Z.cssHooks[t]||Z.cssHooks[s],void 0===n?a&&"get"in a&&void 0!==(r=a.get(e,!1,i))?r:l[t]:(o=typeof n,"string"===o&&(r=Ke.exec(n))&&(n=(r[1]+1)*r[2]+parseFloat(Z.css(e,t)),o="number"),null!=n&&n===n&&("number"!==o||Z.cssNumber[s]||(n+="px"),Y.clearCloneStyle||""!==n||0!==t.indexOf("background")||(l[t]="inherit"),a&&"set"in a&&void 0===(n=a.set(e,n,i))||(l[t]=n)),void 0)}},css:function(e,t,n,i){var r,o,a,s=Z.camelCase(t);return t=Z.cssProps[s]||(Z.cssProps[s]=k(e.style,s)),a=Z.cssHooks[t]||Z.cssHooks[s],a&&"get"in a&&(r=a.get(e,!0,n)),void 0===r&&(r=w(e,t,i)),"normal"===r&&t in Ge&&(r=Ge[t]),""===n||n?(o=parseFloat(r),n===!0||Z.isNumeric(o)?o||0:r):r}}),Z.each(["height","width"],function(e,t){Z.cssHooks[t]={get:function(e,n,i){return n?Fe.test(Z.css(e,"display"))&&0===e.offsetWidth?Z.swap(e,qe,function(){return T(e,t,i)}):T(e,t,i):void 0},set:function(e,n,i){var r=i&&je(e);return C(e,n,i?S(e,t,i,"border-box"===Z.css(e,"boxSizing",!1,r),r):0)}}}),Z.cssHooks.marginRight=x(Y.reliableMarginRight,function(e,t){return t?Z.swap(e,{display:"inline-block"},w,[e,"marginRight"]):void 0}),Z.each({margin:"",padding:"",border:"Width"},function(e,t){Z.cssHooks[e+t]={expand:function(n){for(var i=0,r={},o="string"==typeof n?n.split(" "):[n];4>i;i++)r[e+xe[i]+t]=o[i]||o[i-2]||o[0];return r}},Ue.test(e)||(Z.cssHooks[e+t].set=C)}),Z.fn.extend({css:function(e,t){return me(this,function(e,t,n){var i,r,o={},a=0;if(Z.isArray(t)){for(i=je(e),r=t.length;r>a;a++)o[t[a]]=Z.css(e,t[a],!1,i);return o}return void 0!==n?Z.style(e,t,n):Z.css(e,t)},e,t,arguments.length>1)},show:function(){return M(this,!0)},hide:function(){return M(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){ke(this)?Z(this).show():Z(this).hide()})}}),Z.Tween=L,L.prototype={constructor:L,init:function(e,t,n,i,r,o){this.elem=e,this.prop=n,this.easing=r||"swing",this.options=t,this.start=this.now=this.cur(),this.end=i,this.unit=o||(Z.cssNumber[n]?"":"px")},cur:function(){var e=L.propHooks[this.prop];return e&&e.get?e.get(this):L.propHooks._default.get(this)},run:function(e){var t,n=L.propHooks[this.prop];return this.options.duration?this.pos=t=Z.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):L.propHooks._default.set(this),this}},L.prototype.init.prototype=L.prototype,L.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=Z.css(e.elem,e.prop,""),t&&"auto"!==t?t:0):e.elem[e.prop]},set:function(e){Z.fx.step[e.prop]?Z.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[Z.cssProps[e.prop]]||Z.cssHooks[e.prop])?Z.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},L.propHooks.scrollTop=L.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},Z.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},Z.fx=L.prototype.init,Z.fx.step={};var Ye,Qe,Je=/^(?:toggle|show|hide)$/,Ze=new RegExp("^(?:([+-])=|)("+we+")([a-z%]*)$","i"),et=/queueHooks$/,tt=[A],nt={"*":[function(e,t){var n=this.createTween(e,t),i=n.cur(),r=Ze.exec(t),o=r&&r[3]||(Z.cssNumber[e]?"":"px"),a=(Z.cssNumber[e]||"px"!==o&&+i)&&Ze.exec(Z.css(n.elem,e)),s=1,l=20;if(a&&a[3]!==o){o=o||a[3],r=r||[],a=+i||1;do s=s||".5",a/=s,Z.style(n.elem,e,a+o);while(s!==(s=n.cur()/i)&&1!==s&&--l)}return r&&(a=n.start=+a||+i||0,n.unit=o,n.end=r[1]?a+(r[1]+1)*r[2]:+r[2]),n}]};Z.Animation=Z.extend(O,{tweener:function(e,t){Z.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");for(var n,i=0,r=e.length;r>i;i++)n=e[i],nt[n]=nt[n]||[],nt[n].unshift(t)},prefilter:function(e,t){t?tt.unshift(e):tt.push(e)}}),Z.speed=function(e,t,n){var i=e&&"object"==typeof e?Z.extend({},e):{complete:n||!n&&t||Z.isFunction(e)&&e,duration:e,easing:n&&t||t&&!Z.isFunction(t)&&t};return i.duration=Z.fx.off?0:"number"==typeof i.duration?i.duration:i.duration in Z.fx.speeds?Z.fx.speeds[i.duration]:Z.fx.speeds._default,(null==i.queue||i.queue===!0)&&(i.queue="fx"),i.old=i.complete,i.complete=function(){Z.isFunction(i.old)&&i.old.call(this),i.queue&&Z.dequeue(this,i.queue)},i},Z.fn.extend({fadeTo:function(e,t,n,i){return this.filter(ke).css("opacity",0).show().end().animate({
opacity:t},e,n,i)},animate:function(e,t,n,i){var r=Z.isEmptyObject(e),o=Z.speed(t,n,i),a=function(){var t=O(this,Z.extend({},e),o);(r||ve.get(this,"finish"))&&t.stop(!0)};return a.finish=a,r||o.queue===!1?this.each(a):this.queue(o.queue,a)},stop:function(e,t,n){var i=function(e){var t=e.stop;delete e.stop,t(n)};return"string"!=typeof e&&(n=t,t=e,e=void 0),t&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,r=null!=e&&e+"queueHooks",o=Z.timers,a=ve.get(this);if(r)a[r]&&a[r].stop&&i(a[r]);else for(r in a)a[r]&&a[r].stop&&et.test(r)&&i(a[r]);for(r=o.length;r--;)o[r].elem!==this||null!=e&&o[r].queue!==e||(o[r].anim.stop(n),t=!1,o.splice(r,1));(t||!n)&&Z.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,n=ve.get(this),i=n[e+"queue"],r=n[e+"queueHooks"],o=Z.timers,a=i?i.length:0;for(n.finish=!0,Z.queue(this,e,[]),r&&r.stop&&r.stop.call(this,!0),t=o.length;t--;)o[t].elem===this&&o[t].queue===e&&(o[t].anim.stop(!0),o.splice(t,1));for(t=0;a>t;t++)i[t]&&i[t].finish&&i[t].finish.call(this);delete n.finish})}}),Z.each(["toggle","show","hide"],function(e,t){var n=Z.fn[t];Z.fn[t]=function(e,i,r){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(P(t,!0),e,i,r)}}),Z.each({slideDown:P("show"),slideUp:P("hide"),slideToggle:P("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){Z.fn[e]=function(e,n,i){return this.animate(t,e,n,i)}}),Z.timers=[],Z.fx.tick=function(){var e,t=0,n=Z.timers;for(Ye=Z.now();t<n.length;t++)e=n[t],e()||n[t]!==e||n.splice(t--,1);n.length||Z.fx.stop(),Ye=void 0},Z.fx.timer=function(e){Z.timers.push(e),e()?Z.fx.start():Z.timers.pop()},Z.fx.interval=13,Z.fx.start=function(){Qe||(Qe=setInterval(Z.fx.tick,Z.fx.interval))},Z.fx.stop=function(){clearInterval(Qe),Qe=null},Z.fx.speeds={slow:600,fast:200,_default:400},Z.fn.delay=function(e,t){return e=Z.fx?Z.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,n){var i=setTimeout(t,e);n.stop=function(){clearTimeout(i)}})},function(){var e=Q.createElement("input"),t=Q.createElement("select"),n=t.appendChild(Q.createElement("option"));e.type="checkbox",Y.checkOn=""!==e.value,Y.optSelected=n.selected,t.disabled=!0,Y.optDisabled=!n.disabled,e=Q.createElement("input"),e.value="t",e.type="radio",Y.radioValue="t"===e.value}();var it,rt,ot=Z.expr.attrHandle;Z.fn.extend({attr:function(e,t){return me(this,Z.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){Z.removeAttr(this,e)})}}),Z.extend({attr:function(e,t,n){var i,r,o=e.nodeType;if(e&&3!==o&&8!==o&&2!==o)return typeof e.getAttribute===Se?Z.prop(e,t,n):(1===o&&Z.isXMLDoc(e)||(t=t.toLowerCase(),i=Z.attrHooks[t]||(Z.expr.match.bool.test(t)?rt:it)),void 0===n?i&&"get"in i&&null!==(r=i.get(e,t))?r:(r=Z.find.attr(e,t),null==r?void 0:r):null!==n?i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:(e.setAttribute(t,n+""),n):void Z.removeAttr(e,t))},removeAttr:function(e,t){var n,i,r=0,o=t&&t.match(fe);if(o&&1===e.nodeType)for(;n=o[r++];)i=Z.propFix[n]||n,Z.expr.match.bool.test(n)&&(e[i]=!1),e.removeAttribute(n)},attrHooks:{type:{set:function(e,t){if(!Y.radioValue&&"radio"===t&&Z.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}}}),rt={set:function(e,t,n){return t===!1?Z.removeAttr(e,n):e.setAttribute(n,n),n}},Z.each(Z.expr.match.bool.source.match(/\w+/g),function(e,t){var n=ot[t]||Z.find.attr;ot[t]=function(e,t,i){var r,o;return i||(o=ot[t],ot[t]=r,r=null!=n(e,t,i)?t.toLowerCase():null,ot[t]=o),r}});var at=/^(?:input|select|textarea|button)$/i;Z.fn.extend({prop:function(e,t){return me(this,Z.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each(function(){delete this[Z.propFix[e]||e]})}}),Z.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(e,t,n){var i,r,o,a=e.nodeType;if(e&&3!==a&&8!==a&&2!==a)return o=1!==a||!Z.isXMLDoc(e),o&&(t=Z.propFix[t]||t,r=Z.propHooks[t]),void 0!==n?r&&"set"in r&&void 0!==(i=r.set(e,n,t))?i:e[t]=n:r&&"get"in r&&null!==(i=r.get(e,t))?i:e[t]},propHooks:{tabIndex:{get:function(e){return e.hasAttribute("tabindex")||at.test(e.nodeName)||e.href?e.tabIndex:-1}}}}),Y.optSelected||(Z.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null}}),Z.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){Z.propFix[this.toLowerCase()]=this});var st=/[\t\r\n\f]/g;Z.fn.extend({addClass:function(e){var t,n,i,r,o,a,s="string"==typeof e&&e,l=0,u=this.length;if(Z.isFunction(e))return this.each(function(t){Z(this).addClass(e.call(this,t,this.className))});if(s)for(t=(e||"").match(fe)||[];u>l;l++)if(n=this[l],i=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(st," "):" ")){for(o=0;r=t[o++];)i.indexOf(" "+r+" ")<0&&(i+=r+" ");a=Z.trim(i),n.className!==a&&(n.className=a)}return this},removeClass:function(e){var t,n,i,r,o,a,s=0===arguments.length||"string"==typeof e&&e,l=0,u=this.length;if(Z.isFunction(e))return this.each(function(t){Z(this).removeClass(e.call(this,t,this.className))});if(s)for(t=(e||"").match(fe)||[];u>l;l++)if(n=this[l],i=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(st," "):"")){for(o=0;r=t[o++];)for(;i.indexOf(" "+r+" ")>=0;)i=i.replace(" "+r+" "," ");a=e?Z.trim(i):"",n.className!==a&&(n.className=a)}return this},toggleClass:function(e,t){var n=typeof e;return"boolean"==typeof t&&"string"===n?t?this.addClass(e):this.removeClass(e):Z.isFunction(e)?this.each(function(n){Z(this).toggleClass(e.call(this,n,this.className,t),t)}):this.each(function(){if("string"===n)for(var t,i=0,r=Z(this),o=e.match(fe)||[];t=o[i++];)r.hasClass(t)?r.removeClass(t):r.addClass(t);else(n===Se||"boolean"===n)&&(this.className&&ve.set(this,"__className__",this.className),this.className=this.className||e===!1?"":ve.get(this,"__className__")||"")})},hasClass:function(e){for(var t=" "+e+" ",n=0,i=this.length;i>n;n++)if(1===this[n].nodeType&&(" "+this[n].className+" ").replace(st," ").indexOf(t)>=0)return!0;return!1}});var lt=/\r/g;Z.fn.extend({val:function(e){var t,n,i,r=this[0];{if(arguments.length)return i=Z.isFunction(e),this.each(function(n){var r;1===this.nodeType&&(r=i?e.call(this,n,Z(this).val()):e,null==r?r="":"number"==typeof r?r+="":Z.isArray(r)&&(r=Z.map(r,function(e){return null==e?"":e+""})),t=Z.valHooks[this.type]||Z.valHooks[this.nodeName.toLowerCase()],t&&"set"in t&&void 0!==t.set(this,r,"value")||(this.value=r))});if(r)return t=Z.valHooks[r.type]||Z.valHooks[r.nodeName.toLowerCase()],t&&"get"in t&&void 0!==(n=t.get(r,"value"))?n:(n=r.value,"string"==typeof n?n.replace(lt,""):null==n?"":n)}}}),Z.extend({valHooks:{option:{get:function(e){var t=Z.find.attr(e,"value");return null!=t?t:Z.trim(Z.text(e))}},select:{get:function(e){for(var t,n,i=e.options,r=e.selectedIndex,o="select-one"===e.type||0>r,a=o?null:[],s=o?r+1:i.length,l=0>r?s:o?r:0;s>l;l++)if(n=i[l],(n.selected||l===r)&&(Y.optDisabled?!n.disabled:null===n.getAttribute("disabled"))&&(!n.parentNode.disabled||!Z.nodeName(n.parentNode,"optgroup"))){if(t=Z(n).val(),o)return t;a.push(t)}return a},set:function(e,t){for(var n,i,r=e.options,o=Z.makeArray(t),a=r.length;a--;)i=r[a],(i.selected=Z.inArray(i.value,o)>=0)&&(n=!0);return n||(e.selectedIndex=-1),o}}}}),Z.each(["radio","checkbox"],function(){Z.valHooks[this]={set:function(e,t){return Z.isArray(t)?e.checked=Z.inArray(Z(e).val(),t)>=0:void 0}},Y.checkOn||(Z.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})}),Z.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){Z.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}),Z.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,i){return this.on(t,e,n,i)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)}});var ut=Z.now(),ct=/\?/;Z.parseJSON=function(e){return JSON.parse(e+"")},Z.parseXML=function(e){var t,n;if(!e||"string"!=typeof e)return null;try{n=new DOMParser,t=n.parseFromString(e,"text/xml")}catch(i){t=void 0}return(!t||t.getElementsByTagName("parsererror").length)&&Z.error("Invalid XML: "+e),t};var ht,dt,ft=/#.*$/,pt=/([?&])_=[^&]*/,gt=/^(.*?):[ \t]*([^\r\n]*)$/gm,mt=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,vt=/^(?:GET|HEAD)$/,yt=/^\/\//,_t=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,bt={},wt={},xt="*/".concat("*");try{dt=location.href}catch(kt){dt=Q.createElement("a"),dt.href="",dt=dt.href}ht=_t.exec(dt.toLowerCase())||[],Z.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:dt,type:"GET",isLocal:mt.test(ht[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":xt,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":Z.parseJSON,"text xml":Z.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?R(R(e,Z.ajaxSettings),t):R(Z.ajaxSettings,e)},ajaxPrefilter:D(bt),ajaxTransport:D(wt),ajax:function(e,t){function n(e,t,n,a){var l,c,v,y,b,x=t;2!==_&&(_=2,s&&clearTimeout(s),i=void 0,o=a||"",w.readyState=e>0?4:0,l=e>=200&&300>e||304===e,n&&(y=z(h,w,n)),y=W(h,y,w,l),l?(h.ifModified&&(b=w.getResponseHeader("Last-Modified"),b&&(Z.lastModified[r]=b),b=w.getResponseHeader("etag"),b&&(Z.etag[r]=b)),204===e||"HEAD"===h.type?x="nocontent":304===e?x="notmodified":(x=y.state,c=y.data,v=y.error,l=!v)):(v=x,(e||!x)&&(x="error",0>e&&(e=0))),w.status=e,w.statusText=(t||x)+"",l?p.resolveWith(d,[c,x,w]):p.rejectWith(d,[w,x,v]),w.statusCode(m),m=void 0,u&&f.trigger(l?"ajaxSuccess":"ajaxError",[w,h,l?c:v]),g.fireWith(d,[w,x]),u&&(f.trigger("ajaxComplete",[w,h]),--Z.active||Z.event.trigger("ajaxStop")))}"object"==typeof e&&(t=e,e=void 0),t=t||{};var i,r,o,a,s,l,u,c,h=Z.ajaxSetup({},t),d=h.context||h,f=h.context&&(d.nodeType||d.jquery)?Z(d):Z.event,p=Z.Deferred(),g=Z.Callbacks("once memory"),m=h.statusCode||{},v={},y={},_=0,b="canceled",w={readyState:0,getResponseHeader:function(e){var t;if(2===_){if(!a)for(a={};t=gt.exec(o);)a[t[1].toLowerCase()]=t[2];t=a[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===_?o:null},setRequestHeader:function(e,t){var n=e.toLowerCase();return _||(e=y[n]=y[n]||e,v[e]=t),this},overrideMimeType:function(e){return _||(h.mimeType=e),this},statusCode:function(e){var t;if(e)if(2>_)for(t in e)m[t]=[m[t],e[t]];else w.always(e[w.status]);return this},abort:function(e){var t=e||b;return i&&i.abort(t),n(0,t),this}};if(p.promise(w).complete=g.add,w.success=w.done,w.error=w.fail,h.url=((e||h.url||dt)+"").replace(ft,"").replace(yt,ht[1]+"//"),h.type=t.method||t.type||h.method||h.type,h.dataTypes=Z.trim(h.dataType||"*").toLowerCase().match(fe)||[""],null==h.crossDomain&&(l=_t.exec(h.url.toLowerCase()),h.crossDomain=!(!l||l[1]===ht[1]&&l[2]===ht[2]&&(l[3]||("http:"===l[1]?"80":"443"))===(ht[3]||("http:"===ht[1]?"80":"443")))),h.data&&h.processData&&"string"!=typeof h.data&&(h.data=Z.param(h.data,h.traditional)),B(bt,h,t,w),2===_)return w;u=h.global,u&&0===Z.active++&&Z.event.trigger("ajaxStart"),h.type=h.type.toUpperCase(),h.hasContent=!vt.test(h.type),r=h.url,h.hasContent||(h.data&&(r=h.url+=(ct.test(r)?"&":"?")+h.data,delete h.data),h.cache===!1&&(h.url=pt.test(r)?r.replace(pt,"$1_="+ut++):r+(ct.test(r)?"&":"?")+"_="+ut++)),h.ifModified&&(Z.lastModified[r]&&w.setRequestHeader("If-Modified-Since",Z.lastModified[r]),Z.etag[r]&&w.setRequestHeader("If-None-Match",Z.etag[r])),(h.data&&h.hasContent&&h.contentType!==!1||t.contentType)&&w.setRequestHeader("Content-Type",h.contentType),w.setRequestHeader("Accept",h.dataTypes[0]&&h.accepts[h.dataTypes[0]]?h.accepts[h.dataTypes[0]]+("*"!==h.dataTypes[0]?", "+xt+"; q=0.01":""):h.accepts["*"]);for(c in h.headers)w.setRequestHeader(c,h.headers[c]);if(h.beforeSend&&(h.beforeSend.call(d,w,h)===!1||2===_))return w.abort();b="abort";for(c in{success:1,error:1,complete:1})w[c](h[c]);if(i=B(wt,h,t,w)){w.readyState=1,u&&f.trigger("ajaxSend",[w,h]),h.async&&h.timeout>0&&(s=setTimeout(function(){w.abort("timeout")},h.timeout));try{_=1,i.send(v,n)}catch(x){if(!(2>_))throw x;n(-1,x)}}else n(-1,"No Transport");return w},getJSON:function(e,t,n){return Z.get(e,t,n,"json")},getScript:function(e,t){return Z.get(e,void 0,t,"script")}}),Z.each(["get","post"],function(e,t){Z[t]=function(e,n,i,r){return Z.isFunction(n)&&(r=r||i,i=n,n=void 0),Z.ajax({url:e,type:t,dataType:r,data:n,success:i})}}),Z.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){Z.fn[t]=function(e){return this.on(t,e)}}),Z._evalUrl=function(e){return Z.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})},Z.fn.extend({wrapAll:function(e){var t;return Z.isFunction(e)?this.each(function(t){Z(this).wrapAll(e.call(this,t))}):(this[0]&&(t=Z(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e}).append(this)),this)},wrapInner:function(e){return Z.isFunction(e)?this.each(function(t){Z(this).wrapInner(e.call(this,t))}):this.each(function(){var t=Z(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=Z.isFunction(e);return this.each(function(n){Z(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){Z.nodeName(this,"body")||Z(this).replaceWith(this.childNodes)}).end()}}),Z.expr.filters.hidden=function(e){return e.offsetWidth<=0&&e.offsetHeight<=0},Z.expr.filters.visible=function(e){return!Z.expr.filters.hidden(e)};var Ct=/%20/g,St=/\[\]$/,Tt=/\r?\n/g,Mt=/^(?:submit|button|image|reset|file)$/i,Lt=/^(?:input|select|textarea|keygen)/i;Z.param=function(e,t){var n,i=[],r=function(e,t){t=Z.isFunction(t)?t():null==t?"":t,i[i.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(void 0===t&&(t=Z.ajaxSettings&&Z.ajaxSettings.traditional),Z.isArray(e)||e.jquery&&!Z.isPlainObject(e))Z.each(e,function(){r(this.name,this.value)});else for(n in e)H(n,e[n],t,r);return i.join("&").replace(Ct,"+")},Z.fn.extend({serialize:function(){return Z.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=Z.prop(this,"elements");return e?Z.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!Z(this).is(":disabled")&&Lt.test(this.nodeName)&&!Mt.test(e)&&(this.checked||!Ce.test(e))}).map(function(e,t){var n=Z(this).val();return null==n?null:Z.isArray(n)?Z.map(n,function(e){return{name:t.name,value:e.replace(Tt,"\r\n")}}):{name:t.name,value:n.replace(Tt,"\r\n")}}).get()}}),Z.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(e){}};var Et=0,Pt={},Nt={0:200,1223:204},At=Z.ajaxSettings.xhr();e.ActiveXObject&&Z(e).on("unload",function(){for(var e in Pt)Pt[e]()}),Y.cors=!!At&&"withCredentials"in At,Y.ajax=At=!!At,Z.ajaxTransport(function(e){var t;return Y.cors||At&&!e.crossDomain?{send:function(n,i){var r,o=e.xhr(),a=++Et;if(o.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(r in e.xhrFields)o[r]=e.xhrFields[r];e.mimeType&&o.overrideMimeType&&o.overrideMimeType(e.mimeType),e.crossDomain||n["X-Requested-With"]||(n["X-Requested-With"]="XMLHttpRequest");for(r in n)o.setRequestHeader(r,n[r]);t=function(e){return function(){t&&(delete Pt[a],t=o.onload=o.onerror=null,"abort"===e?o.abort():"error"===e?i(o.status,o.statusText):i(Nt[o.status]||o.status,o.statusText,"string"==typeof o.responseText?{text:o.responseText}:void 0,o.getAllResponseHeaders()))}},o.onload=t(),o.onerror=t("error"),t=Pt[a]=t("abort");try{o.send(e.hasContent&&e.data||null)}catch(s){if(t)throw s}},abort:function(){t&&t()}}:void 0}),Z.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return Z.globalEval(e),e}}}),Z.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),Z.ajaxTransport("script",function(e){if(e.crossDomain){var t,n;return{send:function(i,r){t=Z("<script>").prop({async:!0,charset:e.scriptCharset,src:e.url}).on("load error",n=function(e){t.remove(),n=null,e&&r("error"===e.type?404:200,e.type)}),Q.head.appendChild(t[0])},abort:function(){n&&n()}}}});var It=[],Ot=/(=)\?(?=&|$)|\?\?/;Z.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=It.pop()||Z.expando+"_"+ut++;return this[e]=!0,e}}),Z.ajaxPrefilter("json jsonp",function(t,n,i){var r,o,a,s=t.jsonp!==!1&&(Ot.test(t.url)?"url":"string"==typeof t.data&&!(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&Ot.test(t.data)&&"data");return s||"jsonp"===t.dataTypes[0]?(r=t.jsonpCallback=Z.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,s?t[s]=t[s].replace(Ot,"$1"+r):t.jsonp!==!1&&(t.url+=(ct.test(t.url)?"&":"?")+t.jsonp+"="+r),t.converters["script json"]=function(){return a||Z.error(r+" was not called"),a[0]},t.dataTypes[0]="json",o=e[r],e[r]=function(){a=arguments},i.always(function(){e[r]=o,t[r]&&(t.jsonpCallback=n.jsonpCallback,It.push(r)),a&&Z.isFunction(o)&&o(a[0]),a=o=void 0}),"script"):void 0}),Z.parseHTML=function(e,t,n){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(n=t,t=!1),t=t||Q;var i=ae.exec(e),r=!n&&[];return i?[t.createElement(i[1])]:(i=Z.buildFragment([e],t,r),r&&r.length&&Z(r).remove(),Z.merge([],i.childNodes))};var Dt=Z.fn.load;Z.fn.load=function(e,t,n){if("string"!=typeof e&&Dt)return Dt.apply(this,arguments);var i,r,o,a=this,s=e.indexOf(" ");return s>=0&&(i=Z.trim(e.slice(s)),e=e.slice(0,s)),Z.isFunction(t)?(n=t,t=void 0):t&&"object"==typeof t&&(r="POST"),a.length>0&&Z.ajax({url:e,type:r,dataType:"html",data:t}).done(function(e){o=arguments,a.html(i?Z("<div>").append(Z.parseHTML(e)).find(i):e)}).complete(n&&function(e,t){a.each(n,o||[e.responseText,t,e])}),this},Z.expr.filters.animated=function(e){return Z.grep(Z.timers,function(t){return e===t.elem}).length};var Bt=e.document.documentElement;Z.offset={setOffset:function(e,t,n){var i,r,o,a,s,l,u,c=Z.css(e,"position"),h=Z(e),d={};"static"===c&&(e.style.position="relative"),s=h.offset(),o=Z.css(e,"top"),l=Z.css(e,"left"),u=("absolute"===c||"fixed"===c)&&(o+l).indexOf("auto")>-1,u?(i=h.position(),a=i.top,r=i.left):(a=parseFloat(o)||0,r=parseFloat(l)||0),Z.isFunction(t)&&(t=t.call(e,n,s)),null!=t.top&&(d.top=t.top-s.top+a),null!=t.left&&(d.left=t.left-s.left+r),"using"in t?t.using.call(e,d):h.css(d)}},Z.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each(function(t){Z.offset.setOffset(this,e,t)});var t,n,i=this[0],r={top:0,left:0},o=i&&i.ownerDocument;if(o)return t=o.documentElement,Z.contains(t,i)?(typeof i.getBoundingClientRect!==Se&&(r=i.getBoundingClientRect()),n=U(o),{top:r.top+n.pageYOffset-t.clientTop,left:r.left+n.pageXOffset-t.clientLeft}):r},position:function(){if(this[0]){var e,t,n=this[0],i={top:0,left:0};return"fixed"===Z.css(n,"position")?t=n.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),Z.nodeName(e[0],"html")||(i=e.offset()),i.top+=Z.css(e[0],"borderTopWidth",!0),i.left+=Z.css(e[0],"borderLeftWidth",!0)),{top:t.top-i.top-Z.css(n,"marginTop",!0),left:t.left-i.left-Z.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent||Bt;e&&!Z.nodeName(e,"html")&&"static"===Z.css(e,"position");)e=e.offsetParent;return e||Bt})}}),Z.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,n){var i="pageYOffset"===n;Z.fn[t]=function(r){return me(this,function(t,r,o){var a=U(t);return void 0===o?a?a[n]:t[r]:void(a?a.scrollTo(i?e.pageXOffset:o,i?o:e.pageYOffset):t[r]=o)},t,r,arguments.length,null)}}),Z.each(["top","left"],function(e,t){Z.cssHooks[t]=x(Y.pixelPosition,function(e,n){return n?(n=w(e,t),Ve.test(n)?Z(e).position()[t]+"px":n):void 0})}),Z.each({Height:"height",Width:"width"},function(e,t){Z.each({padding:"inner"+e,content:t,"":"outer"+e},function(n,i){Z.fn[i]=function(i,r){var o=arguments.length&&(n||"boolean"!=typeof i),a=n||(i===!0||r===!0?"margin":"border");return me(this,function(t,n,i){var r;return Z.isWindow(t)?t.document.documentElement["client"+e]:9===t.nodeType?(r=t.documentElement,Math.max(t.body["scroll"+e],r["scroll"+e],t.body["offset"+e],r["offset"+e],r["client"+e])):void 0===i?Z.css(t,n,a):Z.style(t,n,i,a)},t,o?i:void 0,o,null)}})}),Z.fn.size=function(){return this.length},Z.fn.andSelf=Z.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return Z});var Rt=e.jQuery,zt=e.$;return Z.noConflict=function(t){return e.$===Z&&(e.$=zt),t&&e.jQuery===Z&&(e.jQuery=Rt),Z},typeof t===Se&&(e.jQuery=e.$=Z),Z}),function(){var e,t,n,i;!function(){var r={},o={};e=function(e,t,n){r[e]={deps:t,callback:n}},i=n=t=function(e){function n(t){if("."!==t.charAt(0))return t;for(var n=t.split("/"),i=e.split("/").slice(0,-1),r=0,o=n.length;o>r;r++){var a=n[r];if(".."===a)i.pop();else{if("."===a)continue;i.push(a)}}return i.join("/")}if(i._eak_seen=r,o[e])return o[e];if(o[e]={},!r[e])throw new Error("Could not find module "+e);for(var a,s=r[e],l=s.deps,u=s.callback,c=[],h=0,d=l.length;d>h;h++)"exports"===l[h]?c.push(a={}):c.push(t(n(l[h])));var f=u.apply(this,c);return o[e]=a||f}}(),e("promise/all",["./utils","exports"],function(e,t){"use strict";function n(e){var t=this;if(!i(e))throw new TypeError("You must pass an array to all.");return new t(function(t,n){function i(e){return function(t){o(e,t)}}function o(e,n){s[e]=n,0===--l&&t(s)}var a,s=[],l=e.length;0===l&&t([]);for(var u=0;u<e.length;u++)a=e[u],a&&r(a.then)?a.then(i(u),n):o(u,a)})}var i=e.isArray,r=e.isFunction;t.all=n}),e("promise/asap",["exports"],function(e){"use strict";function t(){return function(){process.nextTick(r)}}function n(){var e=0,t=new l(r),n=document.createTextNode("");return t.observe(n,{characterData:!0}),function(){n.data=e=++e%2}}function i(){return function(){u.setTimeout(r,1)}}function r(){for(var e=0;e<c.length;e++){var t=c[e],n=t[0],i=t[1];n(i)}c=[]}function o(e,t){var n=c.push([e,t]);1===n&&a()}var a,s="undefined"!=typeof window?window:{},l=s.MutationObserver||s.WebKitMutationObserver,u="undefined"!=typeof global?global:void 0===this?window:this,c=[];a="undefined"!=typeof process&&"[object process]"==={}.toString.call(process)?t():l?n():i(),e.asap=o}),e("promise/config",["exports"],function(e){"use strict";function t(e,t){return 2!==arguments.length?n[e]:void(n[e]=t)}var n={instrument:!1};e.config=n,e.configure=t}),e("promise/polyfill",["./promise","./utils","exports"],function(e,t,n){"use strict";function i(){var e;e="undefined"!=typeof global?global:"undefined"!=typeof window&&window.document?window:self;"Promise"in e&&"resolve"in e.Promise&&"reject"in e.Promise&&"all"in e.Promise&&"race"in e.Promise&&function(){var t;return new e.Promise(function(e){t=e}),o(t)}();e.Promise=r}var r=e.Promise,o=t.isFunction;n.polyfill=i}),e("promise/promise",["./config","./utils","./all","./race","./resolve","./reject","./asap","exports"],function(e,t,n,i,r,o,a,s){"use strict";function l(e){if(!w(e))throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");if(!(this instanceof l))throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this._subscribers=[],u(e,this)}function u(e,t){function n(e){p(t,e)}function i(e){m(t,e)}try{e(n,i)}catch(r){i(r)}}function c(e,t,n,i){var r,o,a,s,l=w(n);if(l)try{r=n(i),a=!0}catch(u){s=!0,o=u}else r=i,a=!0;f(t,r)||(l&&a?p(t,r):s?m(t,o):e===E?p(t,r):e===P&&m(t,r))}function h(e,t,n,i){var r=e._subscribers,o=r.length;r[o]=t,r[o+E]=n,r[o+P]=i}function d(e,t){for(var n,i,r=e._subscribers,o=e._detail,a=0;a<r.length;a+=3)n=r[a],i=r[a+t],c(t,n,i,o);e._subscribers=null}function f(e,t){var n,i=null;try{if(e===t)throw new TypeError("A promises callback cannot return that same promise.");if(b(t)&&(i=t.then,w(i)))return i.call(t,function(i){return n?!0:(n=!0,void(t!==i?p(e,i):g(e,i)))},function(t){return n?!0:(n=!0,void m(e,t))}),!0}catch(r){return n?!0:(m(e,r),!0)}return!1}function p(e,t){e===t?g(e,t):f(e,t)||g(e,t)}function g(e,t){e._state===M&&(e._state=L,e._detail=t,_.async(v,e))}function m(e,t){e._state===M&&(e._state=L,e._detail=t,_.async(y,e))}function v(e){d(e,e._state=E)}function y(e){d(e,e._state=P)}var _=e.config,b=(e.configure,t.objectOrFunction),w=t.isFunction,x=(t.now,n.all),k=i.race,C=r.resolve,S=o.reject,T=a.asap;_.async=T;var M=void 0,L=0,E=1,P=2;l.prototype={constructor:l,_state:void 0,_detail:void 0,_subscribers:void 0,then:function(e,t){var n=this,i=new this.constructor(function(){});if(this._state){var r=arguments;_.async(function(){c(n._state,i,r[n._state-1],n._detail)})}else h(this,i,e,t);return i},"catch":function(e){return this.then(null,e)}},l.all=x,l.race=k,l.resolve=C,l.reject=S,s.Promise=l}),e("promise/race",["./utils","exports"],function(e,t){"use strict";function n(e){var t=this;if(!i(e))throw new TypeError("You must pass an array to race.");return new t(function(t,n){for(var i,r=0;r<e.length;r++)i=e[r],i&&"function"==typeof i.then?i.then(t,n):t(i)})}var i=e.isArray;t.race=n}),e("promise/reject",["exports"],function(e){"use strict";function t(e){var t=this;return new t(function(t,n){n(e)})}e.reject=t}),e("promise/resolve",["exports"],function(e){"use strict";function t(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=this;return new t(function(t){t(e)})}e.resolve=t}),e("promise/utils",["exports"],function(e){"use strict";function t(e){return n(e)||"object"==typeof e&&null!==e}function n(e){return"function"==typeof e}function i(e){return"[object Array]"===Object.prototype.toString.call(e)}var r=Date.now||function(){return(new Date).getTime()};e.objectOrFunction=t,e.isFunction=n,e.isArray=i,e.now=r}),t("promise/polyfill").polyfill()}(),window.jQuery&&function(e){e.extend({xml2json:function(t,n){function i(t,a){if(!t)return null;var s="",l=null,u=null;t.nodeType,r(t.localName||t.nodeName),t.text||t.nodeValue||"";t.childNodes&&t.childNodes.length>0&&e.each(t.childNodes,function(e,t){var n=t.nodeType,a=r(t.localName||t.nodeName),u=t.text||t.nodeValue||"";if(8!=n)if(3!=n&&4!=n&&a)l=l||{},l[a]?(l[a].length||(l[a]=o(l[a])),l[a]=o(l[a]),l[a][l[a].length]=i(t,!0),l[a].length=l[a].length):l[a]=i(t);else{if(u.match(/^\s+$/))return;s+=u.replace(/^\s+/,"").replace(/\s+$/,"")}}),t.attributes&&t.attributes.length>0&&(u={},l=l||{},e.each(t.attributes,function(e,t){var n=r(t.name),i=t.value;u[n]=i,l[n]?(l[cnn]=o(l[cnn]),l[n][l[n].length]=i,l[n].length=l[n].length):l[n]=i})),l&&(l=e.extend(""!=s?new String(s):{},l||{}),s=l.text?[l.text||""].concat([s]):s,s&&(l.text=s),s="");var c=l||s;return n&&(s&&(c={}),s=c.text||s||"",s&&(c.text=s),a||(c=o(c))),c}if(!t)return{};var r=function(e){return String(e||"").replace(/-/g,"_")},o=function(t){return e.isArray(t)||(t=[t]),t.length=t.length,t};if("string"==typeof t&&(t=e.text2xml(t)),t.nodeType){if(3==t.nodeType||4==t.nodeType)return t.nodeValue;var a=9==t.nodeType?t.documentElement:t,s=i(a,!0);return t=null,a=null,s}},text2xml:function(t){return e.parseXML(t)}})}(jQuery),function(e,t){"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof exports?module.exports=t(require("jquery")):t(e.jQuery)}(this,function(e){function t(e){if(e in h.style)return e;for(var t=["Moz","Webkit","O","ms"],n=e.charAt(0).toUpperCase()+e.substr(1),i=0;i<t.length;++i){var r=t[i]+n;if(r in h.style)return r}}function n(){return h.style[d.transform]="",h.style[d.transform]="rotateY(90deg)",""!==h.style[d.transform]}function i(e){return"string"==typeof e&&this.parse(e),this}function r(e,t,n){t===!0?e.queue(n):t?e.queue(t,n):e.each(function(){n.call(this)})}function o(t){var n=[];return e.each(t,function(t){t=e.camelCase(t),t=e.transit.propertyMap[t]||e.cssProps[t]||t,t=l(t),d[t]&&(t=l(d[t])),-1===e.inArray(t,n)&&n.push(t)}),n}function a(t,n,i,r){var a=o(t);e.cssEase[i]&&(i=e.cssEase[i]);var s=""+c(n)+" "+i;parseInt(r,10)>0&&(s+=" "+c(r));var l=[];return e.each(a,function(e,t){l.push(t+" "+s)}),l.join(", ")}function s(t,n){n||(e.cssNumber[t]=!0),e.transit.propertyMap[t]=d.transform,e.cssHooks[t]={get:function(n){var i=e(n).css("transit:transform");return i.get(t)},set:function(n,i){var r=e(n).css("transit:transform");r.setFromString(t,i),e(n).css({"transit:transform":r})}}}function l(e){return e.replace(/([A-Z])/g,function(e){return"-"+e.toLowerCase()})}function u(e,t){return"string"!=typeof e||e.match(/^[\-0-9\.]+$/)?""+e+t:e}function c(t){var n=t;return"string"!=typeof n||n.match(/^[\-0-9\.]+/)||(n=e.fx.speeds[n]||e.fx.speeds._default),u(n,"ms")}e.transit={version:"0.9.12",propertyMap:{marginLeft:"margin",marginRight:"margin",marginBottom:"margin",marginTop:"margin",paddingLeft:"padding",paddingRight:"padding",paddingBottom:"padding",paddingTop:"padding"},enabled:!0,useTransitionEnd:!1};var h=document.createElement("div"),d={},f=navigator.userAgent.toLowerCase().indexOf("chrome")>-1;d.transition=t("transition"),d.transitionDelay=t("transitionDelay"),d.transform=t("transform"),d.transformOrigin=t("transformOrigin"),d.filter=t("Filter"),d.transform3d=n();var p={transition:"transitionend",MozTransition:"transitionend",OTransition:"oTransitionEnd",WebkitTransition:"webkitTransitionEnd",msTransition:"MSTransitionEnd"},g=d.transitionEnd=p[d.transition]||null;for(var m in d)d.hasOwnProperty(m)&&"undefined"==typeof e.support[m]&&(e.support[m]=d[m]);return h=null,e.cssEase={_default:"ease","in":"ease-in",out:"ease-out","in-out":"ease-in-out",snap:"cubic-bezier(0,1,.5,1)",easeInCubic:"cubic-bezier(.550,.055,.675,.190)",easeOutCubic:"cubic-bezier(.215,.61,.355,1)",easeInOutCubic:"cubic-bezier(.645,.045,.355,1)",easeInCirc:"cubic-bezier(.6,.04,.98,.335)",easeOutCirc:"cubic-bezier(.075,.82,.165,1)",easeInOutCirc:"cubic-bezier(.785,.135,.15,.86)",easeInExpo:"cubic-bezier(.95,.05,.795,.035)",easeOutExpo:"cubic-bezier(.19,1,.22,1)",easeInOutExpo:"cubic-bezier(1,0,0,1)",easeInQuad:"cubic-bezier(.55,.085,.68,.53)",easeOutQuad:"cubic-bezier(.25,.46,.45,.94)",easeInOutQuad:"cubic-bezier(.455,.03,.515,.955)",easeInQuart:"cubic-bezier(.895,.03,.685,.22)",easeOutQuart:"cubic-bezier(.165,.84,.44,1)",easeInOutQuart:"cubic-bezier(.77,0,.175,1)",easeInQuint:"cubic-bezier(.755,.05,.855,.06)",easeOutQuint:"cubic-bezier(.23,1,.32,1)",easeInOutQuint:"cubic-bezier(.86,0,.07,1)",easeInSine:"cubic-bezier(.47,0,.745,.715)",easeOutSine:"cubic-bezier(.39,.575,.565,1)",easeInOutSine:"cubic-bezier(.445,.05,.55,.95)",easeInBack:"cubic-bezier(.6,-.28,.735,.045)",easeOutBack:"cubic-bezier(.175, .885,.32,1.275)",easeInOutBack:"cubic-bezier(.68,-.55,.265,1.55)"},e.cssHooks["transit:transform"]={get:function(t){return e(t).data("transform")||new i},set:function(t,n){var r=n;r instanceof i||(r=new i(r)),"WebkitTransform"!==d.transform||f?t.style[d.transform]=r.toString():t.style[d.transform]=r.toString(!0),e(t).data("transform",r)}},e.cssHooks.transform={set:e.cssHooks["transit:transform"].set},e.cssHooks.filter={get:function(e){return e.style[d.filter]},set:function(e,t){e.style[d.filter]=t}},e.fn.jquery<"1.8"&&(e.cssHooks.transformOrigin={get:function(e){return e.style[d.transformOrigin]},set:function(e,t){e.style[d.transformOrigin]=t}},e.cssHooks.transition={get:function(e){return e.style[d.transition]},set:function(e,t){e.style[d.transition]=t}}),s("scale"),s("scaleX"),s("scaleY"),s("translate"),s("rotate"),s("rotateX"),s("rotateY"),s("rotate3d"),s("perspective"),s("skewX"),s("skewY"),s("x",!0),s("y",!0),i.prototype={setFromString:function(e,t){
var n="string"==typeof t?t.split(","):t.constructor===Array?t:[t];n.unshift(e),i.prototype.set.apply(this,n)},set:function(e){var t=Array.prototype.slice.apply(arguments,[1]);this.setter[e]?this.setter[e].apply(this,t):this[e]=t.join(",")},get:function(e){return this.getter[e]?this.getter[e].apply(this):this[e]||0},setter:{rotate:function(e){this.rotate=u(e,"deg")},rotateX:function(e){this.rotateX=u(e,"deg")},rotateY:function(e){this.rotateY=u(e,"deg")},scale:function(e,t){void 0===t&&(t=e),this.scale=e+","+t},skewX:function(e){this.skewX=u(e,"deg")},skewY:function(e){this.skewY=u(e,"deg")},perspective:function(e){this.perspective=u(e,"px")},x:function(e){this.set("translate",e,null)},y:function(e){this.set("translate",null,e)},translate:function(e,t){void 0===this._translateX&&(this._translateX=0),void 0===this._translateY&&(this._translateY=0),null!==e&&void 0!==e&&(this._translateX=u(e,"px")),null!==t&&void 0!==t&&(this._translateY=u(t,"px")),this.translate=this._translateX+","+this._translateY}},getter:{x:function(){return this._translateX||0},y:function(){return this._translateY||0},scale:function(){var e=(this.scale||"1,1").split(",");return e[0]&&(e[0]=parseFloat(e[0])),e[1]&&(e[1]=parseFloat(e[1])),e[0]===e[1]?e[0]:e},rotate3d:function(){for(var e=(this.rotate3d||"0,0,0,0deg").split(","),t=0;3>=t;++t)e[t]&&(e[t]=parseFloat(e[t]));return e[3]&&(e[3]=u(e[3],"deg")),e}},parse:function(e){var t=this;e.replace(/([a-zA-Z0-9]+)\((.*?)\)/g,function(e,n,i){t.setFromString(n,i)})},toString:function(e){var t=[];for(var n in this)if(this.hasOwnProperty(n)){if(!d.transform3d&&("rotateX"===n||"rotateY"===n||"perspective"===n||"transformOrigin"===n))continue;"_"!==n[0]&&(e&&"scale"===n?t.push(n+"3d("+this[n]+",1)"):e&&"translate"===n?t.push(n+"3d("+this[n]+",0)"):t.push(n+"("+this[n]+")"))}return t.join(" ")}},e.fn.transition=e.fn.transit=function(t,n,i,o){var s=this,l=0,u=!0,h=e.extend(!0,{},t);"function"==typeof n&&(o=n,n=void 0),"object"==typeof n&&(i=n.easing,l=n.delay||0,u="undefined"==typeof n.queue?!0:n.queue,o=n.complete,n=n.duration),"function"==typeof i&&(o=i,i=void 0),"undefined"!=typeof h.easing&&(i=h.easing,delete h.easing),"undefined"!=typeof h.duration&&(n=h.duration,delete h.duration),"undefined"!=typeof h.complete&&(o=h.complete,delete h.complete),"undefined"!=typeof h.queue&&(u=h.queue,delete h.queue),"undefined"!=typeof h.delay&&(l=h.delay,delete h.delay),"undefined"==typeof n&&(n=e.fx.speeds._default),"undefined"==typeof i&&(i=e.cssEase._default),n=c(n);var f=a(h,n,i,l),p=e.transit.enabled&&d.transition,m=p?parseInt(n,10)+parseInt(l,10):0;if(0===m){var v=function(e){s.css(h),o&&o.apply(s),e&&e()};return r(s,u,v),s}var y={},_=function(t){var n=!1,i=function(){n&&s.unbind(g,i),m>0&&s.each(function(){this.style[d.transition]=y[this]||null}),"function"==typeof o&&o.apply(s),"function"==typeof t&&t()};m>0&&g&&e.transit.useTransitionEnd?(n=!0,s.bind(g,i)):window.setTimeout(i,m),s.each(function(){m>0&&(this.style[d.transition]=f),e(this).css(h)})},b=function(e){this.offsetWidth,_(e)};return r(s,u,b),this},e.transit.getTransitionValue=a,e}),function(e){e.ajaxTransport("+*",function(e,t,n){return window.FormData&&(e.dataType&&("blob"===e.dataType||"arraybuffer"===e.dataType)||e.data&&(window.Blob&&e.data instanceof Blob||window.ArrayBuffer&&e.data instanceof ArrayBuffer))?{send:function(t,n){var i,r=new XMLHttpRequest,o=e.url||window.location.href,a=e.type||"GET",s=e.dataType||"text",l=e.data||null,u=e.async||!0;r.addEventListener("load",function(){var e,t={};e=r.status>=200&&r.status<300||304===r.status,e?t[s]=r.response:t.text=String.fromCharCode.apply(null,new Uint8Array(r.response)),n(r.status,r.statusText,t,r.getAllResponseHeaders())}),r.open(a,o,u),r.responseType=s;for(i in t)t.hasOwnProperty(i)&&r.setRequestHeader(i,t[i]);r.send(l)},abort:function(){n.abort()}}:void 0})}(window.jQuery),function(e){function t(){var e=-1,t=this;t.append=function(n){var i,r=t.table;for(i=0;i<n.length;i++)e=e>>>8^r[255&(e^n[i])]},t.get=function(){return~e}}function n(e,t,n){return e.slice?e.slice(t,t+n):e.webkitSlice?e.webkitSlice(t,t+n):e.mozSlice?e.mozSlice(t,t+n):e.msSlice?e.msSlice(t,t+n):void 0}function i(e,t){var n,i;return n=new ArrayBuffer(e),i=new Uint8Array(n),t&&i.set(t,0),{buffer:n,array:i,view:new DataView(n)}}function r(){}function o(e){function t(t,n){var o=new Blob([e],{type:"text/plain"});i=new s(o),i.init(function(){r.size=i.size,t()},n)}function n(e,t,n,r){i.readUint8Array(e,t,n,r)}var i,r=this;r.size=0,r.init=t,r.readUint8Array=n}function a(t){function n(e){for(var n=t.length;"="==t.charAt(n-1);)n--;o=t.indexOf(",")+1,a.size=Math.floor(.75*(n-o)),e()}function r(n,r,a){var s,l=i(r),u=4*Math.floor(n/3),c=4*Math.ceil((n+r)/3),h=e.atob(t.substring(u+o,c+o)),d=n-3*Math.floor(u/4);for(s=d;d+r>s;s++)l.array[s-d]=h.charCodeAt(s);a(l.array)}var o,a=this;a.size=0,a.init=n,a.readUint8Array=r}function s(e){function t(t){this.size=e.size,t()}function i(t,i,r,o){var a=new FileReader;a.onload=function(e){r(new Uint8Array(e.target.result))},a.onerror=o,a.readAsArrayBuffer(n(e,t,i))}var r=this;r.size=0,r.init=t,r.readUint8Array=i}function l(e){function t(t,n){var i;r.data?t():(i=new XMLHttpRequest,i.addEventListener("load",function(){r.size||(r.size=Number(i.getResponseHeader("Content-Length"))),r.data=new Uint8Array(i.response),t()},!1),i.addEventListener("error",n,!1),i.open("GET",e),i.responseType="arraybuffer",i.send())}function n(t,n){var i=new XMLHttpRequest;i.addEventListener("load",function(){r.size=Number(i.getResponseHeader("Content-Length")),t()},!1),i.addEventListener("error",n,!1),i.open("HEAD",e),i.send()}function i(e,n,i,o){t(function(){i(new Uint8Array(r.data.subarray(e,e+n)))},o)}var r=this;r.size=0,r.init=n,r.readUint8Array=i}function u(e){function t(t,n){var i=new XMLHttpRequest;i.addEventListener("load",function(){r.size=Number(i.getResponseHeader("Content-Length")),"bytes"==i.getResponseHeader("Accept-Ranges")?t():n(z)},!1),i.addEventListener("error",n,!1),i.open("HEAD",e),i.send()}function n(t,n,i,r){var o=new XMLHttpRequest;o.open("GET",e),o.responseType="arraybuffer",o.setRequestHeader("Range","bytes="+t+"-"+(t+n-1)),o.addEventListener("load",function(){i(o.response)},!1),o.addEventListener("error",r,!1),o.send()}function i(e,t,i,r){n(e,t,function(e){i(new Uint8Array(e))},r)}var r=this;r.size=0,r.init=t,r.readUint8Array=i}function c(){}function h(){function e(e){i=new Blob([],{type:"text/plain"}),e()}function t(e,t){i=new Blob([i,E?e:e.buffer],{type:"text/plain"}),t()}function n(e,t){var n=new FileReader;n.onload=function(t){e(t.target.result)},n.onerror=t,n.readAsText(i)}var i,r=this;r.init=e,r.writeUint8Array=t,r.getData=n}function d(t){function n(e){a+="data:"+(t||"")+";base64,",e()}function i(t,n){var i,r=s.length,o=s;for(s="",i=0;i<3*Math.floor((r+t.length)/3)-r;i++)o+=String.fromCharCode(t[i]);for(;i<t.length;i++)s+=String.fromCharCode(t[i]);o.length>2?a+=e.btoa(o):s=o,n()}function r(t){t(a+e.btoa(s))}var o=this,a="",s="";o.init=n,o.writeUint8Array=i,o.getData=r}function f(e,t){function n(t,n){e.createWriter(function(e){o=e,t()},n)}function i(e,n,i){var r=new Blob([E?e:e.buffer],{type:t});o.onwrite=function(){o.onwrite=null,n()},o.onerror=i,o.write(r)}function r(t){e.file(t)}var o,a=this;a.init=n,a.writeUint8Array=i,a.getData=r}function p(e){function t(t){r=new Blob([],{type:e}),t()}function n(t,n){r=new Blob([r,E?t:t.buffer],{type:e}),n()}function i(e){e(r)}var r,o=this;o.init=t,o.writeUint8Array=n,o.getData=i}function g(e,t,n,i,r,o,a,s,l,u){function c(){e.removeEventListener("message",h,!1),s(p)}function h(e){var t=e.data,i=t.data;t.onappend&&(p+=i.length,n.writeUint8Array(i,function(){o(!1,i),d()},u)),t.onflush&&(i?(p+=i.length,n.writeUint8Array(i,function(){o(!1,i),c()},u)):c()),t.progress&&a&&a(f+t.current,r)}function d(){f=g*W,r>f?t.readUint8Array(i+f,Math.min(W,r-f),function(t){e.postMessage({append:!0,data:t}),g++,a&&a(f,r),o(!0,t)},l):e.postMessage({flush:!0})}var f,p,g=0;p=0,e.addEventListener("message",h,!1),d()}function m(e,t,n,i,r,o,a,s,l,u){function c(){var p;h=d*W,r>h?t.readUint8Array(i+h,Math.min(W,r-h),function(t){var s=e.append(t,function(){a&&a(i+h,r)});f+=s.length,o(!0,t),n.writeUint8Array(s,function(){o(!1,s),d++,setTimeout(c,1)},u),a&&a(h,r)},l):(p=e.flush(),p?(f+=p.length,n.writeUint8Array(p,function(){o(!1,p),s(f)},u)):s(f))}var h,d=0,f=0;c()}function v(n,i,r,o,a,s,l,u,c){function h(e,t){a&&!e&&p.append(t)}function d(e){s(e,p.get())}var f,p=new t;return e.zip.useWebWorkers?(f=new Worker(e.zip.inflateJSPath||H),g(f,n,i,r,o,h,l,d,u,c)):m(new e.zip.Inflater,n,i,r,o,h,l,d,u,c),f}function y(n,i,r,o,a,s,l){function u(e,t){e&&f.append(t)}function c(e){o(e,f.get())}function h(){d.removeEventListener("message",h,!1),g(d,n,i,0,n.size,u,a,c,s,l)}var d,f=new t;return e.zip.useWebWorkers?(d=new Worker(e.zip.workerScriptsPath+U),d.addEventListener("message",h,!1),d.postMessage({init:!0,level:r})):m(new e.zip.Deflater,n,i,0,n.size,u,a,c,s,l),d}function _(e,n,i,r,o,a,s,l,u){function c(){var t=h*W;r>t?e.readUint8Array(i+t,Math.min(W,r-t),function(e){o&&d.append(e),s&&s(t,r,e),n.writeUint8Array(e,function(){h++,c()},u)},l):a(r,d.get())}var h=0,d=new t;c()}function b(e){var t,n,i="",r=["Ç","ü","é","â","ä","à","å","ç","ê","ë","è","ï","î","ì","Ä","Å","É","æ","Æ","ô","ö","ò","û","ù","ÿ","Ö","Ü","ø","£","Ø","×","ƒ","á","í","ó","ú","ñ","Ñ","ª","º","¿","®","¬","½","¼","¡","«","»","_","_","_","¦","¦","Á","Â","À","©","¦","¦","+","+","¢","¥","+","+","-","-","+","-","+","ã","Ã","+","+","-","-","¦","-","+","¤","ð","Ð","Ê","Ë","È","i","Í","Î","Ï","+","+","_","_","¦","Ì","_","Ó","ß","Ô","Ò","õ","Õ","µ","þ","Þ","Ú","Û","Ù","ý","Ý","¯","´","­","±","_","¾","¶","§","÷","¸","°","¨","·","¹","³","²","_"," "];for(t=0;t<e.length;t++)n=255&e.charCodeAt(t),i+=n>127?r[n-128]:String.fromCharCode(n);return i}function w(e){var t=[],n=0,i=0,r=0,o=0,a=0;for(e+="";n<e.length;)r=e.charCodeAt(n),128>r?(t[i++]=String.fromCharCode(r),n++):r>191&&224>r?(o=e.charCodeAt(n+1),t[i++]=String.fromCharCode((31&r)<<6|63&o),n+=2):(o=e.charCodeAt(n+1),a=e.charCodeAt(n+2),t[i++]=String.fromCharCode((15&r)<<12|(63&o)<<6|63&a),n+=3);return t.join("")}function x(e){var t,n="";for(t=0;t<e.length;t++)n+=String.fromCharCode(e[t]);return n}function k(e){var t=(4294901760&e)>>16,n=65535&e;try{return new Date(1980+((65024&t)>>9),((480&t)>>5)-1,31&t,(63488&n)>>11,(2016&n)>>5,2*(31&n),0)}catch(i){}}function C(e,t,n,i,r){return e.version=t.view.getUint16(n,!0),e.bitFlag=t.view.getUint16(n+2,!0),e.compressionMethod=t.view.getUint16(n+4,!0),e.lastModDateRaw=t.view.getUint32(n+6,!0),e.lastModDate=k(e.lastModDateRaw),1===(1&e.bitFlag)?void r(N):((i||8!=(8&e.bitFlag))&&(e.crc32=t.view.getUint32(n+10,!0),e.compressedSize=t.view.getUint32(n+14,!0),e.uncompressedSize=t.view.getUint32(n+18,!0)),4294967295===e.compressedSize||4294967295===e.uncompressedSize?void r(A):(e.filenameLength=t.view.getUint16(n+22,!0),void(e.extraFieldLength=t.view.getUint16(n+24,!0))))}function S(e,t){function n(){}function r(n,o){e.readUint8Array(e.size-n,n,function(e){var a=i(e.length,e).view;try{1347093766!=a.getUint32(0)?r(n+1,o):o(a)}catch(s){t(I)}},function(){t(I)})}return n.prototype.getData=function(n,r,o,a){function s(e,t){d&&d.terminate(),d=null,e&&e(t)}function l(e){var t=i(4);return t.view.setUint32(0,e),f.crc32==t.view.getUint32(0)}function u(e,t){a&&!l(t)?c():n.getData(function(e){s(r,e)})}function c(){s(t,B)}function h(){s(t,D)}var d,f=this;e.readUint8Array(f.offset,30,function(r){var s,l=i(r.length,r);return 1347093252!=l.view.getUint32(0)?void t(P):(C(f,l,4,!1,function(e){t(e)}),s=f.offset+30+f.filenameLength+f.extraFieldLength,void n.init(function(){0===f.compressionMethod?_(e,n,s,f.compressedSize,a,u,o,c,h):d=v(e,n,s,f.compressedSize,a,u,o,c,h)},h))},c)},{getEntries:function(o){return e.size<22?void t(P):void r(22,function(r){var a,s;a=r.getUint32(16,!0),s=r.getUint16(8,!0),e.readUint8Array(a,e.size-a,function(e){var r,a,l,u,c=0,h=[],d=i(e.length,e);for(r=0;s>r;r++){if(a=new n,1347092738!=d.view.getUint32(c))return void t(P);C(a,d,c+6,!0,function(e){t(e)}),a.commentLength=d.view.getUint16(c+32,!0),a.directory=16==(16&d.view.getUint8(c+38)),a.offset=d.view.getUint32(c+42,!0),l=x(d.array.subarray(c+46,c+46+a.filenameLength)),a.filename=2048===(2048&a.bitFlag)?w(l):b(l),a.directory||"/"!=a.filename.charAt(a.filename.length-1)||(a.directory=!0),u=x(d.array.subarray(c+46+a.filenameLength+a.extraFieldLength,c+46+a.filenameLength+a.extraFieldLength+a.commentLength)),a.comment=2048===(2048&a.bitFlag)?w(u):b(u),h.push(a),c+=46+a.filenameLength+a.extraFieldLength+a.commentLength}o(h)},function(){t(I)})})},close:function(e){e&&e()}}}function T(e){var t,n,i,r=[],o=0,a=0,s=e.length;for(t=0;s>t;t++)n=e.charCodeAt(t),i=null,128>n?a++:i=n>127&&2048>n?String.fromCharCode(n>>6|192)+String.fromCharCode(63&n|128):String.fromCharCode(n>>12|224)+String.fromCharCode(n>>6&63|128)+String.fromCharCode(63&n|128),null!=i&&(a>o&&(r+=e.slice(o,a)),r+=i,o=a=t+1);return a>o&&(r+=e.slice(o,s)),r}function M(e){var t,n=[];for(t=0;t<e.length;t++)n.push(e.charCodeAt(t));return n}function L(e,t,n){function r(e,t){s&&s.terminate(),s=null,e&&e(t)}function o(){r(t,O)}function a(){r(t,B)}var s,l=[],u=[],c=0;return{add:function(t,h,d,f,p){function g(r){var a;x=p.lastModDate||new Date,b=i(26),l[t]={headerArray:b.array,directory:p.directory,filename:w,offset:c,comment:M(T(p.comment||""))},b.view.setUint32(0,335546376),p.version&&b.view.setUint8(0,p.version),n||0==p.level||p.directory||b.view.setUint16(4,2048),b.view.setUint16(6,(x.getHours()<<6|x.getMinutes())<<5|x.getSeconds()/2,!0),b.view.setUint16(8,(x.getFullYear()-1980<<4|x.getMonth()+1)<<5|x.getDate(),!0),b.view.setUint16(22,w.length,!0),a=i(30+w.length),a.view.setUint32(0,1347093252),a.array.set(b.array,4),a.array.set(w,30),c+=a.array.length,e.writeUint8Array(a.array,r,o)}function m(t,n){var a=i(16);c+=t||0,a.view.setUint32(0,1347094280),"undefined"!=typeof n&&(b.view.setUint32(10,n,!0),a.view.setUint32(4,n,!0)),h&&(a.view.setUint32(8,t,!0),b.view.setUint32(14,t,!0),a.view.setUint32(12,h.size,!0),b.view.setUint32(18,h.size,!0)),e.writeUint8Array(a.array,function(){c+=16,r(d)},o)}function v(){if(p=p||{},t=t.trim(),p.directory&&"/"!=t.charAt(t.length-1)&&(t+="/"),l[t])throw R;w=M(T(t)),u.push(t),g(function(){h?n||0==p.level?_(h,e,0,h.size,!0,m,f,a,o):s=y(h,e,p.level,m,f,a,o):m()},o)}var b,w,x;h?h.init(v,a):v()},close:function(t){var n,a=0,s=0;u.forEach(function(e){var t=l[e];a+=46+t.filename.length+t.comment.length}),n=i(a+22),u.forEach(function(e){var t=l[e];n.view.setUint32(s,1347092738),n.view.setUint16(s+4,5120),n.array.set(t.headerArray,s+6),n.view.setUint16(s+32,t.comment.length,!0),t.directory&&n.view.setUint8(s+38,16),n.view.setUint32(s+42,t.offset,!0),n.array.set(t.filename,s+46),n.array.set(t.comment,s+46+t.filename.length),s+=46+t.filename.length+t.comment.length}),n.view.setUint32(s,1347093766),n.view.setUint16(s+8,u.length,!0),n.view.setUint16(s+10,u.length,!0),n.view.setUint32(s+12,a,!0),n.view.setUint32(s+16,c,!0),e.writeUint8Array(n.array,function(){r(function(){e.getData(t)})},o)}}}var E,P="File format is not recognized.",N="File contains encrypted entry.",A="File is using Zip64 (4gb+ file size).",I="Error while reading zip file.",O="Error while writing zip file.",D="Error while writing file data.",B="Error while reading file data.",R="File already exists.",z="HTTP Range not supported.",W=524288,H="inflate.js",U="deflate.js";try{E=0==new Blob([i(0).view]).size}catch(V){}t.prototype.table=function(){var e,t,n,i=[];for(e=0;256>e;e++){for(n=e,t=0;8>t;t++)1&n?n=n>>>1^3988292384:n>>>=1;i[e]=n}return i}(),o.prototype=new r,o.prototype.constructor=o,a.prototype=new r,a.prototype.constructor=a,s.prototype=new r,s.prototype.constructor=s,l.prototype=new r,l.prototype.constructor=l,u.prototype=new r,u.prototype.constructor=u,c.prototype.getData=function(e){e(this.data)},h.prototype=new c,h.prototype.constructor=h,d.prototype=new c,d.prototype.constructor=d,f.prototype=new c,f.prototype.constructor=f,p.prototype=new c,p.prototype.constructor=p,e.zip={Reader:r,Writer:c,BlobReader:s,HttpReader:l,HttpRangeReader:u,Data64URIReader:a,TextReader:o,BlobWriter:p,FileWriter:f,Data64URIWriter:d,TextWriter:h,createReader:function(e,t,n){e.init(function(){t(S(e,n))},n)},createWriter:function(e,t,n,i){e.init(function(){t(L(e,n,i))},n)},workerScriptsPath:"",inflateJSPath:"",useWebWorkers:!0}}(this),!function(e,t){"use strict";var n,i,r=e,o=r.document,a=r.navigator,s=r.setTimeout,l=r.encodeURIComponent,u=r.ActiveXObject,c=r.Error,h=r.Number.parseInt||r.parseInt,d=r.Number.parseFloat||r.parseFloat,f=r.Number.isNaN||r.isNaN,p=r.Math.round,g=r.Date.now,m=r.Object.keys,v=r.Object.defineProperty,y=r.Object.prototype.hasOwnProperty,_=r.Array.prototype.slice,b=function(){var e=function(e){return e};if("function"==typeof r.wrap&&"function"==typeof r.unwrap)try{var t=o.createElement("div"),n=r.unwrap(t);1===t.nodeType&&n&&1===n.nodeType&&(e=r.unwrap)}catch(i){}return e}(),w=function(e){return _.call(e,0)},x=function(){var e,n,i,r,o,a,s=w(arguments),l=s[0]||{};for(e=1,n=s.length;n>e;e++)if(null!=(i=s[e]))for(r in i)y.call(i,r)&&(o=l[r],a=i[r],l!==a&&a!==t&&(l[r]=a));return l},k=function(e){var t,n,i,r;if("object"!=typeof e||null==e)t=e;else if("number"==typeof e.length)for(t=[],n=0,i=e.length;i>n;n++)y.call(e,n)&&(t[n]=k(e[n]));else{t={};for(r in e)y.call(e,r)&&(t[r]=k(e[r]))}return t},C=function(e,t){for(var n={},i=0,r=t.length;r>i;i++)t[i]in e&&(n[t[i]]=e[t[i]]);return n},S=function(e,t){var n={};for(var i in e)-1===t.indexOf(i)&&(n[i]=e[i]);return n},T=function(e){if(e)for(var t in e)y.call(e,t)&&delete e[t];return e},M=function(e,t){if(e&&1===e.nodeType&&e.ownerDocument&&t&&(1===t.nodeType&&t.ownerDocument&&t.ownerDocument===e.ownerDocument||9===t.nodeType&&!t.ownerDocument&&t===e.ownerDocument))do{if(e===t)return!0;e=e.parentNode}while(e);return!1},L=function(e){var t;return"string"==typeof e&&e&&(t=e.split("#")[0].split("?")[0],t=e.slice(0,e.lastIndexOf("/")+1)),t},E=function(e){var t,n;return"string"==typeof e&&e&&(n=e.match(/^(?:|[^:@]*@|.+\)@(?=http[s]?|file)|.+?\s+(?: at |@)(?:[^:\(]+ )*[\(]?)((?:http[s]?|file):\/\/[\/]?.+?\/[^:\)]*?)(?::\d+)(?::\d+)?/),n&&n[1]?t=n[1]:(n=e.match(/\)@((?:http[s]?|file):\/\/[\/]?.+?\/[^:\)]*?)(?::\d+)(?::\d+)?/),n&&n[1]&&(t=n[1]))),t},P=function(){var e,t;try{throw new c}catch(n){t=n}return t&&(e=t.sourceURL||t.fileName||E(t.stack)),e},N=function(){var e,n,i;if(o.currentScript&&(e=o.currentScript.src))return e;if(n=o.getElementsByTagName("script"),1===n.length)return n[0].src||t;if("readyState"in n[0])for(i=n.length;i--;)if("interactive"===n[i].readyState&&(e=n[i].src))return e;return"loading"===o.readyState&&(e=n[n.length-1].src)?e:(e=P())?e:t},A=function(){var e,n,i,r=o.getElementsByTagName("script");for(e=r.length;e--;){if(!(i=r[e].src)){n=null;break}if(i=L(i),null==n)n=i;else if(n!==i){n=null;break}}return n||t},I=function(){var e=L(N())||A()||"";return e+"ZeroClipboard.swf"},O={bridge:null,version:"0.0.0",pluginType:"unknown",disabled:null,outdated:null,unavailable:null,deactivated:null,overdue:null,ready:null},D="11.0.0",B={},R={},z=null,W={ready:"Flash communication is established",error:{"flash-disabled":"Flash is disabled or not installed","flash-outdated":"Flash is too outdated to support ZeroClipboard","flash-unavailable":"Flash is unable to communicate bidirectionally with JavaScript","flash-deactivated":"Flash is too outdated for your browser and/or is configured as click-to-activate","flash-overdue":"Flash communication was established but NOT within the acceptable time limit"}},H={swfPath:I(),trustedDomains:e.location.host?[e.location.host]:[],cacheBust:!0,forceEnhancedClipboard:!1,flashLoadTimeout:3e4,autoActivate:!0,bubbleEvents:!0,containerId:"global-zeroclipboard-html-bridge",containerClass:"global-zeroclipboard-container",swfObjectId:"global-zeroclipboard-flash-bridge",hoverClass:"zeroclipboard-is-hover",activeClass:"zeroclipboard-is-active",forceHandCursor:!1,title:null,zIndex:999999999},U=function(e){if("object"==typeof e&&null!==e)for(var t in e)if(y.call(e,t))if(/^(?:forceHandCursor|title|zIndex|bubbleEvents)$/.test(t))H[t]=e[t];else if(null==O.bridge)if("containerId"===t||"swfObjectId"===t){if(!ne(e[t]))throw new Error("The specified `"+t+"` value is not valid as an HTML4 Element ID");H[t]=e[t]}else H[t]=e[t];return"string"==typeof e&&e?y.call(H,e)?H[e]:void 0:k(H)},V=function(){return{browser:C(a,["userAgent","platform","appName"]),flash:S(O,["bridge"]),zeroclipboard:{version:Ne.version,config:Ne.config()}}},j=function(){return!!(O.disabled||O.outdated||O.unavailable||O.deactivated)},F=function(e,t){var n,i,r,o={};if("string"==typeof e&&e)r=e.toLowerCase().split(/\s+/);else if("object"==typeof e&&e&&"undefined"==typeof t)for(n in e)y.call(e,n)&&"string"==typeof n&&n&&"function"==typeof e[n]&&Ne.on(n,e[n]);if(r&&r.length){for(n=0,i=r.length;i>n;n++)e=r[n].replace(/^on/,""),o[e]=!0,B[e]||(B[e]=[]),B[e].push(t);if(o.ready&&O.ready&&Ne.emit({type:"ready"}),o.error){var a=["disabled","outdated","unavailable","deactivated","overdue"];for(n=0,i=a.length;i>n;n++)if(O[a[n]]===!0){Ne.emit({type:"error",name:"flash-"+a[n]});break}}}return Ne},$=function(e,t){var n,i,r,o,a;if(0===arguments.length)o=m(B);else if("string"==typeof e&&e)o=e.split(/\s+/);else if("object"==typeof e&&e&&"undefined"==typeof t)for(n in e)y.call(e,n)&&"string"==typeof n&&n&&"function"==typeof e[n]&&Ne.off(n,e[n]);if(o&&o.length)for(n=0,i=o.length;i>n;n++)if(e=o[n].toLowerCase().replace(/^on/,""),a=B[e],a&&a.length)if(t)for(r=a.indexOf(t);-1!==r;)a.splice(r,1),r=a.indexOf(t,r);else a.length=0;return Ne},K=function(e){var t;return t="string"==typeof e&&e?k(B[e])||null:k(B)},q=function(e){var t,n,i;return e=ie(e),e&&!ue(e)?"ready"===e.type&&O.overdue===!0?Ne.emit({type:"error",name:"flash-overdue"}):(t=x({},e),le.call(this,t),"copy"===e.type&&(i=ge(R),n=i.data,z=i.formatMap),n):void 0},G=function(){if("boolean"!=typeof O.ready&&(O.ready=!1),!Ne.isFlashUnusable()&&null===O.bridge){var e=H.flashLoadTimeout;"number"==typeof e&&e>=0&&s(function(){"boolean"!=typeof O.deactivated&&(O.deactivated=!0),O.deactivated===!0&&Ne.emit({type:"error",name:"flash-deactivated"})},e),O.overdue=!1,fe()}},X=function(){Ne.clearData(),Ne.blur(),Ne.emit("destroy"),pe(),Ne.off()},Y=function(e,t){var n;if("object"==typeof e&&e&&"undefined"==typeof t)n=e,Ne.clearData();else{if("string"!=typeof e||!e)return;n={},n[e]=t}for(var i in n)"string"==typeof i&&i&&y.call(n,i)&&"string"==typeof n[i]&&n[i]&&(R[i]=n[i])},Q=function(e){"undefined"==typeof e?(T(R),z=null):"string"==typeof e&&y.call(R,e)&&delete R[e]},J=function(e){return"undefined"==typeof e?k(R):"string"==typeof e&&y.call(R,e)?R[e]:void 0},Z=function(e){if(e&&1===e.nodeType){n&&(ke(n,H.activeClass),n!==e&&ke(n,H.hoverClass)),n=e,xe(e,H.hoverClass);var t=e.getAttribute("title")||H.title;if("string"==typeof t&&t){var i=de(O.bridge);i&&i.setAttribute("title",t)}var r=H.forceHandCursor===!0||"pointer"===Ce(e,"cursor");Le(r),Me()}},ee=function(){var e=de(O.bridge);e&&(e.removeAttribute("title"),e.style.left="0px",e.style.top="-9999px",e.style.width="1px",e.style.top="1px"),n&&(ke(n,H.hoverClass),ke(n,H.activeClass),n=null)},te=function(){return n||null},ne=function(e){return"string"==typeof e&&e&&/^[A-Za-z][A-Za-z0-9_:\-\.]*$/.test(e)},ie=function(e){var t;if("string"==typeof e&&e?(t=e,e={}):"object"==typeof e&&e&&"string"==typeof e.type&&e.type&&(t=e.type),t){!e.target&&/^(copy|aftercopy|_click)$/.test(t.toLowerCase())&&(e.target=i),x(e,{type:t.toLowerCase(),target:e.target||n||null,relatedTarget:e.relatedTarget||null,currentTarget:O&&O.bridge||null,timeStamp:e.timeStamp||g()||null});var r=W[e.type];return"error"===e.type&&e.name&&r&&(r=r[e.name]),r&&(e.message=r),"ready"===e.type&&x(e,{target:null,version:O.version}),"error"===e.type&&(/^flash-(disabled|outdated|unavailable|deactivated|overdue)$/.test(e.name)&&x(e,{target:null,minimumVersion:D}),/^flash-(outdated|unavailable|deactivated|overdue)$/.test(e.name)&&x(e,{version:O.version})),"copy"===e.type&&(e.clipboardData={setData:Ne.setData,clearData:Ne.clearData}),"aftercopy"===e.type&&(e=me(e,z)),e.target&&!e.relatedTarget&&(e.relatedTarget=re(e.target)),e=oe(e)}},re=function(e){var t=e&&e.getAttribute&&e.getAttribute("data-clipboard-target");return t?o.getElementById(t):null},oe=function(e){if(e&&/^_(?:click|mouse(?:over|out|down|up|move))$/.test(e.type)){var n=e.target,i="_mouseover"===e.type&&e.relatedTarget?e.relatedTarget:t,a="_mouseout"===e.type&&e.relatedTarget?e.relatedTarget:t,s=Te(n),l=r.screenLeft||r.screenX||0,u=r.screenTop||r.screenY||0,c=o.body.scrollLeft+o.documentElement.scrollLeft,h=o.body.scrollTop+o.documentElement.scrollTop,d=s.left+("number"==typeof e._stageX?e._stageX:0),f=s.top+("number"==typeof e._stageY?e._stageY:0),p=d-c,g=f-h,m=l+p,v=u+g,y="number"==typeof e.movementX?e.movementX:0,_="number"==typeof e.movementY?e.movementY:0;delete e._stageX,delete e._stageY,x(e,{srcElement:n,fromElement:i,toElement:a,screenX:m,screenY:v,pageX:d,pageY:f,clientX:p,clientY:g,x:p,y:g,movementX:y,movementY:_,offsetX:0,offsetY:0,layerX:0,layerY:0})}return e},ae=function(e){var t=e&&"string"==typeof e.type&&e.type||"";return!/^(?:(?:before)?copy|destroy)$/.test(t)},se=function(e,t,n,i){i?s(function(){e.apply(t,n)},0):e.apply(t,n)},le=function(e){if("object"==typeof e&&e&&e.type){var t=ae(e),n=B["*"]||[],i=B[e.type]||[],o=n.concat(i);if(o&&o.length){var a,s,l,u,c,h=this;for(a=0,s=o.length;s>a;a++)l=o[a],u=h,"string"==typeof l&&"function"==typeof r[l]&&(l=r[l]),"object"==typeof l&&l&&"function"==typeof l.handleEvent&&(u=l,l=l.handleEvent),"function"==typeof l&&(c=x({},e),se(l,u,[c],t))}return this}},ue=function(e){var t=e.target||n||null,r="swf"===e._source;delete e._source;var o=["flash-disabled","flash-outdated","flash-unavailable","flash-deactivated","flash-overdue"];switch(e.type){case"error":-1!==o.indexOf(e.name)&&x(O,{disabled:"flash-disabled"===e.name,outdated:"flash-outdated"===e.name,unavailable:"flash-unavailable"===e.name,deactivated:"flash-deactivated"===e.name,overdue:"flash-overdue"===e.name,ready:!1});break;case"ready":var a=O.deactivated===!0;x(O,{disabled:!1,outdated:!1,unavailable:!1,deactivated:!1,overdue:a,ready:!a});break;case"beforecopy":i=t;break;case"copy":var s,l,u=e.relatedTarget;!R["text/html"]&&!R["text/plain"]&&u&&(l=u.value||u.outerHTML||u.innerHTML)&&(s=u.value||u.textContent||u.innerText)?(e.clipboardData.clearData(),e.clipboardData.setData("text/plain",s),l!==s&&e.clipboardData.setData("text/html",l)):!R["text/plain"]&&e.target&&(s=e.target.getAttribute("data-clipboard-text"))&&(e.clipboardData.clearData(),e.clipboardData.setData("text/plain",s));break;case"aftercopy":Ne.clearData(),t&&t!==we()&&t.focus&&t.focus();break;case"_mouseover":Ne.focus(t),H.bubbleEvents===!0&&r&&(t&&t!==e.relatedTarget&&!M(e.relatedTarget,t)&&ce(x({},e,{type:"mouseenter",bubbles:!1,cancelable:!1})),ce(x({},e,{type:"mouseover"})));break;case"_mouseout":Ne.blur(),H.bubbleEvents===!0&&r&&(t&&t!==e.relatedTarget&&!M(e.relatedTarget,t)&&ce(x({},e,{type:"mouseleave",bubbles:!1,cancelable:!1})),ce(x({},e,{type:"mouseout"})));break;case"_mousedown":xe(t,H.activeClass),H.bubbleEvents===!0&&r&&ce(x({},e,{type:e.type.slice(1)}));break;case"_mouseup":ke(t,H.activeClass),H.bubbleEvents===!0&&r&&ce(x({},e,{type:e.type.slice(1)}));break;case"_click":i=null,H.bubbleEvents===!0&&r&&ce(x({},e,{type:e.type.slice(1)}));break;case"_mousemove":H.bubbleEvents===!0&&r&&ce(x({},e,{type:e.type.slice(1)}))}return/^_(?:click|mouse(?:over|out|down|up|move))$/.test(e.type)?!0:void 0},ce=function(e){if(e&&"string"==typeof e.type&&e){var t,n=e.target||null,i=n&&n.ownerDocument||o,a={view:i.defaultView||r,canBubble:!0,cancelable:!0,detail:"click"===e.type?1:0,button:"number"==typeof e.which?e.which-1:"number"==typeof e.button?e.button:i.createEvent?0:1},s=x(a,e);n&&i.createEvent&&n.dispatchEvent&&(s=[s.type,s.canBubble,s.cancelable,s.view,s.detail,s.screenX,s.screenY,s.clientX,s.clientY,s.ctrlKey,s.altKey,s.shiftKey,s.metaKey,s.button,s.relatedTarget],t=i.createEvent("MouseEvents"),t.initMouseEvent&&(t.initMouseEvent.apply(t,s),t._source="js",n.dispatchEvent(t)))}},he=function(){var e=o.createElement("div");return e.id=H.containerId,e.className=H.containerClass,e.style.position="absolute",e.style.left="0px",e.style.top="-9999px",e.style.width="1px",e.style.height="1px",e.style.zIndex=""+Ee(H.zIndex),e},de=function(e){for(var t=e&&e.parentNode;t&&"OBJECT"===t.nodeName&&t.parentNode;)t=t.parentNode;return t||null},fe=function(){var e,t=O.bridge,n=de(t);if(!t){var i=be(r.location.host,H),a="never"===i?"none":"all",s=ye(H),l=H.swfPath+ve(H.swfPath,H);n=he();var u=o.createElement("div");n.appendChild(u),o.body.appendChild(n);var c=o.createElement("div"),h="activex"===O.pluginType;c.innerHTML='<object id="'+H.swfObjectId+'" name="'+H.swfObjectId+'" width="100%" height="100%" '+(h?'classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000"':'type="application/x-shockwave-flash" data="'+l+'"')+">"+(h?'<param name="movie" value="'+l+'"/>':"")+'<param name="allowScriptAccess" value="'+i+'"/><param name="allowNetworking" value="'+a+'"/><param name="menu" value="false"/><param name="wmode" value="transparent"/><param name="flashvars" value="'+s+'"/></object>',t=c.firstChild,c=null,b(t).ZeroClipboard=Ne,n.replaceChild(t,u)}return t||(t=o[H.swfObjectId],t&&(e=t.length)&&(t=t[e-1]),!t&&n&&(t=n.firstChild)),O.bridge=t||null,t},pe=function(){var e=O.bridge;if(e){var t=de(e);t&&("activex"===O.pluginType&&"readyState"in e?(e.style.display="none",function n(){if(4===e.readyState){for(var i in e)"function"==typeof e[i]&&(e[i]=null);e.parentNode&&e.parentNode.removeChild(e),t.parentNode&&t.parentNode.removeChild(t)}else s(n,10)}()):(e.parentNode&&e.parentNode.removeChild(e),t.parentNode&&t.parentNode.removeChild(t))),O.ready=null,O.bridge=null,O.deactivated=null}},ge=function(e){var t={},n={};if("object"==typeof e&&e){for(var i in e)if(i&&y.call(e,i)&&"string"==typeof e[i]&&e[i])switch(i.toLowerCase()){case"text/plain":case"text":case"air:text":case"flash:text":t.text=e[i],n.text=i;break;case"text/html":case"html":case"air:html":case"flash:html":t.html=e[i],n.html=i;break;case"application/rtf":case"text/rtf":case"rtf":case"richtext":case"air:rtf":case"flash:rtf":t.rtf=e[i],n.rtf=i}return{data:t,formatMap:n}}},me=function(e,t){if("object"!=typeof e||!e||"object"!=typeof t||!t)return e;var n={};for(var i in e)if(y.call(e,i)){if("success"!==i&&"data"!==i){n[i]=e[i];continue}n[i]={};var r=e[i];for(var o in r)o&&y.call(r,o)&&y.call(t,o)&&(n[i][t[o]]=r[o])}return n},ve=function(e,t){var n=null==t||t&&t.cacheBust===!0;return n?(-1===e.indexOf("?")?"?":"&")+"noCache="+g():""},ye=function(e){var t,n,i,o,a="",s=[];if(e.trustedDomains&&("string"==typeof e.trustedDomains?o=[e.trustedDomains]:"object"==typeof e.trustedDomains&&"length"in e.trustedDomains&&(o=e.trustedDomains)),o&&o.length)for(t=0,n=o.length;n>t;t++)if(y.call(o,t)&&o[t]&&"string"==typeof o[t]){if(i=_e(o[t]),!i)continue;if("*"===i){s.length=0,s.push(i);break}s.push.apply(s,[i,"//"+i,r.location.protocol+"//"+i])}return s.length&&(a+="trustedOrigins="+l(s.join(","))),e.forceEnhancedClipboard===!0&&(a+=(a?"&":"")+"forceEnhancedClipboard=true"),"string"==typeof e.swfObjectId&&e.swfObjectId&&(a+=(a?"&":"")+"swfObjectId="+l(e.swfObjectId)),a},_e=function(e){if(null==e||""===e)return null;if(e=e.replace(/^\s+|\s+$/g,""),""===e)return null;var t=e.indexOf("//");e=-1===t?e:e.slice(t+2);var n=e.indexOf("/");return e=-1===n?e:-1===t||0===n?null:e.slice(0,n),e&&".swf"===e.slice(-4).toLowerCase()?null:e||null},be=function(){var e=function(e){var t,n,i,r=[];if("string"==typeof e&&(e=[e]),"object"!=typeof e||!e||"number"!=typeof e.length)return r;for(t=0,n=e.length;n>t;t++)if(y.call(e,t)&&(i=_e(e[t]))){if("*"===i){r.length=0,r.push("*");break}-1===r.indexOf(i)&&r.push(i)}return r};return function(t,n){var i=_e(n.swfPath);null===i&&(i=t);var r=e(n.trustedDomains),o=r.length;if(o>0){if(1===o&&"*"===r[0])return"always";if(-1!==r.indexOf(t))return 1===o&&t===i?"sameDomain":"always";
}return"never"}}(),we=function(){try{return o.activeElement}catch(e){return null}},xe=function(e,t){if(!e||1!==e.nodeType)return e;if(e.classList)return e.classList.contains(t)||e.classList.add(t),e;if(t&&"string"==typeof t){var n=(t||"").split(/\s+/);if(1===e.nodeType)if(e.className){for(var i=" "+e.className+" ",r=e.className,o=0,a=n.length;a>o;o++)i.indexOf(" "+n[o]+" ")<0&&(r+=" "+n[o]);e.className=r.replace(/^\s+|\s+$/g,"")}else e.className=t}return e},ke=function(e,t){if(!e||1!==e.nodeType)return e;if(e.classList)return e.classList.contains(t)&&e.classList.remove(t),e;if("string"==typeof t&&t){var n=t.split(/\s+/);if(1===e.nodeType&&e.className){for(var i=(" "+e.className+" ").replace(/[\n\t]/g," "),r=0,o=n.length;o>r;r++)i=i.replace(" "+n[r]+" "," ");e.className=i.replace(/^\s+|\s+$/g,"")}}return e},Ce=function(e,t){var n=r.getComputedStyle(e,null).getPropertyValue(t);return"cursor"!==t||n&&"auto"!==n||"A"!==e.nodeName?n:"pointer"},Se=function(){var e,t,n,i=1;return"function"==typeof o.body.getBoundingClientRect&&(e=o.body.getBoundingClientRect(),t=e.right-e.left,n=o.body.offsetWidth,i=p(t/n*100)/100),i},Te=function(e){var t={left:0,top:0,width:0,height:0};if(e.getBoundingClientRect){var n,i,a,s=e.getBoundingClientRect();"pageXOffset"in r&&"pageYOffset"in r?(n=r.pageXOffset,i=r.pageYOffset):(a=Se(),n=p(o.documentElement.scrollLeft/a),i=p(o.documentElement.scrollTop/a));var l=o.documentElement.clientLeft||0,u=o.documentElement.clientTop||0;t.left=s.left+n-l,t.top=s.top+i-u,t.width="width"in s?s.width:s.right-s.left,t.height="height"in s?s.height:s.bottom-s.top}return t},Me=function(){var e;if(n&&(e=de(O.bridge))){var t=Te(n);x(e.style,{width:t.width+"px",height:t.height+"px",top:t.top+"px",left:t.left+"px",zIndex:""+Ee(H.zIndex)})}},Le=function(e){O.ready===!0&&(O.bridge&&"function"==typeof O.bridge.setHandCursor?O.bridge.setHandCursor(e):O.ready=!1)},Ee=function(e){if(/^(?:auto|inherit)$/.test(e))return e;var t;return"number"!=typeof e||f(e)?"string"==typeof e&&(t=Ee(h(e,10))):t=e,"number"==typeof t?t:"auto"},Pe=function(e){function t(e){var t=e.match(/[\d]+/g);return t.length=3,t.join(".")}function n(e){return!!e&&(e=e.toLowerCase())&&(/^(pepflashplayer\.dll|libpepflashplayer\.so|pepperflashplayer\.plugin)$/.test(e)||"chrome.plugin"===e.slice(-13))}function i(e){e&&(l=!0,e.version&&(h=t(e.version)),!h&&e.description&&(h=t(e.description)),e.filename&&(c=n(e.filename)))}var r,o,s,l=!1,u=!1,c=!1,h="";if(a.plugins&&a.plugins.length)r=a.plugins["Shockwave Flash"],i(r),a.plugins["Shockwave Flash 2.0"]&&(l=!0,h="2.0.0.11");else if(a.mimeTypes&&a.mimeTypes.length)s=a.mimeTypes["application/x-shockwave-flash"],r=s&&s.enabledPlugin,i(r);else if("undefined"!=typeof e){u=!0;try{o=new e("ShockwaveFlash.ShockwaveFlash.7"),l=!0,h=t(o.GetVariable("$version"))}catch(f){try{o=new e("ShockwaveFlash.ShockwaveFlash.6"),l=!0,h="6.0.21"}catch(p){try{o=new e("ShockwaveFlash.ShockwaveFlash"),l=!0,h=t(o.GetVariable("$version"))}catch(g){u=!1}}}}O.disabled=l!==!0,O.outdated=h&&d(h)<d(D),O.version=h||"0.0.0",O.pluginType=c?"pepper":u?"activex":l?"netscape":"unknown"};Pe(u);var Ne=function(){return this instanceof Ne?void("function"==typeof Ne._createClient&&Ne._createClient.apply(this,w(arguments))):new Ne};v(Ne,"version",{value:"2.1.6",writable:!1,configurable:!0,enumerable:!0}),Ne.config=function(){return U.apply(this,w(arguments))},Ne.state=function(){return V.apply(this,w(arguments))},Ne.isFlashUnusable=function(){return j.apply(this,w(arguments))},Ne.on=function(){return F.apply(this,w(arguments))},Ne.off=function(){return $.apply(this,w(arguments))},Ne.handlers=function(){return K.apply(this,w(arguments))},Ne.emit=function(){return q.apply(this,w(arguments))},Ne.create=function(){return G.apply(this,w(arguments))},Ne.destroy=function(){return X.apply(this,w(arguments))},Ne.setData=function(){return Y.apply(this,w(arguments))},Ne.clearData=function(){return Q.apply(this,w(arguments))},Ne.getData=function(){return J.apply(this,w(arguments))},Ne.focus=Ne.activate=function(){return Z.apply(this,w(arguments))},Ne.blur=Ne.deactivate=function(){return ee.apply(this,w(arguments))},Ne.activeElement=function(){return te.apply(this,w(arguments))};var Ae=0,Ie={},Oe=0,De={},Be={};x(H,{autoActivate:!0});var Re=function(e){var t=this;t.id=""+Ae++,Ie[t.id]={instance:t,elements:[],handlers:{}},e&&t.clip(e),Ne.on("*",function(e){return t.emit(e)}),Ne.on("destroy",function(){t.destroy()}),Ne.create()},ze=function(e,t){var n,i,r,o={},a=Ie[this.id]&&Ie[this.id].handlers;if("string"==typeof e&&e)r=e.toLowerCase().split(/\s+/);else if("object"==typeof e&&e&&"undefined"==typeof t)for(n in e)y.call(e,n)&&"string"==typeof n&&n&&"function"==typeof e[n]&&this.on(n,e[n]);if(r&&r.length){for(n=0,i=r.length;i>n;n++)e=r[n].replace(/^on/,""),o[e]=!0,a[e]||(a[e]=[]),a[e].push(t);if(o.ready&&O.ready&&this.emit({type:"ready",client:this}),o.error){var s=["disabled","outdated","unavailable","deactivated","overdue"];for(n=0,i=s.length;i>n;n++)if(O[s[n]]){this.emit({type:"error",name:"flash-"+s[n],client:this});break}}}return this},We=function(e,t){var n,i,r,o,a,s=Ie[this.id]&&Ie[this.id].handlers;if(0===arguments.length)o=m(s);else if("string"==typeof e&&e)o=e.split(/\s+/);else if("object"==typeof e&&e&&"undefined"==typeof t)for(n in e)y.call(e,n)&&"string"==typeof n&&n&&"function"==typeof e[n]&&this.off(n,e[n]);if(o&&o.length)for(n=0,i=o.length;i>n;n++)if(e=o[n].toLowerCase().replace(/^on/,""),a=s[e],a&&a.length)if(t)for(r=a.indexOf(t);-1!==r;)a.splice(r,1),r=a.indexOf(t,r);else a.length=0;return this},He=function(e){var t=null,n=Ie[this.id]&&Ie[this.id].handlers;return n&&(t="string"==typeof e&&e?n[e]?n[e].slice(0):[]:k(n)),t},Ue=function(e){if(Ke.call(this,e)){"object"==typeof e&&e&&"string"==typeof e.type&&e.type&&(e=x({},e));var t=x({},ie(e),{client:this});qe.call(this,t)}return this},Ve=function(e){e=Ge(e);for(var t=0;t<e.length;t++)if(y.call(e,t)&&e[t]&&1===e[t].nodeType){e[t].zcClippingId?-1===De[e[t].zcClippingId].indexOf(this.id)&&De[e[t].zcClippingId].push(this.id):(e[t].zcClippingId="zcClippingId_"+Oe++,De[e[t].zcClippingId]=[this.id],H.autoActivate===!0&&Xe(e[t]));var n=Ie[this.id]&&Ie[this.id].elements;-1===n.indexOf(e[t])&&n.push(e[t])}return this},je=function(e){var t=Ie[this.id];if(!t)return this;var n,i=t.elements;e="undefined"==typeof e?i.slice(0):Ge(e);for(var r=e.length;r--;)if(y.call(e,r)&&e[r]&&1===e[r].nodeType){for(n=0;-1!==(n=i.indexOf(e[r],n));)i.splice(n,1);var o=De[e[r].zcClippingId];if(o){for(n=0;-1!==(n=o.indexOf(this.id,n));)o.splice(n,1);0===o.length&&(H.autoActivate===!0&&Ye(e[r]),delete e[r].zcClippingId)}}return this},Fe=function(){var e=Ie[this.id];return e&&e.elements?e.elements.slice(0):[]},$e=function(){this.unclip(),this.off(),delete Ie[this.id]},Ke=function(e){if(!e||!e.type)return!1;if(e.client&&e.client!==this)return!1;var t=Ie[this.id]&&Ie[this.id].elements,n=!!t&&t.length>0,i=!e.target||n&&-1!==t.indexOf(e.target),r=e.relatedTarget&&n&&-1!==t.indexOf(e.relatedTarget),o=e.client&&e.client===this;return i||r||o?!0:!1},qe=function(e){if("object"==typeof e&&e&&e.type){var t=ae(e),n=Ie[this.id]&&Ie[this.id].handlers["*"]||[],i=Ie[this.id]&&Ie[this.id].handlers[e.type]||[],o=n.concat(i);if(o&&o.length){var a,s,l,u,c,h=this;for(a=0,s=o.length;s>a;a++)l=o[a],u=h,"string"==typeof l&&"function"==typeof r[l]&&(l=r[l]),"object"==typeof l&&l&&"function"==typeof l.handleEvent&&(u=l,l=l.handleEvent),"function"==typeof l&&(c=x({},e),se(l,u,[c],t))}return this}},Ge=function(e){return"string"==typeof e&&(e=[]),"number"!=typeof e.length?[e]:e},Xe=function(e){if(e&&1===e.nodeType){var t=function(e){(e||(e=r.event))&&("js"!==e._source&&(e.stopImmediatePropagation(),e.preventDefault()),delete e._source)},n=function(n){(n||(n=r.event))&&(t(n),Ne.focus(e))};e.addEventListener("mouseover",n,!1),e.addEventListener("mouseout",t,!1),e.addEventListener("mouseenter",t,!1),e.addEventListener("mouseleave",t,!1),e.addEventListener("mousemove",t,!1),Be[e.zcClippingId]={mouseover:n,mouseout:t,mouseenter:t,mouseleave:t,mousemove:t}}},Ye=function(e){if(e&&1===e.nodeType){var t=Be[e.zcClippingId];if("object"==typeof t&&t){for(var n,i,r=["move","leave","enter","out","over"],o=0,a=r.length;a>o;o++)n="mouse"+r[o],i=t[n],"function"==typeof i&&e.removeEventListener(n,i,!1);delete Be[e.zcClippingId]}}};Ne._createClient=function(){Re.apply(this,w(arguments))},Ne.prototype.on=function(){return ze.apply(this,w(arguments))},Ne.prototype.off=function(){return We.apply(this,w(arguments))},Ne.prototype.handlers=function(){return He.apply(this,w(arguments))},Ne.prototype.emit=function(){return Ue.apply(this,w(arguments))},Ne.prototype.clip=function(){return Ve.apply(this,w(arguments))},Ne.prototype.unclip=function(){return je.apply(this,w(arguments))},Ne.prototype.elements=function(){return Fe.apply(this,w(arguments))},Ne.prototype.destroy=function(){return $e.apply(this,w(arguments))},Ne.prototype.setText=function(e){return Ne.setData("text/plain",e),this},Ne.prototype.setHtml=function(e){return Ne.setData("text/html",e),this},Ne.prototype.setRichText=function(e){return Ne.setData("application/rtf",e),this},Ne.prototype.setData=function(){return Ne.setData.apply(this,w(arguments)),this},Ne.prototype.clearData=function(){return Ne.clearData.apply(this,w(arguments)),this},Ne.prototype.getData=function(){return Ne.getData.apply(this,w(arguments))},"function"==typeof define&&define.amd?define(function(){return Ne}):"object"==typeof module&&module&&"object"==typeof module.exports&&module.exports?module.exports=Ne:e.ZeroClipboard=Ne}(function(){return this||window}()),function(){function e(e){this.mode=u.MODE_8BIT_BYTE,this.data=e,this.parsedData=[];for(var t=0,n=this.data.length;n>t;t++){var i=[],r=this.data.charCodeAt(t);r>65536?(i[0]=240|(1835008&r)>>>18,i[1]=128|(258048&r)>>>12,i[2]=128|(4032&r)>>>6,i[3]=128|63&r):r>2048?(i[0]=224|(61440&r)>>>12,i[1]=128|(4032&r)>>>6,i[2]=128|63&r):r>128?(i[0]=192|(1984&r)>>>6,i[1]=128|63&r):i[0]=r,this.parsedData.push(i)}this.parsedData=Array.prototype.concat.apply([],this.parsedData),this.parsedData.length!=this.data.length&&(this.parsedData.unshift(191),this.parsedData.unshift(187),this.parsedData.unshift(239))}function t(e,t){this.typeNumber=e,this.errorCorrectLevel=t,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}function n(e,t){if(void 0==e.length)throw new Error(e.length+"/"+t);for(var n=0;n<e.length&&0==e[n];)n++;this.num=new Array(e.length-n+t);for(var i=0;i<e.length-n;i++)this.num[i]=e[i+n]}function i(e,t){this.totalCount=e,this.dataCount=t}function r(){this.buffer=[],this.length=0}function o(){return"undefined"!=typeof CanvasRenderingContext2D}function a(){var e=!1,t=navigator.userAgent;return/android/i.test(t)&&(e=!0,aMat=t.toString().match(/android ([0-9]\.[0-9])/i),aMat&&aMat[1]&&(e=parseFloat(aMat[1]))),e}function s(e,t){for(var n=1,i=l(e),r=0,o=g.length;o>=r;r++){var a=0;switch(t){case c.L:a=g[r][0];break;case c.M:a=g[r][1];break;case c.Q:a=g[r][2];break;case c.H:a=g[r][3]}if(a>=i)break;n++}if(n>g.length)throw new Error("Too long data");return n}function l(e){var t=encodeURI(e).toString().replace(/\%[0-9a-fA-F]{2}/g,"a");return t.length+(t.length!=e?3:0)}e.prototype={getLength:function(e){return this.parsedData.length},write:function(e){for(var t=0,n=this.parsedData.length;n>t;t++)e.put(this.parsedData[t],8)}},t.prototype={addData:function(t){var n=new e(t);this.dataList.push(n),this.dataCache=null},isDark:function(e,t){if(0>e||this.moduleCount<=e||0>t||this.moduleCount<=t)throw new Error(e+","+t);return this.modules[e][t]},getModuleCount:function(){return this.moduleCount},make:function(){this.makeImpl(!1,this.getBestMaskPattern())},makeImpl:function(e,n){this.moduleCount=4*this.typeNumber+17,this.modules=new Array(this.moduleCount);for(var i=0;i<this.moduleCount;i++){this.modules[i]=new Array(this.moduleCount);for(var r=0;r<this.moduleCount;r++)this.modules[i][r]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(e,n),this.typeNumber>=7&&this.setupTypeNumber(e),null==this.dataCache&&(this.dataCache=t.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,n)},setupPositionProbePattern:function(e,t){for(var n=-1;7>=n;n++)if(!(-1>=e+n||this.moduleCount<=e+n))for(var i=-1;7>=i;i++)-1>=t+i||this.moduleCount<=t+i||(n>=0&&6>=n&&(0==i||6==i)||i>=0&&6>=i&&(0==n||6==n)||n>=2&&4>=n&&i>=2&&4>=i?this.modules[e+n][t+i]=!0:this.modules[e+n][t+i]=!1)},getBestMaskPattern:function(){for(var e=0,t=0,n=0;8>n;n++){this.makeImpl(!0,n);var i=d.getLostPoint(this);(0==n||e>i)&&(e=i,t=n)}return t},createMovieClip:function(e,t,n){var i=e.createEmptyMovieClip(t,n),r=1;this.make();for(var o=0;o<this.modules.length;o++)for(var a=o*r,s=0;s<this.modules[o].length;s++){var l=s*r,u=this.modules[o][s];u&&(i.beginFill(0,100),i.moveTo(l,a),i.lineTo(l+r,a),i.lineTo(l+r,a+r),i.lineTo(l,a+r),i.endFill())}return i},setupTimingPattern:function(){for(var e=8;e<this.moduleCount-8;e++)null==this.modules[e][6]&&(this.modules[e][6]=e%2==0);for(var t=8;t<this.moduleCount-8;t++)null==this.modules[6][t]&&(this.modules[6][t]=t%2==0)},setupPositionAdjustPattern:function(){for(var e=d.getPatternPosition(this.typeNumber),t=0;t<e.length;t++)for(var n=0;n<e.length;n++){var i=e[t],r=e[n];if(null==this.modules[i][r])for(var o=-2;2>=o;o++)for(var a=-2;2>=a;a++)-2==o||2==o||-2==a||2==a||0==o&&0==a?this.modules[i+o][r+a]=!0:this.modules[i+o][r+a]=!1}},setupTypeNumber:function(e){for(var t=d.getBCHTypeNumber(this.typeNumber),n=0;18>n;n++){var i=!e&&1==(t>>n&1);this.modules[Math.floor(n/3)][n%3+this.moduleCount-8-3]=i}for(var n=0;18>n;n++){var i=!e&&1==(t>>n&1);this.modules[n%3+this.moduleCount-8-3][Math.floor(n/3)]=i}},setupTypeInfo:function(e,t){for(var n=this.errorCorrectLevel<<3|t,i=d.getBCHTypeInfo(n),r=0;15>r;r++){var o=!e&&1==(i>>r&1);6>r?this.modules[r][8]=o:8>r?this.modules[r+1][8]=o:this.modules[this.moduleCount-15+r][8]=o}for(var r=0;15>r;r++){var o=!e&&1==(i>>r&1);8>r?this.modules[8][this.moduleCount-r-1]=o:9>r?this.modules[8][15-r-1+1]=o:this.modules[8][15-r-1]=o}this.modules[this.moduleCount-8][8]=!e},mapData:function(e,t){for(var n=-1,i=this.moduleCount-1,r=7,o=0,a=this.moduleCount-1;a>0;a-=2)for(6==a&&a--;;){for(var s=0;2>s;s++)if(null==this.modules[i][a-s]){var l=!1;o<e.length&&(l=1==(e[o]>>>r&1));var u=d.getMask(t,i,a-s);u&&(l=!l),this.modules[i][a-s]=l,r--,-1==r&&(o++,r=7)}if(i+=n,0>i||this.moduleCount<=i){i-=n,n=-n;break}}}},t.PAD0=236,t.PAD1=17,t.createData=function(e,n,o){for(var a=i.getRSBlocks(e,n),s=new r,l=0;l<o.length;l++){var u=o[l];s.put(u.mode,4),s.put(u.getLength(),d.getLengthInBits(u.mode,e)),u.write(s)}for(var c=0,l=0;l<a.length;l++)c+=a[l].dataCount;if(s.getLengthInBits()>8*c)throw new Error("code length overflow. ("+s.getLengthInBits()+">"+8*c+")");for(s.getLengthInBits()+4<=8*c&&s.put(0,4);s.getLengthInBits()%8!=0;)s.putBit(!1);for(;;){if(s.getLengthInBits()>=8*c)break;if(s.put(t.PAD0,8),s.getLengthInBits()>=8*c)break;s.put(t.PAD1,8)}return t.createBytes(s,a)},t.createBytes=function(e,t){for(var i=0,r=0,o=0,a=new Array(t.length),s=new Array(t.length),l=0;l<t.length;l++){var u=t[l].dataCount,c=t[l].totalCount-u;r=Math.max(r,u),o=Math.max(o,c),a[l]=new Array(u);for(var h=0;h<a[l].length;h++)a[l][h]=255&e.buffer[h+i];i+=u;var f=d.getErrorCorrectPolynomial(c),p=new n(a[l],f.getLength()-1),g=p.mod(f);s[l]=new Array(f.getLength()-1);for(var h=0;h<s[l].length;h++){var m=h+g.getLength()-s[l].length;s[l][h]=m>=0?g.get(m):0}}for(var v=0,h=0;h<t.length;h++)v+=t[h].totalCount;for(var y=new Array(v),_=0,h=0;r>h;h++)for(var l=0;l<t.length;l++)h<a[l].length&&(y[_++]=a[l][h]);for(var h=0;o>h;h++)for(var l=0;l<t.length;l++)h<s[l].length&&(y[_++]=s[l][h]);return y};for(var u={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8},c={L:1,M:0,Q:3,H:2},h={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7},d={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(e){for(var t=e<<10;d.getBCHDigit(t)-d.getBCHDigit(d.G15)>=0;)t^=d.G15<<d.getBCHDigit(t)-d.getBCHDigit(d.G15);return(e<<10|t)^d.G15_MASK},getBCHTypeNumber:function(e){for(var t=e<<12;d.getBCHDigit(t)-d.getBCHDigit(d.G18)>=0;)t^=d.G18<<d.getBCHDigit(t)-d.getBCHDigit(d.G18);return e<<12|t},getBCHDigit:function(e){for(var t=0;0!=e;)t++,e>>>=1;return t},getPatternPosition:function(e){return d.PATTERN_POSITION_TABLE[e-1]},getMask:function(e,t,n){switch(e){case h.PATTERN000:return(t+n)%2==0;case h.PATTERN001:return t%2==0;case h.PATTERN010:return n%3==0;case h.PATTERN011:return(t+n)%3==0;case h.PATTERN100:return(Math.floor(t/2)+Math.floor(n/3))%2==0;case h.PATTERN101:return t*n%2+t*n%3==0;case h.PATTERN110:return(t*n%2+t*n%3)%2==0;case h.PATTERN111:return(t*n%3+(t+n)%2)%2==0;default:throw new Error("bad maskPattern:"+e)}},getErrorCorrectPolynomial:function(e){for(var t=new n([1],0),i=0;e>i;i++)t=t.multiply(new n([1,f.gexp(i)],0));return t},getLengthInBits:function(e,t){if(t>=1&&10>t)switch(e){case u.MODE_NUMBER:return 10;case u.MODE_ALPHA_NUM:return 9;case u.MODE_8BIT_BYTE:return 8;case u.MODE_KANJI:return 8;default:throw new Error("mode:"+e)}else if(27>t)switch(e){case u.MODE_NUMBER:return 12;case u.MODE_ALPHA_NUM:return 11;case u.MODE_8BIT_BYTE:return 16;case u.MODE_KANJI:return 10;default:throw new Error("mode:"+e)}else{if(!(41>t))throw new Error("type:"+t);switch(e){case u.MODE_NUMBER:return 14;case u.MODE_ALPHA_NUM:return 13;case u.MODE_8BIT_BYTE:return 16;case u.MODE_KANJI:return 12;default:throw new Error("mode:"+e)}}},getLostPoint:function(e){for(var t=e.getModuleCount(),n=0,i=0;t>i;i++)for(var r=0;t>r;r++){for(var o=0,a=e.isDark(i,r),s=-1;1>=s;s++)if(!(0>i+s||i+s>=t))for(var l=-1;1>=l;l++)0>r+l||r+l>=t||(0!=s||0!=l)&&a==e.isDark(i+s,r+l)&&o++;o>5&&(n+=3+o-5)}for(var i=0;t-1>i;i++)for(var r=0;t-1>r;r++){var u=0;e.isDark(i,r)&&u++,e.isDark(i+1,r)&&u++,e.isDark(i,r+1)&&u++,e.isDark(i+1,r+1)&&u++,(0==u||4==u)&&(n+=3)}for(var i=0;t>i;i++)for(var r=0;t-6>r;r++)e.isDark(i,r)&&!e.isDark(i,r+1)&&e.isDark(i,r+2)&&e.isDark(i,r+3)&&e.isDark(i,r+4)&&!e.isDark(i,r+5)&&e.isDark(i,r+6)&&(n+=40);for(var r=0;t>r;r++)for(var i=0;t-6>i;i++)e.isDark(i,r)&&!e.isDark(i+1,r)&&e.isDark(i+2,r)&&e.isDark(i+3,r)&&e.isDark(i+4,r)&&!e.isDark(i+5,r)&&e.isDark(i+6,r)&&(n+=40);for(var c=0,r=0;t>r;r++)for(var i=0;t>i;i++)e.isDark(i,r)&&c++;var h=Math.abs(100*c/t/t-50)/5;return n+=10*h}},f={glog:function(e){if(1>e)throw new Error("glog("+e+")");return f.LOG_TABLE[e]},gexp:function(e){for(;0>e;)e+=255;for(;e>=256;)e-=255;return f.EXP_TABLE[e]},EXP_TABLE:new Array(256),LOG_TABLE:new Array(256)},p=0;8>p;p++)f.EXP_TABLE[p]=1<<p;for(var p=8;256>p;p++)f.EXP_TABLE[p]=f.EXP_TABLE[p-4]^f.EXP_TABLE[p-5]^f.EXP_TABLE[p-6]^f.EXP_TABLE[p-8];for(var p=0;255>p;p++)f.LOG_TABLE[f.EXP_TABLE[p]]=p;n.prototype={get:function(e){return this.num[e]},getLength:function(){return this.num.length},multiply:function(e){for(var t=new Array(this.getLength()+e.getLength()-1),i=0;i<this.getLength();i++)for(var r=0;r<e.getLength();r++)t[i+r]^=f.gexp(f.glog(this.get(i))+f.glog(e.get(r)));return new n(t,0)},mod:function(e){if(this.getLength()-e.getLength()<0)return this;for(var t=f.glog(this.get(0))-f.glog(e.get(0)),i=new Array(this.getLength()),r=0;r<this.getLength();r++)i[r]=this.get(r);for(var r=0;r<e.getLength();r++)i[r]^=f.gexp(f.glog(e.get(r))+t);return new n(i,0).mod(e)}},i.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],i.getRSBlocks=function(e,t){var n=i.getRsBlockTable(e,t);if(void 0==n)throw new Error("bad rs block @ typeNumber:"+e+"/errorCorrectLevel:"+t);for(var r=n.length/3,o=[],a=0;r>a;a++)for(var s=n[3*a+0],l=n[3*a+1],u=n[3*a+2],c=0;s>c;c++)o.push(new i(l,u));return o},i.getRsBlockTable=function(e,t){switch(t){case c.L:return i.RS_BLOCK_TABLE[4*(e-1)+0];case c.M:return i.RS_BLOCK_TABLE[4*(e-1)+1];case c.Q:return i.RS_BLOCK_TABLE[4*(e-1)+2];case c.H:return i.RS_BLOCK_TABLE[4*(e-1)+3];default:return}},r.prototype={get:function(e){var t=Math.floor(e/8);return 1==(this.buffer[t]>>>7-e%8&1)},put:function(e,t){for(var n=0;t>n;n++)this.putBit(1==(e>>>t-n-1&1))},getLengthInBits:function(){return this.length},putBit:function(e){var t=Math.floor(this.length/8);this.buffer.length<=t&&this.buffer.push(0),e&&(this.buffer[t]|=128>>>this.length%8),this.length++}};var g=[[17,14,11,7],[32,26,20,14],[53,42,32,24],[78,62,46,34],[106,84,60,44],[134,106,74,58],[154,122,86,64],[192,152,108,84],[230,180,130,98],[271,213,151,119],[321,251,177,137],[367,287,203,155],[425,331,241,177],[458,362,258,194],[520,412,292,220],[586,450,322,250],[644,504,364,280],[718,560,394,310],[792,624,442,338],[858,666,482,382],[929,711,509,403],[1003,779,565,439],[1091,857,611,461],[1171,911,661,511],[1273,997,715,535],[1367,1059,751,593],[1465,1125,805,625],[1528,1190,868,658],[1628,1264,908,698],[1732,1370,982,742],[1840,1452,1030,790],[1952,1538,1112,842],[2068,1628,1168,898],[2188,1722,1228,958],[2303,1809,1283,983],[2431,1911,1351,1051],[2563,1989,1423,1093],[2699,2099,1499,1139],[2809,2213,1579,1219],[2953,2331,1663,1273]],m=function(){var e=function(e,t){this._el=e,this._htOption=t};return e.prototype.draw=function(e){function t(e,t){var n=document.createElementNS("http://www.w3.org/2000/svg",e);for(var i in t)t.hasOwnProperty(i)&&n.setAttribute(i,t[i]);return n}var n=this._htOption,i=this._el,r=e.getModuleCount();Math.floor(n.width/r),Math.floor(n.height/r);this.clear();var o=t("svg",{viewBox:"0 0 "+String(r)+" "+String(r),width:"100%",height:"100%",fill:n.colorLight});o.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink"),i.appendChild(o),o.appendChild(t("rect",{fill:n.colorDark,width:"1",height:"1",id:"template"}));for(var a=0;r>a;a++)for(var s=0;r>s;s++)if(e.isDark(a,s)){var l=t("use",{x:String(a),y:String(s)});l.setAttributeNS("http://www.w3.org/1999/xlink","href","#template"),o.appendChild(l)}},e.prototype.clear=function(){for(;this._el.hasChildNodes();)this._el.removeChild(this._el.lastChild)},e}(),v="svg"===document.documentElement.tagName.toLowerCase(),y=v?m:o()?function(){function e(){this._elImage.src=this._elCanvas.toDataURL("image/png"),this._elImage.style.display="block",this._elCanvas.style.display="none"}function t(e,t){var n=this;if(n._fFail=t,n._fSuccess=e,null===n._bSupportDataURI){var i=document.createElement("img"),r=function(){n._bSupportDataURI=!1,n._fFail&&_fFail.call(n)},o=function(){n._bSupportDataURI=!0,n._fSuccess&&n._fSuccess.call(n)};return i.onabort=r,i.onerror=r,i.onload=o,void(i.src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg==")}n._bSupportDataURI===!0&&n._fSuccess?n._fSuccess.call(n):n._bSupportDataURI===!1&&n._fFail&&n._fFail.call(n)}if(this._android&&this._android<=2.1){var n=1/window.devicePixelRatio,i=CanvasRenderingContext2D.prototype.drawImage;CanvasRenderingContext2D.prototype.drawImage=function(e,t,r,o,a,s,l,u,c){if("nodeName"in e&&/img/i.test(e.nodeName))for(var h=arguments.length-1;h>=1;h--)arguments[h]=arguments[h]*n;else"undefined"==typeof u&&(arguments[1]*=n,arguments[2]*=n,arguments[3]*=n,arguments[4]*=n);i.apply(this,arguments)}}var r=function(e,t){this._bIsPainted=!1,this._android=a(),this._htOption=t,this._elCanvas=document.createElement("canvas"),this._elCanvas.width=t.width,this._elCanvas.height=t.height,e.appendChild(this._elCanvas),this._el=e,this._oContext=this._elCanvas.getContext("2d"),this._bIsPainted=!1,this._elImage=document.createElement("img"),this._elImage.alt="Scan me!",this._elImage.style.display="none",this._el.appendChild(this._elImage),this._bSupportDataURI=null};return r.prototype.draw=function(e){var t=this._elImage,n=this._oContext,i=this._htOption,r=e.getModuleCount(),o=i.width/r,a=i.height/r,s=Math.round(o),l=Math.round(a);t.style.display="none",this.clear();for(var u=0;r>u;u++)for(var c=0;r>c;c++){var h=e.isDark(u,c),d=c*o,f=u*a;n.strokeStyle=h?i.colorDark:i.colorLight,n.lineWidth=1,n.fillStyle=h?i.colorDark:i.colorLight,n.fillRect(d,f,o,a),n.strokeRect(Math.floor(d)+.5,Math.floor(f)+.5,s,l),n.strokeRect(Math.ceil(d)-.5,Math.ceil(f)-.5,s,l)}this._bIsPainted=!0},r.prototype.makeImage=function(){this._bIsPainted&&t.call(this,e)},r.prototype.isPainted=function(){return this._bIsPainted},r.prototype.clear=function(){this._oContext.clearRect(0,0,this._elCanvas.width,this._elCanvas.height),this._bIsPainted=!1},r.prototype.round=function(e){return e?Math.floor(1e3*e)/1e3:e},r}():function(){var e=function(e,t){this._el=e,this._htOption=t};return e.prototype.draw=function(e){for(var t=this._htOption,n=this._el,i=e.getModuleCount(),r=Math.floor(t.width/i),o=Math.floor(t.height/i),a=['<table style="border:0;border-collapse:collapse;">'],s=0;i>s;s++){a.push("<tr>");for(var l=0;i>l;l++)a.push('<td style="border:0;border-collapse:collapse;padding:0;margin:0;width:'+r+"px;height:"+o+"px;background-color:"+(e.isDark(s,l)?t.colorDark:t.colorLight)+';"></td>');a.push("</tr>")}a.push("</table>"),n.innerHTML=a.join("");var u=n.childNodes[0],c=(t.width-u.offsetWidth)/2,h=(t.height-u.offsetHeight)/2;c>0&&h>0&&(u.style.margin=h+"px "+c+"px")},e.prototype.clear=function(){this._el.innerHTML=""},e}();window.QRCode=function(e,t){if(this._htOption={width:256,height:256,typeNumber:4,colorDark:"#000000",colorLight:"#ffffff",correctLevel:c.H},"string"==typeof t&&(t={text:t}),t)for(var n in t)this._htOption[n]=t[n];"string"==typeof e&&(e=document.getElementById(e)),this._android=a(),this._el=e,this._oQRCode=null,this._oDrawing=new y(this._el,this._htOption),this._htOption.text&&this.makeCode(this._htOption.text)},QRCode.prototype.makeCode=function(e){this._oQRCode=new t(s(e,this._htOption.correctLevel),this._htOption.correctLevel),this._oQRCode.addData(e),this._oQRCode.make(),this._el.title=e,this._oDrawing.draw(this._oQRCode),this.makeImage()},QRCode.prototype.makeImage=function(){"function"==typeof this._oDrawing.makeImage&&(!this._android||this._android>=3)&&this._oDrawing.makeImage()},QRCode.prototype.clear=function(){this._oDrawing.clear()},QRCode.CorrectLevel=c}();var jhtmls="undefined"==typeof exports?jhtmls||{}:exports;void function(e){"use strict";function t(e){return String(e).replace(/["<>& ]/g,function(e){return"&"+r[e]+";"})}function n(e){var t=[];return t.push("with(this){"),t.push(e.replace(/<(script|style)[^>]*>[\s\S]*?<\/\1>/g,function(e){return['!#{unescape("',escape(e),'")}'].join("")}).replace(/[\r\n]+/g,"\n").replace(/^\n+|\s+$/gm,"").replace(/^([ \w\t_$]*([^&\^?|\n\w\/'"{}\[\]+\-():; \t=\.$_]|:\/\/).*$|^(?!\s*(else|do|try|finally|void|typeof\s[\w$_]*)\s*$)[^'":;{}()\n|=&\/^?]+$)\s?/gm,function(e){return e=e.replace(/&none;/g,"").replace(/["'\\]/g,"\\$&").replace(/\n/g,"\\n").replace(/(!?#)\{(.*?)\}|(!?\$)([a-z_]+\w*(?:\.[a-z_]+\w*)*)/g,function(e,t,n,i,r){if(i&&(t=i,n=r),!n)return"";n=n.replace(/\\n/g,"\n").replace(/\\([\\'"])/g,"$1");var o=/^[a-z$][\w+$]+$/i.test(n)&&!/^(true|false|NaN|null|this)$/.test(n);return["',",o?["typeof ",n,"==='undefined'?'':"].join(""):"","#"===t||"$"===t?"_encode_":"","(",n,"),'"].join("")}),e=["'",e,"'"].join("").replace(/^'',|,''$/g,""),e?["_output_.push(",e,");"].join(""):""})),t.push("}"),new Function("_output_","_encode_","helper","jhtmls",t.join(""))}function i(i,r,o){"function"==typeof i&&(i=String(i).replace(/^[^\{]*\{\s*\/\*!?[ \f\t\v]*\n?|[ \f\t\v]*\*\/[;|\s]*\}$/g,""));var a=n(i),s=function(n,i){i=i||e;var r=[];return a.call(n,r,t,i,e),r.join("")};return arguments.length<=1?s:s(r,o)}var r={'"':"quot","<":"lt",">":"gt","&":"amp"," ":"nbsp"};e.render=i}(jhtmls),function(){function use(e){_p.r([moduleMapping[e]])}var _p={r:function(e){if(_p[e].inited)return _p[e].value;if("function"!=typeof _p[e].value)return _p[e].inited=!0,_p[e].value;var t={exports:{}},n=_p[e].value(null,t.exports,t);if(_p[e].inited=!0,_p[e].value=n,void 0!==n)return n;for(var i in t.exports)if(t.exports.hasOwnProperty(i))return _p[e].inited=!0,_p[e].value=t.exports,t.exports}};_p[0]={value:function(e){function t(e){var t=r[e.clazz];return t?new t(e):null}var n={},i=_p.r(4),r=_p.r(11);return i.extend(n,{parse:function(e){var n=[];return i.isArray(e)?(i.each(e,function(e,i){n.push(t(i))}),n):t(e)}}),n}},_p[1]={value:function(e){var t=_p.r(11);t.___register({ALLOW_FOCUS:!0}),t.___register({Widget:_p.r(60),Icon:_p.r(42),Label:_p.r(48),Button:_p.r(37),ToggleButton:_p.r(59),Buttonset:_p.r(36),Separator:_p.r(56),Item:_p.r(46),Input:_p.r(45),InputButton:_p.r(43),Mask:_p.r(49),ColorPicker:_p.r(38),
Tabs:_p.r(58),SpinButton:_p.r(57),Container:_p.r(39),Panel:_p.r(51),PPanel:_p.r(54),LabelPanel:_p.r(47),Menu:_p.r(50),InputMenu:_p.r(44),ButtonMenu:_p.r(34),DropPanel:_p.r(41),Popup:_p.r(53),PopupMenu:_p.r(52),SelectMenu:_p.r(55),Dialog:_p.r(40),Utils:_p.r(13),Creator:_p.r(0)}),t.__export()}},_p[2]={value:function(e){var t=_p.r(11);t.___register({TablePicker:_p.r(17)})}},_p[3]={value:function(){return jhtmls}},_p[4]={value:function(e){return window.jQuery}},_p[5]={value:function(require,exports){function Class(){}function checkBaseConstructorCall(e,t){var n=e.toString();if(!/this\.callBase/.test(n))throw new Error(t+" : 类构造函数没有调用父类的构造函数！为了安全，请调用父类的构造函数")}function inherit(constructor,BaseClass,classname){var KityClass=eval("(function "+classname+"( __inherit__flag ) {if( __inherit__flag != KITY_INHERIT_FLAG ) {KityClass.__KityConstructor.apply(this, arguments);}this.__KityClassName = KityClass.__KityClassName;})||0");KityClass.__KityConstructor=constructor,KityClass.prototype=new BaseClass(KITY_INHERIT_FLAG);for(var methodName in BaseClass.prototype)BaseClass.prototype.hasOwnProperty(methodName)&&0!==methodName.indexOf("__Kity")&&(KityClass.prototype[methodName]=BaseClass.prototype[methodName]);return KityClass.prototype.constructor=KityClass,KityClass}function mixin(e,t){if(!1==t instanceof Array)return e;var n,i,r,o=t.length;for(e.__KityMixins={constructor:[]},n=0;o>n;n++){i=t[n].prototype;for(r in i)!1!==i.hasOwnProperty(r)&&0!==r.indexOf("__Kity")&&("constructor"===r?e.__KityMixins.constructor.push(i[r]):e.prototype[r]=e.__KityMixins[r]=i[r])}return e}function extend(e,t){t.__KityClassName&&(t=t.prototype);for(var n in t)if(t.hasOwnProperty(n)&&n.indexOf("__Kity")&&"constructor"!=n){var i=e.prototype[n]=t[n];i.__KityMethodClass=e,i.__KityMethodName=n}return e}Function.prototype.bind=Function.prototype.bind||function(e){var t=Array.prototype.slice.call(arguments,1);return this.apply(e,t)},Class.__KityClassName="Class",Class.prototype.base=function(e){var t=arguments.callee.caller,n=t.__KityMethodClass.__KityBaseClass.prototype[e];return n.apply(this,Array.prototype.slice.call(arguments,1))},Class.prototype.callBase=function(){var e=arguments.callee.caller,t=e.__KityMethodClass.__KityBaseClass.prototype[e.__KityMethodName];return t.apply(this,arguments)},Class.prototype.mixin=function(e){var t=arguments.callee.caller,n=t.__KityMethodClass.__KityMixins;if(!n)return this;var i=n[e];return i.apply(this,Array.prototype.slice.call(arguments,1))},Class.prototype.callMixin=function(){var e=arguments.callee.caller,t=e.__KityMethodName,n=e.__KityMethodClass.__KityMixins;if(!n)return this;var i=n[t];if("constructor"==t){for(var r=0,o=i.length;o>r;r++)i[r].call(this);return this}return i.apply(this,arguments)},Class.prototype.pipe=function(e){return"function"==typeof e&&e.call(this,this),this},Class.prototype.getType=function(){return this.__KityClassName},Class.prototype.getClass=function(){return this.constructor};var KITY_INHERIT_FLAG="__KITY_INHERIT_FLAG_"+ +new Date;Class.prototype._accessProperty=function(){return this._propertyRawData||(this._propertyRawData={})},exports.createClass=function(e,t){var n,i,r;return 1===arguments.length&&(t=arguments[0],e="AnonymousClass"),r=t.base||Class,t.hasOwnProperty("constructor")?(n=t.constructor,r!=Class&&checkBaseConstructorCall(n,e)):n=function(){this.callBase.apply(this,arguments),this.callMixin.apply(this,arguments)},i=inherit(n,r,e),i=mixin(i,t.mixins),i.__KityClassName=n.__KityClassName=e,i.__KityBaseClass=n.__KityBaseClass=r,i.__KityMethodName=n.__KityMethodName="constructor",i.__KityMethodClass=n.__KityMethodClass=i,delete t.mixins,delete t.constructor,delete t.base,i=extend(i,t)},exports.extendClass=extend}},_p[6]={value:function(e){var t=_p.r(4),n="__fui__marker__"+ +new Date;return{isElement:function(e){return 1===e.nodeType},getMarker:function(){return n},getRect:function(e){var t=e.getBoundingClientRect();return{width:t.width,height:t.height,top:t.top,bottom:t.bottom,left:t.left,right:t.right}},getBound:function(e){var n=0,i=0;return"body"===e.tagName.toLowerCase()?(i=t(this.getView(e)),n=i.width(),i=i.height(),{top:0,left:0,bottom:i,right:n,width:n,height:i}):this.getRect(e)},getView:function(e){return e.ownerDocument.defaultView||e.ownerDocument.parentWindow}}}},_p[7]={value:function(e){var t=_p.r(3),n=_p.r(4),i={forEach:function(e,t){n.each(e,function(e,n){t.call(null,e,n)})}};return{compile:function(e,r){return e=n.trim(e),0===e.length?"":t.render(e,r,i)}}}},_p[8]={value:function(e,t){function n(e){this.__options=i.extend({},o,e),this.__started=!1,this.__point={x:0,y:0},this.__location={x:0,y:0},this.__range={top:0,left:0,bottom:0,right:0}}var i=_p.r(4),r=_p.r(6),o={handler:null,target:null,axis:"all",range:null};return i.extend(n.prototype,{bind:function(e){if(e&&(this.__options.target=e),!this.__options.target)throw new Error("target unset");this.__target=this.__options.target,this.__handler=this.__options.handler,this.__rangeNode=this.__options.range,this.__initOptions(),this.__initEnv(),this.__initEvent()},__initEvent:function(){var e=this.__handler,t=this;i(e).on("mousedown",function(n){if(1===n.which){var i=r.getRect(e);n.preventDefault(),t.__started=!0,t.__point={x:n.clientX,y:n.clientY},t.__location={x:i.left,y:i.top},t.__range=t.__getRange()}}),i(e.ownerDocument).on("mousemove",function(e){if(t.__started){var n=e.clientX,i=e.clientY;t.__allowAxisX&&t.__xMove(n),t.__allowAxisY&&t.__yMove(i)}}).on("mouseup",function(e){t.__started=!1})},__xMove:function(e){var t=e-this.__point.x;t=this.__location.x+t,t<this.__range.left?t=this.__range.left:t>this.__range.right&&(t=this.__range.right),this.__target.style.left=t+"px"},__yMove:function(e){var t=e-this.__point.y;t=this.__location.y+t,t<this.__range.top?t=this.__range.top:t>this.__range.bottom&&(t=this.__range.bottom),this.__target.style.top=t+"px"},__initEnv:function(){var e=i(this.__handler);e.css("cursor","move")},__initOptions:function(){this.__handler||(this.__handler=this.__target),this.__rangeNode||(this.__rangeNode=this.__options.target.ownerDocument.body),this.__allowAxisX="y"!==this.__options.axis,this.__allowAxisY="x"!==this.__options.axis},__getRange:function(){var e=this.__rangeNode,t=r.getRect(this.__target);return"body"===e.tagName.toLowerCase()?(e=i(this.__rangeNode.ownerDocument),e={top:0,left:0,bottom:e.height(),right:e.width()}):e=r.getRect(e),{top:e.top,left:e.left,bottom:e.bottom-t.height,right:e.right-t.width}}}),function(e){return new n(e)}}},_p[9]={value:function(e){function t(e){var r=!1,o=!1,a=null;return 1===arguments.length?n(e):(i.each([].slice.call(arguments,1),function(n,s){for(var l in s)a=s[l],s.hasOwnProperty(l)&&(r=i.isPlainObject(a),o=i.isArray(a),r||o?r?(i.isPlainObject(e[l])||(e[l]={}),e[l]=t(e[l],a)):o&&(e[l]=t(a)):e[l]=s[l])}),e)}function n(e){var r=null;return i.isPlainObject(e)?t({},e):i.isArray(e)?(r=[],i.each(e,function(e,t){i.isPlainObject(t)||i.isArray(t)?r.push(n(t)):r.push(t)}),r):e}var i=_p.r(4);return t}},_p[10]={value:function(e){return{isContainer:function(e){return"container"===e.__widgetType}}}},_p[11]={value:function(){var e={};return{widgets:e,__export:function(){window.FUI=this},___register:function(e,t){if("string"==typeof e)this[e]=t;else{t=e;for(var n in t)t.hasOwnProperty(n)&&(this[n]=t[n])}},__registerInstance:function(t){e[t.getId()]=t}}}},_p[12]={value:function(e){var t=_p.r(11);return{classPrefix:"fui-",layout:{TOP:"top",LEFT:"left",BOTTOM:"bottom",RIGHT:"right",CENTER:"center",MIDDLE:"middle",LEFT_TOP:"left-top",RIGHT_TOP:"right-top",LEFT_BOTTOM:"left-bottom",RIGHT_BOTTOM:"right-bottom"},allowFocus:!!t.ALLOW_FOCUS,control:{input:1,textarea:1,button:1,select:1,option:1,object:1,embed:1}}}},_p[13]={value:function(e){var t=_p.r(4),n={Tpl:_p.r(7),Widget:_p.r(10),createDraggable:_p.r(8)};return t.extend(n,_p.r(6),_p.r(5))}},_p[14]={value:function(){return'<div unselectable="on" class="fui-t-picker"></div>\n'}},_p[15]={value:function(){return'<div unselectable="on" class="fui-table-picker"></div>\n'}},_p[16]={value:function(e){var t=_p.r(4),n=_p.r(12),i=_p.r(14);return _p.r(13).createClass("TPicker",{base:_p.r(60),constructor:function(e){var n={row:10,col:10};e=t.extend({},n,e),this.callBase(e)},__initOptions:function(){this.callBase(),this.widgetName="TPicker",this.__tpl=i,this.__backplane=null},__render:function(){this.callBase(),this.__backplane=this.__createBackplane(),this.__element.appendChild(this.__backplane)},__initEvent:function(){var e=this,n={};this.callBase(),t(this.__backplane).delegate("td","mousemove",function(t){n=t.target.getAttribute("data-index").split(","),n={row:parseInt(n[0],10),col:parseInt(n[1],10)},e.__update(n.row,n.col)}),t(this.__backplane).on("click",function(t){e.__select(n.row,n.col)})},__select:function(e,t){this.trigger("pickerselect",{row:e,col:t})},__update:function(e,t){for(var i=null,r=this.__options.row,o=this.__options.col,a=n.classPrefix+"table-picker-hoverin",s=0;r>s;s++){i=this.__backplane.rows[s];for(var l=0;o>l;l++)e>=s&&t>=l?i.cells[l].className=a:i.cells[l].className=""}this.trigger("pickerhover",{row:e,col:t})},__createBackplane:function(){for(var e=[],i=null,r=0,o=this.__options.row;o>r;r++){i=[];for(var a=0,s=this.__options.col;s>a;a++)i.push('<td data-index="'+r+","+a+'"></td>');e.push("<tr>"+i.join("")+"</tr>")}return e=t("<table><tbody>"+e.join("")+"</tbody></table>"),e.addClass(n.classPrefix+"t-picker-table"),e[0]}})}},_p[17]={value:function(e){var t=_p.r(4),n=_p.r(12),i=_p.r(15),r=_p.r(48),o=_p.r(16),a=_p.r(37),s=_p.r(54),l=_p.r(49);return _p.r(13).createClass("TablePicker",{base:_p.r(60),constructor:function(e){var n={button:null,row:10,col:10};e=t.extend({},n,e),this.callBase(e)},open:function(){this.__panelWidget.show(),this.__maskWidget.show()},close:function(){this.__panelWidget.hide(),this.__maskWidget.hide()},appendTo:function(e){e.appendChild(this.__buttonWidget.getElement())},getButton:function(){return this.__buttonWidget},__initOptions:function(){this.callBase(),this.widgetName="TablePicker",this.__tpl=i,this.__pickerWidget=null,this.__labelWidget=null,this.__buttonWidget=null,this.__panelWidget=null,this.__maskWidget=null},__render:function(){this.callBase(),this.__pickerWidget=new o(this.__options),this.__labelWidget=new r({text:"插入表格"}),this.__buttonWidget=new a(this.__options.button),this.__panelWidget=new s({className:n.classPrefix+"table-picker-panel",column:!0,resize:"none"}),this.__maskWidget=new l,this.__panelWidget.appendWidget(this.__labelWidget),this.__panelWidget.appendWidget(this.__pickerWidget),this.__panelWidget.positionTo(this.__buttonWidget)},__initEvent:function(){var e=this;this.callBase(),this.__buttonWidget.on("btnclick",function(t){e.open()}),this.__maskWidget.on("maskclick",function(t){e.close()}),this.__pickerWidget.on("pickerhover",function(t,n){var i=n.row+1,r=n.col+1;e.__labelWidget.setText(i+"x"+r+" 表格")}).on("pickerselect",function(t,n){var i=n.row+1,r=n.col+1;e.close(),e.trigger("pickerselect",{row:i,col:r})})},__createBackplane:function(){for(var e=[],i=null,r=0,o=this.__options.row;o>r;r++){i=[];for(var a=0,s=this.__options.col;s>a;a++)i.push('<td data-index="'+r+","+a+'"></td>');e.push("<tr>"+i.join("")+"</tr>")}return e=t("<table><tbody>"+e.join("")+"</tbody></table>"),e.addClass(n.classPrefix+"t-picker-table"),e[0]}})}},_p[18]={value:function(){return'<div unselectable="on" class="fui-button-menu"></div>\n'}},_p[19]={value:function(){return'<div unselectable="on" class="fui-button"></div>\n'}},_p[20]={value:function(){return'<div unselectable="on" class="fui-colorpicker-container">\n<div unselectable="on" class="fui-colorpicker-toolbar">\n<div unselectable="on" class="fui-colorpicker-preview"></div>\n<div unselectable="on" class="fui-colorpicker-clear">$clearText</div>\n</div>\n<div unselectable="on" class="fui-colorpicker-title">$commonText</div>\n<div unselectable="on" class="fui-colorpicker-commoncolor">\nhelper.forEach( commonColor, function ( index, colors ) {\n<div unselectable="on" class="fui-colorpicker-colors fui-colorpicker-colors-line$index">\nhelper.forEach( colors, function( i, color ) {\n<span unselectable="on" class="fui-colorpicker-item" style="background-color: $color; border-color: #{color.toLowerCase() == \'#ffffff\' ? \'#eeeeee\': color};" data-color="$color"></span>\n});\n</div>\n} );\n</div>\n<div unselectable="on" class="fui-colorpicker-title">$standardText</div>\n<div unselectable="on" class="fui-colorpicker-standardcolor fui-colorpicker-colors">\nhelper.forEach( standardColor, function ( i, color ) {\n<span unselectable="on" class="fui-colorpicker-item" style="background-color: $color; border-color: $color;" data-color="$color"></span>\n} );\n</div>\n</div>\n'}},_p[21]={value:function(){return'<div unselectable="on" class="fui-dialog-wrap">\n<div unselectable="on" class="fui-dialog-head">\n<h1 unselectable="on" class="fui-dialog-caption">$caption</h1>\n</div>\n<div unselectable="on" class="fui-dialog-body"></div>\n<div unselectable="on" class="fui-dialog-foot"></div>\n</div>\n'}},_p[22]={value:function(){return"<div unselectable=\"on\" class=\"fui-drop-panel\"  #{ text ? 'title=\"' + m.text + '\"' : '' }></div>\n"}},_p[23]={value:function(){return'<div unselectable="on" class="fui-icon" >\nif ( this.img ) {\n<img unselectable="on" src="#{this.img}" >\n}\n</div>\n'}},_p[24]={value:function(){return'<div unselectable="on" class="fui-input-button"></div>\n'}},_p[25]={value:function(){return'<div unselectable="on" class="fui-input-menu"></div>\n'}},_p[26]={value:function(){return'<input unselectable="on" class="fui-input"  autocomplete="off" !#{ value ? \'value="\' + value + \'"\' : \'\'}>\n'}},_p[27]={value:function(){return"<div unselectable=\"on\" class=\"fui-item!#{ selected ? ' fui-item-selected': '' }\" ></div>\n"}},_p[28]={value:function(){return'<div unselectable="on" class="fui-label">$text</div>\n'}},_p[29]={value:function(){return'<div unselectable="on" class="fui-mask" style="background-color: $bgcolor; opacity: $opacity;"></div>\n'}},_p[30]={value:function(){return'<div unselectable="on" class="fui-panel"></div>\n'}},_p[31]={value:function(){return'<div unselectable="on" class="fui-separator"></div>\n'}},_p[32]={value:function(){return'<div unselectable="on" class="fui-spin-button"></div>\n'}},_p[33]={value:function(){return'<div unselectable="on" class="fui-tabs">\n<div unselectable="on" class="fui-tabs-button-wrap"></div>\n<div unselectable="on" class="fui-tabs-panel-wrap"></div>\n</div>\n'}},_p[34]={value:function(e){var t=_p.r(4),n=_p.r(12),i=_p.r(18),r=_p.r(37),o=_p.r(50),a=_p.r(49),s=n.layout;return _p.r(13).createClass("ButtonMenu",{base:_p.r(60),constructor:function(e){var n={menu:null,mask:null,buttons:[],selected:-1,layout:s.RIGHT};e=t.extend({},n,e),this.callBase(e)},open:function(){this.__openState=!0,this.__maskWidget.show(),this.__menuWidget.show(),this.addClass(n.classPrefix+"button-active")},close:function(){this.__openState=!1,this.__maskWidget.hide(),this.__menuWidget.hide(),this.removeClass(n.classPrefix+"button-active")},isOpen:function(){return!!this.__openState},getSelected:function(){return this.__menuWidget.getSelected()},getSelectedItem:function(){return this.__menuWidget.getSelectedItem()},getValue:function(){return this.getSelectedItem().getValue()},__render:function(){this.callBase(),this.__initButtons(),this.__menuWidget=new o(this.__options.menu),this.__maskWidget=new a(this.__options.mask),this.__menuWidget.positionTo(this.__element),this.__menuWidget.appendTo(this.__element.ownerDocument.body)},__initOptions:function(){this.callBase(),this.widgetName="ButtonMenu",this.__tpl=i,this.__buttonWidgets=null,this.__menuWidget=null,this.__maskWidget=null,this.__openState=!1,-1!==this.__options.selected&&(this.__options.menu.selected=this.__options.selected)},__initButtons:function(){var e=[],i=this.__element,o=null,a=this.__options.buttons.length-1;this.__options.layout===s.TOP||this.__options.layout===s.LEFT?(o=new r(this.__options.buttons[a]),o.appendTo(i)):a=-1,t.each(this.__options.buttons,function(t,n){if(a!==t){var s=new r(n);s.appendTo(i),e.push(s)}else e.push(o)}),this.addClass(n.classPrefix+"layout-"+this.__options.layout),e[e.length-1].addClass(n.classPrefix+"open-btn"),this.__buttonWidgets=e},__initEvent:function(){var e=this.__buttonWidgets[this.__buttonWidgets.length-1],n=this;this.callBase(),e.on("click",function(e){n.open()}),this.__maskWidget.on("maskclick",function(){n.close()}),this.__menuWidget.on("select",function(e,t){e.stopPropagation(),n.close(),n.trigger("select",t)}).on("change",function(e,t){n.trigger("change",t)}),this.on("btnclick",function(e){e.stopPropagation();var n=t.inArray(e.widget,this.__buttonWidgets);n>-1&&n<this.__buttonWidgets.length-1&&this.trigger("buttonclick",{button:this.__buttonWidgets[n]})})}})}},_p[35]={value:function(e){var t=_p.r(4),n=_p.r(25),i=_p.r(43),r=_p.r(50),o=_p.r(49),a=_p.r(13);return _p.r(13).createClass("InputMenu",{base:_p.r(60),constructor:function(e){var t=a.getMarker();this.callBase(t);var i={input:null,menu:null,mask:null};this.__extendOptions(i,e),this.widgetName="InputMenu",this.__tpl=n,this.__lastTime=0,this.__lastSelect=null,this.__inputWidget=null,this.__menuWidget=null,this.__maskWidget=null,this.__menuState=!1,e!==t&&this.__render()},select:function(e){this.__menuWidget.select(e)},setValue:function(e){return this.__inputWidget.setValue(e),this},getValue:function(){return this.__inputWidget.getValue()},__render:function(){return this.__rendered?this:(this.__inputWidget=new i(this.__options.input),this.__menuWidget=new r(this.__options.menu),this.__maskWidget=new o(this.__options.mask),this.callBase(),this.__inputWidget.appendTo(this.__element),this.__menuWidget.positionTo(this.__inputWidget),void this.__initInputMenuEvent())},open:function(){this.__maskWidget.show(),this.__menuWidget.show()},close:function(){this.__maskWidget.hide(),this.__menuWidget.hide()},__initInputMenuEvent:function(){var e=this;this.on("buttonclick",function(){this.__menuState||(this.__appendMenu(),this.__menuState=!0),this.__inputWidget.unfocus(),this.open()}),this.on("keypress",function(e){this.__lastTime=new Date}),this.on("keyup",function(e){8!==e.keyCode&&13!==e.keyCode&&new Date-this.__lastTime<500&&this.__update()}),this.on("inputcomplete",function(){this.__inputWidget.selectRange(99999999),this.__inputComplete()}),this.__menuWidget.on("select",function(t,n){t.stopPropagation(),e.setValue(n.value),e.trigger("select",n),e.close()}),this.__menuWidget.on("change",function(t,n){t.stopPropagation(),e.trigger("change",n)}),this.__inputWidget.on("select change",function(e){e.stopPropagation()}),this.__maskWidget.on("maskclick",function(){e.close()}),this.on("select",function(e,t){this.__lastSelect=t})},__update:function(){var e=this.getValue(),n=e.toLowerCase(),i=this.__getItemValues(),r=null;e&&(t.each(i,function(e,t){return 0===t.toLowerCase().indexOf(n)?(r=t,!1):void 0}),r&&(this.__inputWidget.setValue(r),this.__inputWidget.selectRange(e.length)))},__getItemValues:function(){var e=[];return t.each(this.__menuWidget.getWidgets(),function(t,n){e.push(n.getValue())}),e},__inputComplete:function(){var e=this.__getItemValues(),n=-1,i=this.getValue(),r=this.__lastSelect;t.each(e,function(e,t){return t===i?(n=e,!1):void 0}),this.trigger("select",{index:n,value:i}),r&&r.value===i||this.trigger("change",{from:r||{index:-1,value:null},to:{index:n,value:i}})},__appendMenu:function(){this.__menuWidget.appendTo(this.__inputWidget.getElement().ownerDocument.body)}})}},_p[36]={value:function(e){var t=_p.r(4),n=_p.r(12),i=_p.r(59);return _p.r(13).createClass("Buttonset",{base:_p.r(51),constructor:function(e){var n={selected:-1};e=t.extend({},n,e),this.callBase(e)},getButtons:function(){return this.getWidgets()},getButton:function(e){return this.getWidgets()[e]||null},getValue:function(){return this.__currentIndex>-1?this.__widgets[this.__currentIndex].getValue():null},getSelectedIndex:function(){return this.__currentIndex},appendButton:function(){return this.appendWidget.apply(this,arguments)},insertButton:function(){return this.insertWidget.apply(this,arguments)},select:function(e){return this.__options.disabled?this:(e instanceof i&&(e=t.inArray(e,this.__widgets)),0>e?this.clearSelect():(e=this.__widgets[e],this.__pressButton(e),this))},selectByValue:function(e){var t=this.__widgets.map(function(e){return e.getValue()});return this.select(t.indexOf(e))},clearSelect:function(){return this.__pressButton(null),this},removeButton:function(){return this.removeWidget.apply(this,arguments)},insertWidget:function(e,t){var n=this.callBase(e,t);return null===n?n:(e<=this.__currentIndex&&this.__currentIndex++,e<=this.__prevIndex&&this.__prevIndex++,n)},removeWidget:function(e){var t=e;return"number"!=typeof t&&(t=this.indexOf(e)),e=this.callBase(e),t===this.__currentIndex?this.__currentIndex=-1:t<this.__currentIndex&&this.__currentIndex--,t===this.__prevIndex?this.__prevIndex=-1:t<this.__prevIndex&&this.__prevIndex--,e},__initOptions:function(){this.callBase(),this.widgetName="Buttonset",this.__currentIndex=this.__options.selected,this.__prevIndex=-1},__render:function(){return this.callBase(),t(this.__element).addClass(n.classPrefix+"buttonset"),this.__initButtons(),this},__initButtons:function(){var e=this,n=null;t.each(this.__options.buttons,function(r,o){n=new i(t.extend({},o,{pressed:r===e.__options.selected,preventDefault:!0})),n.__on("click",function(t){e.isDisabled()||e.__pressButton(this)}),n.__on("change",function(e){e.stopPropagation()}),e.appendButton(n)})},__pressButton:function(e){this.__prevIndex=this.__currentIndex,this.__currentIndex=this.indexOf(e),this.__currentIndex!==this.__prevIndex&&(e&&e.press(),t.each(this.__widgets,function(t,n){n!==e&&n.bounce()}),this.trigger("change",{currentIndex:this.__currentIndex,prevIndex:this.__prevIndex}))},__valid:function(e){return e instanceof i}})}},_p[37]={value:function(e){var t=_p.r(4),n=_p.r(12),i=_p.r(19),r=_p.r(42),o=_p.r(48);return _p.r(13).createClass("Button",{base:_p.r(60),constructor:function(e){var n={label:null,text:null,icon:null,layout:"right"};e=t.extend({},n,e),this.callBase(e)},getLabel:function(){return this.__labelWidget.getText()},setLabel:function(e){return this.__labelWidget.setText(e)},getLabelWidget:function(){return this.__labelWidget},getIconWidget:function(){return this.__iconWidget},__render:function(){switch(this.callBase(),this.__iconWidget=new r(this.__options.icon),this.__labelWidget=new o(this.__options.label),this.__options.layout){case"left":case"top":this.__element.appendChild(this.__labelWidget.getElement()),this.__element.appendChild(this.__iconWidget.getElement());break;case"right":case"bottom":default:this.__element.appendChild(this.__iconWidget.getElement()),this.__element.appendChild(this.__labelWidget.getElement())}t(this.__element).addClass(n.classPrefix+"button-layout-"+this.__options.layout)},__initOptions:function(){this.callBase(),this.widgetName="Button",this.__tpl=i,this.__iconWidget=null,this.__labelWidget=null,"object"!=typeof this.__options.label&&(this.__options.label={text:this.__options.label}),"object"!=typeof this.__options.icon&&(this.__options.icon={img:this.__options.icon})},__initEvent:function(){this.callBase(),this.on("click",function(){this.__trigger("btnclick")})}})}},_p[38]={value:function(e){var t=_p.r(13),n=_p.r(12),i=_p.r(49),r=_p.r(20),o=_p.r(4);return t.createClass("ColorPicker",{base:_p.r(54),constructor:function(e){var t={clearText:"",commonText:"",commonColor:[["#ffffff","#000000","#eeece1","#1f497d","#4f81bd","#c0504d","#9bbb59","#8064a2","#4bacc6","#f79646"],["#f2f2f2","#808080","#ddd8c2","#c6d9f1","#dbe5f1","#f2dbdb","#eaf1dd","#e5dfec","#daeef3","#fde9d9"],["#d9d9d9","#595959","#c4bc96","#8db3e2","#b8cce4","#e5b8b7","#d6e3bc","#ccc0d9","#b6dde8","#fbd4b4"],["#bfbfbf","#404040","#938953","#548dd4","#95b3d7","#d99594","#c2d69b","#b2a1c7","#92cddc","#fabf8f"],["#a6a6a6","#262626","#4a442a","#17365d","#365f91","#943634","#76923c","#5f497a","#31849b","#e36c0a"],["#7f7f7f","#0d0d0d","#1c1a10","#0f243e","#243f60","#622423","#4e6128","#3f3151","#205867","#974706"]],standardText:"",standardColor:["#c00000","#ff0000","#ffc000","#ffff00","#92d050","#00b050","#00b0f0","#0070c0","#002060","#7030a0"]};e=o.extend({},t,e),this.callBase(e)},show:function(){return this.__inDoc||(this.__inDoc=!0,this.appendTo(this.__element.ownerDocument.body)),this.__maskWidget.show(),this.callBase(),this},hide:function(){return this.callBase(),this.__maskWidget.hide(),this},attachTo:function(e){var t=this;e.on("click",function(){t.appendTo(e.getElement().ownerDocument.body),t.positionTo(e),t.show()})},__initOptions:function(){this.callBase(),this.widgetName="ColorPicker",this.__contentElement=null,this.__maskWidget=null,this.__inDoc=!1},__render:function(){this.callBase(),o(this.__element).addClass(n.classPrefix+"colorpicker");var e=t.Tpl.compile(r,this.__options);this.__contentElement.appendChild(o(e)[0]),this.__previewElement=o(this.__contentElement).find("."+n.classPrefix+"colorpicker-preview"),this.__clearElement=o(this.__contentElement).find("."+n.classPrefix+"colorpicker-clear"),this.__maskWidget=new i(this.__options.mask)},__initEvent:function(){var e=this;this.callBase(),this.on("click",function(t){var i,r=o(t.target);r.hasClass(n.classPrefix+"colorpicker-item")?(i=r.attr("data-color"),e.trigger("selectcolor",i),e.hide()):r.hasClass(n.classPrefix+"colorpicker-clear")&&(e.trigger("selectcolor",""),e.hide())}),this.on("mouseover",function(t){var i,r=o(t.target);r.hasClass(n.classPrefix+"colorpicker-item")&&(i=r.attr("data-color"),o(e.__element).find("."+n.classPrefix+"colorpicker-preview").css({"background-color":i,"border-color":i}))}),this.__maskWidget.on("click",function(){e.hide()})}})}},_p[39]={value:function(e){var t=_p.r(13),n=_p.r(12),i=_p.r(60),r=_p.r(0),o=_p.r(4);return t.createClass("Container",{base:i,constructor:function(e){var t={column:!1,widgets:null};e=o.extend({},t,e),this.callBase(e)},indexOf:function(e){return o.inArray(e,this.__widgets)},disable:function(){this.callBase(),o.each(this.__widgets,function(e,t){t.disable()})},enable:function(){this.callBase(),o.each(this.__widgets,function(e,t){t.enable()})},getWidgets:function(){return this.__widgets},getWidget:function(e){return this.__widgets[e]||null},getWidgetByValue:function(e){var t=null;return o.each(this.__widgets,function(n,i){return i.getValue()===e?(t=i,!1):void 0}),t},appendWidget:function(e){return this.__valid(e)?(this.__options.disabled&&e.disable(),this.__widgets.push(e),e.appendTo(this.__contentElement),this.__options.column?(this.__widgets.length>0&&this.__widgets.length%this.__options.column===0&&this.__contentElement.appendChild(o('<span class="fui-column"></span>')[0]),o(e.getElement()).addClass(n.classPrefix+"panel-column-widget"),e):e):null},appendWidgets:function(e){var t=this,n=e;return o.isArray(e)||(n=arguments),o.each(n,function(e,n){t.appendWidget(n)}),this},insertWidget:function(e,t){var i=null;return 0===this.__widgets.length?this.appendWidget(t):this.__valid(t)?(this.__options.disabled&&t.disable(),i=this.__widgets[e],this.__widgets.splice(e,0,t),this.__contentElement.insertBefore(t.getElement(),i.getElement()),this.__options.column===!1?t:(this.__contentElement.insertBefore(o('<span class="fui-column"></span>')[0],i.getElement()),o(t.getElement()).addClass(n.classPrefix+"panel-column-widget"),t)):null},insertWidgets:function(e,t){var n=this,i=t;return o.isArray(t)||(i=[].slice.call(arguments,1)),o.each(i,function(t,i){n.insertWidget(e,i),e++}),this},getContentElement:function(){return this.__contentElement},removeWidget:function(e){return"number"==typeof e?e=this.__widgets.splice(e,1)[0]:this.__widgets.splice(this.indexOf(e),1),this.__contentElement.removeChild(e.getElement()),o(e.getElement()).removeClass(n.classPrefix+"panel-column-widget"),e},__initOptions:function(){this.widgetName="Container",this.__widgets=[],this.__contentElement=null,this.__options.column-=0},__render:function(){return this.callBase(),this.__contentElement=this.__element,o(this.__element).addClass(n.classPrefix+"container"),this.__options.column&&o(this.__element).addClass(n.classPrefix+"container-column"),this},__appendChild:function(e){return this.appendWidget(e)},__initWidgets:function(){if(this.__options.widgets){var e=r.parse(this.__options.widgets),t=this;o.isArray(e)||(e=[e]),o.each(e,function(e,n){t.appendWidget(n)})}},__valid:function(e){return e instanceof i}})}},_p[40]={value:function(e){var t=_p.r(13),n=_p.r(12),i=_p.r(60),r=_p.r(49),o=_p.r(21),a=_p.r(37),s=n.layout,l=_p.r(4),u={CANCEL:"cancel",OK:"ok"};return t.createClass("Dialog",{base:_p.r(54),constructor:function(e){var t={layout:s.CENTER,caption:null,resize:"height",draggable:!0,closeButton:!0,mask:{color:"#000",opacity:.2},prompt:!1,buttons:[{className:n.classPrefix+"xdialog-ok-btn",action:"ok",label:"确定"},{className:n.classPrefix+"xdialog-cancel-btn",action:"cancel",label:"取消"}]};e=l.extend({},t,e),this.callBase(e)},open:function(){return this.__fire("open",function(){this.show()}),this},close:function(){return this.__fire("close",function(){this.hide()}),this},getButtons:function(){return this.__buttons},getButton:function(e){return this.__buttons[e]},appendTo:function(e){return this.callBase(e),this.__maskWidget.appendTo(e),this.__inDoc=!0,this},show:function(){return this.__target||(this.__target=this.__element.ownerDocument.body),this.__inDoc||this.appendTo(this.__element.ownerDocument.body),this.__maskWidget.show(),this.callBase(),this.__openState=!0,this},hide:function(){return this.callBase(),this.__maskWidget.hide(),this.__openState=!1,this},toggle:function(){return this.isOpen()?this.close():this.open(),this},isOpen:function(){return this.__openState},getHeadElement:function(){return this.__headElement},getBodyElement:function(){return this.getContentElement()},getFootElement:function(){return this.__footElement},__initOptions:function(){this.callBase(),this.widgetName="Dialog",this.__target=this.__options.target,this.__layout=this.__options.layout,this.__inDoc=!1,this.__hinting=!1,this.__openState=!1,this.__headElement=null,this.__bodyElement=null,this.__footElement=null,this.__maskWidget=null,this.__buttons=[],this.__target instanceof i&&(this.__target=this.__target.getElement())},__render:function(){this.callBase(),this.__innerTpl=t.Tpl.compile(o,this.__options),this.__contentElement.appendChild(l(this.__innerTpl)[0]),l(this.__element).addClass(n.classPrefix+"dialog"),this.__headElement=l(".fui-dialog-head",this.__contentElement)[0],this.__bodyElement=l(".fui-dialog-body",this.__contentElement)[0],this.__footElement=l(".fui-dialog-foot",this.__contentElement)[0],this.__maskWidget=new r(this.__options.mask),this.__contentElement=this.__bodyElement,this.__options.draggable&&this.__initDraggable(),this.__options.closeButton&&this.__initCloseButton(),this.__initButtons(),this.__initMaskLint()},__action:function(e,t){switch(e){case u.OK:this.__triggerHandler(e)!==!1&&this.close();break;case u.CANCEL:this.__triggerHandler(e),this.close()}},__initButtons:function(){var e=this,t=null,n=this.__footElement;l.each(this.__options.buttons,function(i,r){t=new a(r),t.appendTo(n),e.__buttons.push(t)})},__initEvent:function(){var e=this;this.callBase(),l([this.__footElement,this.__headElement]).on("btnclick",function(t,n){e.__action(n.getOptions().action,n)}),this.__options.prompt&&l(this.__element).on("keydown",function(t){switch(t.keyCode){case 13:e.__action(u.OK);break;case 27:e.__action(u.CANCEL)}})},__initDraggable:function(){t.createDraggable({handler:this.__headElement,target:this.__element}).bind()},__initCloseButton:function(){var e=new a({className:"fui-close-button",action:"cancel",icon:{className:"fui-close-button-icon"}});e.appendTo(this.__headElement)},__initMaskLint:function(){var e=this;this.__maskWidget.on("click",function(){e.__hint()})},__hint:function(){if(!this.__hinting){this.__hinting=!0;var e=l(this.__element),t=this,i=[n.classPrefix+"mask-hint",n.classPrefix+"mask-animate"];
e.addClass(i.join(" ")),window.setTimeout(function(){e.removeClass(i[0]),window.setTimeout(function(){e.removeClass(i[1]),t.__hinting=!1},200)},200)}}})}},_p[41]={value:function(e){var t=_p.r(4),n=_p.r(12),i=_p.r(22),r=_p.r(37),o=_p.r(51),a=_p.r(54),s=_p.r(49);return _p.r(13).createClass("DropPanel",{base:_p.r(60),constructor:function(e){var n={button:null,panel:null,width:null,height:null};e=t.extend({},n,e),this.callBase(e)},disable:function(){this.callBase()},enable:function(){this.callBase()},open:function(){this.__popupWidget.appendWidget(this.__panelWidget),this.__maskWidget.show(),this.__popupWidget.show();var e=t(this.__popupWidget.getElement());e.css("top",parseInt(e.css("top"))-t(this.__element).outerHeight()),e.css("min-width",t(this.__element).outerWidth()),e.css("min-height",t(this.__element).height())},close:function(){this.__maskWidget.hide(),this.__popupWidget.hide(),this.__panelWidget.appendTo(this.__contentElement)},getPanelElement:function(){return this.__panelWidget.getElement()},appendWidget:function(e){this.__panelWidget.appendWidget(e)},getWidgets:function(){return this.__panelWidget.getWidgets()},getWidget:function(e){return this.__panelWidget.getWidget(e)},appendWidgets:function(e){return this.__panelWidget.appendWidgets.apply(this,arguments),this},insertWidget:function(e,t){this.__panelWidget.insertWidget(e,t)},insertWidgets:function(e,t){return this.__panelWidget.insertWidgets.apply(this,arguments),this},removeWidget:function(e){return this.__panelWidget.removeWidget(e)},__render:function(){this.__initOptions(),this.__buttonWidget=new r(this.__options.button),this.__panelWidget=new o(this.__options.content),this.__popupWidget=new a,this.__maskWidget=new s(this.__options.mask),this.callBase(),this.__popupWidget.positionTo(this.__element),t(this.__popupWidget.getElement()).addClass(n.classPrefix+"drop-panel-popup");var e=t('<div class="'+n.classPrefix+'drop-panel-content"></div>').append(this.__panelWidget.getElement());this.__contentElement=e[0],t(this.__element).append(e).append(this.__buttonWidget.getElement()),this.__initDropPanelEvent()},__initOptions:function(){this.widgetName="DropPanel",this.__tpl=i,this.__buttonWidget=null,this.__popupWidget=null,this.__panelWidget=null,this.__contentElement=null,this.__maskWidget=null,this.__popupState=!1,"object"!=typeof this.__options.button&&(this.__options.input={icon:this.__options.button})},__initDropPanelEvent:function(){var e=this;this.__buttonWidget.on("click",function(){e.__popupState||(e.__appendPopup(),e.__popupState=!0),e.trigger("buttonclick"),e.open()}),this.__panelWidget.on("click",function(){e.trigger("panelclick")}),this.__maskWidget.on("maskclick",function(){e.close()})},__appendPopup:function(){this.__popupWidget.appendTo(this.__element.ownerDocument.body)}})}},_p[42]={value:function(e){var t=_p.r(4),n=_p.r(23);return _p.r(13).createClass("Icon",{base:_p.r(60),constructor:function(e){var n={img:null};e=t.extend({},n,e),this.callBase(e)},getValue:function(){return this.__options.value||this.__options.img},setImage:function(e){return this.__options.img===e?this:(this.__image&&(this.__image.src=e),void this.trigger("iconchange",{prevImage:this.__prevIcon,currentImage:this.__currentIcon}))},getImage:function(){return this.__currentIcon},__initOptions:function(){this.callBase(),this.widgetName="Icon",this.__tpl=n,this.__prevIcon=null,this.__currentIcon=this.__options.img,this.__image=null},__render:function(){this.__options.__width=this.__options.width,this.__options.__height=this.__options.height,this.__options.width=null,this.__options.height=null,this.callBase(),this.__options.img&&(this.__image=t("img",this.__element)[0],null!==this.__options.__width&&(this.__image.width=this.__options.__width),null!==this.__options.__height&&(this.__image.height=this.__options.__height))}})}},_p[43]={value:function(e){var t=_p.r(4),n=_p.r(12),i=_p.r(24),r=_p.r(37),o=_p.r(45);return _p.r(13).createClass("InputButton",{base:_p.r(60),constructor:function(e){var n={button:null,input:null,placeholder:null,layout:"right"};e=t.extend({},n,e),this.callBase(e)},getValue:function(){return this.__inputWidget.getValue()},setValue:function(e){return this.__inputWidget.setValue(e),this},reset:function(){this.__inputWidget.reset()},selectAll:function(){return this.__inputWidget.selectAll(),this},selectRange:function(e,t){return this.__inputWidget.selectRange(e,t),this},focus:function(){return this.__inputWidget.focus(),this},unfocus:function(){return this.__inputWidget.unfocus(),this},__initOptions:function(){this.callBase(),this.widgetName="InputButton",this.__tpl=i,this.__inputWidget=null,this.__buttonWidget=null,"object"!=typeof this.__options.input&&(this.__options.input={placeholder:this.__options.input}),this.__options.input=t.extend({},this.__options.input,{placeholder:this.__options.placeholder}),"object"!=typeof this.__options.button&&(this.__options.button={icon:this.__options.button})},__render:function(){var e=this;switch(this.callBase(),this.__buttonWidget=new r(this.__options.button),this.__inputWidget=new o(this.__options.input),this.__options.layout){case"left":case"top":this.__buttonWidget.appendTo(this.__element),this.__inputWidget.appendTo(this.__element);break;case"right":case"bottom":default:this.__inputWidget.appendTo(this.__element),this.__buttonWidget.appendTo(this.__element)}t(this.__element).addClass(n.classPrefix+"layout-"+this.__options.layout),this.__buttonWidget.on("click",function(){e.trigger("buttonclick")})}})}},_p[44]={value:function(e){var t=_p.r(4),n=_p.r(25),i=_p.r(43),r=_p.r(50),o=_p.r(49);return _p.r(13).createClass("InputMenu",{base:_p.r(60),constructor:function(e){var n={input:null,menu:null,mask:null,selected:-1};e=t.extend({},n,e),this.callBase(e)},select:function(e){this.__menuWidget.select(e)},selectByValue:function(e){return this.__selectBy("values",e)},selectByLabel:function(e){return this.__selectBy("labels",e)},clearSelect:function(){return this.__lastSelect=-1,this.__menuWidget.clearSelect(),this.__inputWidget.reset(),this},setValue:function(e){return this},getValue:function(){return this.__menuWidget.getSelectedItem().getValue()},open:function(){this.__maskWidget.show(),this.__menuWidget.show()},close:function(){this.__maskWidget.hide(),this.__menuWidget.hide()},__render:function(){this.__inputWidget=new i(this.__options.input),this.__menuWidget=new r(this.__options.menu),this.__maskWidget=new o(this.__options.mask),this.callBase(),this.__inputWidget.appendTo(this.__element),this.__menuWidget.positionTo(this.__inputWidget),this.__initInputValue()},__selectBy:function(e,n){var i=this.__getItemValues()[e],r=-1;return t.each(i,function(e,t){return n===t?(r=e,!1):void 0}),-1!==r?(this.select(r),this.__menuWidget.getSelectedItem()):null},__initInputValue:function(){var e=this.__menuWidget.getItem(this.__options.selected);e&&this.__inputWidget.setValue(e.getLabel())},__initEvent:function(){var e=this;this.callBase(),this.on("buttonclick",function(){this.__menuState||(this.__appendMenu(),this.__menuState=!0),this.__inputWidget.unfocus(),this.open()}),this.on("keypress",function(e){this.__lastTime=new Date}),this.on("keyup",function(e){8!==e.keyCode&&13!==e.keyCode&&new Date-this.__lastTime<500&&this.__update()}),this.on("inputcomplete",function(){this.__inputWidget.selectRange(99999999),this.__inputComplete()}),this.__menuWidget.on("select",function(t,n){t.stopPropagation(),e.__inputWidget.setValue(n.label),e.trigger("select",n),e.close()}),this.__menuWidget.on("menuitemclick",function(t,n){e.trigger("itemclick",n)}),this.__menuWidget.on("change",function(t,n){t.stopPropagation(),e.trigger("change",n)}),this.__inputWidget.on("select change",function(e){e.stopPropagation()}),this.__maskWidget.on("maskclick",function(){e.close()}),this.on("select",function(e,t){this.__lastSelect=t})},__update:function(){var e=this.__inputWidget.getValue(),n=e.toLowerCase(),i=this.__getItemValues().labels,r=null;e&&(t.each(i,function(e,t){return 0===t.toLowerCase().indexOf(n)?(r=t,!1):void 0}),r&&(this.__inputWidget.setValue(r),this.__inputWidget.selectRange(e.length)))},__getItemValues:function(){var e=[],n=[];return t.each(this.__menuWidget.getWidgets(),function(t,i){n.push(i.getLabel()),e.push(i.getValue())}),{labels:n,values:e}},__inputComplete:function(){var e=this.__getItemValues(),n=e.labels,i=-1,r=this.__inputWidget.getValue(),o=this.__lastSelect;t.each(n,function(e,t){return t===r?(i=e,!1):void 0}),this.trigger("select",{index:i,label:r,value:e.values[i]}),o&&o.value===r||this.trigger("change",{from:o||{index:-1,label:null,value:null},to:{index:i,label:r,value:e.values[i]}})},__appendMenu:function(){this.__menuWidget.appendTo(this.__inputWidget.getElement().ownerDocument.body)},__initOptions:function(){this.callBase(),this.widgetName="InputMenu",this.__tpl=n,this.__lastTime=0,this.__lastSelect=null,this.__inputWidget=null,this.__menuWidget=null,this.__maskWidget=null,this.__menuState=!1,-1!==this.__options.selected&&(this.__options.menu.selected=this.__options.selected)}})}},_p[45]={value:function(e){var t=_p.r(12),n=_p.r(4),i=_p.r(26);return _p.r(13).createClass("Input",{base:_p.r(60),constructor:function(e){var t={placeholder:null};e=n.extend({},t,e),this.callBase(e)},getValue:function(){return this.__element.value},setValue:function(e){return this.__element.value=e,this},disable:function(){this.callBase(),this.__element.disabled=!0},enable:function(){this.__element.disabled=!1,this.callBase()},reset:function(){return this.__element.value=this.__options.value||"",this},selectAll:function(){this.__element.select()},selectRange:function(e,t){e||(e=0),t||(t=1e9),this.__element.setSelectionRange(e,t)},focus:function(){return this.__element.focus(),this},unfocus:function(){return this.__element.blur(),this},__initOptions:function(){this.callBase(),this.widgetName="Input",this.__tpl=i,this.__allow_focus=!0},__render:function(){this.callBase(),this.__element.removeAttribute("unselectable"),this.__options.placeholder&&this.__element.setAttribute("placeholder",this.__options.placeholder),this.addClass(t.classPrefix+"selectable")},__initEvent:function(){this.callBase(),this.on("keydown",function(e){13===e.keyCode&&this.trigger("inputcomplete",{value:this.getValue()})})}})}},_p[46]={value:function(e){var t=_p.r(13),n=_p.r(27),i=_p.r(42),r=_p.r(48),o=_p.r(12),a=_p.r(4);return t.createClass("Item",{base:_p.r(60),constructor:function(e){var t={label:"",icon:null,selected:!1,textAlign:"left"};e=a.extend({},t,e),this.callBase(e)},getValue:function(){return this.__options.value||this.__labelWidget.getValue()||this.__iconWidget.getValue()||null},select:function(){return this.__update(!0),this},unselect:function(){return this.__update(!1),this},isSelected:function(){return this.__selectState},setLabel:function(e){return this.__labelWidget.setText(e),this},getLabel:function(){return this.__labelWidget.getText()},setIcon:function(e){return this.__iconWidget.setImage(e),this},getIcon:function(){return this.__iconWidget.getImage()},__render:function(){this.callBase(),this.__iconWidget=new i(this.__options.icon),this.__labelWidget=new r(this.__options.label),this.__iconWidget.appendTo(this.__element),this.__labelWidget.appendTo(this.__element)},__update:function(e){var t=e?"addClass":"removeClass";return e=!!e,a(this.__element)[t](o.classPrefix+"item-selected"),this.__selectState=e,this.trigger(e?"itemselect":"itemunselect"),this},__initEvent:function(){this.callBase(),this.on("click",function(){this.trigger("itemclick")})},__initOptions:function(){this.callBase(),this.widgetName="Item",this.__tpl=n,this.__iconWidget=null,this.__labelWidget=null,this.__selectState=this.__options.selected,"object"!=typeof this.__options.label&&(this.__options.label={text:this.__options.label}),this.__options.label.textAlign||(this.__options.label.textAlign=this.__options.textAlign),"object"!=typeof this.__options.icon&&(this.__options.icon={img:this.__options.icon})}})}},_p[47]={value:function(e){var t=_p.r(13),n=_p.r(12),i=_p.r(48),r=_p.r(4);return t.createClass("LabelPanel",{base:_p.r(51),constructor:function(e){var t={layout:"bottom"};e=r.extend({},t,e),this.callBase(e)},disable:function(){this.callBase(),this.__labelWidget.disable()},enable:function(){this.callBase(),this.__labelWidget.enable()},__render:function(){var e=null,t=this.__options,o=this.__element,a=n.classPrefix,s="fui-label-panel-content",l=null;return this.__labelWidget=new i(t.label),this.callBase(),l=this.__contentElement,r(o).addClass(a+"label-panel"),r(o).addClass(a+"layout-"+t.layout),e=r('<div class="'+s+'"></div>'),l.appendChild(this.__labelWidget.getElement()),l.appendChild(e[0]),this.__contentElement=e[0],this},__initOptions:function(){var e=this.__options.label;this.callBase(),this.widgetName="LabelPanel",this.__labelWidget=null,"object"!=typeof e&&(this.__options.label={text:e}),this.__options.label.className||(this.__options.label.className=""),this.__options.label.className+=" fui-label-panel-label"}})}},_p[48]={value:function(e){var t=_p.r(13),n=_p.r(28),i=_p.r(4);return t.createClass("Label",{base:_p.r(60),constructor:function(e){var t={text:"",textAlign:"center"};e=i.extend({},t,e),this.callBase(e)},getValue:function(){return this.__options.text},setText:function(e){var t=this.__options.text;return this.__options.text=e,i(this.__element).text(e),this.trigger("labelchange",{currentText:e,prevText:t}),this},getText:function(){return this.__options.text},__allowShowTitle:function(){return!1},__initOptions:function(){this.callBase(),this.widgetName="Label",this.__tpl=n,this.__options.text=this.__options.text.toString()}})}},_p[49]={value:function(e){function t(){o(window).on("resize",function(){o.each(s,function(e,t){t&&!t.isHide()&&t.__resize()})})}var n=_p.r(13),i=_p.r(29),r=_p.r(60),o=_p.r(4),a=!1,s=[];return n.createClass("Mask",{base:_p.r(60),constructor:function(e){var t={bgcolor:"#000",opacity:0,inner:!0,target:null,scroll:!1,hide:!0};e=o.extend({},t,e),this.callBase(e)},maskTo:function(e){return e&&(this.__target=e),this},show:function(){var e=null;this.__target||(this.__target=this.__element.ownerDocument.body),e=this.__target.ownerDocument.documentElement,o.contains(e,this.__element)||this.appendTo(this.__target.ownerDocument.body),this.callBase(),this.__position(),this.__resize(),this.__hideState=!1},hide:function(){this.callBase(),this.__hideState=!0},isHide:function(){return this.__hideState},__initOptions:function(){this.callBase(),this.widgetName="Mask",this.__tpl=i,this.__cacheId=s.length,this.__hideState=!0,s.push(this),this.__target=this.__options.target,this.__target instanceof r&&(this.__target=this.__target.getElement())},__render:function(){this.callBase(),this.__initMaskEvent(),a||(a=!0,t())},__initMaskEvent:function(){this.on("mousewheel",function(e){var t=e.originalEvent;e.preventDefault(),e.stopPropagation(),this.trigger("scroll",{delta:t.wheelDelta||t.deltaY||t.detail})}),this.on("click",function(e){e.stopPropagation(),e.target===this.__element&&this.trigger("maskclick")})},__resize:function(){var e=null;this.__targetIsBody()?(e=o(n.getView(this.__target)),e={width:e.width(),height:e.height()}):e=n.getRect(this.__target),this.__element.style.width=e.width+"px",this.__element.style.height=e.height+"px"},__position:function(){var e=null,t=null;this.__targetIsBody()?e={top:0,left:0}:(t=n.getRect(this.__target),e={top:t.top,left:t.left}),o(this.__element).css("top",e.top+"px").css("left",e.left+"px")},__targetIsBody:function(){return"body"===this.__target.tagName.toLowerCase()}})}},_p[50]={value:function(e){var t=_p.r(13),n=_p.r(46),i=_p.r(12),r=_p.r(4);return t.createClass("Menu",{base:_p.r(54),constructor:function(e){var t={column:!0,selected:-1,textAlign:"left",items:[]};e=r.extend({},t,e),this.callBase(e)},select:function(e){var t=this.__widgets[e];return t?(this.__selectItem(t),this):this},clearSelect:function(){var e=this.getSelectedItem();e&&e.unselect(),this.__currentSelect=-1,this.__prevSelect=-1},getItems:function(){return this.getWidgets.apply(this,arguments)},getItem:function(){return this.getWidget.apply(this,arguments)},appendItem:function(e){return this.appendWidget.apply(this,arguments)},insertItem:function(e){return this.insertWidget.apply(this,arguments)},removeItem:function(e){return this.removeWidget.apply(this,arguments)},clearItems:function(){for(;this.getItems().length;)this.removeItem(0);return this},getSelected:function(){return this.__currentSelect},getSelectedItem:function(){return this.getItem(this.__currentSelect)},insertWidget:function(e,t){var n=this.callBase(e,t);return null===n?n:(e<=this.__currentSelect&&this.__currentSelect++,e<=this.__prevSelect&&this.__prevSelect++,n)},removeWidget:function(e){var t=e;return"number"!=typeof t&&(t=this.indexOf(e)),e=this.callBase(e),t===this.__currentSelect?this.__currentSelect=-1:t<this.__currentSelect&&this.__currentSelect--,t===this.__prevSelect?this.__prevSelect=-1:t<this.__prevSelect&&this.__prevSelect--,e},__initOptions:function(){this.callBase(),this.__prevSelect=-1,this.__currentSelect=this.__options.selected,this.widgetName="Menu"},__render:function(){var e=this,t=this.__options.textAlign,o=this.__options.selected;this.callBase(),r(this.__element).addClass(i.classPrefix+"menu"),r.each(this.__options.items,function(i,r){"object"!=typeof r&&(r={label:r}),r.selected=i===o,r.textAlign=t,e.appendItem(new n(r))})},__initEvent:function(){this.callBase(),this.on("itemclick",function(e){this.__selectItem(e.widget,!0)})},__selectItem:function(e,t){var n=null;if(this.__currentSelect>-1&&this.__widgets[this.__currentSelect].unselect(),this.__prevSelect=this.__currentSelect,this.__currentSelect=this.indexOf(e),e.select(),n={index:this.__currentSelect,label:e.getLabel(),value:e.getValue()},t&&this.trigger("menuitemclick",n),this.trigger("select",n),this.__prevSelect!==this.__currentSelect){var i=this.__widgets[this.__prevSelect]||null;this.trigger("change",{from:{index:this.__prevSelect,label:i&&i.getLabel(),value:i&&i.getValue()},to:{index:this.__currentSelect,label:e.getLabel(),value:e.getValue()}})}},__valid:function(e){return e instanceof n}})}},_p[51]={value:function(e){var t=_p.r(13),n=_p.r(30),i=_p.r(4);return t.createClass("Panel",{base:_p.r(39),constructor:function(e){var t={};e=i.extend({},t,e),this.callBase(e)},__render:function(){var e=null;this.callBase(),e=i('<div class="fui-panel-content"></div>'),this.__contentElement.appendChild(e[0]),this.__contentElement=e[0]},__initOptions:function(){this.callBase(),this.widgetName="Panel",this.__tpl=n}})}},_p[52]={value:function(e){var t=_p.r(13),n=_p.r(12),i=_p.r(4),r=_p.r(50);return t.createClass("PopupMenu",{base:_p.r(53),constructor:function(e){this.callBase(i.extend({menu:{}},e))},getMenuWidget:function(){return this.__menuWidget},__initOptions:function(){this.callBase(),this.widgetName="PopupMenu"},__render:function(){this.callBase(),this.__menuWidget=new r,this.appendWidget(this.__menuWidget),i(this.__element).addClass(n.classPrefix+"popup-menu")}})}},_p[53]={value:function(e){var t=_p.r(13),n=_p.r(12),i=_p.r(60),r=_p.r(49),o=_p.r(4);return t.createClass("Popup",{base:_p.r(54),constructor:function(e){var t={mask:{}};e=o.extend({},t,e),this.callBase(e)},open:function(){return this.__fire("open",function(){this.show()}),this},close:function(){return this.__fire("close",function(){this.hide()}),this},show:function(){return this.__target||(this.__target=this.__element.ownerDocument.body),this.__inDoc||(this.__inDoc=!0,this.appendTo(this.__element.ownerDocument.body)),this.__maskWidget.show(),this.callBase(),this.__openState=!0,this},hide:function(){return this.callBase(),this.__maskWidget.hide(),this.__openState=!1,this},toggle:function(){return this.isOpen()?this.close():this.open(),this},isOpen:function(){return this.__openState},__initOptions:function(){this.callBase(),this.widgetName="Popup",this.__target=this.__options.target,this.__layout=this.__options.layout,this.__inDoc=!1,this.__openState=!1,this.__maskWidget=null,this.__target instanceof i&&(this.__target=this.__target.getElement())},__render:function(){this.callBase(),o(this.__element).addClass(n.classPrefix+"popup"),this.__maskWidget=new r(this.__options.mask),this.__options.draggable&&this.__initDraggable(),this.__initMaskEvent()},__initMaskEvent:function(){var e=this;this.__maskWidget.on("click",function(){e.close()})}})}},_p[54]={value:function(e){var t=_p.r(13),n=_p.r(12),i=_p.r(60),r=n.layout,o=_p.r(4);return t.createClass("PPanel",{base:_p.r(51),constructor:function(e){var t={layout:r.BOTTOM,target:null,bound:null,diff:10,hide:!0,resize:"all",iframe:!1};e=o.extend({},t,e),this.callBase(e)},positionTo:function(e,t){return e instanceof i&&(e=e.getElement()),this.__target=e,t&&(this.__layout=t),this},show:function(){var e=null;return this.__target?(this.__options.bound||(this.__options.bound=this.__target.ownerDocument.body),e=this.__target.ownerDocument.documentElement,o.contains(e,this.__element)||this.__target.ownerDocument.body.appendChild(this.__element),o.contains(e,this.__target)&&(this.callBase(t.getMarker()),this.__position(),this.__resize()),this):this.callBase()},__initOptions:function(){this.callBase(),this.widgetName="PPanel",this.__target=this.__options.target,this.__layout=this.__options.layout,this.__height_resized=!1},__render:function(){this.callBase(),this.__options.iframe&&o('<iframe class="fui-ppanel-cover" frameborder="0"></iframe>').appendTo(this.__element),o(this.__element).addClass(n.classPrefix+"ppanel")},__position:function(){var e=null,t=n.classPrefix+"ppanel-position";o(this.__element).addClass(t),e=this.__getLocation(),o(this.__element).css("top",e.top+"px").css("left",e.left+"px")},__resize:function(){var e=t.getBound(this.__target);switch(this.__options.resize){case"all":this.__resizeWidth(e),this.__resizeHeight();break;case"width":this.__resizeWidth(e);break;case"height":this.__resizeHeight()}},__resizeWidth:function(e){if(this.__target){var t=o(this.__element),n=t.outerWidth(),i=t.outerHeight(),r=e.width-n-i;this.__element.style.minWidth=r+"px"}},__resizeHeight:function(){var e=null,n=null,i=0;n=t.getRect(this.__element),n.height=this.__element.scrollHeight,n.bottom=n.top+n.height,e=this.__getBoundRect(),i=n.bottom-e.bottom,i>0?(this.__height_resized=!0,i=n.height-i-this.__options.diff,o(this.__element).css("height",i+"px")):this.__height_resized&&(this.__element.style.height=null)},__getLocation:function(){var e=t.getBound(this.__target);switch(this.__layout){case r.CENTER:case r.MIDDLE:return this.__getCenterLayout(e);case r.LEFT:case r.RIGHT:case r.BOTTOM:case r.TOP:return this.__getOuterLayout(e);default:return this.__getInnerLayout(e)}return location},__getCenterLayout:function(e){var n={top:0,left:0},i=t.getRect(this.__element),r=0;return r=e.height-i.height,r>0&&(n.top=e.top+r/2),r=e.width-i.width,r>0&&(n.left=e.left+r/2),n},__getOuterLayout:function(e){var n={top:0,left:0},i=t.getRect(this.__element);switch(this.__layout){case r.TOP:n.left=e.left,n.top=e.top-i.height;break;case r.LEFT:n.top=e.top,n.left=e.left-i.width;break;case r.RIGHT:n.top=e.top,n.left=e.right;break;case r.BOTTOM:default:n.left=e.left,n.top=e.bottom}return n},__getInnerLayout:function(e){var n={top:0,left:0},i=e,o=t.getRect(this.__element);switch(this.__layout){case r.LEFT_TOP:n.top=i.top,n.left=i.left;break;case r.RIGHT_TOP:n.top=i.top,n.left=i.left+i.width-o.width;break;case r.LEFT_BOTTOM:n.top=i.top+i.height-o.height,n.left=i.left;break;case r.RIGHT_BOTTOM:n.top=i.top+i.height-o.height,n.left=i.left+i.width-o.width}return this.__correctionLocation(n)},__getBoundRect:function(){var e=-1,n=-1,i=null;return"body"===this.__options.bound.tagName.toLowerCase()?(i=t.getView(this.__options.bound),e=o(i).width(),n=o(i).height(),{top:0,left:0,right:e,bottom:n,width:e,height:n}):t.getRect(this.__options.bound)},__correctionLocation:function(e){var n=t.getRect(this.__element),i=t.getRect(this.__target),o=this.__getBoundRect();switch(this.__layout){case r.LEFT_TOP:case r.LEFT_BOTTOM:e.left+n.width>o.right&&(e.left+=i.width-n.width);break;case r.RIGHT_TOP:case r.RIGHT_BOTTOM:e.left<o.left&&(e.left=i.left)}return e}})}},_p[55]={value:function(e){var t=_p.r(4),n=_p.r(12),i=_p.r(51),r=_p.r(54),o=_p.r(37),a=_p.r(0),s=_p.r(49);return _p.r(13).createClass("SelectMenu",{base:i,constructor:function(e){var n={bed:{className:"fui-select-menu-bed"},button:{className:"fui-select-menu-btn"},events:["btnclick"],selected:-1};e=t.extend({},n,e),this.callBase(e)},show:function(){this.__widgetMenu.show(),this.__mask.show()},hide:function(){this.__widgetMenu.hide(),this.__mask.hide()},getValue:function(){var e=this.__widgets[this.__selected];return e?e.getValue():null},getSelected:function(){return this.__widgets[this.__selected]},select:function(e){var t=this.__widgets[e],n="fui-select-menu-selected",i=this.__selected,r=this.__widgets[this.__selected],o=this.__bed.getElement();return t?(r&&r.removeClass(n),o.innerHTML="",o.appendChild(t.cloneElement()),t.addClass(n),this.__selected=e,this.trigger("select",{index:e,widget:t}),this.__selected!==i&&this.trigger("change",{from:{index:i,widget:r},to:{index:e,widget:t}}),this):this},selectByWidget:function(e){return this.select(this.indexOf(e))},selectByValue:function(e){var n=-1;return t.each(this.__widgets,function(t,i){return i.getValue()===e?(n=t,!1):void 0}),this.select(n)},__render:function(){this.__bed=new i(this.__options.bed),this.__dropBtn=new o(this.__options.button),this.__widgetMenu=new r({className:"fui-select-menu-container",layout:n.layout.LEFT_TOP,column:this.__column}),this.__mask=new s;var e=this.__initWidgets();this.callBase(),t(this.__element).addClass(n.classPrefix+"select-menu"),this.appendWidgets([this.__bed,this.__dropBtn,this.__mask,this.__widgetMenu]),this.__widgets=[],this.__oldContentElement=this.__contentElement,this.__contentElement=this.__widgetMenu,this.appendWidgets(e),this.__widgetMenu.positionTo(this.getElement()),t.isNumeric(this.__options.selected)?-1!=this.__options.selected&&this.select(this.__options.selected):this.__bed.appendWidget(a.parse(this.__options.selected))},__initWidgets:function(){var e=[];if(this.__options.widgets)return t.each(this.__options.widgets,function(t,n){e.push(a.parse(n))}),e},__initEvent:function(){this.callBase();var e=this;this.__dropBtn.on("btnclick",function(){e.show()}),this.__mask.on("click",function(){e.hide()}),this.__widgetMenu.on(this.__options.events.join(" "),function(t){var n=t.target;if(n!==e.__oldContentElement&&n!==e.getElement)return t.stopPropagation(),e.selectByWidget(t.widget),e.hide(),!1})},__initOptions:function(){this.callBase(),this.widgetName="SelectMenu",this.__bed=null,this.__dropBtn=null,this.__widgetMenu=null,this.__mask=null,this.__widgets=[],this.__selected=-1,this.__oldContentElement=null,this.__column=this.__options.column,delete this.__options.column}})}},_p[56]={value:function(e){var t=_p.r(13),n=_p.r(31),i=_p.r(4);return t.createClass("Separator",{base:_p.r(60),constructor:function(e){var t={width:1,height:"100%",bgcolor:"#e1e1e1"};e=i.extend({},t,e),this.callBase(e)},__initOptions:function(){this.callBase(),this.widgetName="Separator",this.__tpl=n}})}},_p[57]={value:function(e){var t=_p.r(4),n=_p.r(12),i=_p.r(32),r=_p.r(37),o=_p.r(45),a=_p.r(51);return _p.r(13).createClass("SpinButton",{base:_p.r(60),constructor:function(e){var n={suffix:null,selected:-1,items:[]};e=t.extend({},n,e),this.callBase(e)},getValue:function(){return this.__options.items[this.__currentSelected]||null},setValue:function(e){},select:function(e){this.__update(e)},selectByValue:function(e){e+="",this.__update(t.inArray(e,this.__options.items))},__render:function(){this.callBase(),this.__buttons=[new r({className:n.classPrefix+"spin-up-btn"}),new r({className:n.classPrefix+"spin-down-btn"})],this.__inputWidget=new o,this.__panelWidget=new a({column:!0}),this.__inputWidget.appendTo(this.__element),this.__panelWidget.appendWidget(this.__buttons[0]),this.__panelWidget.appendWidget(this.__buttons[1]),this.__panelWidget.appendTo(this.__element),this.__initSelected(this.__options.selected)},__initEvent:function(){var e=this;this.callBase(),this.__buttons[0].on("btnclick",function(){e.__update(e.__currentSelected-1)}),this.__buttons[1].on("btnclick",function(){e.__update(e.__currentSelected+1)})},__initSelected:function(e){this.__update(e,!1)},__update:function(e,t){var n=-1,i=null,r=null;0>e||e>=this.__options.items.length||(n=this.__currentSelected,this.__currentSelected=e,r=this.__options.items[this.__currentSelected],i=r+" "+(this.__options.suffix||""),this.__inputWidget.setValue(i),t!==!1&&this.trigger("change",{from:this.__options.items[n]||null,to:r}))},__initOptions:function(){var e=this.__options.items;this.callBase(),this.widgetName="SpinButton",this.__tpl=i,this.__buttons=[],this.__panelWidget=null,this.__inputWidget=null,this.__currentSelected=-1,t.each(e,function(t,n){e[t]=n+""})}})}},_p[58]={value:function(e){var t=_p.r(4),n=_p.r(12),i=_p.r(33),r=_p.r(37),o=_p.r(51);return _p.r(13).createClass("Tabs",{base:_p.r(60),constructor:function(e){var n={selected:0,buttons:[],panels:[]};e=t.extend({},n,e),this.callBase(e)},getButtons:function(){return this.__btns},getButton:function(e){return this.getButtons()[e]||null},getButtonByValue:function(e){var n=null;return t.each(this.__btns,function(t,i){return i.getValue()===e?(n=i,!1):void 0}),n},getPanels:function(){return this.__panels},getPanel:function(e){return this.getPanels()[e]||null},getPanelByValue:function(e){var n=null;return t.each(this.__panels,function(t,i){return i.getValue()===e?(n=i,!1):void 0}),n},getSelectedIndex:function(){return this.__selected},getSelected:function(){var e=this.getSelectedIndex();return{button:this.getButton(e),panel:this.getPanel(e)}},appendTab:function(e){return e.panels=e.panels||[],this.__renderByOptions(e)},removeTab:function(e){if(0>e)return null;var t=this.__btns.splice(e,1),n=this.__panels.splice(e,1);return t.length?(t=t[0],n=n[0],t.remove(),n.remove(),{button:t,panel:n}):null},select:function(e){var t=null;return this.__selectItem(e)?(t=this.__getInfo(e),this.trigger("tabsselect",t),this.__prevSelected!==this.__selected&&this.trigger("tabschange",{from:this.__getInfo(this.__prevSelected),to:t}),this):this},getIndexByButton:function(e){return t.inArray(e,this.__btns)},appendButtonTo:function(e){t.each(this.__btns,function(t,n){n.appendTo(e)})},appendPanelTo:function(e){t.each(this.__panels,function(t,n){n.appendTo(e)})},__render:function(){this.callBase(),this.__btnWrap=t(".fui-tabs-button-wrap",this.__element)[0],this.__panelWrap=t(".fui-tabs-panel-wrap",this.__element)[0],this.__renderByOptions(this.__options),this.__selectItem(this.__options.selected)},__renderByOptions:function(e){var n=this,i=[],a=this.__btns,s=this.__panels,l=this.__btnWrap,u=this.__panelWrap;return t.each(e.buttons,function(t,c){var h=null,d=null;"object"!=typeof c&&(c={label:c}),h=new r(c),h.on("click",function(){n.select(n.getIndexByButton(this))}),c=e.panels[t]||{},c.hide=!0,d=new o(c),a.push(h),s.push(d),i.push({button:h,panel:d}),h.appendTo(l),d.appendTo(u)}),i},__initOptions:function(){this.callBase(),this.widgetName="Tabs",this.__tpl=i,this.__btns=[],this.__panels=[],this.__prevSelected=-1,this.__selected=-1,this.__btnWrap=null,this.__panelWrap=null,null===this.__options.panels&&(this.__options.panels=[],this.__options.panels.length=this.__options.buttons.length)},__selectItem:function(e){var t=this.getButton(e),i=this.getButton(this.__selected),r=n.classPrefix+"selected";return t?(i&&(i.removeClass(r),this.getPanel(this.__selected).hide()),t.addClass(r),this.getPanel(e).show(),this.__prevSelected=this.__selected,this.__selected=e,!0):!1},__getInfo:function(e){return{index:e,button:this.getButton(e),panel:this.getPanel(e)}}})}},_p[59]={value:function(e){var t=_p.r(4),n=_p.r(12);return _p.r(13).createClass("ToggleButton",{base:_p.r(37),constructor:function(e){var n={pressed:!1};e=t.extend({},n,e),this.callBase(e)},isPressed:function(){return this.__state},press:function(){
var e=n.classPrefix+"button-pressed";t(this.__element).addClass(e),this.__updateState(!0)},bounce:function(){var e=n.classPrefix+"button-pressed";t(this.__element).removeClass(e),this.__updateState(!1)},toggle:function(){this.__state?this.bounce():this.press()},__initOptions:function(){this.callBase(),this.widgetName="ToggleButton",this.__state=!1},__render:function(){return this.callBase(),t(this.__element).addClass(n.classPrefix+"toggle-button"),this.__initButtonState(),this},__initButtonState:function(){this.__options.pressed&&(t(this.__element).addClass(n.classPrefix+"button-pressed"),this.__state=!0)},__initEvent:function(){this.callBase(),this.on("click",function(){this.toggle()})},__updateState:function(e){e=!!e,this.__state=e,this.trigger("change",e,!e)}})}},_p[60]={value:function(e){function t(){return n+ ++i}var n="_fui_",i=0,r=_p.r(12),o=_p.r(11),a=_p.r(4),s=_p.r(13),l=s.createClass("Widget",{constructor:function(e){var t={id:null,className:"",disabled:!1,preventDefault:!1,text:"",value:null,hide:!1,width:null,height:null};this.__widgetType="widget",this.__tpl="",this.__compiledTpl="",this.__options={},this.__element=null,this.__allow_focus=!!r.allowFocus,this.widgetName="Widget",this.__extendOptions(t,e),this.__initOptions(),this.__render(),this.__initEvent(),this.__initWidgets&&this.__initWidgets()},getId:function(){return this.id},getValue:function(){return this.__options.value},getOptions:function(){return this.__options},setValue:function(e){return this.__options.value=e,this},show:function(){return this.__show(),this},hide:function(){return this.__hide(),this},addClass:function(e){return a(this.__element).addClass(e),this},removeClass:function(e){return a(this.__element).removeClass(e),this},setStyle:function(){return a.fn.css.apply(a(this.__element),arguments),this},getStyle:function(){return a.fn.css.apply(a(this.__element),arguments)},isDisabled:function(){return this.__options.disabled},enable:function(){return this.__options.disabled=!1,a(this.__element).removeClass(r.classPrefix+"disabled"),this},disable:function(){return this.__options.disabled=!0,a(this.__element).addClass(r.classPrefix+"disabled"),this},cloneElement:function(){return this.__element.cloneNode(!0)},getElement:function(){return this.__element},appendTo:function(e){if(s.isElement(e))e.appendChild(this.__element);else{if(!(e instanceof l))throw new Error("TypeError: Widget.appendTo()");e.__appendChild(this)}return this},remove:function(){var e=this.__element.parentNode;return e&&e.removeChild(this.__element),this},off:function(e,t){return a(this.__element).off(t&&t.__fui_listener),this},on:function(e,t){return this.__options.preventDefault||this.__on(e,t),this},__initOptions:function(){},__render:function(){var e=null,t=this.__tpl,n=this.__options,i=null;return this.id=this.__id(),o.__registerInstance(this),this.__compiledTpl=s.Tpl.compile(t,n),this.__element=a(this.__compiledTpl)[0],this.__element.setAttribute("id",this.id),e=a(this.__element),n.disabled&&e.addClass(r.classPrefix+"disabled"),e.addClass(r.classPrefix+"widget"),i=n.className,i.length>0&&(a.isArray(i)?e.addClass(i.join(" ")):e.addClass(i)),this.__initBasicEnv(),n.hide&&this.__hide(),n.style&&this.setStyle(n.style),this},__appendChild:function(e){return this.__element.appendChild(e.getElement())},__initEvent:function(){this.on("mousedown",function(e){var t=e.target.tagName.toLowerCase();r.control[t]||this.__allowFocus()?e.stopPropagation():e.preventDefault()})},__on:function(e,t){var n=this;return t.__fui_listener=function(e,i){for(var r=[],o=0,a=arguments.length;a>o;o++)1!==o&&r.push(arguments[o]);return e.widget=i,n.isDisabled()?void 0:t.apply(n,r)},a(this.__element).on(e,t.__fui_listener),this},trigger:function(e,t){return this.__options.preventDefault||this.__trigger.apply(this,arguments),this},__allowShowTitle:function(){return!0},__allowFocus:function(){return!!this.__allow_focus},__trigger:function(e,t){var n=[].slice.call(arguments,1);return a(this.__element).trigger(e,[this].concat(n)),this},__triggerHandler:function(e,t){var n=[this].concat([].slice.call(arguments,1));return a(this.__element).triggerHandler(e,n)},__fire:function(e,t){var n={cancel:!1};return/^(before|after)/.test(e)?this:(this.__trigger("before"+e,n),n.cancel===!0?this:(n=t.call(this,e),this.__trigger(e),this.__trigger("after"+e,n),this))},__extendOptions:function(){var e=[{},this.__options],t=[!0];e=e.concat([].slice.call(arguments,0));for(var n=0,i=e.length;i>n;n++)"string"!=typeof e[n]&&t.push(e[n]);this.__options=a.extend.apply(a,t)},__hide:function(){a(this.__element).addClass(r.classPrefix+"hide")},__show:function(){a(this.__element).removeClass(r.classPrefix+"hide")},__initBasicEnv:function(){this.__options.text&&this.__allowShowTitle()&&this.__element.setAttribute("title",this.__options.text),this.__options.width&&(this.__element.style.width=this.__options.width+"px"),this.__options.height&&(this.__element.style.height=this.__options.height+"px"),this.widgetName&&this.__element.setAttribute("rule",this.widgetName)},__id:function(){return this.__options.id||t()}});return l}},_p[61]={value:function(e){_p.r(1),_p.r(2)}};var moduleMapping={"fui.export":61};use("fui.export")}(),function(e){function t(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e}function n(){Error.apply(this,arguments)}function i(e){if(Error.call(this,e),"object"==typeof e)for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);else this.detail=e}function r(e,t){this.id=e,this.username=t}function o(e){this.content=e,e instanceof Blob?this.type=u.file.TYPE_BLOB:"string"==typeof e?this.type=u.file.TYPE_TEXT:"object"==typeof e?this.type=u.file.TYPE_JSON:this.type=u.file.TYPE_UNKNOWN}function a(e){this.setPath(e),this.isDir=!1,this.data=null,this.size=0,this.createTime=new Date,this.modifyTime=new Date}function s(e,t,n){this.user=e,this.file=t,this.access=n||0}function l(e,t,n){this.path=e,this.method=t,this.user=n,this.dupPolicy=u.file.DUP_FAIL,this.newPath=null,this.acl=null,this.extra=null,this.dataType=u.file.TYPE_TEXT}var u={version:"1.0"};u.provider={},u.file={},u.user={};var c={},h=null,d=function(){return new e.resolve(null)},f={check:d,login:d,logout:d,init:d,current:d};t(n,Error),t(i,Error),u.AuthError=n,u.FileRequestError=i,a.prototype.setPath=function(e){u.file.anlysisPath(e,this)},u.file.anlysisPath=function(e,t){t=t||{};for(var n=e.split("/");"/"==n[0]||""===n[0];)n.shift();for(;"/"==n[n.length-1]||""===n[n.length-1];)n.pop();if(t.filename=n.pop()||null,n.length?t.parentPath="/"+n.join("/")+"/":t.parentPath=t.filename?"/":null,t.filename){var i=t.filename.split(".");i.length>1?t.extension="."+i.pop():t.extension=null,t.name=i.join("."),t.path=t.parentPath+t.filename}else t.path="/";return t},u.user.User=r,u.file.Data=o,u.file.File=a,u.file.Acl=s,u.file.FileRequest=l,u.file.TYPE_TEXT="text",u.file.TYPE_JSON="json",u.file.TYPE_BLOB="blob",u.file.TYPE_UNKNOWN="unknown",u.file.METHOD_READ="read",u.file.METHOD_WRITE="write",u.file.METHOD_LIST="list",u.file.METHOD_MOVE="move",u.file.METHOD_DELETE="delete",u.file.METHOD_MKDIR="mkdir",u.file.METHOD_ACL_READ="readAcl",u.file.METHOD_ACL_WRITE="writeAcl",u.file.DUP_OVERWRITE="overwrite",u.file.DUP_FAIL="fail",u.file.DUP_RENAME="rename",u.file.ACCESS_PUBLIC=1,u.file.ACCESS_READ=2,u.file.ACCESS_WRITE=4,u.file.ACCESS_CREATE=8,u.file.ACCESS_DELETE=16,u.file.ACCESS_ACL_READ=32,u.file.ACCESS_ACL_WRITE=64,u.file.ACCESS_ALL=65534,u.provider.register=function(e,t){if(c[e]=t,h||(h=t),"function"!=typeof t.handle)throw new Error("Not implement: provider.handle()")},u.provider.use=function(e){h=c[e]},u.provider.init=function(e,t){var n=c[e];return n&&"function"==typeof n.init?n.init.call(n,t):null},u.user.impl=function(e){f=e},["check","login","logout","init","current"].forEach(function(e){u.user[e]=function(){return f[e].apply(f,arguments)}}),["read","write","list","move","delete","mkdir","readAcl","writeAcl"].forEach(function(t){u.file[t]=function(n){return u.user.check().then(function(i){var r=n.provider?c[n.provider]:h,o=new l(n.path,t,i);"read"==t&&(o.dataType=n.dataType||u.file.TYPE_TEXT),"write"==t&&(o.dupPolicy=n.ondup,o.data=new u.file.Data(n.content),delete n.ondup),"move"==t&&(o.dupPolicy=n.ondup,o.newPath=n.newPath,delete n.newPath),"writeAcl"==t&&(o.acl=n.acl,delete n.acl),delete n.provider,delete n.path,o.extra=n;var a=r.handle(o);return e.resolve(a)})}}),window.fio=u}(Promise),function(e,t){function n(e){d=e.apiKey||d}function i(e){return new Promise(function(n,i){t.ajax(e).done(n).fail(i)})}function r(){for(var e,t=g.current,n=/[&\?#](\w+?)=([^&]+)/g,i={};e=n.exec(t);)i[e[1]]=e[2];return i}function o(){var e=document.cookie,t=new RegExp(d+"_ak=(.*?)(;|$)"),n=t.exec(e);return n&&decodeURIComponent(n[1])||null}function a(e,t){var n=d+"_ak="+encodeURIComponent(e);n+="; max-age="+(t||60),document.cookie=n}function s(){document.cookie=d+"_ak="}function l(){return p}function u(){function e(){return new Promise(function(e,t){function n(){return clearTimeout(a),!r&&o.length&&(a=setTimeout(n,o.shift())),i({url:g.getLoggedInUser,data:{access_token:f},dataType:"jsonp"}).then(function(t){clearTimeout(a),r||e(t),r=!0})}var r=!1,o=[1e3,2e3,3e3],a=0;n()})}if(p&&+new Date-p.validateTime<36e5)return Promise.resolve(p);if(u.pendingRequest)return u.pendingRequest;var t=r();return t.access_token?(a(t.access_token,t.state),document.location.href=g.current.substr(0,document.location.href.indexOf("#")),u.pendingRequest=new Promise(function(){})):(f=o())?u.pendingRequest=e().then(function(e){return e.error_code?(f=null,s(),null):(p=new fio.user.User(e.uid,e.uname),p.smallImage="http://tb.himg.baidu.com/sys/portraitn/item/"+e.portrait,p.largeImage="http://tb.himg.baidu.com/sys/portrait/item/"+e.portrait,p.access_token=f,p.validateTime=+new Date,u.pendingRequest=null,p)}):Promise.resolve(null)}function c(t){return e.location.href=g.authorize+"?"+["client_id="+d,"response_type=token","scope=basic netdisk","redirect_uri="+(t.redirectUrl||g.current),"display=page","force_login="+(t&&t.force?1:0),"state="+(t.remember||60)].join("&"),new Promise(function(){})}function h(){var e=p;return p=null,f=null,s(),Promise.resolve(e)}var d,f,p,g={authorize:"https://openapi.baidu.com/oauth/2.0/authorize",getLoggedInUser:"https://openapi.baidu.com/rest/2.0/passport/users/getLoggedInUser",current:e.location.href};fio.user.impl({check:u,login:c,logout:h,init:n,current:l})}(window,jQuery),function(e,t){function n(e){return e.cache=!1,new Promise(function(n,i){t.ajax(e).done(n).fail(i)})}function i(e){return new Promise(function(t){setTimeout(function(){t()},e)})}function r(e){var t=new fio.file.File(e.path);return t.createTime=new Date(1e3*e.ctime),t.modifyTime=new Date(1e3*e.mtime),t.size=e.size,t.isDir=!!e.isdir,t.provider="netdisk",t}function o(e){function t(){return n({url:s.file,data:{method:"meta",access_token:r,path:e},dataType:"json"})["catch"](function(e){if(t.retry++>2)throw e;return new Promise(function(e){setTimeout(function(){e(t())},200*t.retry)})})}var i=fio.user.current(),r=i&&i.access_token;if(!r)throw new Error("Not Authorized");return t.retry=0,t()}function a(a){function l(){function t(t){if(e.console.warn("PCS Fail("+ ++g+"): ",{request:a,error:t}),p--)return i(1e3*g).then(l);throw t.requestMethod=a.method,t.requestPath=a.path,t.requestUser=a.user&&a.user.username||null,t.requestParam=h,a.dataType&&(t.requestDataType=a.dataType),t}function s(e){function t(e){return e.list[0]}if(e.error_code)throw new fio.FileRequestError(e);if(a.method===fio.file.METHOD_READ)return o(h.path).then(t).then(r).then(function(t){return t.data=new fio.file.Data(e),t});if(a.method==fio.file.METHOD_LIST)return e.list.map(r);if(a.method==fio.file.METHOD_MOVE)return new Promise(function(n){setTimeout(function(){n(o(e.extra.list[0].to).then(t).then(r))},200)});if(a.method==fio.file.METHOD_DELETE)return new fio.file.File(a.path);var n=r(e);return a.method===fio.file.METHOD_WRITE&&(n.data=a.data),n}function u(e){var n=e.responseText,i={readyState:e.readyState,status:e.status,statusText:e.statusText,headers:e.getAllResponseHeaders(),responseText:n};if(n)try{i.detail=JSON.parse(n)}catch(r){}return t(new fio.FileRequestError(i))}return n(d).then(s,u)}var u=fio.user.current(),c=u&&u.access_token;if(!c)throw new Error("Not Authorized");var h={},d={url:s.file,type:"GET",dataType:"JSON"};switch(a.method){case fio.file.METHOD_ACL_READ:case fio.file.METHOD_ACL_WRITE:throw new Error("Not Supported File Request:"+a.method);case fio.file.METHOD_READ:d.dataType=a.dataType,h.method="download";break;case fio.file.METHOD_WRITE:d.type="POST",h.method="upload",h.ondup=a.dupPolicy==fio.file.DUP_OVERWRITE?"overwrite":"newcopy";var f=new FormData;a.data.type==fio.file.TYPE_BLOB?f.append("file",a.data.content):f.append("file",new Blob([a.data.content],{type:"text/plain"})),d.data=f,d.processData=!1,d.contentType=!1;break;case fio.file.METHOD_LIST:h.method="list";break;case fio.file.METHOD_MKDIR:d.type="POST",h.method="mkdir";break;case fio.file.METHOD_MOVE:d.type="POST",h.method="move",h.to=a.newPath,a.dupPolicy==fio.file.DUP_RENAME&&(h.ondup="newcopy");break;case fio.file.METHOD_DELETE:d.type="POST",h.method="delete"}a.method==fio.file.METHOD_MOVE?h.from=a.path:h.path=a.path,d.url+="?"+t.param(h)+"&access_token="+c;var p=void 0===a.extra.retry?3:parseInt(a.extra.retry,10),g=0;return l()}var s={file:"https://pcs.baidu.com/rest/2.0/pcs/file"};fio.provider.register("netdisk",{handle:a})}(window,jQuery),function(){function e(e){this.tokens=[],this.tokens.links={},this.options=e||u.defaults,this.rules=c.normal,this.options.gfm&&(this.options.tables?this.rules=c.tables:this.rules=c.gfm)}function t(e,t){if(this.options=t||u.defaults,this.links=e,this.rules=h.normal,this.renderer=this.options.renderer||new n,this.renderer.options=this.options,!this.links)throw new Error("Tokens array requires a `links` property.");this.options.gfm?this.options.breaks?this.rules=h.breaks:this.rules=h.gfm:this.options.pedantic&&(this.rules=h.pedantic)}function n(e){this.options=e||{}}function i(e){this.tokens=[],this.token=null,this.options=e||u.defaults,this.options.renderer=this.options.renderer||new n,this.renderer=this.options.renderer,this.renderer.options=this.options}function r(e,t){return e.replace(t?/&/g:/&(?!#?\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function o(e){return e.replace(/&([#\w]+);/g,function(e,t){return t=t.toLowerCase(),"colon"===t?":":"#"===t.charAt(0)?"x"===t.charAt(1)?String.fromCharCode(parseInt(t.substring(2),16)):String.fromCharCode(+t.substring(1)):""})}function a(e,t){return e=e.source,t=t||"",function n(i,r){return i?(r=r.source||r,r=r.replace(/(^|[^\[])\^/g,"$1"),e=e.replace(i,r),n):new RegExp(e,t)}}function s(){}function l(e){for(var t,n,i=1;i<arguments.length;i++){t=arguments[i];for(n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}function u(t,n,o){if(o||"function"==typeof n){o||(o=n,n=null),n=l({},u.defaults,n||{});var a,s,c=n.highlight,h=0;try{a=e.lex(t,n)}catch(d){return o(d)}s=a.length;var f=function(e){if(e)return n.highlight=c,o(e);var t;try{t=i.parse(a,n)}catch(r){e=r}return n.highlight=c,e?o(e):o(null,t)};if(!c||c.length<3)return f();if(delete n.highlight,!s)return f();for(;h<a.length;h++)!function(e){return"code"!==e.type?--s||f():c(e.text,e.lang,function(t,n){return t?f(t):null==n||n===e.text?--s||f():(e.text=n,e.escaped=!0,void(--s||f()))})}(a[h])}else try{return n&&(n=l({},u.defaults,n)),i.parse(e.lex(t,n),n)}catch(d){if(d.message+="\nPlease report this to https://github.com/chjj/marked.",(n||u.defaults).silent)return"<p>An error occured:</p><pre>"+r(d.message+"",!0)+"</pre>";throw d}}var c={newline:/^\n+/,code:/^( {4}[^\n]+\n*)+/,fences:s,hr:/^( *[-*_]){3,} *(?:\n+|$)/,heading:/^ *(#{1,6}) *([^\n]+?) *#* *(?:\n+|$)/,nptable:s,lheading:/^([^\n]+)\n *(=|-){2,} *(?:\n+|$)/,blockquote:/^( *>[^\n]+(\n(?!def)[^\n]+)*\n*)+/,list:/^( *)(bull) [\s\S]+?(?:hr|def|\n{2,}(?! )(?!\1bull )\n*|\s*$)/,html:/^ *(?:comment *(?:\n|\s*$)|closed *(?:\n{2,}|\s*$)|closing *(?:\n{2,}|\s*$))/,def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +["(]([^\n]+)[")])? *(?:\n+|$)/,table:s,paragraph:/^((?:[^\n]+\n?(?!hr|heading|lheading|blockquote|tag|def))+)\n*/,text:/^[^\n]+/};c.bullet=/(?:[*+-]|\d+\.)/,c.item=/^( *)(bull) [^\n]*(?:\n(?!\1bull )[^\n]*)*/,c.item=a(c.item,"gm")(/bull/g,c.bullet)(),c.list=a(c.list)(/bull/g,c.bullet)("hr","\\n+(?=\\1?(?:[-*_] *){3,}(?:\\n+|$))")("def","\\n+(?="+c.def.source+")")(),c.blockquote=a(c.blockquote)("def",c.def)(),c._tag="(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:/|[^\\w\\s@]*@)\\b",c.html=a(c.html)("comment",/<!--[\s\S]*?-->/)("closed",/<(tag)[\s\S]+?<\/\1>/)("closing",/<tag(?:"[^"]*"|'[^']*'|[^'">])*?>/)(/tag/g,c._tag)(),c.paragraph=a(c.paragraph)("hr",c.hr)("heading",c.heading)("lheading",c.lheading)("blockquote",c.blockquote)("tag","<"+c._tag)("def",c.def)(),c.normal=l({},c),c.gfm=l({},c.normal,{fences:/^ *(`{3,}|~{3,}) *(\S+)? *\n([\s\S]+?)\s*\1 *(?:\n+|$)/,paragraph:/^/}),c.gfm.paragraph=a(c.paragraph)("(?!","(?!"+c.gfm.fences.source.replace("\\1","\\2")+"|"+c.list.source.replace("\\1","\\3")+"|")(),c.tables=l({},c.gfm,{nptable:/^ *(\S.*\|.*)\n *([-:]+ *\|[-| :]*)\n((?:.*\|.*(?:\n|$))*)\n*/,table:/^ *\|(.+)\n *\|( *[-:]+[-| :]*)\n((?: *\|.*(?:\n|$))*)\n*/}),e.rules=c,e.lex=function(t,n){var i=new e(n);return i.lex(t)},e.prototype.lex=function(e){return e=e.replace(/\r\n|\r/g,"\n").replace(/\t/g,"    ").replace(/\u00a0/g," ").replace(/\u2424/g,"\n"),this.token(e,!0)},e.prototype.token=function(e,t,n){for(var i,r,o,a,s,l,u,h,d,e=e.replace(/^ +$/gm,"");e;)if((o=this.rules.newline.exec(e))&&(e=e.substring(o[0].length),o[0].length>1&&this.tokens.push({type:"space"})),o=this.rules.code.exec(e))e=e.substring(o[0].length),o=o[0].replace(/^ {4}/gm,""),this.tokens.push({type:"code",text:this.options.pedantic?o:o.replace(/\n+$/,"")});else if(o=this.rules.fences.exec(e))e=e.substring(o[0].length),this.tokens.push({type:"code",lang:o[2],text:o[3]});else if(o=this.rules.heading.exec(e))e=e.substring(o[0].length),this.tokens.push({type:"heading",depth:o[1].length,text:o[2]});else if(t&&(o=this.rules.nptable.exec(e))){for(e=e.substring(o[0].length),l={type:"table",header:o[1].replace(/^ *| *\| *$/g,"").split(/ *\| */),align:o[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:o[3].replace(/\n$/,"").split("\n")},h=0;h<l.align.length;h++)/^ *-+: *$/.test(l.align[h])?l.align[h]="right":/^ *:-+: *$/.test(l.align[h])?l.align[h]="center":/^ *:-+ *$/.test(l.align[h])?l.align[h]="left":l.align[h]=null;for(h=0;h<l.cells.length;h++)l.cells[h]=l.cells[h].split(/ *\| */);this.tokens.push(l)}else if(o=this.rules.lheading.exec(e))e=e.substring(o[0].length),this.tokens.push({type:"heading",depth:"="===o[2]?1:2,text:o[1]});else if(o=this.rules.hr.exec(e))e=e.substring(o[0].length),this.tokens.push({type:"hr"});else if(o=this.rules.blockquote.exec(e))e=e.substring(o[0].length),this.tokens.push({type:"blockquote_start"}),o=o[0].replace(/^ *> ?/gm,""),this.token(o,t,!0),this.tokens.push({type:"blockquote_end"});else if(o=this.rules.list.exec(e)){for(e=e.substring(o[0].length),a=o[2],this.tokens.push({type:"list_start",ordered:a.length>1}),o=o[0].match(this.rules.item),i=!1,d=o.length,h=0;d>h;h++)l=o[h],u=l.length,l=l.replace(/^ *([*+-]|\d+\.) +/,""),~l.indexOf("\n ")&&(u-=l.length,l=this.options.pedantic?l.replace(/^ {1,4}/gm,""):l.replace(new RegExp("^ {1,"+u+"}","gm"),"")),this.options.smartLists&&h!==d-1&&(s=c.bullet.exec(o[h+1])[0],a===s||a.length>1&&s.length>1||(e=o.slice(h+1).join("\n")+e,h=d-1)),r=i||/\n\n(?!\s*$)/.test(l),h!==d-1&&(i="\n"===l.charAt(l.length-1),r||(r=i)),this.tokens.push({type:r?"loose_item_start":"list_item_start"}),this.token(l,!1,n),this.tokens.push({type:"list_item_end"});this.tokens.push({type:"list_end"})}else if(o=this.rules.html.exec(e))e=e.substring(o[0].length),this.tokens.push({type:this.options.sanitize?"paragraph":"html",pre:"pre"===o[1]||"script"===o[1]||"style"===o[1],text:o[0]});else if(!n&&t&&(o=this.rules.def.exec(e)))e=e.substring(o[0].length),this.tokens.links[o[1].toLowerCase()]={href:o[2],title:o[3]};else if(t&&(o=this.rules.table.exec(e))){for(e=e.substring(o[0].length),l={type:"table",header:o[1].replace(/^ *| *\| *$/g,"").split(/ *\| */),align:o[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:o[3].replace(/(?: *\| *)?\n$/,"").split("\n")},h=0;h<l.align.length;h++)/^ *-+: *$/.test(l.align[h])?l.align[h]="right":/^ *:-+: *$/.test(l.align[h])?l.align[h]="center":/^ *:-+ *$/.test(l.align[h])?l.align[h]="left":l.align[h]=null;for(h=0;h<l.cells.length;h++)l.cells[h]=l.cells[h].replace(/^ *\| *| *\| *$/g,"").split(/ *\| */);this.tokens.push(l)}else if(t&&(o=this.rules.paragraph.exec(e)))e=e.substring(o[0].length),this.tokens.push({type:"paragraph",text:"\n"===o[1].charAt(o[1].length-1)?o[1].slice(0,-1):o[1]});else if(o=this.rules.text.exec(e))e=e.substring(o[0].length),this.tokens.push({type:"text",text:o[0]});else if(e)throw new Error("Infinite loop on byte: "+e.charCodeAt(0));return this.tokens};var h={escape:/^\\([\\`*{}\[\]()#+\-.!_>])/,autolink:/^<([^ >]+(@|:\/)[^ >]+)>/,url:s,tag:/^<!--[\s\S]*?-->|^<\/?\w+(?:"[^"]*"|'[^']*'|[^'">])*?>/,link:/^!?\[(inside)\]\(href\)/,reflink:/^!?\[(inside)\]\s*\[([^\]]*)\]/,nolink:/^!?\[((?:\[[^\]]*\]|[^\[\]])*)\]/,strong:/^__([\s\S]+?)__(?!_)|^\*\*([\s\S]+?)\*\*(?!\*)/,em:/^\b_((?:__|[\s\S])+?)_\b|^\*((?:\*\*|[\s\S])+?)\*(?!\*)/,code:/^(`+)\s*([\s\S]*?[^`])\s*\1(?!`)/,br:/^ {2,}\n(?!\s*$)/,del:s,text:/^[\s\S]+?(?=[\\<!\[_*`]| {2,}\n|$)/};h._inside=/(?:\[[^\]]*\]|[^\[\]]|\](?=[^\[]*\]))*/,h._href=/\s*<?([\s\S]*?)>?(?:\s+['"]([\s\S]*?)['"])?\s*/,h.link=a(h.link)("inside",h._inside)("href",h._href)(),h.reflink=a(h.reflink)("inside",h._inside)(),h.normal=l({},h),h.pedantic=l({},h.normal,{strong:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,em:/^_(?=\S)([\s\S]*?\S)_(?!_)|^\*(?=\S)([\s\S]*?\S)\*(?!\*)/}),h.gfm=l({},h.normal,{escape:a(h.escape)("])","~|])")(),url:/^(https?:\/\/[^\s<]+[^<.,:;"')\]\s])/,del:/^~~(?=\S)([\s\S]*?\S)~~/,text:a(h.text)("]|","~]|")("|","|https?://|")()}),h.breaks=l({},h.gfm,{br:a(h.br)("{2,}","*")(),text:a(h.gfm.text)("{2,}","*")()}),t.rules=h,t.output=function(e,n,i){var r=new t(n,i);return r.output(e)},t.prototype.output=function(e){for(var t,n,i,o,a="";e;)if(o=this.rules.escape.exec(e))e=e.substring(o[0].length),a+=o[1];else if(o=this.rules.autolink.exec(e))e=e.substring(o[0].length),"@"===o[2]?(n=":"===o[1].charAt(6)?this.mangle(o[1].substring(7)):this.mangle(o[1]),i=this.mangle("mailto:")+n):(n=r(o[1]),i=n),a+=this.renderer.link(i,null,n);else if(this.inLink||!(o=this.rules.url.exec(e))){if(o=this.rules.tag.exec(e))!this.inLink&&/^<a /i.test(o[0])?this.inLink=!0:this.inLink&&/^<\/a>/i.test(o[0])&&(this.inLink=!1),e=e.substring(o[0].length),a+=this.options.sanitize?r(o[0]):o[0];else if(o=this.rules.link.exec(e))e=e.substring(o[0].length),this.inLink=!0,a+=this.outputLink(o,{href:o[2],title:o[3]}),this.inLink=!1;else if((o=this.rules.reflink.exec(e))||(o=this.rules.nolink.exec(e))){if(e=e.substring(o[0].length),t=(o[2]||o[1]).replace(/\s+/g," "),t=this.links[t.toLowerCase()],!t||!t.href){a+=o[0].charAt(0),e=o[0].substring(1)+e;continue}this.inLink=!0,a+=this.outputLink(o,t),this.inLink=!1}else if(o=this.rules.strong.exec(e))e=e.substring(o[0].length),a+=this.renderer.strong(this.output(o[2]||o[1]));else if(o=this.rules.em.exec(e))e=e.substring(o[0].length),a+=this.renderer.em(this.output(o[2]||o[1]));else if(o=this.rules.code.exec(e))e=e.substring(o[0].length),a+=this.renderer.codespan(r(o[2],!0));else if(o=this.rules.br.exec(e))e=e.substring(o[0].length),a+=this.renderer.br();else if(o=this.rules.del.exec(e))e=e.substring(o[0].length),a+=this.renderer.del(this.output(o[1]));else if(o=this.rules.text.exec(e))e=e.substring(o[0].length),a+=r(this.smartypants(o[0]));else if(e)throw new Error("Infinite loop on byte: "+e.charCodeAt(0))}else e=e.substring(o[0].length),n=r(o[1]),i=n,a+=this.renderer.link(i,null,n);return a},t.prototype.outputLink=function(e,t){var n=r(t.href),i=t.title?r(t.title):null;return"!"!==e[0].charAt(0)?this.renderer.link(n,i,this.output(e[1])):this.renderer.image(n,i,r(e[1]))},t.prototype.smartypants=function(e){return this.options.smartypants?e.replace(/--/g,"—").replace(/(^|[-\u2014\/(\[{"\s])'/g,"$1‘").replace(/'/g,"’").replace(/(^|[-\u2014\/(\[{\u2018\s])"/g,"$1“").replace(/"/g,"”").replace(/\.{3}/g,"…"):e},t.prototype.mangle=function(e){for(var t,n="",i=e.length,r=0;i>r;r++)t=e.charCodeAt(r),Math.random()>.5&&(t="x"+t.toString(16)),n+="&#"+t+";";return n},n.prototype.code=function(e,t,n){if(this.options.highlight){var i=this.options.highlight(e,t);null!=i&&i!==e&&(n=!0,e=i)}return t?'<pre><code class="'+this.options.langPrefix+r(t,!0)+'">'+(n?e:r(e,!0))+"\n</code></pre>\n":"<pre><code>"+(n?e:r(e,!0))+"\n</code></pre>"},n.prototype.blockquote=function(e){return"<blockquote>\n"+e+"</blockquote>\n"},n.prototype.html=function(e){return e},n.prototype.heading=function(e,t,n){return"<h"+t+' id="'+this.options.headerPrefix+n.toLowerCase().replace(/[^\w]+/g,"-")+'">'+e+"</h"+t+">\n"},n.prototype.hr=function(){return this.options.xhtml?"<hr/>\n":"<hr>\n"},n.prototype.list=function(e,t){var n=t?"ol":"ul";return"<"+n+">\n"+e+"</"+n+">\n"},n.prototype.listitem=function(e){return"<li>"+e+"</li>\n"},n.prototype.paragraph=function(e){return"<p>"+e+"</p>\n"},n.prototype.table=function(e,t){return"<table>\n<thead>\n"+e+"</thead>\n<tbody>\n"+t+"</tbody>\n</table>\n"},n.prototype.tablerow=function(e){return"<tr>\n"+e+"</tr>\n"},n.prototype.tablecell=function(e,t){var n=t.header?"th":"td",i=t.align?"<"+n+' style="text-align:'+t.align+'">':"<"+n+">";return i+e+"</"+n+">\n"},n.prototype.strong=function(e){return"<strong>"+e+"</strong>"},n.prototype.em=function(e){return"<em>"+e+"</em>"},n.prototype.codespan=function(e){return"<code>"+e+"</code>"},n.prototype.br=function(){return this.options.xhtml?"<br/>":"<br>"},n.prototype.del=function(e){return"<del>"+e+"</del>"},n.prototype.link=function(e,t,n){if(this.options.sanitize){try{var i=decodeURIComponent(o(e)).replace(/[^\w:]/g,"").toLowerCase()}catch(r){return""}if(0===i.indexOf("javascript:"))return""}var a='<a href="'+e+'"';return t&&(a+=' title="'+t+'"'),a+=">"+n+"</a>"},n.prototype.image=function(e,t,n){var i='<img src="'+e+'" alt="'+n+'"';return t&&(i+=' title="'+t+'"'),i+=this.options.xhtml?"/>":">"},i.parse=function(e,t,n){var r=new i(t,n);return r.parse(e)},i.prototype.parse=function(e){this.inline=new t(e.links,this.options,this.renderer),this.tokens=e.reverse();for(var n="";this.next();)n+=this.tok();return n},i.prototype.next=function(){return this.token=this.tokens.pop()},i.prototype.peek=function(){return this.tokens[this.tokens.length-1]||0},i.prototype.parseText=function(){for(var e=this.token.text;"text"===this.peek().type;)e+="\n"+this.next().text;return this.inline.output(e)},i.prototype.tok=function(){switch(this.token.type){case"space":return"";case"hr":return this.renderer.hr();case"heading":return this.renderer.heading(this.inline.output(this.token.text),this.token.depth,this.token.text);case"code":return this.renderer.code(this.token.text,this.token.lang,this.token.escaped);case"table":var e,t,n,i,r,o="",a="";for(n="",e=0;e<this.token.header.length;e++)i={header:!0,align:this.token.align[e]},n+=this.renderer.tablecell(this.inline.output(this.token.header[e]),{header:!0,align:this.token.align[e]});for(o+=this.renderer.tablerow(n),e=0;e<this.token.cells.length;e++){for(t=this.token.cells[e],n="",r=0;r<t.length;r++)n+=this.renderer.tablecell(this.inline.output(t[r]),{header:!1,align:this.token.align[r]});a+=this.renderer.tablerow(n)}return this.renderer.table(o,a);case"blockquote_start":for(var a="";"blockquote_end"!==this.next().type;)a+=this.tok();return this.renderer.blockquote(a);case"list_start":for(var a="",s=this.token.ordered;"list_end"!==this.next().type;)a+=this.tok();return this.renderer.list(a,s);case"list_item_start":for(var a="";"list_item_end"!==this.next().type;)a+="text"===this.token.type?this.parseText():this.tok();return this.renderer.listitem(a);case"loose_item_start":for(var a="";"list_item_end"!==this.next().type;)a+=this.tok();return this.renderer.listitem(a);case"html":var l=this.token.pre||this.options.pedantic?this.token.text:this.inline.output(this.token.text);return this.renderer.html(l);case"paragraph":return this.renderer.paragraph(this.inline.output(this.token.text));case"text":return this.renderer.paragraph(this.parseText())}},s.exec=s,u.options=u.setOptions=function(e){return l(u.defaults,e),u},u.defaults={gfm:!0,tables:!0,breaks:!1,pedantic:!1,sanitize:!1,smartLists:!1,silent:!1,highlight:null,langPrefix:"lang-",smartypants:!1,headerPrefix:"",renderer:new n,xhtml:!1},u.Parser=i,u.parser=i.parse,u.Renderer=n,u.Lexer=e,u.lexer=e.lex,u.InlineLexer=t,u.inlineLexer=t.output,u.parse=u,"undefined"!=typeof module&&"object"==typeof exports?module.exports=u:"function"==typeof define&&define.amd?define(function(){return u}):this.marked=u}.call(function(){return this||("undefined"!=typeof window?window:global)}()),function(e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else{if("function"==typeof define&&define.amd)return define([],e);this.CodeMirror=e()}}(function(){"use strict";function e(n,i){if(!(this instanceof e))return new e(n,i);this.options=i=i?gr(i):{},gr(Io,i,!1),p(i);var r=i.value;"string"==typeof r&&(r=new ia(r,i.mode)),this.doc=r;var o=this.display=new t(n,r);o.wrapper.CodeMirror=this,c(this),l(this),i.lineWrapping&&(this.display.wrapper.className+=" CodeMirror-wrap"),i.autofocus&&!uo&&St(this),this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:!1,focused:!1,suppressEdits:!1,pasteIncoming:!1,cutIncoming:!1,draggingText:!1,highlight:new lr},Jr&&11>Zr&&setTimeout(mr(Ct,this,!0),20),Lt(this),Pr(),Ze(this),this.curOp.forceUpdate=!0,Ei(this,r),i.autofocus&&!uo||Cr()==o.input?setTimeout(mr(Qt,this),20):Jt(this);for(var a in Oo)Oo.hasOwnProperty(a)&&Oo[a](this,i[a],Do);b(this);for(var s=0;s<Wo.length;++s)Wo[s](this);tt(this)}function t(e,t){var n=this,i=n.input=br("textarea",null,null,"position: absolute; padding: 0; width: 1px; height: 1em; outline: none");eo?i.style.width="1000px":i.setAttribute("wrap","off"),lo&&(i.style.border="1px solid black"),i.setAttribute("autocorrect","off"),i.setAttribute("autocapitalize","off"),i.setAttribute("spellcheck","false"),n.inputDiv=br("div",[i],null,"overflow: hidden; position: relative; width: 3px; height: 0px;"),n.scrollbarH=br("div",[br("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar"),n.scrollbarV=br("div",[br("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar"),n.scrollbarFiller=br("div",null,"CodeMirror-scrollbar-filler"),n.gutterFiller=br("div",null,"CodeMirror-gutter-filler"),n.lineDiv=br("div",null,"CodeMirror-code"),n.selectionDiv=br("div",null,null,"position: relative; z-index: 1"),n.cursorDiv=br("div",null,"CodeMirror-cursors"),n.measure=br("div",null,"CodeMirror-measure"),n.lineMeasure=br("div",null,"CodeMirror-measure"),n.lineSpace=br("div",[n.measure,n.lineMeasure,n.selectionDiv,n.cursorDiv,n.lineDiv],null,"position: relative; outline: none"),n.mover=br("div",[br("div",[n.lineSpace],"CodeMirror-lines")],null,"position: relative"),n.sizer=br("div",[n.mover],"CodeMirror-sizer"),n.heightForcer=br("div",null,null,"position: absolute; height: "+fa+"px; width: 1px;"),n.gutters=br("div",null,"CodeMirror-gutters"),n.lineGutter=null,n.scroller=br("div",[n.sizer,n.heightForcer,n.gutters],"CodeMirror-scroll"),n.scroller.setAttribute("tabIndex","-1"),n.wrapper=br("div",[n.inputDiv,n.scrollbarH,n.scrollbarV,n.scrollbarFiller,n.gutterFiller,n.scroller],"CodeMirror"),Jr&&8>Zr&&(n.gutters.style.zIndex=-1,n.scroller.style.paddingRight=0),lo&&(i.style.width="0px"),eo||(n.scroller.draggable=!0),oo&&(n.inputDiv.style.height="1px",n.inputDiv.style.position="absolute"),Jr&&8>Zr&&(n.scrollbarH.style.minHeight=n.scrollbarV.style.minWidth="18px"),
e.appendChild?e.appendChild(n.wrapper):e(n.wrapper),n.viewFrom=n.viewTo=t.first,n.view=[],n.externalMeasured=null,n.viewOffset=0,n.lastSizeC=0,n.updateLineNumbers=null,n.lineNumWidth=n.lineNumInnerWidth=n.lineNumChars=null,n.prevInput="",n.alignWidgets=!1,n.pollingFast=!1,n.poll=new lr,n.cachedCharWidth=n.cachedTextHeight=n.cachedPaddingH=null,n.inaccurateSelection=!1,n.maxLine=null,n.maxLineLength=0,n.maxLineChanged=!1,n.wheelDX=n.wheelDY=n.wheelStartX=n.wheelStartY=null,n.shift=!1,n.selForContextMenu=null}function n(t){t.doc.mode=e.getMode(t.options,t.doc.modeOption),i(t)}function i(e){e.doc.iter(function(e){e.stateAfter&&(e.stateAfter=null),e.styles&&(e.styles=null)}),e.doc.frontier=e.doc.first,xe(e,100),e.state.modeGen++,e.curOp&&pt(e)}function r(e){e.options.lineWrapping?(Mr(e.display.wrapper,"CodeMirror-wrap"),e.display.sizer.style.minWidth=""):(Tr(e.display.wrapper,"CodeMirror-wrap"),f(e)),a(e),pt(e),He(e),setTimeout(function(){v(e)},100)}function o(e){var t=Qe(e.display),n=e.options.lineWrapping,i=n&&Math.max(5,e.display.scroller.clientWidth/Je(e.display)-3);return function(r){if(ni(e.doc,r))return 0;var o=0;if(r.widgets)for(var a=0;a<r.widgets.length;a++)r.widgets[a].height&&(o+=r.widgets[a].height);return n?o+(Math.ceil(r.text.length/i)||1)*t:o+t}}function a(e){var t=e.doc,n=o(e);t.iter(function(e){var t=n(e);t!=e.height&&Ii(e,t)})}function s(e){var t=Fo[e.options.keyMap],n=t.style;e.display.wrapper.className=e.display.wrapper.className.replace(/\s*cm-keymap-\S+/g,"")+(n?" cm-keymap-"+n:"")}function l(e){e.display.wrapper.className=e.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+e.options.theme.replace(/(^|\s)\s*/g," cm-s-"),He(e)}function u(e){c(e),pt(e),setTimeout(function(){_(e)},20)}function c(e){var t=e.display.gutters,n=e.options.gutters;wr(t);for(var i=0;i<n.length;++i){var r=n[i],o=t.appendChild(br("div",null,"CodeMirror-gutter "+r));"CodeMirror-linenumbers"==r&&(e.display.lineGutter=o,o.style.width=(e.display.lineNumWidth||1)+"px")}t.style.display=i?"":"none",h(e)}function h(e){var t=e.display.gutters.offsetWidth;e.display.sizer.style.marginLeft=t+"px",e.display.scrollbarH.style.left=e.options.fixedGutter?t+"px":0}function d(e){if(0==e.height)return 0;for(var t,n=e.text.length,i=e;t=Xn(i);){var r=t.find(0,!0);i=r.from.line,n+=r.from.ch-r.to.ch}for(i=e;t=Yn(i);){var r=t.find(0,!0);n-=i.text.length-r.from.ch,i=r.to.line,n+=i.text.length-r.to.ch}return n}function f(e){var t=e.display,n=e.doc;t.maxLine=Pi(n,n.first),t.maxLineLength=d(t.maxLine),t.maxLineChanged=!0,n.iter(function(e){var n=d(e);n>t.maxLineLength&&(t.maxLineLength=n,t.maxLine=e)})}function p(e){var t=dr(e.gutters,"CodeMirror-linenumbers");-1==t&&e.lineNumbers?e.gutters=e.gutters.concat(["CodeMirror-linenumbers"]):t>-1&&!e.lineNumbers&&(e.gutters=e.gutters.slice(0),e.gutters.splice(t,1))}function g(e){return e.display.scroller.clientHeight-e.display.wrapper.clientHeight<fa-3}function m(e){var t=e.display.scroller;return{clientHeight:t.clientHeight,barHeight:e.display.scrollbarV.clientHeight,scrollWidth:t.scrollWidth,clientWidth:t.clientWidth,hScrollbarTakesSpace:g(e),barWidth:e.display.scrollbarH.clientWidth,docHeight:Math.round(e.doc.height+Me(e.display))}}function v(e,t){t||(t=m(e));var n=e.display,i=Ar(n.measure),r=t.docHeight+fa,o=t.scrollWidth>t.clientWidth;o&&t.scrollWidth<=t.clientWidth+1&&i>0&&!t.hScrollbarTakesSpace&&(o=!1);var a=r>t.clientHeight;if(a?(n.scrollbarV.style.display="block",n.scrollbarV.style.bottom=o?i+"px":"0",n.scrollbarV.firstChild.style.height=Math.max(0,r-t.clientHeight+(t.barHeight||n.scrollbarV.clientHeight))+"px"):(n.scrollbarV.style.display="",n.scrollbarV.firstChild.style.height="0"),o?(n.scrollbarH.style.display="block",n.scrollbarH.style.right=a?i+"px":"0",n.scrollbarH.firstChild.style.width=t.scrollWidth-t.clientWidth+(t.barWidth||n.scrollbarH.clientWidth)+"px"):(n.scrollbarH.style.display="",n.scrollbarH.firstChild.style.width="0"),o&&a?(n.scrollbarFiller.style.display="block",n.scrollbarFiller.style.height=n.scrollbarFiller.style.width=i+"px"):n.scrollbarFiller.style.display="",o&&e.options.coverGutterNextToScrollbar&&e.options.fixedGutter?(n.gutterFiller.style.display="block",n.gutterFiller.style.height=i+"px",n.gutterFiller.style.width=n.gutters.offsetWidth+"px"):n.gutterFiller.style.display="",!e.state.checkedOverlayScrollbar&&t.clientHeight>0){if(0===i){var s=co&&!ao?"12px":"18px";n.scrollbarV.style.minWidth=n.scrollbarH.style.minHeight=s;var l=function(t){er(t)!=n.scrollbarV&&er(t)!=n.scrollbarH&&ut(e,At)(t)};ua(n.scrollbarV,"mousedown",l),ua(n.scrollbarH,"mousedown",l)}e.state.checkedOverlayScrollbar=!0}}function y(e,t,n){var i=n&&null!=n.top?Math.max(0,n.top):e.scroller.scrollTop;i=Math.floor(i-Te(e));var r=n&&null!=n.bottom?n.bottom:i+e.wrapper.clientHeight,o=Di(t,i),a=Di(t,r);if(n&&n.ensure){var s=n.ensure.from.line,l=n.ensure.to.line;if(o>s)return{from:s,to:Di(t,Bi(Pi(t,s))+e.wrapper.clientHeight)};if(Math.min(l,t.lastLine())>=a)return{from:Di(t,Bi(Pi(t,l))-e.wrapper.clientHeight),to:l}}return{from:o,to:Math.max(a,o+1)}}function _(e){var t=e.display,n=t.view;if(t.alignWidgets||t.gutters.firstChild&&e.options.fixedGutter){for(var i=x(t)-t.scroller.scrollLeft+e.doc.scrollLeft,r=t.gutters.offsetWidth,o=i+"px",a=0;a<n.length;a++)if(!n[a].hidden){e.options.fixedGutter&&n[a].gutter&&(n[a].gutter.style.left=o);var s=n[a].alignable;if(s)for(var l=0;l<s.length;l++)s[l].style.left=o}e.options.fixedGutter&&(t.gutters.style.left=i+r+"px")}}function b(e){if(!e.options.lineNumbers)return!1;var t=e.doc,n=w(e.options,t.first+t.size-1),i=e.display;if(n.length!=i.lineNumChars){var r=i.measure.appendChild(br("div",[br("div",n)],"CodeMirror-linenumber CodeMirror-gutter-elt")),o=r.firstChild.offsetWidth,a=r.offsetWidth-o;return i.lineGutter.style.width="",i.lineNumInnerWidth=Math.max(o,i.lineGutter.offsetWidth-a),i.lineNumWidth=i.lineNumInnerWidth+a,i.lineNumChars=i.lineNumInnerWidth?n.length:-1,i.lineGutter.style.width=i.lineNumWidth+"px",h(e),!0}return!1}function w(e,t){return String(e.lineNumberFormatter(t+e.firstLineNumber))}function x(e){return e.scroller.getBoundingClientRect().left-e.sizer.getBoundingClientRect().left}function k(e,t,n){var i=e.display;this.viewport=t,this.visible=y(i,e.doc,t),this.editorIsHidden=!i.wrapper.offsetWidth,this.wrapperHeight=i.wrapper.clientHeight,this.oldViewFrom=i.viewFrom,this.oldViewTo=i.viewTo,this.oldScrollerWidth=i.scroller.clientWidth,this.force=n,this.dims=N(e)}function C(e,t){var n=e.display,i=e.doc;if(t.editorIsHidden)return mt(e),!1;if(!t.force&&t.visible.from>=n.viewFrom&&t.visible.to<=n.viewTo&&(null==n.updateLineNumbers||n.updateLineNumbers>=n.viewTo)&&0==bt(e))return!1;b(e)&&(mt(e),t.dims=N(e));var r=i.first+i.size,o=Math.max(t.visible.from-e.options.viewportMargin,i.first),a=Math.min(r,t.visible.to+e.options.viewportMargin);n.viewFrom<o&&o-n.viewFrom<20&&(o=Math.max(i.first,n.viewFrom)),n.viewTo>a&&n.viewTo-a<20&&(a=Math.min(r,n.viewTo)),vo&&(o=ei(e.doc,o),a=ti(e.doc,a));var s=o!=n.viewFrom||a!=n.viewTo||n.lastSizeC!=t.wrapperHeight;_t(e,o,a),n.viewOffset=Bi(Pi(e.doc,n.viewFrom)),e.display.mover.style.top=n.viewOffset+"px";var l=bt(e);if(!s&&0==l&&!t.force&&(null==n.updateLineNumbers||n.updateLineNumbers>=n.viewTo))return!1;var u=Cr();return l>4&&(n.lineDiv.style.display="none"),A(e,n.updateLineNumbers,t.dims),l>4&&(n.lineDiv.style.display=""),u&&Cr()!=u&&u.offsetHeight&&u.focus(),wr(n.cursorDiv),wr(n.selectionDiv),s&&(n.lastSizeC=t.wrapperHeight,xe(e,400)),n.updateLineNumbers=null,!0}function S(e,t){for(var n=t.force,i=t.viewport,r=!0;;r=!1){if(r&&e.options.lineWrapping&&t.oldScrollerWidth!=e.display.scroller.clientWidth)n=!0;else if(n=!1,i&&null!=i.top&&(i={top:Math.min(e.doc.height+Me(e.display)-fa-e.display.scroller.clientHeight,i.top)}),t.visible=y(e.display,e.doc,i),t.visible.from>=e.display.viewFrom&&t.visible.to<=e.display.viewTo)break;if(!C(e,t))break;E(e);var o=m(e);ye(e),M(e,o),v(e,o)}nr(e,"update",e),(e.display.viewFrom!=t.oldViewFrom||e.display.viewTo!=t.oldViewTo)&&nr(e,"viewportChange",e,e.display.viewFrom,e.display.viewTo)}function T(e,t){var n=new k(e,t);if(C(e,n)){E(e),S(e,n);var i=m(e);ye(e),M(e,i),v(e,i)}}function M(e,t){e.display.sizer.style.minHeight=e.display.heightForcer.style.top=t.docHeight+"px",e.display.gutters.style.height=Math.max(t.docHeight,t.clientHeight-fa)+"px"}function L(e,t){e.display.sizer.offsetWidth+e.display.gutters.offsetWidth<e.display.scroller.clientWidth-1&&(e.display.sizer.style.minHeight=e.display.heightForcer.style.top="0px",e.display.gutters.style.height=t.docHeight+"px")}function E(e){for(var t=e.display,n=t.lineDiv.offsetTop,i=0;i<t.view.length;i++){var r,o=t.view[i];if(!o.hidden){if(Jr&&8>Zr){var a=o.node.offsetTop+o.node.offsetHeight;r=a-n,n=a}else{var s=o.node.getBoundingClientRect();r=s.bottom-s.top}var l=o.line.height-r;if(2>r&&(r=Qe(t)),(l>.001||-.001>l)&&(Ii(o.line,r),P(o.line),o.rest))for(var u=0;u<o.rest.length;u++)P(o.rest[u])}}}function P(e){if(e.widgets)for(var t=0;t<e.widgets.length;++t)e.widgets[t].height=e.widgets[t].node.offsetHeight}function N(e){for(var t=e.display,n={},i={},r=t.gutters.clientLeft,o=t.gutters.firstChild,a=0;o;o=o.nextSibling,++a)n[e.options.gutters[a]]=o.offsetLeft+o.clientLeft+r,i[e.options.gutters[a]]=o.clientWidth;return{fixedPos:x(t),gutterTotalWidth:t.gutters.offsetWidth,gutterLeft:n,gutterWidth:i,wrapperWidth:t.wrapper.clientWidth}}function A(e,t,n){function i(t){var n=t.nextSibling;return eo&&co&&e.display.currentWheelTarget==t?t.style.display="none":t.parentNode.removeChild(t),n}for(var r=e.display,o=e.options.lineNumbers,a=r.lineDiv,s=a.firstChild,l=r.view,u=r.viewFrom,c=0;c<l.length;c++){var h=l[c];if(h.hidden);else if(h.node){for(;s!=h.node;)s=i(s);var d=o&&null!=t&&u>=t&&h.lineNumber;h.changes&&(dr(h.changes,"gutter")>-1&&(d=!1),I(e,h,u,n)),d&&(wr(h.lineNumber),h.lineNumber.appendChild(document.createTextNode(w(e.options,u)))),s=h.node.nextSibling}else{var f=U(e,h,u,n);a.insertBefore(f,s)}u+=h.size}for(;s;)s=i(s)}function I(e,t,n,i){for(var r=0;r<t.changes.length;r++){var o=t.changes[r];"text"==o?R(e,t):"gutter"==o?W(e,t,n,i):"class"==o?z(t):"widget"==o&&H(t,i)}t.changes=null}function O(e){return e.node==e.text&&(e.node=br("div",null,null,"position: relative"),e.text.parentNode&&e.text.parentNode.replaceChild(e.node,e.text),e.node.appendChild(e.text),Jr&&8>Zr&&(e.node.style.zIndex=2)),e.node}function D(e){var t=e.bgClass?e.bgClass+" "+(e.line.bgClass||""):e.line.bgClass;if(t&&(t+=" CodeMirror-linebackground"),e.background)t?e.background.className=t:(e.background.parentNode.removeChild(e.background),e.background=null);else if(t){var n=O(e);e.background=n.insertBefore(br("div",null,t),n.firstChild)}}function B(e,t){var n=e.display.externalMeasured;return n&&n.line==t.line?(e.display.externalMeasured=null,t.measure=n.measure,n.built):vi(e,t)}function R(e,t){var n=t.text.className,i=B(e,t);t.text==t.node&&(t.node=i.pre),t.text.parentNode.replaceChild(i.pre,t.text),t.text=i.pre,i.bgClass!=t.bgClass||i.textClass!=t.textClass?(t.bgClass=i.bgClass,t.textClass=i.textClass,z(t)):n&&(t.text.className=n)}function z(e){D(e),e.line.wrapClass?O(e).className=e.line.wrapClass:e.node!=e.text&&(e.node.className="");var t=e.textClass?e.textClass+" "+(e.line.textClass||""):e.line.textClass;e.text.className=t||""}function W(e,t,n,i){t.gutter&&(t.node.removeChild(t.gutter),t.gutter=null);var r=t.line.gutterMarkers;if(e.options.lineNumbers||r){var o=O(t),a=t.gutter=o.insertBefore(br("div",null,"CodeMirror-gutter-wrapper","position: absolute; left: "+(e.options.fixedGutter?i.fixedPos:-i.gutterTotalWidth)+"px"),t.text);if(!e.options.lineNumbers||r&&r["CodeMirror-linenumbers"]||(t.lineNumber=a.appendChild(br("div",w(e.options,n),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+i.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+e.display.lineNumInnerWidth+"px"))),r)for(var s=0;s<e.options.gutters.length;++s){var l=e.options.gutters[s],u=r.hasOwnProperty(l)&&r[l];u&&a.appendChild(br("div",[u],"CodeMirror-gutter-elt","left: "+i.gutterLeft[l]+"px; width: "+i.gutterWidth[l]+"px"))}}}function H(e,t){e.alignable&&(e.alignable=null);for(var n,i=e.node.firstChild;i;i=n){var n=i.nextSibling;"CodeMirror-linewidget"==i.className&&e.node.removeChild(i)}V(e,t)}function U(e,t,n,i){var r=B(e,t);return t.text=t.node=r.pre,r.bgClass&&(t.bgClass=r.bgClass),r.textClass&&(t.textClass=r.textClass),z(t),W(e,t,n,i),V(t,i),t.node}function V(e,t){if(j(e.line,e,t,!0),e.rest)for(var n=0;n<e.rest.length;n++)j(e.rest[n],e,t,!1)}function j(e,t,n,i){if(e.widgets)for(var r=O(t),o=0,a=e.widgets;o<a.length;++o){var s=a[o],l=br("div",[s.node],"CodeMirror-linewidget");s.handleMouseEvents||(l.ignoreEvents=!0),F(s,l,t,n),i&&s.above?r.insertBefore(l,t.gutter||t.text):r.appendChild(l),nr(s,"redraw")}}function F(e,t,n,i){if(e.noHScroll){(n.alignable||(n.alignable=[])).push(t);var r=i.wrapperWidth;t.style.left=i.fixedPos+"px",e.coverGutter||(r-=i.gutterTotalWidth,t.style.paddingLeft=i.gutterTotalWidth+"px"),t.style.width=r+"px"}e.coverGutter&&(t.style.zIndex=5,t.style.position="relative",e.noHScroll||(t.style.marginLeft=-i.gutterTotalWidth+"px"))}function $(e){return yo(e.line,e.ch)}function K(e,t){return _o(e,t)<0?t:e}function q(e,t){return _o(e,t)<0?e:t}function G(e,t){this.ranges=e,this.primIndex=t}function X(e,t){this.anchor=e,this.head=t}function Y(e,t){var n=e[t];e.sort(function(e,t){return _o(e.from(),t.from())}),t=dr(e,n);for(var i=1;i<e.length;i++){var r=e[i],o=e[i-1];if(_o(o.to(),r.from())>=0){var a=q(o.from(),r.from()),s=K(o.to(),r.to()),l=o.empty()?r.from()==r.head:o.from()==o.head;t>=i&&--t,e.splice(--i,2,new X(l?s:a,l?a:s))}}return new G(e,t)}function Q(e,t){return new G([new X(e,t||e)],0)}function J(e,t){return Math.max(e.first,Math.min(t,e.first+e.size-1))}function Z(e,t){if(t.line<e.first)return yo(e.first,0);var n=e.first+e.size-1;return t.line>n?yo(n,Pi(e,n).text.length):ee(t,Pi(e,t.line).text.length)}function ee(e,t){var n=e.ch;return null==n||n>t?yo(e.line,t):0>n?yo(e.line,0):e}function te(e,t){return t>=e.first&&t<e.first+e.size}function ne(e,t){for(var n=[],i=0;i<t.length;i++)n[i]=Z(e,t[i]);return n}function ie(e,t,n,i){if(e.cm&&e.cm.display.shift||e.extend){var r=t.anchor;if(i){var o=_o(n,r)<0;o!=_o(i,r)<0?(r=n,n=i):o!=_o(n,i)<0&&(n=i)}return new X(r,n)}return new X(i||n,n)}function re(e,t,n,i){ce(e,new G([ie(e,e.sel.primary(),t,n)],0),i)}function oe(e,t,n){for(var i=[],r=0;r<e.sel.ranges.length;r++)i[r]=ie(e,e.sel.ranges[r],t[r],null);var o=Y(i,e.sel.primIndex);ce(e,o,n)}function ae(e,t,n,i){var r=e.sel.ranges.slice(0);r[t]=n,ce(e,Y(r,e.sel.primIndex),i)}function se(e,t,n,i){ce(e,Q(t,n),i)}function le(e,t){var n={ranges:t.ranges,update:function(t){this.ranges=[];for(var n=0;n<t.length;n++)this.ranges[n]=new X(Z(e,t[n].anchor),Z(e,t[n].head))}};return ha(e,"beforeSelectionChange",e,n),e.cm&&ha(e.cm,"beforeSelectionChange",e.cm,n),n.ranges!=t.ranges?Y(n.ranges,n.ranges.length-1):t}function ue(e,t,n){var i=e.history.done,r=hr(i);r&&r.ranges?(i[i.length-1]=t,he(e,t,n)):ce(e,t,n)}function ce(e,t,n){he(e,t,n),Fi(e,e.sel,e.cm?e.cm.curOp.id:NaN,n)}function he(e,t,n){(ar(e,"beforeSelectionChange")||e.cm&&ar(e.cm,"beforeSelectionChange"))&&(t=le(e,t));var i=n&&n.bias||(_o(t.primary().head,e.sel.primary().head)<0?-1:1);de(e,pe(e,t,i,!0)),n&&n.scroll===!1||!e.cm||_n(e.cm)}function de(e,t){t.equals(e.sel)||(e.sel=t,e.cm&&(e.cm.curOp.updateInput=e.cm.curOp.selectionChanged=!0,or(e.cm)),nr(e,"cursorActivity",e))}function fe(e){de(e,pe(e,e.sel,null,!1),ga)}function pe(e,t,n,i){for(var r,o=0;o<t.ranges.length;o++){var a=t.ranges[o],s=ge(e,a.anchor,n,i),l=ge(e,a.head,n,i);(r||s!=a.anchor||l!=a.head)&&(r||(r=t.ranges.slice(0,o)),r[o]=new X(s,l))}return r?Y(r,t.primIndex):t}function ge(e,t,n,i){var r=!1,o=t,a=n||1;e.cantEdit=!1;e:for(;;){var s=Pi(e,o.line);if(s.markedSpans)for(var l=0;l<s.markedSpans.length;++l){var u=s.markedSpans[l],c=u.marker;if((null==u.from||(c.inclusiveLeft?u.from<=o.ch:u.from<o.ch))&&(null==u.to||(c.inclusiveRight?u.to>=o.ch:u.to>o.ch))){if(i&&(ha(c,"beforeCursorEnter"),c.explicitlyCleared)){if(s.markedSpans){--l;continue}break}if(!c.atomic)continue;var h=c.find(0>a?-1:1);if(0==_o(h,o)&&(h.ch+=a,h.ch<0?h=h.line>e.first?Z(e,yo(h.line-1)):null:h.ch>s.text.length&&(h=h.line<e.first+e.size-1?yo(h.line+1,0):null),!h)){if(r)return i?(e.cantEdit=!0,yo(e.first,0)):ge(e,t,n,!0);r=!0,h=t,a=-a}o=h;continue e}}return o}}function me(e){for(var t=e.display,n=e.doc,i={},r=i.cursors=document.createDocumentFragment(),o=i.selection=document.createDocumentFragment(),a=0;a<n.sel.ranges.length;a++){var s=n.sel.ranges[a],l=s.empty();(l||e.options.showCursorWhenSelecting)&&_e(e,s,r),l||be(e,s,o)}if(e.options.moveInputWithCursor){var u=Ke(e,n.sel.primary().head,"div"),c=t.wrapper.getBoundingClientRect(),h=t.lineDiv.getBoundingClientRect();i.teTop=Math.max(0,Math.min(t.wrapper.clientHeight-10,u.top+h.top-c.top)),i.teLeft=Math.max(0,Math.min(t.wrapper.clientWidth-10,u.left+h.left-c.left))}return i}function ve(e,t){xr(e.display.cursorDiv,t.cursors),xr(e.display.selectionDiv,t.selection),null!=t.teTop&&(e.display.inputDiv.style.top=t.teTop+"px",e.display.inputDiv.style.left=t.teLeft+"px")}function ye(e){ve(e,me(e))}function _e(e,t,n){var i=Ke(e,t.head,"div",null,null,!e.options.singleCursorHeightPerLine),r=n.appendChild(br("div"," ","CodeMirror-cursor"));if(r.style.left=i.left+"px",r.style.top=i.top+"px",r.style.height=Math.max(0,i.bottom-i.top)*e.options.cursorHeight+"px",i.other){var o=n.appendChild(br("div"," ","CodeMirror-cursor CodeMirror-secondarycursor"));o.style.display="",o.style.left=i.other.left+"px",o.style.top=i.other.top+"px",o.style.height=.85*(i.other.bottom-i.other.top)+"px"}}function be(e,t,n){function i(e,t,n,i){0>t&&(t=0),t=Math.round(t),i=Math.round(i),s.appendChild(br("div",null,"CodeMirror-selected","position: absolute; left: "+e+"px; top: "+t+"px; width: "+(null==n?c-e:n)+"px; height: "+(i-t)+"px"))}function r(t,n,r){function o(n,i){return $e(e,yo(t,n),"div",h,i)}var s,l,h=Pi(a,t),d=h.text.length;return Br(Ri(h),n||0,null==r?d:r,function(e,t,a){var h,f,p,g=o(e,"left");if(e==t)h=g,f=p=g.left;else{if(h=o(t-1,"right"),"rtl"==a){var m=g;g=h,h=m}f=g.left,p=h.right}null==n&&0==e&&(f=u),h.top-g.top>3&&(i(f,g.top,null,g.bottom),f=u,g.bottom<h.top&&i(f,g.bottom,null,h.top)),null==r&&t==d&&(p=c),(!s||g.top<s.top||g.top==s.top&&g.left<s.left)&&(s=g),(!l||h.bottom>l.bottom||h.bottom==l.bottom&&h.right>l.right)&&(l=h),u+1>f&&(f=u),i(f,h.top,p-f,h.bottom)}),{start:s,end:l}}var o=e.display,a=e.doc,s=document.createDocumentFragment(),l=Le(e.display),u=l.left,c=o.lineSpace.offsetWidth-l.right,h=t.from(),d=t.to();if(h.line==d.line)r(h.line,h.ch,d.ch);else{var f=Pi(a,h.line),p=Pi(a,d.line),g=Jn(f)==Jn(p),m=r(h.line,h.ch,g?f.text.length+1:null).end,v=r(d.line,g?0:null,d.ch).start;g&&(m.top<v.top-2?(i(m.right,m.top,null,m.bottom),i(u,v.top,v.left,v.bottom)):i(m.right,m.top,v.left-m.right,m.bottom)),m.bottom<v.top&&i(u,m.bottom,null,v.top)}n.appendChild(s)}function we(e){if(e.state.focused){var t=e.display;clearInterval(t.blinker);var n=!0;t.cursorDiv.style.visibility="",e.options.cursorBlinkRate>0?t.blinker=setInterval(function(){t.cursorDiv.style.visibility=(n=!n)?"":"hidden"},e.options.cursorBlinkRate):e.options.cursorBlinkRate<0&&(t.cursorDiv.style.visibility="hidden")}}function xe(e,t){e.doc.mode.startState&&e.doc.frontier<e.display.viewTo&&e.state.highlight.set(t,mr(ke,e))}function ke(e){var t=e.doc;if(t.frontier<t.first&&(t.frontier=t.first),!(t.frontier>=e.display.viewTo)){var n=+new Date+e.options.workTime,i=Uo(t.mode,Se(e,t.frontier)),r=[];t.iter(t.frontier,Math.min(t.first+t.size,e.display.viewTo+500),function(o){if(t.frontier>=e.display.viewFrom){var a=o.styles,s=fi(e,o,i,!0);o.styles=s.styles;var l=o.styleClasses,u=s.classes;u?o.styleClasses=u:l&&(o.styleClasses=null);for(var c=!a||a.length!=o.styles.length||l!=u&&(!l||!u||l.bgClass!=u.bgClass||l.textClass!=u.textClass),h=0;!c&&h<a.length;++h)c=a[h]!=o.styles[h];c&&r.push(t.frontier),o.stateAfter=Uo(t.mode,i)}else gi(e,o.text,i),o.stateAfter=t.frontier%5==0?Uo(t.mode,i):null;return++t.frontier,+new Date>n?(xe(e,e.options.workDelay),!0):void 0}),r.length&&lt(e,function(){for(var t=0;t<r.length;t++)gt(e,r[t],"text")})}}function Ce(e,t,n){for(var i,r,o=e.doc,a=n?-1:t-(e.doc.mode.innerMode?1e3:100),s=t;s>a;--s){if(s<=o.first)return o.first;var l=Pi(o,s-1);if(l.stateAfter&&(!n||s<=o.frontier))return s;var u=ya(l.text,null,e.options.tabSize);(null==r||i>u)&&(r=s-1,i=u)}return r}function Se(e,t,n){var i=e.doc,r=e.display;if(!i.mode.startState)return!0;var o=Ce(e,t,n),a=o>i.first&&Pi(i,o-1).stateAfter;return a=a?Uo(i.mode,a):Vo(i.mode),i.iter(o,t,function(n){gi(e,n.text,a);var s=o==t-1||o%5==0||o>=r.viewFrom&&o<r.viewTo;n.stateAfter=s?Uo(i.mode,a):null,++o}),n&&(i.frontier=o),a}function Te(e){return e.lineSpace.offsetTop}function Me(e){return e.mover.offsetHeight-e.lineSpace.offsetHeight}function Le(e){if(e.cachedPaddingH)return e.cachedPaddingH;var t=xr(e.measure,br("pre","x")),n=window.getComputedStyle?window.getComputedStyle(t):t.currentStyle,i={left:parseInt(n.paddingLeft),right:parseInt(n.paddingRight)};return isNaN(i.left)||isNaN(i.right)||(e.cachedPaddingH=i),i}function Ee(e,t,n){var i=e.options.lineWrapping,r=i&&e.display.scroller.clientWidth;if(!t.measure.heights||i&&t.measure.width!=r){var o=t.measure.heights=[];if(i){t.measure.width=r;for(var a=t.text.firstChild.getClientRects(),s=0;s<a.length-1;s++){var l=a[s],u=a[s+1];Math.abs(l.bottom-u.bottom)>2&&o.push((l.bottom+u.top)/2-n.top)}}o.push(n.bottom-n.top)}}function Pe(e,t,n){if(e.line==t)return{map:e.measure.map,cache:e.measure.cache};for(var i=0;i<e.rest.length;i++)if(e.rest[i]==t)return{map:e.measure.maps[i],cache:e.measure.caches[i]};for(var i=0;i<e.rest.length;i++)if(Oi(e.rest[i])>n)return{map:e.measure.maps[i],cache:e.measure.caches[i],before:!0}}function Ne(e,t){t=Jn(t);var n=Oi(t),i=e.display.externalMeasured=new dt(e.doc,t,n);i.lineN=n;var r=i.built=vi(e,i);return i.text=r.pre,xr(e.display.lineMeasure,r.pre),i}function Ae(e,t,n,i){return De(e,Oe(e,t),n,i)}function Ie(e,t){if(t>=e.display.viewFrom&&t<e.display.viewTo)return e.display.view[vt(e,t)];var n=e.display.externalMeasured;return n&&t>=n.lineN&&t<n.lineN+n.size?n:void 0}function Oe(e,t){var n=Oi(t),i=Ie(e,n);i&&!i.text?i=null:i&&i.changes&&I(e,i,n,N(e)),i||(i=Ne(e,t));var r=Pe(i,t,n);return{line:t,view:i,rect:null,map:r.map,cache:r.cache,before:r.before,hasHeights:!1}}function De(e,t,n,i,r){t.before&&(n=-1);var o,a=n+(i||"");return t.cache.hasOwnProperty(a)?o=t.cache[a]:(t.rect||(t.rect=t.view.text.getBoundingClientRect()),t.hasHeights||(Ee(e,t.view,t.rect),t.hasHeights=!0),o=Be(e,t,n,i),o.bogus||(t.cache[a]=o)),{left:o.left,right:o.right,top:r?o.rtop:o.top,bottom:r?o.rbottom:o.bottom}}function Be(e,t,n,i){for(var r,o,a,s,l=t.map,u=0;u<l.length;u+=3){var c=l[u],h=l[u+1];if(c>n?(o=0,a=1,s="left"):h>n?(o=n-c,a=o+1):(u==l.length-3||n==h&&l[u+3]>n)&&(a=h-c,o=a-1,n>=h&&(s="right")),null!=o){if(r=l[u+2],c==h&&i==(r.insertLeft?"left":"right")&&(s=i),"left"==i&&0==o)for(;u&&l[u-2]==l[u-3]&&l[u-1].insertLeft;)r=l[(u-=3)+2],s="left";if("right"==i&&o==h-c)for(;u<l.length-3&&l[u+3]==l[u+4]&&!l[u+5].insertLeft;)r=l[(u+=3)+2],s="right";break}}var d;if(3==r.nodeType){for(var u=0;4>u;u++){for(;o&&_r(t.line.text.charAt(c+o));)--o;for(;h>c+a&&_r(t.line.text.charAt(c+a));)++a;if(Jr&&9>Zr&&0==o&&a==h-c)d=r.parentNode.getBoundingClientRect();else if(Jr&&e.options.lineWrapping){var f=wa(r,o,a).getClientRects();d=f.length?f["right"==i?f.length-1:0]:ko}else d=wa(r,o,a).getBoundingClientRect()||ko;if(d.left||d.right||0==o)break;a=o,o-=1,s="right"}Jr&&11>Zr&&(d=Re(e.display.measure,d))}else{o>0&&(s=i="right");var f;d=e.options.lineWrapping&&(f=r.getClientRects()).length>1?f["right"==i?f.length-1:0]:r.getBoundingClientRect()}if(Jr&&9>Zr&&!o&&(!d||!d.left&&!d.right)){var p=r.parentNode.getClientRects()[0];d=p?{left:p.left,right:p.left+Je(e.display),top:p.top,bottom:p.bottom}:ko}for(var g=d.top-t.rect.top,m=d.bottom-t.rect.top,v=(g+m)/2,y=t.view.measure.heights,u=0;u<y.length-1&&!(v<y[u]);u++);var _=u?y[u-1]:0,b=y[u],w={left:("right"==s?d.right:d.left)-t.rect.left,right:("left"==s?d.left:d.right)-t.rect.left,top:_,bottom:b};return d.left||d.right||(w.bogus=!0),e.options.singleCursorHeightPerLine||(w.rtop=g,w.rbottom=m),w}function Re(e,t){if(!window.screen||null==screen.logicalXDPI||screen.logicalXDPI==screen.deviceXDPI||!Dr(e))return t;var n=screen.logicalXDPI/screen.deviceXDPI,i=screen.logicalYDPI/screen.deviceYDPI;return{left:t.left*n,right:t.right*n,top:t.top*i,bottom:t.bottom*i}}function ze(e){if(e.measure&&(e.measure.cache={},e.measure.heights=null,e.rest))for(var t=0;t<e.rest.length;t++)e.measure.caches[t]={}}function We(e){e.display.externalMeasure=null,wr(e.display.lineMeasure);for(var t=0;t<e.display.view.length;t++)ze(e.display.view[t])}function He(e){We(e),e.display.cachedCharWidth=e.display.cachedTextHeight=e.display.cachedPaddingH=null,e.options.lineWrapping||(e.display.maxLineChanged=!0),e.display.lineNumChars=null}function Ue(){return window.pageXOffset||(document.documentElement||document.body).scrollLeft}function Ve(){return window.pageYOffset||(document.documentElement||document.body).scrollTop}function je(e,t,n,i){if(t.widgets)for(var r=0;r<t.widgets.length;++r)if(t.widgets[r].above){var o=oi(t.widgets[r]);n.top+=o,n.bottom+=o}if("line"==i)return n;i||(i="local");var a=Bi(t);if("local"==i?a+=Te(e.display):a-=e.display.viewOffset,"page"==i||"window"==i){var s=e.display.lineSpace.getBoundingClientRect();a+=s.top+("window"==i?0:Ve());var l=s.left+("window"==i?0:Ue());n.left+=l,n.right+=l}return n.top+=a,n.bottom+=a,n}function Fe(e,t,n){if("div"==n)return t;var i=t.left,r=t.top;if("page"==n)i-=Ue(),r-=Ve();else if("local"==n||!n){var o=e.display.sizer.getBoundingClientRect();i+=o.left,r+=o.top}var a=e.display.lineSpace.getBoundingClientRect();return{left:i-a.left,top:r-a.top}}function $e(e,t,n,i,r){return i||(i=Pi(e.doc,t.line)),je(e,i,Ae(e,i,t.ch,r),n)}function Ke(e,t,n,i,r,o){function a(t,a){var s=De(e,r,t,a?"right":"left",o);return a?s.left=s.right:s.right=s.left,je(e,i,s,n)}function s(e,t){var n=l[t],i=n.level%2;return e==Rr(n)&&t&&n.level<l[t-1].level?(n=l[--t],e=zr(n)-(n.level%2?0:1),i=!0):e==zr(n)&&t<l.length-1&&n.level<l[t+1].level&&(n=l[++t],e=Rr(n)-n.level%2,i=!1),i&&e==n.to&&e>n.from?a(e-1):a(e,i)}i=i||Pi(e.doc,t.line),r||(r=Oe(e,i));var l=Ri(i),u=t.ch;if(!l)return a(u);var c=$r(l,u),h=s(u,c);return null!=Da&&(h.other=s(u,Da)),h}function qe(e,t){var n=0,t=Z(e.doc,t);e.options.lineWrapping||(n=Je(e.display)*t.ch);var i=Pi(e.doc,t.line),r=Bi(i)+Te(e.display);return{left:n,right:n,top:r,bottom:r+i.height}}function Ge(e,t,n,i){var r=yo(e,t);return r.xRel=i,n&&(r.outside=!0),r}function Xe(e,t,n){var i=e.doc;if(n+=e.display.viewOffset,0>n)return Ge(i.first,0,!0,-1);var r=Di(i,n),o=i.first+i.size-1;if(r>o)return Ge(i.first+i.size-1,Pi(i,o).text.length,!0,1);0>t&&(t=0);for(var a=Pi(i,r);;){var s=Ye(e,a,r,t,n),l=Yn(a),u=l&&l.find(0,!0);if(!l||!(s.ch>u.from.ch||s.ch==u.from.ch&&s.xRel>0))return s;r=Oi(a=u.to.line)}}function Ye(e,t,n,i,r){function o(i){var r=Ke(e,yo(n,i),"line",t,u);return s=!0,a>r.bottom?r.left-l:a<r.top?r.left+l:(s=!1,r.left)}var a=r-Bi(t),s=!1,l=2*e.display.wrapper.clientWidth,u=Oe(e,t),c=Ri(t),h=t.text.length,d=Wr(t),f=Hr(t),p=o(d),g=s,m=o(f),v=s;if(i>m)return Ge(n,f,v,1);for(;;){if(c?f==d||f==qr(t,d,1):1>=f-d){for(var y=p>i||m-i>=i-p?d:f,_=i-(y==d?p:m);_r(t.text.charAt(y));)++y;var b=Ge(n,y,y==d?g:v,-1>_?-1:_>1?1:0);return b}var w=Math.ceil(h/2),x=d+w;if(c){x=d;for(var k=0;w>k;++k)x=qr(t,x,1)}var C=o(x);C>i?(f=x,m=C,(v=s)&&(m+=1e3),h=w):(d=x,p=C,g=s,h-=w)}}function Qe(e){if(null!=e.cachedTextHeight)return e.cachedTextHeight;if(null==bo){bo=br("pre");for(var t=0;49>t;++t)bo.appendChild(document.createTextNode("x")),bo.appendChild(br("br"));bo.appendChild(document.createTextNode("x"))}xr(e.measure,bo);var n=bo.offsetHeight/50;return n>3&&(e.cachedTextHeight=n),wr(e.measure),n||1}function Je(e){if(null!=e.cachedCharWidth)return e.cachedCharWidth;var t=br("span","xxxxxxxxxx"),n=br("pre",[t]);xr(e.measure,n);var i=t.getBoundingClientRect(),r=(i.right-i.left)/10;return r>2&&(e.cachedCharWidth=r),r||10}function Ze(e){e.curOp={cm:e,viewChanged:!1,startHeight:e.doc.height,forceUpdate:!1,updateInput:null,typing:!1,changeObjs:null,cursorActivityHandlers:null,cursorActivityCalled:0,selectionChanged:!1,updateMaxLine:!1,scrollLeft:null,scrollTop:null,scrollToPos:null,id:++So},Co?Co.ops.push(e.curOp):e.curOp.ownsGroup=Co={ops:[e.curOp],delayedCallbacks:[]}}function et(e){var t=e.delayedCallbacks,n=0;do{for(;n<t.length;n++)t[n]();for(var i=0;i<e.ops.length;i++){var r=e.ops[i];if(r.cursorActivityHandlers)for(;r.cursorActivityCalled<r.cursorActivityHandlers.length;)r.cursorActivityHandlers[r.cursorActivityCalled++](r.cm)}}while(n<t.length)}function tt(e){var t=e.curOp,n=t.ownsGroup;if(n)try{et(n)}finally{Co=null;for(var i=0;i<n.ops.length;i++)n.ops[i].cm.curOp=null;nt(n)}}function nt(e){for(var t=e.ops,n=0;n<t.length;n++)it(t[n]);for(var n=0;n<t.length;n++)rt(t[n]);for(var n=0;n<t.length;n++)ot(t[n]);for(var n=0;n<t.length;n++)at(t[n]);for(var n=0;n<t.length;n++)st(t[n])}function it(e){var t=e.cm,n=t.display;e.updateMaxLine&&f(t),e.mustUpdate=e.viewChanged||e.forceUpdate||null!=e.scrollTop||e.scrollToPos&&(e.scrollToPos.from.line<n.viewFrom||e.scrollToPos.to.line>=n.viewTo)||n.maxLineChanged&&t.options.lineWrapping,e.update=e.mustUpdate&&new k(t,e.mustUpdate&&{top:e.scrollTop,ensure:e.scrollToPos},e.forceUpdate)}function rt(e){e.updatedDisplay=e.mustUpdate&&C(e.cm,e.update)}function ot(e){var t=e.cm,n=t.display;e.updatedDisplay&&E(t),e.barMeasure=m(t),n.maxLineChanged&&!t.options.lineWrapping&&(e.adjustWidthTo=Ae(t,n.maxLine,n.maxLine.text.length).left+3,e.maxScrollLeft=Math.max(0,n.sizer.offsetLeft+e.adjustWidthTo+fa-n.scroller.clientWidth)),(e.updatedDisplay||e.selectionChanged)&&(e.newSelectionNodes=me(t))}function at(e){var t=e.cm;null!=e.adjustWidthTo&&(t.display.sizer.style.minWidth=e.adjustWidthTo+"px",e.maxScrollLeft<t.doc.scrollLeft&&Ut(t,Math.min(t.display.scroller.scrollLeft,e.maxScrollLeft),!0),t.display.maxLineChanged=!1),e.newSelectionNodes&&ve(t,e.newSelectionNodes),e.updatedDisplay&&M(t,e.barMeasure),(e.updatedDisplay||e.startHeight!=t.doc.height)&&v(t,e.barMeasure),e.selectionChanged&&we(t),t.state.focused&&e.updateInput&&Ct(t,e.typing)}function st(e){var t=e.cm,n=t.display,i=t.doc;if(null!=e.adjustWidthTo&&Math.abs(e.barMeasure.scrollWidth-t.display.scroller.scrollWidth)>1&&v(t),e.updatedDisplay&&S(t,e.update),null==n.wheelStartX||null==e.scrollTop&&null==e.scrollLeft&&!e.scrollToPos||(n.wheelStartX=n.wheelStartY=null),null!=e.scrollTop&&(n.scroller.scrollTop!=e.scrollTop||e.forceScroll)){var r=Math.max(0,Math.min(n.scroller.scrollHeight-n.scroller.clientHeight,e.scrollTop));n.scroller.scrollTop=n.scrollbarV.scrollTop=i.scrollTop=r}if(null!=e.scrollLeft&&(n.scroller.scrollLeft!=e.scrollLeft||e.forceScroll)){var o=Math.max(0,Math.min(n.scroller.scrollWidth-n.scroller.clientWidth,e.scrollLeft));n.scroller.scrollLeft=n.scrollbarH.scrollLeft=i.scrollLeft=o,_(t)}if(e.scrollToPos){var a=gn(t,Z(i,e.scrollToPos.from),Z(i,e.scrollToPos.to),e.scrollToPos.margin);e.scrollToPos.isCursor&&t.state.focused&&pn(t,a)}var s=e.maybeHiddenMarkers,l=e.maybeUnhiddenMarkers;if(s)for(var u=0;u<s.length;++u)s[u].lines.length||ha(s[u],"hide");if(l)for(var u=0;u<l.length;++u)l[u].lines.length&&ha(l[u],"unhide");n.wrapper.offsetHeight&&(i.scrollTop=t.display.scroller.scrollTop),e.updatedDisplay&&eo&&(t.options.lineWrapping&&L(t,e.barMeasure),e.barMeasure.scrollWidth>e.barMeasure.clientWidth&&e.barMeasure.scrollWidth<e.barMeasure.clientWidth+1&&!g(t)&&v(t)),e.changeObjs&&ha(t,"changes",t,e.changeObjs)}function lt(e,t){if(e.curOp)return t();Ze(e);try{return t()}finally{tt(e)}}function ut(e,t){return function(){if(e.curOp)return t.apply(e,arguments);Ze(e);try{return t.apply(e,arguments)}finally{tt(e)}}}function ct(e){return function(){if(this.curOp)return e.apply(this,arguments);Ze(this);try{return e.apply(this,arguments);
}finally{tt(this)}}}function ht(e){return function(){var t=this.cm;if(!t||t.curOp)return e.apply(this,arguments);Ze(t);try{return e.apply(this,arguments)}finally{tt(t)}}}function dt(e,t,n){this.line=t,this.rest=Zn(t),this.size=this.rest?Oi(hr(this.rest))-n+1:1,this.node=this.text=null,this.hidden=ni(e,t)}function ft(e,t,n){for(var i,r=[],o=t;n>o;o=i){var a=new dt(e.doc,Pi(e.doc,o),o);i=o+a.size,r.push(a)}return r}function pt(e,t,n,i){null==t&&(t=e.doc.first),null==n&&(n=e.doc.first+e.doc.size),i||(i=0);var r=e.display;if(i&&n<r.viewTo&&(null==r.updateLineNumbers||r.updateLineNumbers>t)&&(r.updateLineNumbers=t),e.curOp.viewChanged=!0,t>=r.viewTo)vo&&ei(e.doc,t)<r.viewTo&&mt(e);else if(n<=r.viewFrom)vo&&ti(e.doc,n+i)>r.viewFrom?mt(e):(r.viewFrom+=i,r.viewTo+=i);else if(t<=r.viewFrom&&n>=r.viewTo)mt(e);else if(t<=r.viewFrom){var o=yt(e,n,n+i,1);o?(r.view=r.view.slice(o.index),r.viewFrom=o.lineN,r.viewTo+=i):mt(e)}else if(n>=r.viewTo){var o=yt(e,t,t,-1);o?(r.view=r.view.slice(0,o.index),r.viewTo=o.lineN):mt(e)}else{var a=yt(e,t,t,-1),s=yt(e,n,n+i,1);a&&s?(r.view=r.view.slice(0,a.index).concat(ft(e,a.lineN,s.lineN)).concat(r.view.slice(s.index)),r.viewTo+=i):mt(e)}var l=r.externalMeasured;l&&(n<l.lineN?l.lineN+=i:t<l.lineN+l.size&&(r.externalMeasured=null))}function gt(e,t,n){e.curOp.viewChanged=!0;var i=e.display,r=e.display.externalMeasured;if(r&&t>=r.lineN&&t<r.lineN+r.size&&(i.externalMeasured=null),!(t<i.viewFrom||t>=i.viewTo)){var o=i.view[vt(e,t)];if(null!=o.node){var a=o.changes||(o.changes=[]);-1==dr(a,n)&&a.push(n)}}}function mt(e){e.display.viewFrom=e.display.viewTo=e.doc.first,e.display.view=[],e.display.viewOffset=0}function vt(e,t){if(t>=e.display.viewTo)return null;if(t-=e.display.viewFrom,0>t)return null;for(var n=e.display.view,i=0;i<n.length;i++)if(t-=n[i].size,0>t)return i}function yt(e,t,n,i){var r,o=vt(e,t),a=e.display.view;if(!vo||n==e.doc.first+e.doc.size)return{index:o,lineN:n};for(var s=0,l=e.display.viewFrom;o>s;s++)l+=a[s].size;if(l!=t){if(i>0){if(o==a.length-1)return null;r=l+a[o].size-t,o++}else r=l-t;t+=r,n+=r}for(;ei(e.doc,n)!=n;){if(o==(0>i?0:a.length-1))return null;n+=i*a[o-(0>i?1:0)].size,o+=i}return{index:o,lineN:n}}function _t(e,t,n){var i=e.display,r=i.view;0==r.length||t>=i.viewTo||n<=i.viewFrom?(i.view=ft(e,t,n),i.viewFrom=t):(i.viewFrom>t?i.view=ft(e,t,i.viewFrom).concat(i.view):i.viewFrom<t&&(i.view=i.view.slice(vt(e,t))),i.viewFrom=t,i.viewTo<n?i.view=i.view.concat(ft(e,i.viewTo,n)):i.viewTo>n&&(i.view=i.view.slice(0,vt(e,n)))),i.viewTo=n}function bt(e){for(var t=e.display.view,n=0,i=0;i<t.length;i++){var r=t[i];r.hidden||r.node&&!r.changes||++n}return n}function wt(e){e.display.pollingFast||e.display.poll.set(e.options.pollInterval,function(){kt(e),e.state.focused&&wt(e)})}function xt(e){function t(){var i=kt(e);i||n?(e.display.pollingFast=!1,wt(e)):(n=!0,e.display.poll.set(60,t))}var n=!1;e.display.pollingFast=!0,e.display.poll.set(20,t)}function kt(e){var t=e.display.input,n=e.display.prevInput,i=e.doc;if(!e.state.focused||Na(t)&&!n||Mt(e)||e.options.disableInput)return!1;e.state.pasteIncoming&&e.state.fakedLastChar&&(t.value=t.value.substring(0,t.value.length-1),e.state.fakedLastChar=!1);var r=t.value;if(r==n&&!e.somethingSelected())return!1;if(Jr&&Zr>=9&&e.display.inputHasSelection===r||co&&/[\uf700-\uf7ff]/.test(r))return Ct(e),!1;var o=!e.curOp;o&&Ze(e),e.display.shift=!1,8203!=r.charCodeAt(0)||i.sel!=e.display.selForContextMenu||n||(n="​");for(var a=0,s=Math.min(n.length,r.length);s>a&&n.charCodeAt(a)==r.charCodeAt(a);)++a;var l=r.slice(a),u=Pa(l),c=null;e.state.pasteIncoming&&i.sel.ranges.length>1&&(To&&To.join("\n")==l?c=i.sel.ranges.length%To.length==0&&fr(To,Pa):u.length==i.sel.ranges.length&&(c=fr(u,function(e){return[e]})));for(var h=i.sel.ranges.length-1;h>=0;h--){var d=i.sel.ranges[h],f=d.from(),p=d.to();a<n.length?f=yo(f.line,f.ch-(n.length-a)):e.state.overwrite&&d.empty()&&!e.state.pasteIncoming&&(p=yo(p.line,Math.min(Pi(i,p.line).text.length,p.ch+hr(u).length)));var g=e.curOp.updateInput,m={from:f,to:p,text:c?c[h%c.length]:u,origin:e.state.pasteIncoming?"paste":e.state.cutIncoming?"cut":"+input"};if(sn(e.doc,m),nr(e,"inputRead",e,m),l&&!e.state.pasteIncoming&&e.options.electricChars&&e.options.smartIndent&&d.head.ch<100&&(!h||i.sel.ranges[h-1].head.line!=d.head.line)){var v=e.getModeAt(d.head),y=Ao(m);if(v.electricChars){for(var _=0;_<v.electricChars.length;_++)if(l.indexOf(v.electricChars.charAt(_))>-1){wn(e,y.line,"smart");break}}else v.electricInput&&v.electricInput.test(Pi(i,y.line).text.slice(0,y.ch))&&wn(e,y.line,"smart")}}return _n(e),e.curOp.updateInput=g,e.curOp.typing=!0,r.length>1e3||r.indexOf("\n")>-1?t.value=e.display.prevInput="":e.display.prevInput=r,o&&tt(e),e.state.pasteIncoming=e.state.cutIncoming=!1,!0}function Ct(e,t){var n,i,r=e.doc;if(e.somethingSelected()){e.display.prevInput="";var o=r.sel.primary();n=Aa&&(o.to().line-o.from().line>100||(i=e.getSelection()).length>1e3);var a=n?"-":i||e.getSelection();e.display.input.value=a,e.state.focused&&ba(e.display.input),Jr&&Zr>=9&&(e.display.inputHasSelection=a)}else t||(e.display.prevInput=e.display.input.value="",Jr&&Zr>=9&&(e.display.inputHasSelection=null));e.display.inaccurateSelection=n}function St(e){"nocursor"==e.options.readOnly||uo&&Cr()==e.display.input||e.display.input.focus()}function Tt(e){e.state.focused||(St(e),Qt(e))}function Mt(e){return e.options.readOnly||e.doc.cantEdit}function Lt(e){function t(){e.state.focused&&setTimeout(mr(St,e),0)}function n(t){rr(e,t)||la(t)}function i(t){if(e.somethingSelected())To=e.getSelections(),r.inaccurateSelection&&(r.prevInput="",r.inaccurateSelection=!1,r.input.value=To.join("\n"),ba(r.input));else{for(var n=[],i=[],o=0;o<e.doc.sel.ranges.length;o++){var a=e.doc.sel.ranges[o].head.line,s={anchor:yo(a,0),head:yo(a+1,0)};i.push(s),n.push(e.getRange(s.anchor,s.head))}"cut"==t.type?e.setSelections(i,null,ga):(r.prevInput="",r.input.value=n.join("\n"),ba(r.input)),To=n}"cut"==t.type&&(e.state.cutIncoming=!0)}var r=e.display;ua(r.scroller,"mousedown",ut(e,At)),Jr&&11>Zr?ua(r.scroller,"dblclick",ut(e,function(t){if(!rr(e,t)){var n=Nt(e,t);if(n&&!Rt(e,t)&&!Pt(e.display,t)){aa(t);var i=e.findWordAt(n);re(e.doc,i.anchor,i.head)}}})):ua(r.scroller,"dblclick",function(t){rr(e,t)||aa(t)}),ua(r.lineSpace,"selectstart",function(e){Pt(r,e)||aa(e)}),go||ua(r.scroller,"contextmenu",function(t){Zt(e,t)}),ua(r.scroller,"scroll",function(){r.scroller.clientHeight&&(Ht(e,r.scroller.scrollTop),Ut(e,r.scroller.scrollLeft,!0),ha(e,"scroll",e))}),ua(r.scrollbarV,"scroll",function(){r.scroller.clientHeight&&Ht(e,r.scrollbarV.scrollTop)}),ua(r.scrollbarH,"scroll",function(){r.scroller.clientHeight&&Ut(e,r.scrollbarH.scrollLeft)}),ua(r.scroller,"mousewheel",function(t){Vt(e,t)}),ua(r.scroller,"DOMMouseScroll",function(t){Vt(e,t)}),ua(r.scrollbarH,"mousedown",t),ua(r.scrollbarV,"mousedown",t),ua(r.wrapper,"scroll",function(){r.wrapper.scrollTop=r.wrapper.scrollLeft=0}),ua(r.input,"keyup",function(t){Xt.call(e,t)}),ua(r.input,"input",function(){Jr&&Zr>=9&&e.display.inputHasSelection&&(e.display.inputHasSelection=null),xt(e)}),ua(r.input,"keydown",ut(e,qt)),ua(r.input,"keypress",ut(e,Yt)),ua(r.input,"focus",mr(Qt,e)),ua(r.input,"blur",mr(Jt,e)),e.options.dragDrop&&(ua(r.scroller,"dragstart",function(t){Wt(e,t)}),ua(r.scroller,"dragenter",n),ua(r.scroller,"dragover",n),ua(r.scroller,"drop",ut(e,zt))),ua(r.scroller,"paste",function(t){Pt(r,t)||(e.state.pasteIncoming=!0,St(e),xt(e))}),ua(r.input,"paste",function(){if(eo&&!e.state.fakedLastChar&&!(new Date-e.state.lastMiddleDown<200)){var t=r.input.selectionStart,n=r.input.selectionEnd;r.input.value+="$",r.input.selectionEnd=n,r.input.selectionStart=t,e.state.fakedLastChar=!0}e.state.pasteIncoming=!0,xt(e)}),ua(r.input,"cut",i),ua(r.input,"copy",i),oo&&ua(r.sizer,"mouseup",function(){Cr()==r.input&&r.input.blur(),St(e)})}function Et(e){var t=e.display;t.cachedCharWidth=t.cachedTextHeight=t.cachedPaddingH=null,e.setSize()}function Pt(e,t){for(var n=er(t);n!=e.wrapper;n=n.parentNode)if(!n||n.ignoreEvents||n.parentNode==e.sizer&&n!=e.mover)return!0}function Nt(e,t,n,i){var r=e.display;if(!n){var o=er(t);if(o==r.scrollbarH||o==r.scrollbarV||o==r.scrollbarFiller||o==r.gutterFiller)return null}var a,s,l=r.lineSpace.getBoundingClientRect();try{a=t.clientX-l.left,s=t.clientY-l.top}catch(t){return null}var u,c=Xe(e,a,s);if(i&&1==c.xRel&&(u=Pi(e.doc,c.line).text).length==c.ch){var h=ya(u,u.length,e.options.tabSize)-u.length;c=yo(c.line,Math.max(0,Math.round((a-Le(e.display).left)/Je(e.display))-h))}return c}function At(e){if(!rr(this,e)){var t=this,n=t.display;if(n.shift=e.shiftKey,Pt(n,e))return void(eo||(n.scroller.draggable=!1,setTimeout(function(){n.scroller.draggable=!0},100)));if(!Rt(t,e)){var i=Nt(t,e);switch(window.focus(),tr(e)){case 1:i?It(t,e,i):er(e)==n.scroller&&aa(e);break;case 2:eo&&(t.state.lastMiddleDown=+new Date),i&&re(t.doc,i),setTimeout(mr(St,t),20),aa(e);break;case 3:go&&Zt(t,e)}}}}function It(e,t,n){setTimeout(mr(Tt,e),0);var i,r=+new Date;xo&&xo.time>r-400&&0==_o(xo.pos,n)?i="triple":wo&&wo.time>r-400&&0==_o(wo.pos,n)?(i="double",xo={time:r,pos:n}):(i="single",wo={time:r,pos:n});var o=e.doc.sel,a=co?t.metaKey:t.ctrlKey;e.options.dragDrop&&Ea&&!Mt(e)&&"single"==i&&o.contains(n)>-1&&o.somethingSelected()?Ot(e,t,n,a):Dt(e,t,n,i,a)}function Ot(e,t,n,i){var r=e.display,o=ut(e,function(a){eo&&(r.scroller.draggable=!1),e.state.draggingText=!1,ca(document,"mouseup",o),ca(r.scroller,"drop",o),Math.abs(t.clientX-a.clientX)+Math.abs(t.clientY-a.clientY)<10&&(aa(a),i||re(e.doc,n),St(e),Jr&&9==Zr&&setTimeout(function(){document.body.focus(),St(e)},20))});eo&&(r.scroller.draggable=!0),e.state.draggingText=o,r.scroller.dragDrop&&r.scroller.dragDrop(),ua(document,"mouseup",o),ua(r.scroller,"drop",o)}function Dt(e,t,n,i,r){function o(t){if(0!=_o(g,t))if(g=t,"rect"==i){for(var r=[],o=e.options.tabSize,a=ya(Pi(u,n.line).text,n.ch,o),s=ya(Pi(u,t.line).text,t.ch,o),l=Math.min(a,s),f=Math.max(a,s),p=Math.min(n.line,t.line),m=Math.min(e.lastLine(),Math.max(n.line,t.line));m>=p;p++){var v=Pi(u,p).text,y=ur(v,l,o);l==f?r.push(new X(yo(p,y),yo(p,y))):v.length>y&&r.push(new X(yo(p,y),yo(p,ur(v,f,o))))}r.length||r.push(new X(n,n)),ce(u,Y(d.ranges.slice(0,h).concat(r),h),{origin:"*mouse",scroll:!1}),e.scrollIntoView(t)}else{var _=c,b=_.anchor,w=t;if("single"!=i){if("double"==i)var x=e.findWordAt(t);else var x=new X(yo(t.line,0),Z(u,yo(t.line+1,0)));_o(x.anchor,b)>0?(w=x.head,b=q(_.from(),x.anchor)):(w=x.anchor,b=K(_.to(),x.head))}var r=d.ranges.slice(0);r[h]=new X(Z(u,b),w),ce(u,Y(r,h),ma)}}function a(t){var n=++v,r=Nt(e,t,!0,"rect"==i);if(r)if(0!=_o(r,g)){Tt(e),o(r);var s=y(l,u);(r.line>=s.to||r.line<s.from)&&setTimeout(ut(e,function(){v==n&&a(t)}),150)}else{var c=t.clientY<m.top?-20:t.clientY>m.bottom?20:0;c&&setTimeout(ut(e,function(){v==n&&(l.scroller.scrollTop+=c,a(t))}),50)}}function s(t){v=1/0,aa(t),St(e),ca(document,"mousemove",_),ca(document,"mouseup",b),u.history.lastSelOrigin=null}var l=e.display,u=e.doc;aa(t);var c,h,d=u.sel;if(r&&!t.shiftKey?(h=u.sel.contains(n),c=h>-1?u.sel.ranges[h]:new X(n,n)):c=u.sel.primary(),t.altKey)i="rect",r||(c=new X(n,n)),n=Nt(e,t,!0,!0),h=-1;else if("double"==i){var f=e.findWordAt(n);c=e.display.shift||u.extend?ie(u,c,f.anchor,f.head):f}else if("triple"==i){var p=new X(yo(n.line,0),Z(u,yo(n.line+1,0)));c=e.display.shift||u.extend?ie(u,c,p.anchor,p.head):p}else c=ie(u,c,n);r?h>-1?ae(u,h,c,ma):(h=u.sel.ranges.length,ce(u,Y(u.sel.ranges.concat([c]),h),{scroll:!1,origin:"*mouse"})):(h=0,ce(u,new G([c],0),ma),d=u.sel);var g=n,m=l.wrapper.getBoundingClientRect(),v=0,_=ut(e,function(e){tr(e)?a(e):s(e)}),b=ut(e,s);ua(document,"mousemove",_),ua(document,"mouseup",b)}function Bt(e,t,n,i,r){try{var o=t.clientX,a=t.clientY}catch(t){return!1}if(o>=Math.floor(e.display.gutters.getBoundingClientRect().right))return!1;i&&aa(t);var s=e.display,l=s.lineDiv.getBoundingClientRect();if(a>l.bottom||!ar(e,n))return Zi(t);a-=l.top-s.viewOffset;for(var u=0;u<e.options.gutters.length;++u){var c=s.gutters.childNodes[u];if(c&&c.getBoundingClientRect().right>=o){var h=Di(e.doc,a),d=e.options.gutters[u];return r(e,n,e,h,d,t),Zi(t)}}}function Rt(e,t){return Bt(e,t,"gutterClick",!0,nr)}function zt(e){var t=this;if(!rr(t,e)&&!Pt(t.display,e)){aa(e),Jr&&(Mo=+new Date);var n=Nt(t,e,!0),i=e.dataTransfer.files;if(n&&!Mt(t))if(i&&i.length&&window.FileReader&&window.File)for(var r=i.length,o=Array(r),a=0,s=function(e,i){var s=new FileReader;s.onload=ut(t,function(){if(o[i]=s.result,++a==r){n=Z(t.doc,n);var e={from:n,to:n,text:Pa(o.join("\n")),origin:"paste"};sn(t.doc,e),ue(t.doc,Q(n,Ao(e)))}}),s.readAsText(e)},l=0;r>l;++l)s(i[l],l);else{if(t.state.draggingText&&t.doc.sel.contains(n)>-1)return t.state.draggingText(e),void setTimeout(mr(St,t),20);try{var o=e.dataTransfer.getData("Text");if(o){if(t.state.draggingText&&!(co?e.metaKey:e.ctrlKey))var u=t.listSelections();if(he(t.doc,Q(n,n)),u)for(var l=0;l<u.length;++l)fn(t.doc,"",u[l].anchor,u[l].head,"drag");t.replaceSelection(o,"around","paste"),St(t)}}catch(e){}}}}function Wt(e,t){if(Jr&&(!e.state.draggingText||+new Date-Mo<100))return void la(t);if(!rr(e,t)&&!Pt(e.display,t)&&(t.dataTransfer.setData("Text",e.getSelection()),t.dataTransfer.setDragImage&&!ro)){var n=br("img",null,null,"position: fixed; left: 0; top: 0;");n.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",io&&(n.width=n.height=1,e.display.wrapper.appendChild(n),n._top=n.offsetTop),t.dataTransfer.setDragImage(n,0,0),io&&n.parentNode.removeChild(n)}}function Ht(e,t){Math.abs(e.doc.scrollTop-t)<2||(e.doc.scrollTop=t,Xr||T(e,{top:t}),e.display.scroller.scrollTop!=t&&(e.display.scroller.scrollTop=t),e.display.scrollbarV.scrollTop!=t&&(e.display.scrollbarV.scrollTop=t),Xr&&T(e),xe(e,100))}function Ut(e,t,n){(n?t==e.doc.scrollLeft:Math.abs(e.doc.scrollLeft-t)<2)||(t=Math.min(t,e.display.scroller.scrollWidth-e.display.scroller.clientWidth),e.doc.scrollLeft=t,_(e),e.display.scroller.scrollLeft!=t&&(e.display.scroller.scrollLeft=t),e.display.scrollbarH.scrollLeft!=t&&(e.display.scrollbarH.scrollLeft=t))}function Vt(e,t){var n=t.wheelDeltaX,i=t.wheelDeltaY;null==n&&t.detail&&t.axis==t.HORIZONTAL_AXIS&&(n=t.detail),null==i&&t.detail&&t.axis==t.VERTICAL_AXIS?i=t.detail:null==i&&(i=t.wheelDelta);var r=e.display,o=r.scroller;if(n&&o.scrollWidth>o.clientWidth||i&&o.scrollHeight>o.clientHeight){if(i&&co&&eo)e:for(var a=t.target,s=r.view;a!=o;a=a.parentNode)for(var l=0;l<s.length;l++)if(s[l].node==a){e.display.currentWheelTarget=a;break e}if(n&&!Xr&&!io&&null!=Eo)return i&&Ht(e,Math.max(0,Math.min(o.scrollTop+i*Eo,o.scrollHeight-o.clientHeight))),Ut(e,Math.max(0,Math.min(o.scrollLeft+n*Eo,o.scrollWidth-o.clientWidth))),aa(t),void(r.wheelStartX=null);if(i&&null!=Eo){var u=i*Eo,c=e.doc.scrollTop,h=c+r.wrapper.clientHeight;0>u?c=Math.max(0,c+u-50):h=Math.min(e.doc.height,h+u+50),T(e,{top:c,bottom:h})}20>Lo&&(null==r.wheelStartX?(r.wheelStartX=o.scrollLeft,r.wheelStartY=o.scrollTop,r.wheelDX=n,r.wheelDY=i,setTimeout(function(){if(null!=r.wheelStartX){var e=o.scrollLeft-r.wheelStartX,t=o.scrollTop-r.wheelStartY,n=t&&r.wheelDY&&t/r.wheelDY||e&&r.wheelDX&&e/r.wheelDX;r.wheelStartX=r.wheelStartY=null,n&&(Eo=(Eo*Lo+n)/(Lo+1),++Lo)}},200)):(r.wheelDX+=n,r.wheelDY+=i))}}function jt(e,t,n){if("string"==typeof t&&(t=jo[t],!t))return!1;e.display.pollingFast&&kt(e)&&(e.display.pollingFast=!1);var i=e.display.shift,r=!1;try{Mt(e)&&(e.state.suppressEdits=!0),n&&(e.display.shift=!1),r=t(e)!=pa}finally{e.display.shift=i,e.state.suppressEdits=!1}return r}function Ft(e){var t=e.state.keyMaps.slice(0);return e.options.extraKeys&&t.push(e.options.extraKeys),t.push(e.options.keyMap),t}function $t(e,t){var n=Mn(e.options.keyMap),i=n.auto;clearTimeout(Po),i&&!Ko(t)&&(Po=setTimeout(function(){Mn(e.options.keyMap)==n&&(e.options.keyMap=i.call?i.call(null,e):i,s(e))},50));var r=qo(t,!0),o=!1;if(!r)return!1;var a=Ft(e);return o=t.shiftKey?$o("Shift-"+r,a,function(t){return jt(e,t,!0)})||$o(r,a,function(t){return("string"==typeof t?/^go[A-Z]/.test(t):t.motion)?jt(e,t):void 0}):$o(r,a,function(t){return jt(e,t)}),o&&(aa(t),we(e),nr(e,"keyHandled",e,r,t)),o}function Kt(e,t,n){var i=$o("'"+n+"'",Ft(e),function(t){return jt(e,t,!0)});return i&&(aa(t),we(e),nr(e,"keyHandled",e,"'"+n+"'",t)),i}function qt(e){var t=this;if(Tt(t),!rr(t,e)){Jr&&11>Zr&&27==e.keyCode&&(e.returnValue=!1);var n=e.keyCode;t.display.shift=16==n||e.shiftKey;var i=$t(t,e);io&&(No=i?n:null,!i&&88==n&&!Aa&&(co?e.metaKey:e.ctrlKey)&&t.replaceSelection("",null,"cut")),18!=n||/\bCodeMirror-crosshair\b/.test(t.display.lineDiv.className)||Gt(t)}}function Gt(e){function t(e){18!=e.keyCode&&e.altKey||(Tr(n,"CodeMirror-crosshair"),ca(document,"keyup",t),ca(document,"mouseover",t))}var n=e.display.lineDiv;Mr(n,"CodeMirror-crosshair"),ua(document,"keyup",t),ua(document,"mouseover",t)}function Xt(e){16==e.keyCode&&(this.doc.sel.shift=!1),rr(this,e)}function Yt(e){var t=this;if(!(rr(t,e)||e.ctrlKey&&!e.altKey||co&&e.metaKey)){var n=e.keyCode,i=e.charCode;if(io&&n==No)return No=null,void aa(e);if(!(io&&(!e.which||e.which<10)||oo)||!$t(t,e)){var r=String.fromCharCode(null==i?n:i);Kt(t,e,r)||(Jr&&Zr>=9&&(t.display.inputHasSelection=null),xt(t))}}}function Qt(e){"nocursor"!=e.options.readOnly&&(e.state.focused||(ha(e,"focus",e),e.state.focused=!0,Mr(e.display.wrapper,"CodeMirror-focused"),e.curOp||e.display.selForContextMenu==e.doc.sel||(Ct(e),eo&&setTimeout(mr(Ct,e,!0),0))),wt(e),we(e))}function Jt(e){e.state.focused&&(ha(e,"blur",e),e.state.focused=!1,Tr(e.display.wrapper,"CodeMirror-focused")),clearInterval(e.display.blinker),setTimeout(function(){e.state.focused||(e.display.shift=!1)},150)}function Zt(e,t){function n(){if(null!=r.input.selectionStart){var t=e.somethingSelected(),n=r.input.value="​"+(t?r.input.value:"");r.prevInput=t?"":"​",r.input.selectionStart=1,r.input.selectionEnd=n.length,r.selForContextMenu=e.doc.sel}}function i(){if(r.inputDiv.style.position="relative",r.input.style.cssText=l,Jr&&9>Zr&&(r.scrollbarV.scrollTop=r.scroller.scrollTop=a),wt(e),null!=r.input.selectionStart){(!Jr||Jr&&9>Zr)&&n();var t=0,i=function(){r.selForContextMenu==e.doc.sel&&0==r.input.selectionStart?ut(e,jo.selectAll)(e):t++<10?r.detectingSelectAll=setTimeout(i,500):Ct(e)};r.detectingSelectAll=setTimeout(i,200)}}if(!rr(e,t,"contextmenu")){var r=e.display;if(!Pt(r,t)&&!en(e,t)){var o=Nt(e,t),a=r.scroller.scrollTop;if(o&&!io){var s=e.options.resetSelectionOnContextMenu;s&&-1==e.doc.sel.contains(o)&&ut(e,ce)(e.doc,Q(o),ga);var l=r.input.style.cssText;if(r.inputDiv.style.position="absolute",r.input.style.cssText="position: fixed; width: 30px; height: 30px; top: "+(t.clientY-5)+"px; left: "+(t.clientX-5)+"px; z-index: 1000; background: "+(Jr?"rgba(255, 255, 255, .05)":"transparent")+"; outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);",eo)var u=window.scrollY;if(St(e),eo&&window.scrollTo(null,u),Ct(e),e.somethingSelected()||(r.input.value=r.prevInput=" "),r.selForContextMenu=e.doc.sel,clearTimeout(r.detectingSelectAll),Jr&&Zr>=9&&n(),go){la(t);var c=function(){ca(window,"mouseup",c),setTimeout(i,20)};ua(window,"mouseup",c)}else setTimeout(i,50)}}}}function en(e,t){return ar(e,"gutterContextMenu")?Bt(e,t,"gutterContextMenu",!1,ha):!1}function tn(e,t){if(_o(e,t.from)<0)return e;if(_o(e,t.to)<=0)return Ao(t);var n=e.line+t.text.length-(t.to.line-t.from.line)-1,i=e.ch;return e.line==t.to.line&&(i+=Ao(t).ch-t.to.ch),yo(n,i)}function nn(e,t){for(var n=[],i=0;i<e.sel.ranges.length;i++){var r=e.sel.ranges[i];n.push(new X(tn(r.anchor,t),tn(r.head,t)))}return Y(n,e.sel.primIndex)}function rn(e,t,n){return e.line==t.line?yo(n.line,e.ch-t.ch+n.ch):yo(n.line+(e.line-t.line),e.ch)}function on(e,t,n){for(var i=[],r=yo(e.first,0),o=r,a=0;a<t.length;a++){var s=t[a],l=rn(s.from,r,o),u=rn(Ao(s),r,o);if(r=s.to,o=u,"around"==n){var c=e.sel.ranges[a],h=_o(c.head,c.anchor)<0;i[a]=new X(h?u:l,h?l:u)}else i[a]=new X(l,l)}return new G(i,e.sel.primIndex)}function an(e,t,n){var i={canceled:!1,from:t.from,to:t.to,text:t.text,origin:t.origin,cancel:function(){this.canceled=!0}};return n&&(i.update=function(t,n,i,r){t&&(this.from=Z(e,t)),n&&(this.to=Z(e,n)),i&&(this.text=i),void 0!==r&&(this.origin=r)}),ha(e,"beforeChange",e,i),e.cm&&ha(e.cm,"beforeChange",e.cm,i),i.canceled?null:{from:i.from,to:i.to,text:i.text,origin:i.origin}}function sn(e,t,n){if(e.cm){if(!e.cm.curOp)return ut(e.cm,sn)(e,t,n);if(e.cm.state.suppressEdits)return}if(!(ar(e,"beforeChange")||e.cm&&ar(e.cm,"beforeChange"))||(t=an(e,t,!0))){var i=mo&&!n&&Vn(e,t.from,t.to);if(i)for(var r=i.length-1;r>=0;--r)ln(e,{from:i[r].from,to:i[r].to,text:r?[""]:t.text});else ln(e,t)}}function ln(e,t){if(1!=t.text.length||""!=t.text[0]||0!=_o(t.from,t.to)){var n=nn(e,t);Vi(e,t,n,e.cm?e.cm.curOp.id:NaN),hn(e,t,n,Wn(e,t));var i=[];Li(e,function(e,n){n||-1!=dr(i,e.history)||(Ji(e.history,t),i.push(e.history)),hn(e,t,null,Wn(e,t))})}}function un(e,t,n){if(!e.cm||!e.cm.state.suppressEdits){for(var i,r=e.history,o=e.sel,a="undo"==t?r.done:r.undone,s="undo"==t?r.undone:r.done,l=0;l<a.length&&(i=a[l],n?!i.ranges||i.equals(e.sel):i.ranges);l++);if(l!=a.length){for(r.lastOrigin=r.lastSelOrigin=null;i=a.pop(),i.ranges;){if($i(i,s),n&&!i.equals(e.sel))return void ce(e,i,{clearRedo:!1});o=i}var u=[];$i(o,s),s.push({changes:u,generation:r.generation}),r.generation=i.generation||++r.maxGeneration;for(var c=ar(e,"beforeChange")||e.cm&&ar(e.cm,"beforeChange"),l=i.changes.length-1;l>=0;--l){var h=i.changes[l];if(h.origin=t,c&&!an(e,h,!1))return void(a.length=0);u.push(Wi(e,h));var d=l?nn(e,h):hr(a);hn(e,h,d,Un(e,h)),!l&&e.cm&&e.cm.scrollIntoView({from:h.from,to:Ao(h)});var f=[];Li(e,function(e,t){t||-1!=dr(f,e.history)||(Ji(e.history,h),f.push(e.history)),hn(e,h,null,Un(e,h))})}}}}function cn(e,t){if(0!=t&&(e.first+=t,e.sel=new G(fr(e.sel.ranges,function(e){return new X(yo(e.anchor.line+t,e.anchor.ch),yo(e.head.line+t,e.head.ch))}),e.sel.primIndex),e.cm)){pt(e.cm,e.first,e.first-t,t);for(var n=e.cm.display,i=n.viewFrom;i<n.viewTo;i++)gt(e.cm,i,"gutter")}}function hn(e,t,n,i){if(e.cm&&!e.cm.curOp)return ut(e.cm,hn)(e,t,n,i);if(t.to.line<e.first)return void cn(e,t.text.length-1-(t.to.line-t.from.line));if(!(t.from.line>e.lastLine())){if(t.from.line<e.first){var r=t.text.length-1-(e.first-t.from.line);cn(e,r),t={from:yo(e.first,0),to:yo(t.to.line+r,t.to.ch),text:[hr(t.text)],origin:t.origin}}var o=e.lastLine();t.to.line>o&&(t={from:t.from,to:yo(o,Pi(e,o).text.length),text:[t.text[0]],origin:t.origin}),t.removed=Ni(e,t.from,t.to),n||(n=nn(e,t)),e.cm?dn(e.cm,t,i):Si(e,t,i),he(e,n,ga)}}function dn(e,t,n){var i=e.doc,r=e.display,a=t.from,s=t.to,l=!1,u=a.line;e.options.lineWrapping||(u=Oi(Jn(Pi(i,a.line))),i.iter(u,s.line+1,function(e){return e==r.maxLine?(l=!0,!0):void 0})),i.sel.contains(t.from,t.to)>-1&&or(e),Si(i,t,n,o(e)),e.options.lineWrapping||(i.iter(u,a.line+t.text.length,function(e){var t=d(e);t>r.maxLineLength&&(r.maxLine=e,r.maxLineLength=t,r.maxLineChanged=!0,l=!1)}),l&&(e.curOp.updateMaxLine=!0)),i.frontier=Math.min(i.frontier,a.line),xe(e,400);var c=t.text.length-(s.line-a.line)-1;a.line!=s.line||1!=t.text.length||Ci(e.doc,t)?pt(e,a.line,s.line+1,c):gt(e,a.line,"text");var h=ar(e,"changes"),f=ar(e,"change");if(f||h){var p={from:a,to:s,text:t.text,removed:t.removed,origin:t.origin};f&&nr(e,"change",e,p),h&&(e.curOp.changeObjs||(e.curOp.changeObjs=[])).push(p)}e.display.selForContextMenu=null}function fn(e,t,n,i,r){if(i||(i=n),_o(i,n)<0){var o=i;i=n,n=o}"string"==typeof t&&(t=Pa(t)),sn(e,{from:n,to:i,text:t,origin:r})}function pn(e,t){var n=e.display,i=n.sizer.getBoundingClientRect(),r=null;if(t.top+i.top<0?r=!0:t.bottom+i.top>(window.innerHeight||document.documentElement.clientHeight)&&(r=!1),null!=r&&!so){var o=br("div","​",null,"position: absolute; top: "+(t.top-n.viewOffset-Te(e.display))+"px; height: "+(t.bottom-t.top+fa)+"px; left: "+t.left+"px; width: 2px;");e.display.lineSpace.appendChild(o),o.scrollIntoView(r),e.display.lineSpace.removeChild(o)}}function gn(e,t,n,i){null==i&&(i=0);for(var r=0;5>r;r++){var o=!1,a=Ke(e,t),s=n&&n!=t?Ke(e,n):a,l=vn(e,Math.min(a.left,s.left),Math.min(a.top,s.top)-i,Math.max(a.left,s.left),Math.max(a.bottom,s.bottom)+i),u=e.doc.scrollTop,c=e.doc.scrollLeft;if(null!=l.scrollTop&&(Ht(e,l.scrollTop),Math.abs(e.doc.scrollTop-u)>1&&(o=!0)),null!=l.scrollLeft&&(Ut(e,l.scrollLeft),Math.abs(e.doc.scrollLeft-c)>1&&(o=!0)),!o)return a}}function mn(e,t,n,i,r){var o=vn(e,t,n,i,r);null!=o.scrollTop&&Ht(e,o.scrollTop),null!=o.scrollLeft&&Ut(e,o.scrollLeft)}function vn(e,t,n,i,r){var o=e.display,a=Qe(e.display);0>n&&(n=0);var s=e.curOp&&null!=e.curOp.scrollTop?e.curOp.scrollTop:o.scroller.scrollTop,l=o.scroller.clientHeight-fa,u={};r-n>l&&(r=n+l);var c=e.doc.height+Me(o),h=a>n,d=r>c-a;if(s>n)u.scrollTop=h?0:n;else if(r>s+l){var f=Math.min(n,(d?c:r)-l);f!=s&&(u.scrollTop=f)}var p=e.curOp&&null!=e.curOp.scrollLeft?e.curOp.scrollLeft:o.scroller.scrollLeft,g=o.scroller.clientWidth-fa-o.gutters.offsetWidth,m=i-t>g;return m&&(i=t+g),10>t?u.scrollLeft=0:p>t?u.scrollLeft=Math.max(0,t-(m?0:10)):i>g+p-3&&(u.scrollLeft=i+(m?0:10)-g),u}function yn(e,t,n){(null!=t||null!=n)&&bn(e),null!=t&&(e.curOp.scrollLeft=(null==e.curOp.scrollLeft?e.doc.scrollLeft:e.curOp.scrollLeft)+t),null!=n&&(e.curOp.scrollTop=(null==e.curOp.scrollTop?e.doc.scrollTop:e.curOp.scrollTop)+n)}function _n(e){bn(e);var t=e.getCursor(),n=t,i=t;e.options.lineWrapping||(n=t.ch?yo(t.line,t.ch-1):t,i=yo(t.line,t.ch+1)),e.curOp.scrollToPos={from:n,to:i,margin:e.options.cursorScrollMargin,isCursor:!0}}function bn(e){var t=e.curOp.scrollToPos;if(t){e.curOp.scrollToPos=null;var n=qe(e,t.from),i=qe(e,t.to),r=vn(e,Math.min(n.left,i.left),Math.min(n.top,i.top)-t.margin,Math.max(n.right,i.right),Math.max(n.bottom,i.bottom)+t.margin);e.scrollTo(r.scrollLeft,r.scrollTop)}}function wn(e,t,n,i){var r,o=e.doc;null==n&&(n="add"),"smart"==n&&(o.mode.indent?r=Se(e,t):n="prev");var a=e.options.tabSize,s=Pi(o,t),l=ya(s.text,null,a);s.stateAfter&&(s.stateAfter=null);var u,c=s.text.match(/^\s*/)[0];if(i||/\S/.test(s.text)){if("smart"==n&&(u=o.mode.indent(r,s.text.slice(c.length),s.text),u==pa||u>150)){if(!i)return;n="prev"}}else u=0,n="not";"prev"==n?u=t>o.first?ya(Pi(o,t-1).text,null,a):0:"add"==n?u=l+e.options.indentUnit:"subtract"==n?u=l-e.options.indentUnit:"number"==typeof n&&(u=l+n),u=Math.max(0,u);var h="",d=0;if(e.options.indentWithTabs)for(var f=Math.floor(u/a);f;--f)d+=a,h+="	";if(u>d&&(h+=cr(u-d)),h!=c)fn(o,h,yo(t,0),yo(t,c.length),"+input");else for(var f=0;f<o.sel.ranges.length;f++){var p=o.sel.ranges[f];if(p.head.line==t&&p.head.ch<c.length){var d=yo(t,c.length);ae(o,f,new X(d,d));break}}s.stateAfter=null}function xn(e,t,n,i){var r=t,o=t;return"number"==typeof t?o=Pi(e,J(e,t)):r=Oi(t),null==r?null:(i(o,r)&&e.cm&&gt(e.cm,r,n),o)}function kn(e,t){for(var n=e.doc.sel.ranges,i=[],r=0;r<n.length;r++){for(var o=t(n[r]);i.length&&_o(o.from,hr(i).to)<=0;){var a=i.pop();if(_o(a.from,o.from)<0){o.from=a.from;break}}i.push(o)}lt(e,function(){for(var t=i.length-1;t>=0;t--)fn(e.doc,"",i[t].from,i[t].to,"+delete");_n(e)})}function Cn(e,t,n,i,r){function o(){var t=s+n;return t<e.first||t>=e.first+e.size?h=!1:(s=t,c=Pi(e,t))}function a(e){var t=(r?qr:Gr)(c,l,n,!0);if(null==t){if(e||!o())return h=!1;l=r?(0>n?Hr:Wr)(c):0>n?c.text.length:0}else l=t;return!0}var s=t.line,l=t.ch,u=n,c=Pi(e,s),h=!0;if("char"==i)a();else if("column"==i)a(!0);else if("word"==i||"group"==i)for(var d=null,f="group"==i,p=e.cm&&e.cm.getHelper(t,"wordChars"),g=!0;!(0>n)||a(!g);g=!1){var m=c.text.charAt(l)||"\n",v=vr(m,p)?"w":f&&"\n"==m?"n":!f||/\s/.test(m)?null:"p";if(!f||g||v||(v="s"),d&&d!=v){0>n&&(n=1,a());break}if(v&&(d=v),n>0&&!a(!g))break}var y=ge(e,yo(s,l),u,!0);return h||(y.hitSide=!0),y}function Sn(e,t,n,i){var r,o=e.doc,a=t.left;if("page"==i){var s=Math.min(e.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight);r=t.top+n*(s-(0>n?1.5:.5)*Qe(e.display))}else"line"==i&&(r=n>0?t.bottom+3:t.top-3);for(;;){var l=Xe(e,a,r);if(!l.outside)break;if(0>n?0>=r:r>=o.height){l.hitSide=!0;break}r+=5*n}return l}function Tn(t,n,i,r){e.defaults[t]=n,i&&(Oo[t]=r?function(e,t,n){n!=Do&&i(e,t,n)}:i)}function Mn(e){return"string"==typeof e?Fo[e]:e}function Ln(e,t,n,i,r){if(i&&i.shared)return En(e,t,n,i,r);if(e.cm&&!e.cm.curOp)return ut(e.cm,Ln)(e,t,n,i,r);var o=new Xo(e,r),a=_o(t,n);if(i&&gr(i,o,!1),a>0||0==a&&o.clearWhenEmpty!==!1)return o;if(o.replacedWith&&(o.collapsed=!0,o.widgetNode=br("span",[o.replacedWith],"CodeMirror-widget"),i.handleMouseEvents||(o.widgetNode.ignoreEvents=!0),i.insertLeft&&(o.widgetNode.insertLeft=!0)),o.collapsed){if(Qn(e,t.line,t,n,o)||t.line!=n.line&&Qn(e,n.line,t,n,o))throw new Error("Inserting collapsed marker partially overlapping an existing one");vo=!0}o.addToHistory&&Vi(e,{from:t,to:n,origin:"markText"},e.sel,NaN);var s,l=t.line,u=e.cm;if(e.iter(l,n.line+1,function(e){u&&o.collapsed&&!u.options.lineWrapping&&Jn(e)==u.display.maxLine&&(s=!0),o.collapsed&&l!=t.line&&Ii(e,0),Bn(e,new In(o,l==t.line?t.ch:null,l==n.line?n.ch:null)),++l}),o.collapsed&&e.iter(t.line,n.line+1,function(t){ni(e,t)&&Ii(t,0)}),o.clearOnEnter&&ua(o,"beforeCursorEnter",function(){o.clear()}),o.readOnly&&(mo=!0,(e.history.done.length||e.history.undone.length)&&e.clearHistory()),o.collapsed&&(o.id=++Yo,o.atomic=!0),u){if(s&&(u.curOp.updateMaxLine=!0),o.collapsed)pt(u,t.line,n.line+1);else if(o.className||o.title||o.startStyle||o.endStyle)for(var c=t.line;c<=n.line;c++)gt(u,c,"text");o.atomic&&fe(u.doc),nr(u,"markerAdded",u,o)}return o}function En(e,t,n,i,r){i=gr(i),i.shared=!1;var o=[Ln(e,t,n,i,r)],a=o[0],s=i.widgetNode;return Li(e,function(e){s&&(i.widgetNode=s.cloneNode(!0)),o.push(Ln(e,Z(e,t),Z(e,n),i,r));for(var l=0;l<e.linked.length;++l)if(e.linked[l].isParent)return;a=hr(o)}),new Qo(o,a)}function Pn(e){return e.findMarks(yo(e.first,0),e.clipPos(yo(e.lastLine())),function(e){return e.parent})}function Nn(e,t){for(var n=0;n<t.length;n++){var i=t[n],r=i.find(),o=e.clipPos(r.from),a=e.clipPos(r.to);if(_o(o,a)){var s=Ln(e,o,a,i.primary,i.primary.type);i.markers.push(s),s.parent=i}}}function An(e){for(var t=0;t<e.length;t++){var n=e[t],i=[n.primary.doc];Li(n.primary.doc,function(e){i.push(e)});for(var r=0;r<n.markers.length;r++){var o=n.markers[r];-1==dr(i,o.doc)&&(o.parent=null,n.markers.splice(r--,1))}}}function In(e,t,n){this.marker=e,this.from=t,this.to=n}function On(e,t){if(e)for(var n=0;n<e.length;++n){var i=e[n];if(i.marker==t)return i}}function Dn(e,t){for(var n,i=0;i<e.length;++i)e[i]!=t&&(n||(n=[])).push(e[i]);return n}function Bn(e,t){e.markedSpans=e.markedSpans?e.markedSpans.concat([t]):[t],t.marker.attachLine(e)}function Rn(e,t,n){if(e)for(var i,r=0;r<e.length;++r){var o=e[r],a=o.marker,s=null==o.from||(a.inclusiveLeft?o.from<=t:o.from<t);if(s||o.from==t&&"bookmark"==a.type&&(!n||!o.marker.insertLeft)){var l=null==o.to||(a.inclusiveRight?o.to>=t:o.to>t);(i||(i=[])).push(new In(a,o.from,l?null:o.to))}}return i}function zn(e,t,n){if(e)for(var i,r=0;r<e.length;++r){var o=e[r],a=o.marker,s=null==o.to||(a.inclusiveRight?o.to>=t:o.to>t);if(s||o.from==t&&"bookmark"==a.type&&(!n||o.marker.insertLeft)){var l=null==o.from||(a.inclusiveLeft?o.from<=t:o.from<t);(i||(i=[])).push(new In(a,l?null:o.from-t,null==o.to?null:o.to-t))}}return i}function Wn(e,t){var n=te(e,t.from.line)&&Pi(e,t.from.line).markedSpans,i=te(e,t.to.line)&&Pi(e,t.to.line).markedSpans;if(!n&&!i)return null;var r=t.from.ch,o=t.to.ch,a=0==_o(t.from,t.to),s=Rn(n,r,a),l=zn(i,o,a),u=1==t.text.length,c=hr(t.text).length+(u?r:0);if(s)for(var h=0;h<s.length;++h){var d=s[h];if(null==d.to){var f=On(l,d.marker);f?u&&(d.to=null==f.to?null:f.to+c):d.to=r}}if(l)for(var h=0;h<l.length;++h){var d=l[h];if(null!=d.to&&(d.to+=c),null==d.from){var f=On(s,d.marker);f||(d.from=c,u&&(s||(s=[])).push(d))}else d.from+=c,u&&(s||(s=[])).push(d)}s&&(s=Hn(s)),l&&l!=s&&(l=Hn(l));var p=[s];if(!u){var g,m=t.text.length-2;if(m>0&&s)for(var h=0;h<s.length;++h)null==s[h].to&&(g||(g=[])).push(new In(s[h].marker,null,null));for(var h=0;m>h;++h)p.push(g);
p.push(l)}return p}function Hn(e){for(var t=0;t<e.length;++t){var n=e[t];null!=n.from&&n.from==n.to&&n.marker.clearWhenEmpty!==!1&&e.splice(t--,1)}return e.length?e:null}function Un(e,t){var n=Gi(e,t),i=Wn(e,t);if(!n)return i;if(!i)return n;for(var r=0;r<n.length;++r){var o=n[r],a=i[r];if(o&&a)e:for(var s=0;s<a.length;++s){for(var l=a[s],u=0;u<o.length;++u)if(o[u].marker==l.marker)continue e;o.push(l)}else a&&(n[r]=a)}return n}function Vn(e,t,n){var i=null;if(e.iter(t.line,n.line+1,function(e){if(e.markedSpans)for(var t=0;t<e.markedSpans.length;++t){var n=e.markedSpans[t].marker;!n.readOnly||i&&-1!=dr(i,n)||(i||(i=[])).push(n)}}),!i)return null;for(var r=[{from:t,to:n}],o=0;o<i.length;++o)for(var a=i[o],s=a.find(0),l=0;l<r.length;++l){var u=r[l];if(!(_o(u.to,s.from)<0||_o(u.from,s.to)>0)){var c=[l,1],h=_o(u.from,s.from),d=_o(u.to,s.to);(0>h||!a.inclusiveLeft&&!h)&&c.push({from:u.from,to:s.from}),(d>0||!a.inclusiveRight&&!d)&&c.push({from:s.to,to:u.to}),r.splice.apply(r,c),l+=c.length-1}}return r}function jn(e){var t=e.markedSpans;if(t){for(var n=0;n<t.length;++n)t[n].marker.detachLine(e);e.markedSpans=null}}function Fn(e,t){if(t){for(var n=0;n<t.length;++n)t[n].marker.attachLine(e);e.markedSpans=t}}function $n(e){return e.inclusiveLeft?-1:0}function Kn(e){return e.inclusiveRight?1:0}function qn(e,t){var n=e.lines.length-t.lines.length;if(0!=n)return n;var i=e.find(),r=t.find(),o=_o(i.from,r.from)||$n(e)-$n(t);if(o)return-o;var a=_o(i.to,r.to)||Kn(e)-Kn(t);return a?a:t.id-e.id}function Gn(e,t){var n,i=vo&&e.markedSpans;if(i)for(var r,o=0;o<i.length;++o)r=i[o],r.marker.collapsed&&null==(t?r.from:r.to)&&(!n||qn(n,r.marker)<0)&&(n=r.marker);return n}function Xn(e){return Gn(e,!0)}function Yn(e){return Gn(e,!1)}function Qn(e,t,n,i,r){var o=Pi(e,t),a=vo&&o.markedSpans;if(a)for(var s=0;s<a.length;++s){var l=a[s];if(l.marker.collapsed){var u=l.marker.find(0),c=_o(u.from,n)||$n(l.marker)-$n(r),h=_o(u.to,i)||Kn(l.marker)-Kn(r);if(!(c>=0&&0>=h||0>=c&&h>=0)&&(0>=c&&(_o(u.to,n)>0||l.marker.inclusiveRight&&r.inclusiveLeft)||c>=0&&(_o(u.from,i)<0||l.marker.inclusiveLeft&&r.inclusiveRight)))return!0}}}function Jn(e){for(var t;t=Xn(e);)e=t.find(-1,!0).line;return e}function Zn(e){for(var t,n;t=Yn(e);)e=t.find(1,!0).line,(n||(n=[])).push(e);return n}function ei(e,t){var n=Pi(e,t),i=Jn(n);return n==i?t:Oi(i)}function ti(e,t){if(t>e.lastLine())return t;var n,i=Pi(e,t);if(!ni(e,i))return t;for(;n=Yn(i);)i=n.find(1,!0).line;return Oi(i)+1}function ni(e,t){var n=vo&&t.markedSpans;if(n)for(var i,r=0;r<n.length;++r)if(i=n[r],i.marker.collapsed){if(null==i.from)return!0;if(!i.marker.widgetNode&&0==i.from&&i.marker.inclusiveLeft&&ii(e,t,i))return!0}}function ii(e,t,n){if(null==n.to){var i=n.marker.find(1,!0);return ii(e,i.line,On(i.line.markedSpans,n.marker))}if(n.marker.inclusiveRight&&n.to==t.text.length)return!0;for(var r,o=0;o<t.markedSpans.length;++o)if(r=t.markedSpans[o],r.marker.collapsed&&!r.marker.widgetNode&&r.from==n.to&&(null==r.to||r.to!=n.from)&&(r.marker.inclusiveLeft||n.marker.inclusiveRight)&&ii(e,t,r))return!0}function ri(e,t,n){Bi(t)<(e.curOp&&e.curOp.scrollTop||e.doc.scrollTop)&&yn(e,null,n)}function oi(e){if(null!=e.height)return e.height;if(!kr(document.body,e.node)){var t="position: relative;";e.coverGutter&&(t+="margin-left: -"+e.cm.getGutterElement().offsetWidth+"px;"),xr(e.cm.display.measure,br("div",[e.node],null,t))}return e.height=e.node.offsetHeight}function ai(e,t,n,i){var r=new Jo(e,n,i);return r.noHScroll&&(e.display.alignWidgets=!0),xn(e.doc,t,"widget",function(t){var n=t.widgets||(t.widgets=[]);if(null==r.insertAt?n.push(r):n.splice(Math.min(n.length-1,Math.max(0,r.insertAt)),0,r),r.line=t,!ni(e.doc,t)){var i=Bi(t)<e.doc.scrollTop;Ii(t,t.height+oi(r)),i&&yn(e,null,r.height),e.curOp.forceUpdate=!0}return!0}),r}function si(e,t,n,i){e.text=t,e.stateAfter&&(e.stateAfter=null),e.styles&&(e.styles=null),null!=e.order&&(e.order=null),jn(e),Fn(e,n);var r=i?i(e):1;r!=e.height&&Ii(e,r)}function li(e){e.parent=null,jn(e)}function ui(e,t){if(e)for(;;){var n=e.match(/(?:^|\s+)line-(background-)?(\S+)/);if(!n)break;e=e.slice(0,n.index)+e.slice(n.index+n[0].length);var i=n[1]?"bgClass":"textClass";null==t[i]?t[i]=n[2]:new RegExp("(?:^|s)"+n[2]+"(?:$|s)").test(t[i])||(t[i]+=" "+n[2])}return e}function ci(t,n){if(t.blankLine)return t.blankLine(n);if(t.innerMode){var i=e.innerMode(t,n);return i.mode.blankLine?i.mode.blankLine(i.state):void 0}}function hi(e,t,n){for(var i=0;10>i;i++){var r=e.token(t,n);if(t.pos>t.start)return r}throw new Error("Mode "+e.name+" failed to advance stream.")}function di(t,n,i,r,o,a,s){var l=i.flattenSpans;null==l&&(l=t.options.flattenSpans);var u,c=0,h=null,d=new Go(n,t.options.tabSize);for(""==n&&ui(ci(i,r),a);!d.eol();){if(d.pos>t.options.maxHighlightLength?(l=!1,s&&gi(t,n,r,d.pos),d.pos=n.length,u=null):u=ui(hi(i,d,r),a),t.options.addModeClass){var f=e.innerMode(i,r).mode.name;f&&(u="m-"+(u?f+" "+u:f))}l&&h==u||(c<d.start&&o(d.start,h),c=d.start,h=u),d.start=d.pos}for(;c<d.pos;){var p=Math.min(d.pos,c+5e4);o(p,h),c=p}}function fi(e,t,n,i){var r=[e.state.modeGen],o={};di(e,t.text,e.doc.mode,n,function(e,t){r.push(e,t)},o,i);for(var a=0;a<e.state.overlays.length;++a){var s=e.state.overlays[a],l=1,u=0;di(e,t.text,s.mode,!0,function(e,t){for(var n=l;e>u;){var i=r[l];i>e&&r.splice(l,1,e,r[l+1],i),l+=2,u=Math.min(e,i)}if(t)if(s.opaque)r.splice(n,l-n,e,"cm-overlay "+t),l=n+2;else for(;l>n;n+=2){var o=r[n+1];r[n+1]=(o?o+" ":"")+"cm-overlay "+t}},o)}return{styles:r,classes:o.bgClass||o.textClass?o:null}}function pi(e,t){if(!t.styles||t.styles[0]!=e.state.modeGen){var n=fi(e,t,t.stateAfter=Se(e,Oi(t)));t.styles=n.styles,n.classes?t.styleClasses=n.classes:t.styleClasses&&(t.styleClasses=null)}return t.styles}function gi(e,t,n,i){var r=e.doc.mode,o=new Go(t,e.options.tabSize);for(o.start=o.pos=i||0,""==t&&ci(r,n);!o.eol()&&o.pos<=e.options.maxHighlightLength;)hi(r,o,n),o.start=o.pos}function mi(e,t){if(!e||/^\s*$/.test(e))return null;var n=t.addModeClass?ta:ea;return n[e]||(n[e]=e.replace(/\S+/g,"cm-$&"))}function vi(e,t){var n=br("span",null,null,eo?"padding-right: .1px":null),i={pre:br("pre",[n]),content:n,col:0,pos:0,cm:e};t.measure={};for(var r=0;r<=(t.rest?t.rest.length:0);r++){var o,a=r?t.rest[r-1]:t.line;i.pos=0,i.addToken=_i,(Jr||eo)&&e.getOption("lineWrapping")&&(i.addToken=bi(i.addToken)),Or(e.display.measure)&&(o=Ri(a))&&(i.addToken=wi(i.addToken,o)),i.map=[],ki(a,i,pi(e,a)),a.styleClasses&&(a.styleClasses.bgClass&&(i.bgClass=Lr(a.styleClasses.bgClass,i.bgClass||"")),a.styleClasses.textClass&&(i.textClass=Lr(a.styleClasses.textClass,i.textClass||""))),0==i.map.length&&i.map.push(0,0,i.content.appendChild(Ir(e.display.measure))),0==r?(t.measure.map=i.map,t.measure.cache={}):((t.measure.maps||(t.measure.maps=[])).push(i.map),(t.measure.caches||(t.measure.caches=[])).push({}))}return ha(e,"renderLine",e,t.line,i.pre),i.pre.className&&(i.textClass=Lr(i.pre.className,i.textClass||"")),i}function yi(e){var t=br("span","•","cm-invalidchar");return t.title="\\u"+e.charCodeAt(0).toString(16),t}function _i(e,t,n,i,r,o){if(t){var a=e.cm.options.specialChars,s=!1;if(a.test(t))for(var l=document.createDocumentFragment(),u=0;;){a.lastIndex=u;var c=a.exec(t),h=c?c.index-u:t.length-u;if(h){var d=document.createTextNode(t.slice(u,u+h));Jr&&9>Zr?l.appendChild(br("span",[d])):l.appendChild(d),e.map.push(e.pos,e.pos+h,d),e.col+=h,e.pos+=h}if(!c)break;if(u+=h+1,"	"==c[0]){var f=e.cm.options.tabSize,p=f-e.col%f,d=l.appendChild(br("span",cr(p),"cm-tab"));e.col+=p}else{var d=e.cm.options.specialCharPlaceholder(c[0]);Jr&&9>Zr?l.appendChild(br("span",[d])):l.appendChild(d),e.col+=1}e.map.push(e.pos,e.pos+1,d),e.pos++}else{e.col+=t.length;var l=document.createTextNode(t);e.map.push(e.pos,e.pos+t.length,l),Jr&&9>Zr&&(s=!0),e.pos+=t.length}if(n||i||r||s){var g=n||"";i&&(g+=i),r&&(g+=r);var m=br("span",[l],g);return o&&(m.title=o),e.content.appendChild(m)}e.content.appendChild(l)}}function bi(e){function t(e){for(var t=" ",n=0;n<e.length-2;++n)t+=n%2?" ":" ";return t+=" "}return function(n,i,r,o,a,s){e(n,i.replace(/ {3,}/g,t),r,o,a,s)}}function wi(e,t){return function(n,i,r,o,a,s){r=r?r+" cm-force-border":"cm-force-border";for(var l=n.pos,u=l+i.length;;){for(var c=0;c<t.length;c++){var h=t[c];if(h.to>l&&h.from<=l)break}if(h.to>=u)return e(n,i,r,o,a,s);e(n,i.slice(0,h.to-l),r,o,null,s),o=null,i=i.slice(h.to-l),l=h.to}}}function xi(e,t,n,i){var r=!i&&n.widgetNode;r&&(e.map.push(e.pos,e.pos+t,r),e.content.appendChild(r)),e.pos+=t}function ki(e,t,n){var i=e.markedSpans,r=e.text,o=0;if(i)for(var a,s,l,u,c,h,d=r.length,f=0,p=1,g="",m=0;;){if(m==f){s=l=u=c="",h=null,m=1/0;for(var v=[],y=0;y<i.length;++y){var _=i[y],b=_.marker;_.from<=f&&(null==_.to||_.to>f)?(null!=_.to&&m>_.to&&(m=_.to,l=""),b.className&&(s+=" "+b.className),b.startStyle&&_.from==f&&(u+=" "+b.startStyle),b.endStyle&&_.to==m&&(l+=" "+b.endStyle),b.title&&!c&&(c=b.title),b.collapsed&&(!h||qn(h.marker,b)<0)&&(h=_)):_.from>f&&m>_.from&&(m=_.from),"bookmark"==b.type&&_.from==f&&b.widgetNode&&v.push(b)}if(h&&(h.from||0)==f&&(xi(t,(null==h.to?d+1:h.to)-f,h.marker,null==h.from),null==h.to))return;if(!h&&v.length)for(var y=0;y<v.length;++y)xi(t,0,v[y])}if(f>=d)break;for(var w=Math.min(d,m);;){if(g){var x=f+g.length;if(!h){var k=x>w?g.slice(0,w-f):g;t.addToken(t,k,a?a+s:s,u,f+k.length==m?l:"",c)}if(x>=w){g=g.slice(w-f),f=w;break}f=x,u=""}g=r.slice(o,o=n[p++]),a=mi(n[p++],t.cm.options)}}else for(var p=1;p<n.length;p+=2)t.addToken(t,r.slice(o,o=n[p]),mi(n[p+1],t.cm.options))}function Ci(e,t){return 0==t.from.ch&&0==t.to.ch&&""==hr(t.text)&&(!e.cm||e.cm.options.wholeLineUpdateBefore)}function Si(e,t,n,i){function r(e){return n?n[e]:null}function o(e,n,r){si(e,n,r,i),nr(e,"change",e,t)}var a=t.from,s=t.to,l=t.text,u=Pi(e,a.line),c=Pi(e,s.line),h=hr(l),d=r(l.length-1),f=s.line-a.line;if(Ci(e,t)){for(var p=0,g=[];p<l.length-1;++p)g.push(new Zo(l[p],r(p),i));o(c,c.text,d),f&&e.remove(a.line,f),g.length&&e.insert(a.line,g)}else if(u==c)if(1==l.length)o(u,u.text.slice(0,a.ch)+h+u.text.slice(s.ch),d);else{for(var g=[],p=1;p<l.length-1;++p)g.push(new Zo(l[p],r(p),i));g.push(new Zo(h+u.text.slice(s.ch),d,i)),o(u,u.text.slice(0,a.ch)+l[0],r(0)),e.insert(a.line+1,g)}else if(1==l.length)o(u,u.text.slice(0,a.ch)+l[0]+c.text.slice(s.ch),r(0)),e.remove(a.line+1,f);else{o(u,u.text.slice(0,a.ch)+l[0],r(0)),o(c,h+c.text.slice(s.ch),d);for(var p=1,g=[];p<l.length-1;++p)g.push(new Zo(l[p],r(p),i));f>1&&e.remove(a.line+1,f-1),e.insert(a.line+1,g)}nr(e,"change",e,t)}function Ti(e){this.lines=e,this.parent=null;for(var t=0,n=0;t<e.length;++t)e[t].parent=this,n+=e[t].height;this.height=n}function Mi(e){this.children=e;for(var t=0,n=0,i=0;i<e.length;++i){var r=e[i];t+=r.chunkSize(),n+=r.height,r.parent=this}this.size=t,this.height=n,this.parent=null}function Li(e,t,n){function i(e,r,o){if(e.linked)for(var a=0;a<e.linked.length;++a){var s=e.linked[a];if(s.doc!=r){var l=o&&s.sharedHist;(!n||l)&&(t(s.doc,l),i(s.doc,e,l))}}}i(e,null,!0)}function Ei(e,t){if(t.cm)throw new Error("This document is already in use.");e.doc=t,t.cm=e,a(e),n(e),e.options.lineWrapping||f(e),e.options.mode=t.modeOption,pt(e)}function Pi(e,t){if(t-=e.first,0>t||t>=e.size)throw new Error("There is no line "+(t+e.first)+" in the document.");for(var n=e;!n.lines;)for(var i=0;;++i){var r=n.children[i],o=r.chunkSize();if(o>t){n=r;break}t-=o}return n.lines[t]}function Ni(e,t,n){var i=[],r=t.line;return e.iter(t.line,n.line+1,function(e){var o=e.text;r==n.line&&(o=o.slice(0,n.ch)),r==t.line&&(o=o.slice(t.ch)),i.push(o),++r}),i}function Ai(e,t,n){var i=[];return e.iter(t,n,function(e){i.push(e.text)}),i}function Ii(e,t){var n=t-e.height;if(n)for(var i=e;i;i=i.parent)i.height+=n}function Oi(e){if(null==e.parent)return null;for(var t=e.parent,n=dr(t.lines,e),i=t.parent;i;t=i,i=i.parent)for(var r=0;i.children[r]!=t;++r)n+=i.children[r].chunkSize();return n+t.first}function Di(e,t){var n=e.first;e:do{for(var i=0;i<e.children.length;++i){var r=e.children[i],o=r.height;if(o>t){e=r;continue e}t-=o,n+=r.chunkSize()}return n}while(!e.lines);for(var i=0;i<e.lines.length;++i){var a=e.lines[i],s=a.height;if(s>t)break;t-=s}return n+i}function Bi(e){e=Jn(e);for(var t=0,n=e.parent,i=0;i<n.lines.length;++i){var r=n.lines[i];if(r==e)break;t+=r.height}for(var o=n.parent;o;n=o,o=n.parent)for(var i=0;i<o.children.length;++i){var a=o.children[i];if(a==n)break;t+=a.height}return t}function Ri(e){var t=e.order;return null==t&&(t=e.order=Ba(e.text)),t}function zi(e){this.done=[],this.undone=[],this.undoDepth=1/0,this.lastModTime=this.lastSelTime=0,this.lastOp=this.lastSelOp=null,this.lastOrigin=this.lastSelOrigin=null,this.generation=this.maxGeneration=e||1}function Wi(e,t){var n={from:$(t.from),to:Ao(t),text:Ni(e,t.from,t.to)};return Ki(e,n,t.from.line,t.to.line+1),Li(e,function(e){Ki(e,n,t.from.line,t.to.line+1)},!0),n}function Hi(e){for(;e.length;){var t=hr(e);if(!t.ranges)break;e.pop()}}function Ui(e,t){return t?(Hi(e.done),hr(e.done)):e.done.length&&!hr(e.done).ranges?hr(e.done):e.done.length>1&&!e.done[e.done.length-2].ranges?(e.done.pop(),hr(e.done)):void 0}function Vi(e,t,n,i){var r=e.history;r.undone.length=0;var o,a=+new Date;if((r.lastOp==i||r.lastOrigin==t.origin&&t.origin&&("+"==t.origin.charAt(0)&&e.cm&&r.lastModTime>a-e.cm.options.historyEventDelay||"*"==t.origin.charAt(0)))&&(o=Ui(r,r.lastOp==i))){var s=hr(o.changes);0==_o(t.from,t.to)&&0==_o(t.from,s.to)?s.to=Ao(t):o.changes.push(Wi(e,t))}else{var l=hr(r.done);for(l&&l.ranges||$i(e.sel,r.done),o={changes:[Wi(e,t)],generation:r.generation},r.done.push(o);r.done.length>r.undoDepth;)r.done.shift(),r.done[0].ranges||r.done.shift()}r.done.push(n),r.generation=++r.maxGeneration,r.lastModTime=r.lastSelTime=a,r.lastOp=r.lastSelOp=i,r.lastOrigin=r.lastSelOrigin=t.origin,s||ha(e,"historyAdded")}function ji(e,t,n,i){var r=t.charAt(0);return"*"==r||"+"==r&&n.ranges.length==i.ranges.length&&n.somethingSelected()==i.somethingSelected()&&new Date-e.history.lastSelTime<=(e.cm?e.cm.options.historyEventDelay:500)}function Fi(e,t,n,i){var r=e.history,o=i&&i.origin;n==r.lastSelOp||o&&r.lastSelOrigin==o&&(r.lastModTime==r.lastSelTime&&r.lastOrigin==o||ji(e,o,hr(r.done),t))?r.done[r.done.length-1]=t:$i(t,r.done),r.lastSelTime=+new Date,r.lastSelOrigin=o,r.lastSelOp=n,i&&i.clearRedo!==!1&&Hi(r.undone)}function $i(e,t){var n=hr(t);n&&n.ranges&&n.equals(e)||t.push(e)}function Ki(e,t,n,i){var r=t["spans_"+e.id],o=0;e.iter(Math.max(e.first,n),Math.min(e.first+e.size,i),function(n){n.markedSpans&&((r||(r=t["spans_"+e.id]={}))[o]=n.markedSpans),++o})}function qi(e){if(!e)return null;for(var t,n=0;n<e.length;++n)e[n].marker.explicitlyCleared?t||(t=e.slice(0,n)):t&&t.push(e[n]);return t?t.length?t:null:e}function Gi(e,t){var n=t["spans_"+e.id];if(!n)return null;for(var i=0,r=[];i<t.text.length;++i)r.push(qi(n[i]));return r}function Xi(e,t,n){for(var i=0,r=[];i<e.length;++i){var o=e[i];if(o.ranges)r.push(n?G.prototype.deepCopy.call(o):o);else{var a=o.changes,s=[];r.push({changes:s});for(var l=0;l<a.length;++l){var u,c=a[l];if(s.push({from:c.from,to:c.to,text:c.text}),t)for(var h in c)(u=h.match(/^spans_(\d+)$/))&&dr(t,Number(u[1]))>-1&&(hr(s)[h]=c[h],delete c[h])}}}return r}function Yi(e,t,n,i){n<e.line?e.line+=i:t<e.line&&(e.line=t,e.ch=0)}function Qi(e,t,n,i){for(var r=0;r<e.length;++r){var o=e[r],a=!0;if(o.ranges){o.copied||(o=e[r]=o.deepCopy(),o.copied=!0);for(var s=0;s<o.ranges.length;s++)Yi(o.ranges[s].anchor,t,n,i),Yi(o.ranges[s].head,t,n,i)}else{for(var s=0;s<o.changes.length;++s){var l=o.changes[s];if(n<l.from.line)l.from=yo(l.from.line+i,l.from.ch),l.to=yo(l.to.line+i,l.to.ch);else if(t<=l.to.line){a=!1;break}}a||(e.splice(0,r+1),r=0)}}}function Ji(e,t){var n=t.from.line,i=t.to.line,r=t.text.length-(i-n)-1;Qi(e.done,n,i,r),Qi(e.undone,n,i,r)}function Zi(e){return null!=e.defaultPrevented?e.defaultPrevented:0==e.returnValue}function er(e){return e.target||e.srcElement}function tr(e){var t=e.which;return null==t&&(1&e.button?t=1:2&e.button?t=3:4&e.button&&(t=2)),co&&e.ctrlKey&&1==t&&(t=3),t}function nr(e,t){function n(e){return function(){e.apply(null,o)}}var i=e._handlers&&e._handlers[t];if(i){var r,o=Array.prototype.slice.call(arguments,2);Co?r=Co.delayedCallbacks:da?r=da:(r=da=[],setTimeout(ir,0));for(var a=0;a<i.length;++a)r.push(n(i[a]))}}function ir(){var e=da;da=null;for(var t=0;t<e.length;++t)e[t]()}function rr(e,t,n){return ha(e,n||t.type,e,t),Zi(t)||t.codemirrorIgnore}function or(e){var t=e._handlers&&e._handlers.cursorActivity;if(t)for(var n=e.curOp.cursorActivityHandlers||(e.curOp.cursorActivityHandlers=[]),i=0;i<t.length;++i)-1==dr(n,t[i])&&n.push(t[i])}function ar(e,t){var n=e._handlers&&e._handlers[t];return n&&n.length>0}function sr(e){e.prototype.on=function(e,t){ua(this,e,t)},e.prototype.off=function(e,t){ca(this,e,t)}}function lr(){this.id=null}function ur(e,t,n){for(var i=0,r=0;;){var o=e.indexOf("	",i);-1==o&&(o=e.length);var a=o-i;if(o==e.length||r+a>=t)return i+Math.min(a,t-r);if(r+=o-i,r+=n-r%n,i=o+1,r>=t)return i}}function cr(e){for(;_a.length<=e;)_a.push(hr(_a)+" ");return _a[e]}function hr(e){return e[e.length-1]}function dr(e,t){for(var n=0;n<e.length;++n)if(e[n]==t)return n;return-1}function fr(e,t){for(var n=[],i=0;i<e.length;i++)n[i]=t(e[i],i);return n}function pr(e,t){var n;if(Object.create)n=Object.create(e);else{var i=function(){};i.prototype=e,n=new i}return t&&gr(t,n),n}function gr(e,t,n){t||(t={});for(var i in e)!e.hasOwnProperty(i)||n===!1&&t.hasOwnProperty(i)||(t[i]=e[i]);return t}function mr(e){var t=Array.prototype.slice.call(arguments,1);return function(){return e.apply(null,t)}}function vr(e,t){return t?t.source.indexOf("\\w")>-1&&ka(e)?!0:t.test(e):ka(e)}function yr(e){for(var t in e)if(e.hasOwnProperty(t)&&e[t])return!1;return!0}function _r(e){return e.charCodeAt(0)>=768&&Ca.test(e)}function br(e,t,n,i){var r=document.createElement(e);if(n&&(r.className=n),i&&(r.style.cssText=i),"string"==typeof t)r.appendChild(document.createTextNode(t));else if(t)for(var o=0;o<t.length;++o)r.appendChild(t[o]);return r}function wr(e){for(var t=e.childNodes.length;t>0;--t)e.removeChild(e.firstChild);return e}function xr(e,t){return wr(e).appendChild(t)}function kr(e,t){if(e.contains)return e.contains(t);for(;t=t.parentNode;)if(t==e)return!0}function Cr(){return document.activeElement}function Sr(e){return new RegExp("\\b"+e+"\\b\\s*")}function Tr(e,t){var n=Sr(t);n.test(e.className)&&(e.className=e.className.replace(n,""))}function Mr(e,t){Sr(t).test(e.className)||(e.className+=" "+t)}function Lr(e,t){for(var n=e.split(" "),i=0;i<n.length;i++)n[i]&&!Sr(n[i]).test(t)&&(t+=" "+n[i]);return t}function Er(e){if(document.body.getElementsByClassName)for(var t=document.body.getElementsByClassName("CodeMirror"),n=0;n<t.length;n++){var i=t[n].CodeMirror;i&&e(i)}}function Pr(){La||(Nr(),La=!0)}function Nr(){var e;ua(window,"resize",function(){null==e&&(e=setTimeout(function(){e=null,Sa=null,Er(Et)},100))}),ua(window,"blur",function(){Er(Jt)})}function Ar(e){if(null!=Sa)return Sa;var t=br("div",null,null,"width: 50px; height: 50px; overflow-x: scroll");return xr(e,t),t.offsetWidth&&(Sa=t.offsetHeight-t.clientHeight),Sa||0}function Ir(e){if(null==Ta){var t=br("span","​");xr(e,br("span",[t,document.createTextNode("x")])),0!=e.firstChild.offsetHeight&&(Ta=t.offsetWidth<=1&&t.offsetHeight>2&&!(Jr&&8>Zr))}return Ta?br("span","​"):br("span"," ",null,"display: inline-block; width: 1px; margin-right: -1px")}function Or(e){if(null!=Ma)return Ma;var t=xr(e,document.createTextNode("AخA")),n=wa(t,0,1).getBoundingClientRect();if(!n||n.left==n.right)return!1;var i=wa(t,1,2).getBoundingClientRect();return Ma=i.right-n.right<3}function Dr(e){if(null!=Ia)return Ia;var t=xr(e,br("span","x")),n=t.getBoundingClientRect(),i=wa(t,0,1).getBoundingClientRect();return Ia=Math.abs(n.left-i.left)>1}function Br(e,t,n,i){if(!e)return i(t,n,"ltr");for(var r=!1,o=0;o<e.length;++o){var a=e[o];(a.from<n&&a.to>t||t==n&&a.to==t)&&(i(Math.max(a.from,t),Math.min(a.to,n),1==a.level?"rtl":"ltr"),r=!0)}r||i(t,n,"ltr")}function Rr(e){return e.level%2?e.to:e.from}function zr(e){return e.level%2?e.from:e.to}function Wr(e){var t=Ri(e);return t?Rr(t[0]):0}function Hr(e){var t=Ri(e);return t?zr(hr(t)):e.text.length}function Ur(e,t){var n=Pi(e.doc,t),i=Jn(n);i!=n&&(t=Oi(i));var r=Ri(i),o=r?r[0].level%2?Hr(i):Wr(i):0;return yo(t,o)}function Vr(e,t){for(var n,i=Pi(e.doc,t);n=Yn(i);)i=n.find(1,!0).line,t=null;var r=Ri(i),o=r?r[0].level%2?Wr(i):Hr(i):i.text.length;return yo(null==t?Oi(i):t,o)}function jr(e,t){var n=Ur(e,t.line),i=Pi(e.doc,n.line),r=Ri(i);if(!r||0==r[0].level){var o=Math.max(0,i.text.search(/\S/)),a=t.line==n.line&&t.ch<=o&&t.ch;return yo(n.line,a?0:o)}return n}function Fr(e,t,n){var i=e[0].level;return t==i?!0:n==i?!1:n>t}function $r(e,t){Da=null;for(var n,i=0;i<e.length;++i){var r=e[i];if(r.from<t&&r.to>t)return i;if(r.from==t||r.to==t){if(null!=n)return Fr(e,r.level,e[n].level)?(r.from!=r.to&&(Da=n),i):(r.from!=r.to&&(Da=i),n);n=i}}return n}function Kr(e,t,n,i){if(!i)return t+n;do t+=n;while(t>0&&_r(e.text.charAt(t)));return t}function qr(e,t,n,i){var r=Ri(e);if(!r)return Gr(e,t,n,i);for(var o=$r(r,t),a=r[o],s=Kr(e,t,a.level%2?-n:n,i);;){if(s>a.from&&s<a.to)return s;if(s==a.from||s==a.to)return $r(r,s)==o?s:(a=r[o+=n],n>0==a.level%2?a.to:a.from);if(a=r[o+=n],!a)return null;s=n>0==a.level%2?Kr(e,a.to,-1,i):Kr(e,a.from,1,i)}}function Gr(e,t,n,i){var r=t+n;if(i)for(;r>0&&_r(e.text.charAt(r));)r+=n;return 0>r||r>e.text.length?null:r}var Xr=/gecko\/\d/i.test(navigator.userAgent),Yr=/MSIE \d/.test(navigator.userAgent),Qr=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),Jr=Yr||Qr,Zr=Jr&&(Yr?document.documentMode||6:Qr[1]),eo=/WebKit\//.test(navigator.userAgent),to=eo&&/Qt\/\d+\.\d+/.test(navigator.userAgent),no=/Chrome\//.test(navigator.userAgent),io=/Opera\//.test(navigator.userAgent),ro=/Apple Computer/.test(navigator.vendor),oo=/KHTML\//.test(navigator.userAgent),ao=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(navigator.userAgent),so=/PhantomJS/.test(navigator.userAgent),lo=/AppleWebKit/.test(navigator.userAgent)&&/Mobile\/\w+/.test(navigator.userAgent),uo=lo||/Android|webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(navigator.userAgent),co=lo||/Mac/.test(navigator.platform),ho=/win/i.test(navigator.platform),fo=io&&navigator.userAgent.match(/Version\/(\d*\.\d*)/);fo&&(fo=Number(fo[1])),fo&&fo>=15&&(io=!1,eo=!0);var po=co&&(to||io&&(null==fo||12.11>fo)),go=Xr||Jr&&Zr>=9,mo=!1,vo=!1,yo=e.Pos=function(e,t){return this instanceof yo?(this.line=e,void(this.ch=t)):new yo(e,t)},_o=e.cmpPos=function(e,t){return e.line-t.line||e.ch-t.ch};G.prototype={primary:function(){return this.ranges[this.primIndex]},equals:function(e){if(e==this)return!0;if(e.primIndex!=this.primIndex||e.ranges.length!=this.ranges.length)return!1;for(var t=0;t<this.ranges.length;t++){var n=this.ranges[t],i=e.ranges[t];if(0!=_o(n.anchor,i.anchor)||0!=_o(n.head,i.head))return!1}return!0},deepCopy:function(){for(var e=[],t=0;t<this.ranges.length;t++)e[t]=new X($(this.ranges[t].anchor),$(this.ranges[t].head));return new G(e,this.primIndex)},somethingSelected:function(){for(var e=0;e<this.ranges.length;e++)if(!this.ranges[e].empty())return!0;return!1},contains:function(e,t){t||(t=e);for(var n=0;n<this.ranges.length;n++){var i=this.ranges[n];if(_o(t,i.from())>=0&&_o(e,i.to())<=0)return n}return-1}},X.prototype={from:function(){return q(this.anchor,this.head)},to:function(){return K(this.anchor,this.head)},empty:function(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch}};var bo,wo,xo,ko={left:0,right:0,top:0,bottom:0},Co=null,So=0,To=null,Mo=0,Lo=0,Eo=null;Jr?Eo=-.53:Xr?Eo=15:no?Eo=-.7:ro&&(Eo=-1/3);var Po,No=null,Ao=e.changeEnd=function(e){return e.text?yo(e.from.line+e.text.length-1,hr(e.text).length+(1==e.text.length?e.from.ch:0)):e.to};e.prototype={constructor:e,focus:function(){window.focus(),St(this),xt(this)},setOption:function(e,t){var n=this.options,i=n[e];(n[e]!=t||"mode"==e)&&(n[e]=t,Oo.hasOwnProperty(e)&&ut(this,Oo[e])(this,t,i))},getOption:function(e){return this.options[e]},getDoc:function(){return this.doc},addKeyMap:function(e,t){this.state.keyMaps[t?"push":"unshift"](e)},removeKeyMap:function(e){for(var t=this.state.keyMaps,n=0;n<t.length;++n)if(t[n]==e||"string"!=typeof t[n]&&t[n].name==e)return t.splice(n,1),!0},addOverlay:ct(function(t,n){var i=t.token?t:e.getMode(this.options,t);if(i.startState)throw new Error("Overlays may not be stateful.");this.state.overlays.push({mode:i,modeSpec:t,opaque:n&&n.opaque}),this.state.modeGen++,pt(this)}),removeOverlay:ct(function(e){for(var t=this.state.overlays,n=0;n<t.length;++n){var i=t[n].modeSpec;if(i==e||"string"==typeof e&&i.name==e)return t.splice(n,1),this.state.modeGen++,void pt(this)}}),indentLine:ct(function(e,t,n){"string"!=typeof t&&"number"!=typeof t&&(t=null==t?this.options.smartIndent?"smart":"prev":t?"add":"subtract"),te(this.doc,e)&&wn(this,e,t,n)}),indentSelection:ct(function(e){for(var t=this.doc.sel.ranges,n=-1,i=0;i<t.length;i++){var r=t[i];if(r.empty())r.head.line>n&&(wn(this,r.head.line,e,!0),n=r.head.line,i==this.doc.sel.primIndex&&_n(this));else{var o=r.from(),a=r.to(),s=Math.max(n,o.line);n=Math.min(this.lastLine(),a.line-(a.ch?0:1))+1;for(var l=s;n>l;++l)wn(this,l,e);var u=this.doc.sel.ranges;0==o.ch&&t.length==u.length&&u[i].from().ch>0&&ae(this.doc,i,new X(o,u[i].to()),ga)}}}),getTokenAt:function(e,t){var n=this.doc;e=Z(n,e);for(var i=Se(this,e.line,t),r=this.doc.mode,o=Pi(n,e.line),a=new Go(o.text,this.options.tabSize);a.pos<e.ch&&!a.eol();){a.start=a.pos;var s=hi(r,a,i)}return{start:a.start,end:a.pos,string:a.current(),type:s||null,state:i}},getTokenTypeAt:function(e){e=Z(this.doc,e);var t,n=pi(this,Pi(this.doc,e.line)),i=0,r=(n.length-1)/2,o=e.ch;if(0==o)t=n[2];else for(;;){var a=i+r>>1;if((a?n[2*a-1]:0)>=o)r=a;else{if(!(n[2*a+1]<o)){t=n[2*a+2];break}i=a+1}}var s=t?t.indexOf("cm-overlay "):-1;return 0>s?t:0==s?null:t.slice(0,s-1)},getModeAt:function(t){var n=this.doc.mode;return n.innerMode?e.innerMode(n,this.getTokenAt(t).state).mode:n},getHelper:function(e,t){return this.getHelpers(e,t)[0]},getHelpers:function(e,t){var n=[];if(!Ho.hasOwnProperty(t))return Ho;var i=Ho[t],r=this.getModeAt(e);if("string"==typeof r[t])i[r[t]]&&n.push(i[r[t]]);else if(r[t])for(var o=0;o<r[t].length;o++){var a=i[r[t][o]];a&&n.push(a)}else r.helperType&&i[r.helperType]?n.push(i[r.helperType]):i[r.name]&&n.push(i[r.name]);for(var o=0;o<i._global.length;o++){var s=i._global[o];s.pred(r,this)&&-1==dr(n,s.val)&&n.push(s.val)}return n},getStateAfter:function(e,t){var n=this.doc;return e=J(n,null==e?n.first+n.size-1:e),Se(this,e+1,t)},cursorCoords:function(e,t){var n,i=this.doc.sel.primary();return n=null==e?i.head:"object"==typeof e?Z(this.doc,e):e?i.from():i.to(),Ke(this,n,t||"page")},charCoords:function(e,t){return $e(this,Z(this.doc,e),t||"page")},coordsChar:function(e,t){return e=Fe(this,e,t||"page"),Xe(this,e.left,e.top)},lineAtHeight:function(e,t){return e=Fe(this,{top:e,left:0},t||"page").top,Di(this.doc,e+this.display.viewOffset)},heightAtLine:function(e,t){var n=!1,i=this.doc.first+this.doc.size-1;e<this.doc.first?e=this.doc.first:e>i&&(e=i,n=!0);var r=Pi(this.doc,e);return je(this,r,{top:0,left:0},t||"page").top+(n?this.doc.height-Bi(r):0)},defaultTextHeight:function(){return Qe(this.display)},defaultCharWidth:function(){return Je(this.display)},setGutterMarker:ct(function(e,t,n){return xn(this.doc,e,"gutter",function(e){var i=e.gutterMarkers||(e.gutterMarkers={});return i[t]=n,!n&&yr(i)&&(e.gutterMarkers=null),!0})}),clearGutter:ct(function(e){var t=this,n=t.doc,i=n.first;n.iter(function(n){n.gutterMarkers&&n.gutterMarkers[e]&&(n.gutterMarkers[e]=null,gt(t,i,"gutter"),yr(n.gutterMarkers)&&(n.gutterMarkers=null)),++i})}),addLineWidget:ct(function(e,t,n){return ai(this,e,t,n)}),removeLineWidget:function(e){e.clear()},lineInfo:function(e){if("number"==typeof e){if(!te(this.doc,e))return null;var t=e;if(e=Pi(this.doc,e),!e)return null}else{var t=Oi(e);if(null==t)return null}return{line:t,handle:e,text:e.text,gutterMarkers:e.gutterMarkers,textClass:e.textClass,bgClass:e.bgClass,wrapClass:e.wrapClass,widgets:e.widgets}},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo}},addWidget:function(e,t,n,i,r){var o=this.display;e=Ke(this,Z(this.doc,e));var a=e.bottom,s=e.left;if(t.style.position="absolute",o.sizer.appendChild(t),"over"==i)a=e.top;else if("above"==i||"near"==i){var l=Math.max(o.wrapper.clientHeight,this.doc.height),u=Math.max(o.sizer.clientWidth,o.lineSpace.clientWidth);("above"==i||e.bottom+t.offsetHeight>l)&&e.top>t.offsetHeight?a=e.top-t.offsetHeight:e.bottom+t.offsetHeight<=l&&(a=e.bottom),s+t.offsetWidth>u&&(s=u-t.offsetWidth)}t.style.top=a+"px",t.style.left=t.style.right="","right"==r?(s=o.sizer.clientWidth-t.offsetWidth,t.style.right="0px"):("left"==r?s=0:"middle"==r&&(s=(o.sizer.clientWidth-t.offsetWidth)/2),t.style.left=s+"px"),n&&mn(this,s,a,s+t.offsetWidth,a+t.offsetHeight)},triggerOnKeyDown:ct(qt),triggerOnKeyPress:ct(Yt),triggerOnKeyUp:Xt,execCommand:function(e){return jo.hasOwnProperty(e)?jo[e](this):void 0},findPosH:function(e,t,n,i){var r=1;0>t&&(r=-1,t=-t);for(var o=0,a=Z(this.doc,e);t>o&&(a=Cn(this.doc,a,r,n,i),!a.hitSide);++o);return a},moveH:ct(function(e,t){var n=this;n.extendSelectionsBy(function(i){return n.display.shift||n.doc.extend||i.empty()?Cn(n.doc,i.head,e,t,n.options.rtlMoveVisually):0>e?i.from():i.to()},va)}),deleteH:ct(function(e,t){var n=this.doc.sel,i=this.doc;n.somethingSelected()?i.replaceSelection("",null,"+delete"):kn(this,function(n){var r=Cn(i,n.head,e,t,!1);return 0>e?{from:r,to:n.head}:{from:n.head,to:r}})}),findPosV:function(e,t,n,i){var r=1,o=i;0>t&&(r=-1,t=-t);for(var a=0,s=Z(this.doc,e);t>a;++a){var l=Ke(this,s,"div");if(null==o?o=l.left:l.left=o,s=Sn(this,l,r,n),s.hitSide)break}return s},moveV:ct(function(e,t){var n=this,i=this.doc,r=[],o=!n.display.shift&&!i.extend&&i.sel.somethingSelected();if(i.extendSelectionsBy(function(a){if(o)return 0>e?a.from():a.to();var s=Ke(n,a.head,"div");null!=a.goalColumn&&(s.left=a.goalColumn),r.push(s.left);var l=Sn(n,s,e,t);return"page"==t&&a==i.sel.primary()&&yn(n,null,$e(n,l,"div").top-s.top),l},va),r.length)for(var a=0;a<i.sel.ranges.length;a++)i.sel.ranges[a].goalColumn=r[a]}),findWordAt:function(e){var t=this.doc,n=Pi(t,e.line).text,i=e.ch,r=e.ch;if(n){var o=this.getHelper(e,"wordChars");(e.xRel<0||r==n.length)&&i?--i:++r;for(var a=n.charAt(i),s=vr(a,o)?function(e){return vr(e,o)}:/\s/.test(a)?function(e){return/\s/.test(e)}:function(e){return!/\s/.test(e)&&!vr(e)};i>0&&s(n.charAt(i-1));)--i;for(;r<n.length&&s(n.charAt(r));)++r}return new X(yo(e.line,i),yo(e.line,r))},toggleOverwrite:function(e){(null==e||e!=this.state.overwrite)&&((this.state.overwrite=!this.state.overwrite)?Mr(this.display.cursorDiv,"CodeMirror-overwrite"):Tr(this.display.cursorDiv,"CodeMirror-overwrite"),ha(this,"overwriteToggle",this,this.state.overwrite))},hasFocus:function(){return Cr()==this.display.input},scrollTo:ct(function(e,t){(null!=e||null!=t)&&bn(this),null!=e&&(this.curOp.scrollLeft=e),null!=t&&(this.curOp.scrollTop=t)}),getScrollInfo:function(){var e=this.display.scroller,t=fa;return{left:e.scrollLeft,top:e.scrollTop,height:e.scrollHeight-t,width:e.scrollWidth-t,clientHeight:e.clientHeight-t,clientWidth:e.clientWidth-t}},scrollIntoView:ct(function(e,t){if(null==e?(e={from:this.doc.sel.primary().head,to:null},null==t&&(t=this.options.cursorScrollMargin)):"number"==typeof e?e={from:yo(e,0),to:null}:null==e.from&&(e={from:e,to:null}),e.to||(e.to=e.from),e.margin=t||0,null!=e.from.line)bn(this),this.curOp.scrollToPos=e;else{var n=vn(this,Math.min(e.from.left,e.to.left),Math.min(e.from.top,e.to.top)-e.margin,Math.max(e.from.right,e.to.right),Math.max(e.from.bottom,e.to.bottom)+e.margin);this.scrollTo(n.scrollLeft,n.scrollTop)}}),setSize:ct(function(e,t){function n(e){return"number"==typeof e||/^\d+$/.test(String(e))?e+"px":e}var i=this;null!=e&&(i.display.wrapper.style.width=n(e)),null!=t&&(i.display.wrapper.style.height=n(t)),i.options.lineWrapping&&We(this);
var r=i.display.viewFrom;i.doc.iter(r,i.display.viewTo,function(e){if(e.widgets)for(var t=0;t<e.widgets.length;t++)if(e.widgets[t].noHScroll){gt(i,r,"widget");break}++r}),i.curOp.forceUpdate=!0,ha(i,"refresh",this)}),operation:function(e){return lt(this,e)},refresh:ct(function(){var e=this.display.cachedTextHeight;pt(this),this.curOp.forceUpdate=!0,He(this),this.scrollTo(this.doc.scrollLeft,this.doc.scrollTop),h(this),(null==e||Math.abs(e-Qe(this.display))>.5)&&a(this),ha(this,"refresh",this)}),swapDoc:ct(function(e){var t=this.doc;return t.cm=null,Ei(this,e),He(this),Ct(this),this.scrollTo(e.scrollLeft,e.scrollTop),this.curOp.forceScroll=!0,nr(this,"swapDoc",this,t),t}),getInputField:function(){return this.display.input},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}},sr(e);var Io=e.defaults={},Oo=e.optionHandlers={},Do=e.Init={toString:function(){return"CodeMirror.Init"}};Tn("value","",function(e,t){e.setValue(t)},!0),Tn("mode",null,function(e,t){e.doc.modeOption=t,n(e)},!0),Tn("indentUnit",2,n,!0),Tn("indentWithTabs",!1),Tn("smartIndent",!0),Tn("tabSize",4,function(e){i(e),He(e),pt(e)},!0),Tn("specialChars",/[\t\u0000-\u0019\u00ad\u200b-\u200f\u2028\u2029\ufeff]/g,function(e,t){e.options.specialChars=new RegExp(t.source+(t.test("	")?"":"|	"),"g"),e.refresh()},!0),Tn("specialCharPlaceholder",yi,function(e){e.refresh()},!0),Tn("electricChars",!0),Tn("rtlMoveVisually",!ho),Tn("wholeLineUpdateBefore",!0),Tn("theme","default",function(e){l(e),u(e)},!0),Tn("keyMap","default",s),Tn("extraKeys",null),Tn("lineWrapping",!1,r,!0),Tn("gutters",[],function(e){p(e.options),u(e)},!0),Tn("fixedGutter",!0,function(e,t){e.display.gutters.style.left=t?x(e.display)+"px":"0",e.refresh()},!0),Tn("coverGutterNextToScrollbar",!1,v,!0),Tn("lineNumbers",!1,function(e){p(e.options),u(e)},!0),Tn("firstLineNumber",1,u,!0),Tn("lineNumberFormatter",function(e){return e},u,!0),Tn("showCursorWhenSelecting",!1,ye,!0),Tn("resetSelectionOnContextMenu",!0),Tn("readOnly",!1,function(e,t){"nocursor"==t?(Jt(e),e.display.input.blur(),e.display.disabled=!0):(e.display.disabled=!1,t||Ct(e))}),Tn("disableInput",!1,function(e,t){t||Ct(e)},!0),Tn("dragDrop",!0),Tn("cursorBlinkRate",530),Tn("cursorScrollMargin",0),Tn("cursorHeight",1,ye,!0),Tn("singleCursorHeightPerLine",!0,ye,!0),Tn("workTime",100),Tn("workDelay",100),Tn("flattenSpans",!0,i,!0),Tn("addModeClass",!1,i,!0),Tn("pollInterval",100),Tn("undoDepth",200,function(e,t){e.doc.history.undoDepth=t}),Tn("historyEventDelay",1250),Tn("viewportMargin",10,function(e){e.refresh()},!0),Tn("maxHighlightLength",1e4,i,!0),Tn("moveInputWithCursor",!0,function(e,t){t||(e.display.inputDiv.style.top=e.display.inputDiv.style.left=0)}),Tn("tabindex",null,function(e,t){e.display.input.tabIndex=t||""}),Tn("autofocus",null);var Bo=e.modes={},Ro=e.mimeModes={};e.defineMode=function(t,n){e.defaults.mode||"null"==t||(e.defaults.mode=t),arguments.length>2&&(n.dependencies=Array.prototype.slice.call(arguments,2)),Bo[t]=n},e.defineMIME=function(e,t){Ro[e]=t},e.resolveMode=function(t){if("string"==typeof t&&Ro.hasOwnProperty(t))t=Ro[t];else if(t&&"string"==typeof t.name&&Ro.hasOwnProperty(t.name)){var n=Ro[t.name];"string"==typeof n&&(n={name:n}),t=pr(n,t),t.name=n.name}else if("string"==typeof t&&/^[\w\-]+\/[\w\-]+\+xml$/.test(t))return e.resolveMode("application/xml");return"string"==typeof t?{name:t}:t||{name:"null"}},e.getMode=function(t,n){var n=e.resolveMode(n),i=Bo[n.name];if(!i)return e.getMode(t,"text/plain");var r=i(t,n);if(zo.hasOwnProperty(n.name)){var o=zo[n.name];for(var a in o)o.hasOwnProperty(a)&&(r.hasOwnProperty(a)&&(r["_"+a]=r[a]),r[a]=o[a])}if(r.name=n.name,n.helperType&&(r.helperType=n.helperType),n.modeProps)for(var a in n.modeProps)r[a]=n.modeProps[a];return r},e.defineMode("null",function(){return{token:function(e){e.skipToEnd()}}}),e.defineMIME("text/plain","null");var zo=e.modeExtensions={};e.extendMode=function(e,t){var n=zo.hasOwnProperty(e)?zo[e]:zo[e]={};gr(t,n)},e.defineExtension=function(t,n){e.prototype[t]=n},e.defineDocExtension=function(e,t){ia.prototype[e]=t},e.defineOption=Tn;var Wo=[];e.defineInitHook=function(e){Wo.push(e)};var Ho=e.helpers={};e.registerHelper=function(t,n,i){Ho.hasOwnProperty(t)||(Ho[t]=e[t]={_global:[]}),Ho[t][n]=i},e.registerGlobalHelper=function(t,n,i,r){e.registerHelper(t,n,r),Ho[t]._global.push({pred:i,val:r})};var Uo=e.copyState=function(e,t){if(t===!0)return t;if(e.copyState)return e.copyState(t);var n={};for(var i in t){var r=t[i];r instanceof Array&&(r=r.concat([])),n[i]=r}return n},Vo=e.startState=function(e,t,n){return e.startState?e.startState(t,n):!0};e.innerMode=function(e,t){for(;e.innerMode;){var n=e.innerMode(t);if(!n||n.mode==e)break;t=n.state,e=n.mode}return n||{mode:e,state:t}};var jo=e.commands={selectAll:function(e){e.setSelection(yo(e.firstLine(),0),yo(e.lastLine()),ga)},singleSelection:function(e){e.setSelection(e.getCursor("anchor"),e.getCursor("head"),ga)},killLine:function(e){kn(e,function(t){if(t.empty()){var n=Pi(e.doc,t.head.line).text.length;return t.head.ch==n&&t.head.line<e.lastLine()?{from:t.head,to:yo(t.head.line+1,0)}:{from:t.head,to:yo(t.head.line,n)}}return{from:t.from(),to:t.to()}})},deleteLine:function(e){kn(e,function(t){return{from:yo(t.from().line,0),to:Z(e.doc,yo(t.to().line+1,0))}})},delLineLeft:function(e){kn(e,function(e){return{from:yo(e.from().line,0),to:e.from()}})},delWrappedLineLeft:function(e){kn(e,function(t){var n=e.charCoords(t.head,"div").top+5,i=e.coordsChar({left:0,top:n},"div");return{from:i,to:t.from()}})},delWrappedLineRight:function(e){kn(e,function(t){var n=e.charCoords(t.head,"div").top+5,i=e.coordsChar({left:e.display.lineDiv.offsetWidth+100,top:n},"div");return{from:t.from(),to:i}})},undo:function(e){e.undo()},redo:function(e){e.redo()},undoSelection:function(e){e.undoSelection()},redoSelection:function(e){e.redoSelection()},goDocStart:function(e){e.extendSelection(yo(e.firstLine(),0))},goDocEnd:function(e){e.extendSelection(yo(e.lastLine()))},goLineStart:function(e){e.extendSelectionsBy(function(t){return Ur(e,t.head.line)},{origin:"+move",bias:1})},goLineStartSmart:function(e){e.extendSelectionsBy(function(t){return jr(e,t.head)},{origin:"+move",bias:1})},goLineEnd:function(e){e.extendSelectionsBy(function(t){return Vr(e,t.head.line)},{origin:"+move",bias:-1})},goLineRight:function(e){e.extendSelectionsBy(function(t){var n=e.charCoords(t.head,"div").top+5;return e.coordsChar({left:e.display.lineDiv.offsetWidth+100,top:n},"div")},va)},goLineLeft:function(e){e.extendSelectionsBy(function(t){var n=e.charCoords(t.head,"div").top+5;return e.coordsChar({left:0,top:n},"div")},va)},goLineLeftSmart:function(e){e.extendSelectionsBy(function(t){var n=e.charCoords(t.head,"div").top+5,i=e.coordsChar({left:0,top:n},"div");return i.ch<e.getLine(i.line).search(/\S/)?jr(e,t.head):i},va)},goLineUp:function(e){e.moveV(-1,"line")},goLineDown:function(e){e.moveV(1,"line")},goPageUp:function(e){e.moveV(-1,"page")},goPageDown:function(e){e.moveV(1,"page")},goCharLeft:function(e){e.moveH(-1,"char")},goCharRight:function(e){e.moveH(1,"char")},goColumnLeft:function(e){e.moveH(-1,"column")},goColumnRight:function(e){e.moveH(1,"column")},goWordLeft:function(e){e.moveH(-1,"word")},goGroupRight:function(e){e.moveH(1,"group")},goGroupLeft:function(e){e.moveH(-1,"group")},goWordRight:function(e){e.moveH(1,"word")},delCharBefore:function(e){e.deleteH(-1,"char")},delCharAfter:function(e){e.deleteH(1,"char")},delWordBefore:function(e){e.deleteH(-1,"word")},delWordAfter:function(e){e.deleteH(1,"word")},delGroupBefore:function(e){e.deleteH(-1,"group")},delGroupAfter:function(e){e.deleteH(1,"group")},indentAuto:function(e){e.indentSelection("smart")},indentMore:function(e){e.indentSelection("add")},indentLess:function(e){e.indentSelection("subtract")},insertTab:function(e){e.replaceSelection("	")},insertSoftTab:function(e){for(var t=[],n=e.listSelections(),i=e.options.tabSize,r=0;r<n.length;r++){var o=n[r].from(),a=ya(e.getLine(o.line),o.ch,i);t.push(new Array(i-a%i+1).join(" "))}e.replaceSelections(t)},defaultTab:function(e){e.somethingSelected()?e.indentSelection("add"):e.execCommand("insertTab")},transposeChars:function(e){lt(e,function(){for(var t=e.listSelections(),n=[],i=0;i<t.length;i++){var r=t[i].head,o=Pi(e.doc,r.line).text;if(o)if(r.ch==o.length&&(r=new yo(r.line,r.ch-1)),r.ch>0)r=new yo(r.line,r.ch+1),e.replaceRange(o.charAt(r.ch-1)+o.charAt(r.ch-2),yo(r.line,r.ch-2),r,"+transpose");else if(r.line>e.doc.first){var a=Pi(e.doc,r.line-1).text;a&&e.replaceRange(o.charAt(0)+"\n"+a.charAt(a.length-1),yo(r.line-1,a.length-1),yo(r.line,1),"+transpose")}n.push(new X(r,r))}e.setSelections(n)})},newlineAndIndent:function(e){lt(e,function(){for(var t=e.listSelections().length,n=0;t>n;n++){var i=e.listSelections()[n];e.replaceRange("\n",i.anchor,i.head,"+input"),e.indentLine(i.from().line+1,null,!0),_n(e)}})},toggleOverwrite:function(e){e.toggleOverwrite()}},Fo=e.keyMap={};Fo.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite",Esc:"singleSelection"},Fo.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Up":"goLineUp","Ctrl-Down":"goLineDown","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"},Fo.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Home":"goDocStart","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineLeft","Cmd-Right":"goLineRight","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delWrappedLineLeft","Cmd-Delete":"delWrappedLineRight","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection","Ctrl-Up":"goDocStart","Ctrl-Down":"goDocEnd",fallthrough:["basic","emacsy"]},Fo.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-D":"delWordAfter","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars"},Fo["default"]=co?Fo.macDefault:Fo.pcDefault;var $o=e.lookupKey=function(e,t,n){function i(t){t=Mn(t);var r=t[e];if(r===!1)return"stop";if(null!=r&&n(r))return!0;if(t.nofallthrough)return"stop";var o=t.fallthrough;if(null==o)return!1;if("[object Array]"!=Object.prototype.toString.call(o))return i(o);for(var a=0;a<o.length;++a){var s=i(o[a]);if(s)return s}return!1}for(var r=0;r<t.length;++r){var o=i(t[r]);if(o)return"stop"!=o}},Ko=e.isModifierKey=function(e){var t=Oa[e.keyCode];return"Ctrl"==t||"Alt"==t||"Shift"==t||"Mod"==t},qo=e.keyName=function(e,t){if(io&&34==e.keyCode&&e["char"])return!1;var n=Oa[e.keyCode];return null==n||e.altGraphKey?!1:(e.altKey&&(n="Alt-"+n),(po?e.metaKey:e.ctrlKey)&&(n="Ctrl-"+n),(po?e.ctrlKey:e.metaKey)&&(n="Cmd-"+n),!t&&e.shiftKey&&(n="Shift-"+n),n)};e.fromTextArea=function(t,n){function i(){t.value=u.getValue()}if(n||(n={}),n.value=t.value,!n.tabindex&&t.tabindex&&(n.tabindex=t.tabindex),!n.placeholder&&t.placeholder&&(n.placeholder=t.placeholder),null==n.autofocus){var r=Cr();n.autofocus=r==t||null!=t.getAttribute("autofocus")&&r==document.body}if(t.form&&(ua(t.form,"submit",i),!n.leaveSubmitMethodAlone)){var o=t.form,a=o.submit;try{var s=o.submit=function(){i(),o.submit=a,o.submit(),o.submit=s}}catch(l){}}t.style.display="none";var u=e(function(e){t.parentNode.insertBefore(e,t.nextSibling)},n);return u.save=i,u.getTextArea=function(){return t},u.toTextArea=function(){u.toTextArea=isNaN,i(),t.parentNode.removeChild(u.getWrapperElement()),t.style.display="",t.form&&(ca(t.form,"submit",i),"function"==typeof t.form.submit&&(t.form.submit=a))},u};var Go=e.StringStream=function(e,t){this.pos=this.start=0,this.string=e,this.tabSize=t||8,this.lastColumnPos=this.lastColumnValue=0,this.lineStart=0};Go.prototype={eol:function(){return this.pos>=this.string.length},sol:function(){return this.pos==this.lineStart},peek:function(){return this.string.charAt(this.pos)||void 0},next:function(){return this.pos<this.string.length?this.string.charAt(this.pos++):void 0},eat:function(e){var t=this.string.charAt(this.pos);if("string"==typeof e)var n=t==e;else var n=t&&(e.test?e.test(t):e(t));return n?(++this.pos,t):void 0},eatWhile:function(e){for(var t=this.pos;this.eat(e););return this.pos>t},eatSpace:function(){for(var e=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>e},skipToEnd:function(){this.pos=this.string.length},skipTo:function(e){var t=this.string.indexOf(e,this.pos);return t>-1?(this.pos=t,!0):void 0},backUp:function(e){this.pos-=e},column:function(){return this.lastColumnPos<this.start&&(this.lastColumnValue=ya(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue-(this.lineStart?ya(this.string,this.lineStart,this.tabSize):0)},indentation:function(){return ya(this.string,null,this.tabSize)-(this.lineStart?ya(this.string,this.lineStart,this.tabSize):0)},match:function(e,t,n){if("string"!=typeof e){var i=this.string.slice(this.pos).match(e);return i&&i.index>0?null:(i&&t!==!1&&(this.pos+=i[0].length),i)}var r=function(e){return n?e.toLowerCase():e},o=this.string.substr(this.pos,e.length);return r(o)==r(e)?(t!==!1&&(this.pos+=e.length),!0):void 0},current:function(){return this.string.slice(this.start,this.pos)},hideFirstChars:function(e,t){this.lineStart+=e;try{return t()}finally{this.lineStart-=e}}};var Xo=e.TextMarker=function(e,t){this.lines=[],this.type=t,this.doc=e};sr(Xo),Xo.prototype.clear=function(){if(!this.explicitlyCleared){var e=this.doc.cm,t=e&&!e.curOp;if(t&&Ze(e),ar(this,"clear")){var n=this.find();n&&nr(this,"clear",n.from,n.to)}for(var i=null,r=null,o=0;o<this.lines.length;++o){var a=this.lines[o],s=On(a.markedSpans,this);e&&!this.collapsed?gt(e,Oi(a),"text"):e&&(null!=s.to&&(r=Oi(a)),null!=s.from&&(i=Oi(a))),a.markedSpans=Dn(a.markedSpans,s),null==s.from&&this.collapsed&&!ni(this.doc,a)&&e&&Ii(a,Qe(e.display))}if(e&&this.collapsed&&!e.options.lineWrapping)for(var o=0;o<this.lines.length;++o){var l=Jn(this.lines[o]),u=d(l);u>e.display.maxLineLength&&(e.display.maxLine=l,e.display.maxLineLength=u,e.display.maxLineChanged=!0)}null!=i&&e&&this.collapsed&&pt(e,i,r+1),this.lines.length=0,this.explicitlyCleared=!0,this.atomic&&this.doc.cantEdit&&(this.doc.cantEdit=!1,e&&fe(e.doc)),e&&nr(e,"markerCleared",e,this),t&&tt(e),this.parent&&this.parent.clear()}},Xo.prototype.find=function(e,t){null==e&&"bookmark"==this.type&&(e=1);for(var n,i,r=0;r<this.lines.length;++r){var o=this.lines[r],a=On(o.markedSpans,this);if(null!=a.from&&(n=yo(t?o:Oi(o),a.from),-1==e))return n;if(null!=a.to&&(i=yo(t?o:Oi(o),a.to),1==e))return i}return n&&{from:n,to:i}},Xo.prototype.changed=function(){var e=this.find(-1,!0),t=this,n=this.doc.cm;e&&n&&lt(n,function(){var i=e.line,r=Oi(e.line),o=Ie(n,r);if(o&&(ze(o),n.curOp.selectionChanged=n.curOp.forceUpdate=!0),n.curOp.updateMaxLine=!0,!ni(t.doc,i)&&null!=t.height){var a=t.height;t.height=null;var s=oi(t)-a;s&&Ii(i,i.height+s)}})},Xo.prototype.attachLine=function(e){if(!this.lines.length&&this.doc.cm){var t=this.doc.cm.curOp;t.maybeHiddenMarkers&&-1!=dr(t.maybeHiddenMarkers,this)||(t.maybeUnhiddenMarkers||(t.maybeUnhiddenMarkers=[])).push(this)}this.lines.push(e)},Xo.prototype.detachLine=function(e){if(this.lines.splice(dr(this.lines,e),1),!this.lines.length&&this.doc.cm){var t=this.doc.cm.curOp;(t.maybeHiddenMarkers||(t.maybeHiddenMarkers=[])).push(this)}};var Yo=0,Qo=e.SharedTextMarker=function(e,t){this.markers=e,this.primary=t;for(var n=0;n<e.length;++n)e[n].parent=this};sr(Qo),Qo.prototype.clear=function(){if(!this.explicitlyCleared){this.explicitlyCleared=!0;for(var e=0;e<this.markers.length;++e)this.markers[e].clear();nr(this,"clear")}},Qo.prototype.find=function(e,t){return this.primary.find(e,t)};var Jo=e.LineWidget=function(e,t,n){if(n)for(var i in n)n.hasOwnProperty(i)&&(this[i]=n[i]);this.cm=e,this.node=t};sr(Jo),Jo.prototype.clear=function(){var e=this.cm,t=this.line.widgets,n=this.line,i=Oi(n);if(null!=i&&t){for(var r=0;r<t.length;++r)t[r]==this&&t.splice(r--,1);t.length||(n.widgets=null);var o=oi(this);lt(e,function(){ri(e,n,-o),gt(e,i,"widget"),Ii(n,Math.max(0,n.height-o))})}},Jo.prototype.changed=function(){var e=this.height,t=this.cm,n=this.line;this.height=null;var i=oi(this)-e;i&&lt(t,function(){t.curOp.forceUpdate=!0,ri(t,n,i),Ii(n,n.height+i)})};var Zo=e.Line=function(e,t,n){this.text=e,Fn(this,t),this.height=n?n(this):1};sr(Zo),Zo.prototype.lineNo=function(){return Oi(this)};var ea={},ta={};Ti.prototype={chunkSize:function(){return this.lines.length},removeInner:function(e,t){for(var n=e,i=e+t;i>n;++n){var r=this.lines[n];this.height-=r.height,li(r),nr(r,"delete")}this.lines.splice(e,t)},collapse:function(e){e.push.apply(e,this.lines)},insertInner:function(e,t,n){this.height+=n,this.lines=this.lines.slice(0,e).concat(t).concat(this.lines.slice(e));for(var i=0;i<t.length;++i)t[i].parent=this},iterN:function(e,t,n){for(var i=e+t;i>e;++e)if(n(this.lines[e]))return!0}},Mi.prototype={chunkSize:function(){return this.size},removeInner:function(e,t){this.size-=t;for(var n=0;n<this.children.length;++n){var i=this.children[n],r=i.chunkSize();if(r>e){var o=Math.min(t,r-e),a=i.height;if(i.removeInner(e,o),this.height-=a-i.height,r==o&&(this.children.splice(n--,1),i.parent=null),0==(t-=o))break;e=0}else e-=r}if(this.size-t<25&&(this.children.length>1||!(this.children[0]instanceof Ti))){var s=[];this.collapse(s),this.children=[new Ti(s)],this.children[0].parent=this}},collapse:function(e){for(var t=0;t<this.children.length;++t)this.children[t].collapse(e)},insertInner:function(e,t,n){this.size+=t.length,this.height+=n;for(var i=0;i<this.children.length;++i){var r=this.children[i],o=r.chunkSize();if(o>=e){if(r.insertInner(e,t,n),r.lines&&r.lines.length>50){for(;r.lines.length>50;){var a=r.lines.splice(r.lines.length-25,25),s=new Ti(a);r.height-=s.height,this.children.splice(i+1,0,s),s.parent=this}this.maybeSpill()}break}e-=o}},maybeSpill:function(){if(!(this.children.length<=10)){var e=this;do{var t=e.children.splice(e.children.length-5,5),n=new Mi(t);if(e.parent){e.size-=n.size,e.height-=n.height;var i=dr(e.parent.children,e);e.parent.children.splice(i+1,0,n)}else{var r=new Mi(e.children);r.parent=e,e.children=[r,n],e=r}n.parent=e.parent}while(e.children.length>10);e.parent.maybeSpill()}},iterN:function(e,t,n){for(var i=0;i<this.children.length;++i){var r=this.children[i],o=r.chunkSize();if(o>e){var a=Math.min(t,o-e);if(r.iterN(e,a,n))return!0;if(0==(t-=a))break;e=0}else e-=o}}};var na=0,ia=e.Doc=function(e,t,n){if(!(this instanceof ia))return new ia(e,t,n);null==n&&(n=0),Mi.call(this,[new Ti([new Zo("",null)])]),this.first=n,this.scrollTop=this.scrollLeft=0,this.cantEdit=!1,this.cleanGeneration=1,this.frontier=n;var i=yo(n,0);this.sel=Q(i),this.history=new zi(null),this.id=++na,this.modeOption=t,"string"==typeof e&&(e=Pa(e)),Si(this,{from:i,to:i,text:e}),ce(this,Q(i),ga)};ia.prototype=pr(Mi.prototype,{constructor:ia,iter:function(e,t,n){n?this.iterN(e-this.first,t-e,n):this.iterN(this.first,this.first+this.size,e)},insert:function(e,t){for(var n=0,i=0;i<t.length;++i)n+=t[i].height;this.insertInner(e-this.first,t,n)},remove:function(e,t){this.removeInner(e-this.first,t)},getValue:function(e){var t=Ai(this,this.first,this.first+this.size);return e===!1?t:t.join(e||"\n")},setValue:ht(function(e){var t=yo(this.first,0),n=this.first+this.size-1;sn(this,{from:t,to:yo(n,Pi(this,n).text.length),text:Pa(e),origin:"setValue"},!0),ce(this,Q(t))}),replaceRange:function(e,t,n,i){t=Z(this,t),n=n?Z(this,n):t,fn(this,e,t,n,i)},getRange:function(e,t,n){var i=Ni(this,Z(this,e),Z(this,t));return n===!1?i:i.join(n||"\n")},getLine:function(e){var t=this.getLineHandle(e);return t&&t.text},getLineHandle:function(e){return te(this,e)?Pi(this,e):void 0},getLineNumber:function(e){return Oi(e)},getLineHandleVisualStart:function(e){return"number"==typeof e&&(e=Pi(this,e)),Jn(e)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(e){return Z(this,e)},getCursor:function(e){var t,n=this.sel.primary();return t=null==e||"head"==e?n.head:"anchor"==e?n.anchor:"end"==e||"to"==e||e===!1?n.to():n.from()},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},setCursor:ht(function(e,t,n){se(this,Z(this,"number"==typeof e?yo(e,t||0):e),null,n)}),setSelection:ht(function(e,t,n){se(this,Z(this,e),Z(this,t||e),n)}),extendSelection:ht(function(e,t,n){re(this,Z(this,e),t&&Z(this,t),n)}),extendSelections:ht(function(e,t){oe(this,ne(this,e,t))}),extendSelectionsBy:ht(function(e,t){oe(this,fr(this.sel.ranges,e),t)}),setSelections:ht(function(e,t,n){if(e.length){for(var i=0,r=[];i<e.length;i++)r[i]=new X(Z(this,e[i].anchor),Z(this,e[i].head));null==t&&(t=Math.min(e.length-1,this.sel.primIndex)),ce(this,Y(r,t),n)}}),addSelection:ht(function(e,t,n){var i=this.sel.ranges.slice(0);i.push(new X(Z(this,e),Z(this,t||e))),ce(this,Y(i,i.length-1),n)}),getSelection:function(e){for(var t,n=this.sel.ranges,i=0;i<n.length;i++){var r=Ni(this,n[i].from(),n[i].to());t=t?t.concat(r):r}return e===!1?t:t.join(e||"\n")},getSelections:function(e){for(var t=[],n=this.sel.ranges,i=0;i<n.length;i++){var r=Ni(this,n[i].from(),n[i].to());e!==!1&&(r=r.join(e||"\n")),t[i]=r}return t},replaceSelection:function(e,t,n){for(var i=[],r=0;r<this.sel.ranges.length;r++)i[r]=e;this.replaceSelections(i,t,n||"+input")},replaceSelections:ht(function(e,t,n){for(var i=[],r=this.sel,o=0;o<r.ranges.length;o++){var a=r.ranges[o];i[o]={from:a.from(),to:a.to(),text:Pa(e[o]),origin:n}}for(var s=t&&"end"!=t&&on(this,i,t),o=i.length-1;o>=0;o--)sn(this,i[o]);s?ue(this,s):this.cm&&_n(this.cm)}),undo:ht(function(){un(this,"undo")}),redo:ht(function(){un(this,"redo")}),undoSelection:ht(function(){un(this,"undo",!0)}),redoSelection:ht(function(){un(this,"redo",!0)}),setExtending:function(e){this.extend=e},getExtending:function(){return this.extend},historySize:function(){for(var e=this.history,t=0,n=0,i=0;i<e.done.length;i++)e.done[i].ranges||++t;for(var i=0;i<e.undone.length;i++)e.undone[i].ranges||++n;return{undo:t,redo:n}},clearHistory:function(){this.history=new zi(this.history.maxGeneration)},markClean:function(){this.cleanGeneration=this.changeGeneration(!0)},changeGeneration:function(e){return e&&(this.history.lastOp=this.history.lastSelOp=this.history.lastOrigin=null),this.history.generation},isClean:function(e){return this.history.generation==(e||this.cleanGeneration)},getHistory:function(){return{done:Xi(this.history.done),undone:Xi(this.history.undone)}},setHistory:function(e){var t=this.history=new zi(this.history.maxGeneration);t.done=Xi(e.done.slice(0),null,!0),t.undone=Xi(e.undone.slice(0),null,!0)},addLineClass:ht(function(e,t,n){return xn(this,e,"class",function(e){var i="text"==t?"textClass":"background"==t?"bgClass":"wrapClass";if(e[i]){if(new RegExp("(?:^|\\s)"+n+"(?:$|\\s)").test(e[i]))return!1;e[i]+=" "+n}else e[i]=n;return!0})}),removeLineClass:ht(function(e,t,n){return xn(this,e,"class",function(e){var i="text"==t?"textClass":"background"==t?"bgClass":"wrapClass",r=e[i];if(!r)return!1;if(null==n)e[i]=null;else{var o=r.match(new RegExp("(?:^|\\s+)"+n+"(?:$|\\s+)"));if(!o)return!1;var a=o.index+o[0].length;e[i]=r.slice(0,o.index)+(o.index&&a!=r.length?" ":"")+r.slice(a)||null}return!0})}),markText:function(e,t,n){return Ln(this,Z(this,e),Z(this,t),n,"range")},setBookmark:function(e,t){var n={replacedWith:t&&(null==t.nodeType?t.widget:t),insertLeft:t&&t.insertLeft,clearWhenEmpty:!1,shared:t&&t.shared};return e=Z(this,e),Ln(this,e,e,n,"bookmark")},findMarksAt:function(e){e=Z(this,e);var t=[],n=Pi(this,e.line).markedSpans;if(n)for(var i=0;i<n.length;++i){var r=n[i];(null==r.from||r.from<=e.ch)&&(null==r.to||r.to>=e.ch)&&t.push(r.marker.parent||r.marker)}return t},findMarks:function(e,t,n){e=Z(this,e),t=Z(this,t);var i=[],r=e.line;return this.iter(e.line,t.line+1,function(o){var a=o.markedSpans;if(a)for(var s=0;s<a.length;s++){var l=a[s];r==e.line&&e.ch>l.to||null==l.from&&r!=e.line||r==t.line&&l.from>t.ch||n&&!n(l.marker)||i.push(l.marker.parent||l.marker)}++r}),i},getAllMarks:function(){var e=[];return this.iter(function(t){var n=t.markedSpans;if(n)for(var i=0;i<n.length;++i)null!=n[i].from&&e.push(n[i].marker)}),e},posFromIndex:function(e){var t,n=this.first;return this.iter(function(i){var r=i.text.length+1;return r>e?(t=e,!0):(e-=r,void++n)}),Z(this,yo(n,t))},indexFromPos:function(e){e=Z(this,e);var t=e.ch;return e.line<this.first||e.ch<0?0:(this.iter(this.first,e.line,function(e){t+=e.text.length+1}),t)},copy:function(e){var t=new ia(Ai(this,this.first,this.first+this.size),this.modeOption,this.first);return t.scrollTop=this.scrollTop,t.scrollLeft=this.scrollLeft,t.sel=this.sel,t.extend=!1,e&&(t.history.undoDepth=this.history.undoDepth,t.setHistory(this.getHistory())),t},linkedDoc:function(e){e||(e={});var t=this.first,n=this.first+this.size;null!=e.from&&e.from>t&&(t=e.from),null!=e.to&&e.to<n&&(n=e.to);var i=new ia(Ai(this,t,n),e.mode||this.modeOption,t);return e.sharedHist&&(i.history=this.history),(this.linked||(this.linked=[])).push({doc:i,sharedHist:e.sharedHist}),i.linked=[{doc:this,isParent:!0,sharedHist:e.sharedHist}],Nn(i,Pn(this)),i},unlinkDoc:function(t){if(t instanceof e&&(t=t.doc),this.linked)for(var n=0;n<this.linked.length;++n){var i=this.linked[n];if(i.doc==t){this.linked.splice(n,1),t.unlinkDoc(this),An(Pn(this));break}}if(t.history==this.history){var r=[t.id];Li(t,function(e){r.push(e.id)},!0),t.history=new zi(null),t.history.done=Xi(this.history.done,r),t.history.undone=Xi(this.history.undone,r)}},iterLinkedDocs:function(e){Li(this,e)},getMode:function(){return this.mode},getEditor:function(){return this.cm}}),ia.prototype.eachLine=ia.prototype.iter;var ra="iter insert remove copy getEditor".split(" ");for(var oa in ia.prototype)ia.prototype.hasOwnProperty(oa)&&dr(ra,oa)<0&&(e.prototype[oa]=function(e){return function(){return e.apply(this.doc,arguments)}}(ia.prototype[oa]));sr(ia);var aa=e.e_preventDefault=function(e){e.preventDefault?e.preventDefault():e.returnValue=!1},sa=e.e_stopPropagation=function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},la=e.e_stop=function(e){aa(e),sa(e)},ua=e.on=function(e,t,n){if(e.addEventListener)e.addEventListener(t,n,!1);else if(e.attachEvent)e.attachEvent("on"+t,n);else{var i=e._handlers||(e._handlers={}),r=i[t]||(i[t]=[]);r.push(n)}},ca=e.off=function(e,t,n){if(e.removeEventListener)e.removeEventListener(t,n,!1);else if(e.detachEvent)e.detachEvent("on"+t,n);else{var i=e._handlers&&e._handlers[t];if(!i)return;for(var r=0;r<i.length;++r)if(i[r]==n){i.splice(r,1);break}}},ha=e.signal=function(e,t){var n=e._handlers&&e._handlers[t];if(n)for(var i=Array.prototype.slice.call(arguments,2),r=0;r<n.length;++r)n[r].apply(null,i)},da=null,fa=30,pa=e.Pass={toString:function(){return"CodeMirror.Pass"}},ga={scroll:!1},ma={origin:"*mouse"},va={origin:"+move"};lr.prototype.set=function(e,t){clearTimeout(this.id),this.id=setTimeout(t,e)};var ya=e.countColumn=function(e,t,n,i,r){null==t&&(t=e.search(/[^\s\u00a0]/),-1==t&&(t=e.length));for(var o=i||0,a=r||0;;){var s=e.indexOf("	",o);if(0>s||s>=t)return a+(t-o);a+=s-o,a+=n-a%n,o=s+1}},_a=[""],ba=function(e){e.select()};lo?ba=function(e){e.selectionStart=0,e.selectionEnd=e.value.length}:Jr&&(ba=function(e){try{e.select()}catch(t){}}),[].indexOf&&(dr=function(e,t){return e.indexOf(t)}),[].map&&(fr=function(e,t){return e.map(t)});var wa,xa=/[\u00df\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/,ka=e.isWordChar=function(e){return/\w/.test(e)||e>""&&(e.toUpperCase()!=e.toLowerCase()||xa.test(e))},Ca=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/;wa=document.createRange?function(e,t,n){var i=document.createRange();return i.setEnd(e,n),i.setStart(e,t),i}:function(e,t,n){var i=document.body.createTextRange();return i.moveToElementText(e.parentNode),i.collapse(!0),i.moveEnd("character",n),i.moveStart("character",t),i},Jr&&11>Zr&&(Cr=function(){try{return document.activeElement}catch(e){return document.body}});var Sa,Ta,Ma,La=!1,Ea=function(){if(Jr&&9>Zr)return!1;var e=br("div");return"draggable"in e||"dragDrop"in e}(),Pa=e.splitLines=3!="\n\nb".split(/\n/).length?function(e){for(var t=0,n=[],i=e.length;i>=t;){var r=e.indexOf("\n",t);-1==r&&(r=e.length);var o=e.slice(t,"\r"==e.charAt(r-1)?r-1:r),a=o.indexOf("\r");-1!=a?(n.push(o.slice(0,a)),t+=a+1):(n.push(o),t=r+1)}return n}:function(e){return e.split(/\r\n?|\n/)},Na=window.getSelection?function(e){try{return e.selectionStart!=e.selectionEnd}catch(t){return!1}}:function(e){try{var t=e.ownerDocument.selection.createRange()}catch(n){}return t&&t.parentElement()==e?0!=t.compareEndPoints("StartToEnd",t):!1},Aa=function(){var e=br("div");return"oncopy"in e?!0:(e.setAttribute("oncopy","return;"),"function"==typeof e.oncopy);
}(),Ia=null,Oa={3:"Enter",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",107:"=",109:"-",127:"Delete",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"};e.keyNames=Oa,function(){for(var e=0;10>e;e++)Oa[e+48]=Oa[e+96]=String(e);for(var e=65;90>=e;e++)Oa[e]=String.fromCharCode(e);for(var e=1;12>=e;e++)Oa[e+111]=Oa[e+63235]="F"+e}();var Da,Ba=function(){function e(e){return 247>=e?n.charAt(e):e>=1424&&1524>=e?"R":e>=1536&&1773>=e?i.charAt(e-1536):e>=1774&&2220>=e?"r":e>=8192&&8203>=e?"w":8204==e?"b":"L"}function t(e,t,n){this.level=e,this.from=t,this.to=n}var n="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN",i="rrrrrrrrrrrr,rNNmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmrrrrrrrnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmNmmmm",r=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,o=/[stwN]/,a=/[LRr]/,s=/[Lb1n]/,l=/[1n]/,u="L";return function(n){if(!r.test(n))return!1;for(var i,c=n.length,h=[],d=0;c>d;++d)h.push(i=e(n.charCodeAt(d)));for(var d=0,f=u;c>d;++d){var i=h[d];"m"==i?h[d]=f:f=i}for(var d=0,p=u;c>d;++d){var i=h[d];"1"==i&&"r"==p?h[d]="n":a.test(i)&&(p=i,"r"==i&&(h[d]="R"))}for(var d=1,f=h[0];c-1>d;++d){var i=h[d];"+"==i&&"1"==f&&"1"==h[d+1]?h[d]="1":","!=i||f!=h[d+1]||"1"!=f&&"n"!=f||(h[d]=f),f=i}for(var d=0;c>d;++d){var i=h[d];if(","==i)h[d]="N";else if("%"==i){for(var g=d+1;c>g&&"%"==h[g];++g);for(var m=d&&"!"==h[d-1]||c>g&&"1"==h[g]?"1":"N",v=d;g>v;++v)h[v]=m;d=g-1}}for(var d=0,p=u;c>d;++d){var i=h[d];"L"==p&&"1"==i?h[d]="L":a.test(i)&&(p=i)}for(var d=0;c>d;++d)if(o.test(h[d])){for(var g=d+1;c>g&&o.test(h[g]);++g);for(var y="L"==(d?h[d-1]:u),_="L"==(c>g?h[g]:u),m=y||_?"L":"R",v=d;g>v;++v)h[v]=m;d=g-1}for(var b,w=[],d=0;c>d;)if(s.test(h[d])){var x=d;for(++d;c>d&&s.test(h[d]);++d);w.push(new t(0,x,d))}else{var k=d,C=w.length;for(++d;c>d&&"L"!=h[d];++d);for(var v=k;d>v;)if(l.test(h[v])){v>k&&w.splice(C,0,new t(1,k,v));var S=v;for(++v;d>v&&l.test(h[v]);++v);w.splice(C,0,new t(2,S,v)),k=v}else++v;d>k&&w.splice(C,0,new t(1,k,d))}return 1==w[0].level&&(b=n.match(/^\s+/))&&(w[0].from=b[0].length,w.unshift(new t(0,0,b[0].length))),1==hr(w).level&&(b=n.match(/\s+$/))&&(hr(w).to-=b[0].length,w.push(new t(0,c-b[0].length,c))),w[0].level!=hr(w).level&&w.push(new t(w[0].level,c,c)),w}}();return e.version="4.7.0",e}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";e.defineMode("xml",function(t,n){function i(e,t){function n(n){return t.tokenize=n,n(e,t)}var i=e.next();if("<"==i)return e.eat("!")?e.eat("[")?e.match("CDATA[")?n(a("atom","]]>")):null:e.match("--")?n(a("comment","-->")):e.match("DOCTYPE",!0,!0)?(e.eatWhile(/[\w\._\-]/),n(s(1))):null:e.eat("?")?(e.eatWhile(/[\w\._\-]/),t.tokenize=a("meta","?>"),"meta"):(k=e.eat("/")?"closeTag":"openTag",t.tokenize=r,"tag bracket");if("&"==i){var o;return o=e.eat("#")?e.eat("x")?e.eatWhile(/[a-fA-F\d]/)&&e.eat(";"):e.eatWhile(/[\d]/)&&e.eat(";"):e.eatWhile(/[\w\.\-:]/)&&e.eat(";"),o?"atom":"error"}return e.eatWhile(/[^&<]/),null}function r(e,t){var n=e.next();if(">"==n||"/"==n&&e.eat(">"))return t.tokenize=i,k=">"==n?"endTag":"selfcloseTag","tag bracket";if("="==n)return k="equals",null;if("<"==n){t.tokenize=i,t.state=h,t.tagName=t.tagStart=null;var r=t.tokenize(e,t);return r?r+" tag error":"tag error"}return/[\'\"]/.test(n)?(t.tokenize=o(n),t.stringStartCol=e.column(),t.tokenize(e,t)):(e.match(/^[^\s\u00a0=<>\"\']*[^\s\u00a0=<>\"\'\/]/),"word")}function o(e){var t=function(t,n){for(;!t.eol();)if(t.next()==e){n.tokenize=r;break}return"string"};return t.isInAttribute=!0,t}function a(e,t){return function(n,r){for(;!n.eol();){if(n.match(t)){r.tokenize=i;break}n.next()}return e}}function s(e){return function(t,n){for(var r;null!=(r=t.next());){if("<"==r)return n.tokenize=s(e+1),n.tokenize(t,n);if(">"==r){if(1==e){n.tokenize=i;break}return n.tokenize=s(e-1),n.tokenize(t,n)}}return"meta"}}function l(e,t,n){this.prev=e.context,this.tagName=t,this.indent=e.indented,this.startOfLine=n,(S.doNotIndent.hasOwnProperty(t)||e.context&&e.context.noIndent)&&(this.noIndent=!0)}function u(e){e.context&&(e.context=e.context.prev)}function c(e,t){for(var n;;){if(!e.context)return;if(n=e.context.tagName,!S.contextGrabbers.hasOwnProperty(n)||!S.contextGrabbers[n].hasOwnProperty(t))return;u(e)}}function h(e,t,n){return"openTag"==e?(n.tagStart=t.column(),d):"closeTag"==e?f:h}function d(e,t,n){return"word"==e?(n.tagName=t.current(),C="tag",m):(C="error",d)}function f(e,t,n){if("word"==e){var i=t.current();return n.context&&n.context.tagName!=i&&S.implicitlyClosed.hasOwnProperty(n.context.tagName)&&u(n),n.context&&n.context.tagName==i?(C="tag",p):(C="tag error",g)}return C="error",g}function p(e,t,n){return"endTag"!=e?(C="error",p):(u(n),h)}function g(e,t,n){return C="error",p(e,t,n)}function m(e,t,n){if("word"==e)return C="attribute",v;if("endTag"==e||"selfcloseTag"==e){var i=n.tagName,r=n.tagStart;return n.tagName=n.tagStart=null,"selfcloseTag"==e||S.autoSelfClosers.hasOwnProperty(i)?c(n,i):(c(n,i),n.context=new l(n,i,r==n.indented)),h}return C="error",m}function v(e,t,n){return"equals"==e?y:(S.allowMissing||(C="error"),m(e,t,n))}function y(e,t,n){return"string"==e?_:"word"==e&&S.allowUnquoted?(C="string",m):(C="error",m(e,t,n))}function _(e,t,n){return"string"==e?_:m(e,t,n)}var b=t.indentUnit,w=n.multilineTagIndentFactor||1,x=n.multilineTagIndentPastTag;null==x&&(x=!0);var k,C,S=n.htmlMode?{autoSelfClosers:{area:!0,base:!0,br:!0,col:!0,command:!0,embed:!0,frame:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0,menuitem:!0},implicitlyClosed:{dd:!0,li:!0,optgroup:!0,option:!0,p:!0,rp:!0,rt:!0,tbody:!0,td:!0,tfoot:!0,th:!0,tr:!0},contextGrabbers:{dd:{dd:!0,dt:!0},dt:{dd:!0,dt:!0},li:{li:!0},option:{option:!0,optgroup:!0},optgroup:{optgroup:!0},p:{address:!0,article:!0,aside:!0,blockquote:!0,dir:!0,div:!0,dl:!0,fieldset:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,menu:!0,nav:!0,ol:!0,p:!0,pre:!0,section:!0,table:!0,ul:!0},rp:{rp:!0,rt:!0},rt:{rp:!0,rt:!0},tbody:{tbody:!0,tfoot:!0},td:{td:!0,th:!0},tfoot:{tbody:!0},th:{td:!0,th:!0},thead:{tbody:!0,tfoot:!0},tr:{tr:!0}},doNotIndent:{pre:!0},allowUnquoted:!0,allowMissing:!0,caseFold:!0}:{autoSelfClosers:{},implicitlyClosed:{},contextGrabbers:{},doNotIndent:{},allowUnquoted:!1,allowMissing:!1,caseFold:!1},T=n.alignCDATA;return{startState:function(){return{tokenize:i,state:h,indented:0,tagName:null,tagStart:null,context:null}},token:function(e,t){if(!t.tagName&&e.sol()&&(t.indented=e.indentation()),e.eatSpace())return null;k=null;var n=t.tokenize(e,t);return(n||k)&&"comment"!=n&&(C=null,t.state=t.state(k||n,e,t),C&&(n="error"==C?n+" error":C)),n},indent:function(t,n,o){var a=t.context;if(t.tokenize.isInAttribute)return t.tagStart==t.indented?t.stringStartCol+1:t.indented+b;if(a&&a.noIndent)return e.Pass;if(t.tokenize!=r&&t.tokenize!=i)return o?o.match(/^(\s*)/)[0].length:0;if(t.tagName)return x?t.tagStart+t.tagName.length+2:t.tagStart+b*w;if(T&&/<!\[CDATA\[/.test(n))return 0;var s=n&&/^<(\/)?([\w_:\.-]*)/.exec(n);if(s&&s[1])for(;a;){if(a.tagName==s[2]){a=a.prev;break}if(!S.implicitlyClosed.hasOwnProperty(a.tagName))break;a=a.prev}else if(s)for(;a;){var l=S.contextGrabbers[a.tagName];if(!l||!l.hasOwnProperty(s[2]))break;a=a.prev}for(;a&&!a.startOfLine;)a=a.prev;return a?a.indent+b:0},electricInput:/<\/[\s\w:]+>$/,blockCommentStart:"<!--",blockCommentEnd:"-->",configuration:n.htmlMode?"html":"xml",helperType:n.htmlMode?"html":"xml"}}),e.defineMIME("text/xml","xml"),e.defineMIME("application/xml","xml"),e.mimeModes.hasOwnProperty("text/html")||e.defineMIME("text/html",{name:"xml",htmlMode:!0})}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";e.defineMode("javascript",function(t,n){function i(e){for(var t,n=!1,i=!1;null!=(t=e.next());){if(!n){if("/"==t&&!i)return;"["==t?i=!0:i&&"]"==t&&(i=!1)}n=!n&&"\\"==t}}function r(e,t,n){return pe=e,ge=n,t}function o(e,t){var n=e.next();if('"'==n||"'"==n)return t.tokenize=a(n),t.tokenize(e,t);if("."==n&&e.match(/^\d+(?:[eE][+\-]?\d+)?/))return r("number","number");if("."==n&&e.match(".."))return r("spread","meta");if(/[\[\]{}\(\),;\:\.]/.test(n))return r(n);if("="==n&&e.eat(">"))return r("=>","operator");if("0"==n&&e.eat(/x/i))return e.eatWhile(/[\da-f]/i),r("number","number");if(/\d/.test(n))return e.match(/^\d*(?:\.\d*)?(?:[eE][+\-]?\d+)?/),r("number","number");if("/"==n)return e.eat("*")?(t.tokenize=s,s(e,t)):e.eat("/")?(e.skipToEnd(),r("comment","comment")):"operator"==t.lastType||"keyword c"==t.lastType||"sof"==t.lastType||/^[\[{}\(,;:]$/.test(t.lastType)?(i(e),e.eatWhile(/[gimy]/),r("regexp","string-2")):(e.eatWhile(ke),r("operator","operator",e.current()));if("`"==n)return t.tokenize=l,l(e,t);if("#"==n)return e.skipToEnd(),r("error","error");if(ke.test(n))return e.eatWhile(ke),r("operator","operator",e.current());if(we.test(n)){e.eatWhile(we);var o=e.current(),u=xe.propertyIsEnumerable(o)&&xe[o];return u&&"."!=t.lastType?r(u.type,u.style,o):r("variable","variable",o)}}function a(e){return function(t,n){var i,a=!1;if(ye&&"@"==t.peek()&&t.match(Ce))return n.tokenize=o,r("jsonld-keyword","meta");for(;null!=(i=t.next())&&(i!=e||a);)a=!a&&"\\"==i;return a||(n.tokenize=o),r("string","string")}}function s(e,t){for(var n,i=!1;n=e.next();){if("/"==n&&i){t.tokenize=o;break}i="*"==n}return r("comment","comment")}function l(e,t){for(var n,i=!1;null!=(n=e.next());){if(!i&&("`"==n||"$"==n&&e.eat("{"))){t.tokenize=o;break}i=!i&&"\\"==n}return r("quasi","string-2",e.current())}function u(e,t){t.fatArrowAt&&(t.fatArrowAt=null);var n=e.string.indexOf("=>",e.start);if(!(0>n)){for(var i=0,r=!1,o=n-1;o>=0;--o){var a=e.string.charAt(o),s=Se.indexOf(a);if(s>=0&&3>s){if(!i){++o;break}if(0==--i)break}else if(s>=3&&6>s)++i;else if(we.test(a))r=!0;else if(r&&!i){++o;break}}r&&!i&&(t.fatArrowAt=o)}}function c(e,t,n,i,r,o){this.indented=e,this.column=t,this.type=n,this.prev=r,this.info=o,null!=i&&(this.align=i)}function h(e,t){for(var n=e.localVars;n;n=n.next)if(n.name==t)return!0;for(var i=e.context;i;i=i.prev)for(var n=i.vars;n;n=n.next)if(n.name==t)return!0}function d(e,t,n,i,r){var o=e.cc;for(Me.state=e,Me.stream=r,Me.marked=null,Me.cc=o,Me.style=t,e.lexical.hasOwnProperty("align")||(e.lexical.align=!0);;){var a=o.length?o.pop():_e?x:w;if(a(n,i)){for(;o.length&&o[o.length-1].lex;)o.pop()();return Me.marked?Me.marked:"variable"==n&&h(e,i)?"variable-2":t}}}function f(){for(var e=arguments.length-1;e>=0;e--)Me.cc.push(arguments[e])}function p(){return f.apply(null,arguments),!0}function g(e){function t(t){for(var n=t;n;n=n.next)if(n.name==e)return!0;return!1}var i=Me.state;if(i.context){if(Me.marked="def",t(i.localVars))return;i.localVars={name:e,next:i.localVars}}else{if(t(i.globalVars))return;n.globalVars&&(i.globalVars={name:e,next:i.globalVars})}}function m(){Me.state.context={prev:Me.state.context,vars:Me.state.localVars},Me.state.localVars=Le}function v(){Me.state.localVars=Me.state.context.vars,Me.state.context=Me.state.context.prev}function y(e,t){var n=function(){var n=Me.state,i=n.indented;if("stat"==n.lexical.type)i=n.lexical.indented;else for(var r=n.lexical;r&&")"==r.type&&r.align;r=r.prev)i=r.indented;n.lexical=new c(i,Me.stream.column(),e,null,n.lexical,t)};return n.lex=!0,n}function _(){var e=Me.state;e.lexical.prev&&(")"==e.lexical.type&&(e.indented=e.lexical.indented),e.lexical=e.lexical.prev)}function b(e){function t(n){return n==e?p():";"==e?f():p(t)}return t}function w(e,t){return"var"==e?p(y("vardef",t.length),j,b(";"),_):"keyword a"==e?p(y("form"),x,w,_):"keyword b"==e?p(y("form"),w,_):"{"==e?p(y("}"),H,_):";"==e?p():"if"==e?("else"==Me.state.lexical.info&&Me.state.cc[Me.state.cc.length-1]==_&&Me.state.cc.pop()(),p(y("form"),x,w,_,G)):"function"==e?p(ee):"for"==e?p(y("form"),X,w,_):"variable"==e?p(y("stat"),I):"switch"==e?p(y("form"),x,y("}","switch"),b("{"),H,_,_):"case"==e?p(x,b(":")):"default"==e?p(b(":")):"catch"==e?p(y("form"),m,b("("),te,b(")"),w,_,v):"module"==e?p(y("form"),m,ae,v,_):"class"==e?p(y("form"),ne,_):"export"==e?p(y("form"),se,_):"import"==e?p(y("form"),le,_):f(y("stat"),x,b(";"),_)}function x(e){return C(e,!1)}function k(e){return C(e,!0)}function C(e,t){if(Me.state.fatArrowAt==Me.stream.start){var n=t?A:N;if("("==e)return p(m,y(")"),z(F,")"),_,b("=>"),n,v);if("variable"==e)return f(m,F,b("=>"),n,v)}var i=t?L:M;return Te.hasOwnProperty(e)?p(i):"function"==e?p(ee,i):"keyword c"==e?p(t?T:S):"("==e?p(y(")"),S,fe,b(")"),_,i):"operator"==e||"spread"==e?p(t?k:x):"["==e?p(y("]"),he,_,i):"{"==e?W(D,"}",null,i):"quasi"==e?f(E,i):p()}function S(e){return e.match(/[;\}\)\],]/)?f():f(x)}function T(e){return e.match(/[;\}\)\],]/)?f():f(k)}function M(e,t){return","==e?p(x):L(e,t,!1)}function L(e,t,n){var i=0==n?M:L,r=0==n?x:k;return"=>"==e?p(m,n?A:N,v):"operator"==e?/\+\+|--/.test(t)?p(i):"?"==t?p(x,b(":"),r):p(r):"quasi"==e?f(E,i):";"!=e?"("==e?W(k,")","call",i):"."==e?p(O,i):"["==e?p(y("]"),S,b("]"),_,i):void 0:void 0}function E(e,t){return"quasi"!=e?f():"${"!=t.slice(t.length-2)?p(E):p(x,P)}function P(e){return"}"==e?(Me.marked="string-2",Me.state.tokenize=l,p(E)):void 0}function N(e){return u(Me.stream,Me.state),f("{"==e?w:x)}function A(e){return u(Me.stream,Me.state),f("{"==e?w:k)}function I(e){return":"==e?p(_,w):f(M,b(";"),_)}function O(e){return"variable"==e?(Me.marked="property",p()):void 0}function D(e,t){return"variable"==e||"keyword"==Me.style?(Me.marked="property",p("get"==t||"set"==t?B:R)):"number"==e||"string"==e?(Me.marked=ye?"property":Me.style+" property",p(R)):"jsonld-keyword"==e?p(R):"["==e?p(x,b("]"),R):void 0}function B(e){return"variable"!=e?f(R):(Me.marked="property",p(ee))}function R(e){return":"==e?p(k):"("==e?f(ee):void 0}function z(e,t){function n(i){if(","==i){var r=Me.state.lexical;return"call"==r.info&&(r.pos=(r.pos||0)+1),p(e,n)}return i==t?p():p(b(t))}return function(i){return i==t?p():f(e,n)}}function W(e,t,n){for(var i=3;i<arguments.length;i++)Me.cc.push(arguments[i]);return p(y(t,n),z(e,t),_)}function H(e){return"}"==e?p():f(w,H)}function U(e){return be&&":"==e?p(V):void 0}function V(e){return"variable"==e?(Me.marked="variable-3",p()):void 0}function j(){return f(F,U,K,q)}function F(e,t){return"variable"==e?(g(t),p()):"["==e?W(F,"]"):"{"==e?W($,"}"):void 0}function $(e,t){return"variable"!=e||Me.stream.match(/^\s*:/,!1)?("variable"==e&&(Me.marked="property"),p(b(":"),F,K)):(g(t),p(K))}function K(e,t){return"="==t?p(k):void 0}function q(e){return","==e?p(j):void 0}function G(e,t){return"keyword b"==e&&"else"==t?p(y("form","else"),w,_):void 0}function X(e){return"("==e?p(y(")"),Y,b(")"),_):void 0}function Y(e){return"var"==e?p(j,b(";"),J):";"==e?p(J):"variable"==e?p(Q):f(x,b(";"),J)}function Q(e,t){return"in"==t||"of"==t?(Me.marked="keyword",p(x)):p(M,J)}function J(e,t){return";"==e?p(Z):"in"==t||"of"==t?(Me.marked="keyword",p(x)):f(x,b(";"),Z)}function Z(e){")"!=e&&p(x)}function ee(e,t){return"*"==t?(Me.marked="keyword",p(ee)):"variable"==e?(g(t),p(ee)):"("==e?p(m,y(")"),z(te,")"),_,w,v):void 0}function te(e){return"spread"==e?p(te):f(F,U)}function ne(e,t){return"variable"==e?(g(t),p(ie)):void 0}function ie(e,t){return"extends"==t?p(x,ie):"{"==e?p(y("}"),re,_):void 0}function re(e,t){return"variable"==e||"keyword"==Me.style?(Me.marked="property","get"==t||"set"==t?p(oe,ee,re):p(ee,re)):"*"==t?(Me.marked="keyword",p(re)):";"==e?p(re):"}"==e?p():void 0}function oe(e){return"variable"!=e?f():(Me.marked="property",p())}function ae(e,t){return"string"==e?p(w):"variable"==e?(g(t),p(ce)):void 0}function se(e,t){return"*"==t?(Me.marked="keyword",p(ce,b(";"))):"default"==t?(Me.marked="keyword",p(x,b(";"))):f(w)}function le(e){return"string"==e?p():f(ue,ce)}function ue(e,t){return"{"==e?W(ue,"}"):("variable"==e&&g(t),p())}function ce(e,t){return"from"==t?(Me.marked="keyword",p(x)):void 0}function he(e){return"]"==e?p():f(k,de)}function de(e){return"for"==e?f(fe,b("]")):","==e?p(z(T,"]")):f(z(k,"]"))}function fe(e){return"for"==e?p(X,fe):"if"==e?p(x,fe):void 0}var pe,ge,me=t.indentUnit,ve=n.statementIndent,ye=n.jsonld,_e=n.json||ye,be=n.typescript,we=n.wordCharacters||/[\w$\xa1-\uffff]/,xe=function(){function e(e){return{type:e,style:"keyword"}}var t=e("keyword a"),n=e("keyword b"),i=e("keyword c"),r=e("operator"),o={type:"atom",style:"atom"},a={"if":e("if"),"while":t,"with":t,"else":n,"do":n,"try":n,"finally":n,"return":i,"break":i,"continue":i,"new":i,"delete":i,"throw":i,"debugger":i,"var":e("var"),"const":e("var"),let:e("var"),"function":e("function"),"catch":e("catch"),"for":e("for"),"switch":e("switch"),"case":e("case"),"default":e("default"),"in":r,"typeof":r,"instanceof":r,"true":o,"false":o,"null":o,undefined:o,NaN:o,Infinity:o,"this":e("this"),module:e("module"),"class":e("class"),"super":e("atom"),"yield":i,"export":e("export"),"import":e("import"),"extends":i};if(be){var s={type:"variable",style:"variable-3"},l={"interface":e("interface"),"extends":e("extends"),constructor:e("constructor"),"public":e("public"),"private":e("private"),"protected":e("protected"),"static":e("static"),string:s,number:s,bool:s,any:s};for(var u in l)a[u]=l[u]}return a}(),ke=/[+\-*&%=<>!?|~^]/,Ce=/^@(context|id|value|language|type|container|list|set|reverse|index|base|vocab|graph)"/,Se="([{}])",Te={atom:!0,number:!0,variable:!0,string:!0,regexp:!0,"this":!0,"jsonld-keyword":!0},Me={state:null,column:null,marked:null,cc:null},Le={name:"this",next:{name:"arguments"}};return _.lex=!0,{startState:function(e){var t={tokenize:o,lastType:"sof",cc:[],lexical:new c((e||0)-me,0,"block",!1),localVars:n.localVars,context:n.localVars&&{vars:n.localVars},indented:0};return n.globalVars&&"object"==typeof n.globalVars&&(t.globalVars=n.globalVars),t},token:function(e,t){if(e.sol()&&(t.lexical.hasOwnProperty("align")||(t.lexical.align=!1),t.indented=e.indentation(),u(e,t)),t.tokenize!=s&&e.eatSpace())return null;var n=t.tokenize(e,t);return"comment"==pe?n:(t.lastType="operator"!=pe||"++"!=ge&&"--"!=ge?pe:"incdec",d(t,n,pe,ge,e))},indent:function(t,i){if(t.tokenize==s)return e.Pass;if(t.tokenize!=o)return 0;var r=i&&i.charAt(0),a=t.lexical;if(!/^\s*else\b/.test(i))for(var l=t.cc.length-1;l>=0;--l){var u=t.cc[l];if(u==_)a=a.prev;else if(u!=G)break}"stat"==a.type&&"}"==r&&(a=a.prev),ve&&")"==a.type&&"stat"==a.prev.type&&(a=a.prev);var c=a.type,h=r==c;return"vardef"==c?a.indented+("operator"==t.lastType||","==t.lastType?a.info+1:0):"form"==c&&"{"==r?a.indented:"form"==c?a.indented+me:"stat"==c?a.indented+("operator"==t.lastType||","==t.lastType?ve||me:0):"switch"!=a.info||h||0==n.doubleIndentSwitch?a.align?a.column+(h?0:1):a.indented+(h?0:me):a.indented+(/^(?:case|default)\b/.test(i)?me:2*me)},electricInput:/^\s*(?:case .*?:|default:|\{|\})$/,blockCommentStart:_e?null:"/*",blockCommentEnd:_e?null:"*/",lineComment:_e?null:"//",fold:"brace",helperType:_e?"json":"javascript",jsonldMode:ye,jsonMode:_e}}),e.registerHelper("wordChars","javascript",/[\w$]/),e.defineMIME("text/javascript","javascript"),e.defineMIME("text/ecmascript","javascript"),e.defineMIME("application/javascript","javascript"),e.defineMIME("application/x-javascript","javascript"),e.defineMIME("application/ecmascript","javascript"),e.defineMIME("application/json",{name:"javascript",json:!0}),e.defineMIME("application/x-json",{name:"javascript",json:!0}),e.defineMIME("application/ld+json",{name:"javascript",jsonld:!0}),e.defineMIME("text/typescript",{name:"javascript",typescript:!0}),e.defineMIME("application/typescript",{name:"javascript",typescript:!0})}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";function t(e){for(var t={},n=0;n<e.length;++n)t[e[n]]=!0;return t}function n(e,t){for(var n,i=!1;null!=(n=e.next());){if(i&&"/"==n){t.tokenize=null;break}i="*"==n}return["comment","comment"]}function i(e,t){return e.skipTo("-->")?(e.match("-->"),t.tokenize=null):e.skipToEnd(),["comment","comment"]}e.defineMode("css",function(t,n){function i(e,t){return f=t,e}function r(e,t){var n=e.next();if(m[n]){var r=m[n](e,t);if(r!==!1)return r}return"@"==n?(e.eatWhile(/[\w\\\-]/),i("def",e.current())):"="==n||("~"==n||"|"==n)&&e.eat("=")?i(null,"compare"):'"'==n||"'"==n?(t.tokenize=o(n),t.tokenize(e,t)):"#"==n?(e.eatWhile(/[\w\\\-]/),i("atom","hash")):"!"==n?(e.match(/^\s*\w*/),i("keyword","important")):/\d/.test(n)||"."==n&&e.eat(/\d/)?(e.eatWhile(/[\w.%]/),i("number","unit")):"-"!==n?/[,+>*\/]/.test(n)?i(null,"select-op"):"."==n&&e.match(/^-?[_a-z][_a-z0-9-]*/i)?i("qualifier","qualifier"):/[:;{}\[\]\(\)]/.test(n)?i(null,n):"u"==n&&e.match("rl(")?(e.backUp(1),t.tokenize=a,i("property","word")):/[\w\\\-]/.test(n)?(e.eatWhile(/[\w\\\-]/),i("property","word")):i(null,null):/[\d.]/.test(e.peek())?(e.eatWhile(/[\w.%]/),i("number","unit")):e.match(/^\w+-/)?i("meta","meta"):void 0}function o(e){return function(t,n){for(var r,o=!1;null!=(r=t.next());){if(r==e&&!o){")"==e&&t.backUp(1);break}o=!o&&"\\"==r}return(r==e||!o&&")"!=e)&&(n.tokenize=null),i("string","string")}}function a(e,t){return e.next(),e.match(/\s*[\"\')]/,!1)?t.tokenize=null:t.tokenize=o(")"),i(null,"(")}function s(e,t,n){this.type=e,this.indent=t,this.prev=n}function l(e,t,n){return e.context=new s(n,t.indentation()+g,e.context),n}function u(e){return e.context=e.context.prev,e.context.type}function c(e,t,n){return S[n.context.type](e,t,n)}function h(e,t,n,i){for(var r=i||1;r>0;r--)n.context=n.context.prev;return c(e,t,n)}function d(e){var t=e.current().toLowerCase();p=x.hasOwnProperty(t)?"atom":w.hasOwnProperty(t)?"keyword":"variable"}n.propertyKeywords||(n=e.resolveMode("text/css"));var f,p,g=t.indentUnit,m=n.tokenHooks,v=n.mediaTypes||{},y=n.mediaFeatures||{},_=n.propertyKeywords||{},b=n.nonStandardPropertyKeywords||{},w=n.colorKeywords||{},x=n.valueKeywords||{},k=n.fontProperties||{},C=n.allowNested,S={};return S.top=function(e,t,n){if("{"==e)return l(n,t,"block");if("}"==e&&n.context.prev)return u(n);if("@media"==e)return l(n,t,"media");if("@font-face"==e)return"font_face_before";if(/^@(-(moz|ms|o|webkit)-)?keyframes$/.test(e))return"keyframes";if(e&&"@"==e.charAt(0))return l(n,t,"at");if("hash"==e)p="builtin";else if("word"==e)p="tag";else{if("variable-definition"==e)return"maybeprop";if("interpolation"==e)return l(n,t,"interpolation");if(":"==e)return"pseudo";if(C&&"("==e)return l(n,t,"parens")}return n.context.type},S.block=function(e,t,n){if("word"==e){var i=t.current().toLowerCase();return _.hasOwnProperty(i)?(p="property","maybeprop"):b.hasOwnProperty(i)?(p="string-2","maybeprop"):C?(p=t.match(/^\s*:/,!1)?"property":"tag","block"):(p+=" error","maybeprop")}return"meta"==e?"block":C||"hash"!=e&&"qualifier"!=e?S.top(e,t,n):(p="error","block")},S.maybeprop=function(e,t,n){return":"==e?l(n,t,"prop"):c(e,t,n)},S.prop=function(e,t,n){if(";"==e)return u(n);if("{"==e&&C)return l(n,t,"propBlock");if("}"==e||"{"==e)return h(e,t,n);if("("==e)return l(n,t,"parens");if("hash"!=e||/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/.test(t.current())){if("word"==e)d(t);else if("interpolation"==e)return l(n,t,"interpolation")}else p+=" error";return"prop"},S.propBlock=function(e,t,n){return"}"==e?u(n):"word"==e?(p="property","maybeprop"):n.context.type},S.parens=function(e,t,n){return"{"==e||"}"==e?h(e,t,n):")"==e?u(n):"("==e?l(n,t,"parens"):("word"==e&&d(t),"parens")},S.pseudo=function(e,t,n){return"word"==e?(p="variable-3",n.context.type):c(e,t,n)},S.media=function(e,t,n){if("("==e)return l(n,t,"media_parens");if("}"==e)return h(e,t,n);if("{"==e)return u(n)&&l(n,t,C?"block":"top");if("word"==e){var i=t.current().toLowerCase();p="only"==i||"not"==i||"and"==i?"keyword":v.hasOwnProperty(i)?"attribute":y.hasOwnProperty(i)?"property":"error"}return n.context.type},S.media_parens=function(e,t,n){return")"==e?u(n):"{"==e||"}"==e?h(e,t,n,2):S.media(e,t,n)},S.font_face_before=function(e,t,n){return"{"==e?l(n,t,"font_face"):c(e,t,n)},S.font_face=function(e,t,n){return"}"==e?u(n):"word"==e?(p=k.hasOwnProperty(t.current().toLowerCase())?"property":"error","maybeprop"):"font_face"},S.keyframes=function(e,t,n){return"word"==e?(p="variable","keyframes"):"{"==e?l(n,t,"top"):c(e,t,n)},S.at=function(e,t,n){return";"==e?u(n):"{"==e||"}"==e?h(e,t,n):("word"==e?p="tag":"hash"==e&&(p="builtin"),"at")},S.interpolation=function(e,t,n){return"}"==e?u(n):"{"==e||";"==e?h(e,t,n):("variable"!=e&&(p="error"),"interpolation")},{startState:function(e){return{tokenize:null,state:"top",context:new s("top",e||0,null)}},token:function(e,t){if(!t.tokenize&&e.eatSpace())return null;var n=(t.tokenize||r)(e,t);return n&&"object"==typeof n&&(f=n[1],n=n[0]),p=n,t.state=S[t.state](f,e,t),p},indent:function(e,t){var n=e.context,i=t&&t.charAt(0),r=n.indent;return"prop"!=n.type||"}"!=i&&")"!=i||(n=n.prev),!n.prev||("}"!=i||"block"!=n.type&&"top"!=n.type&&"interpolation"!=n.type&&"font_face"!=n.type)&&(")"!=i||"parens"!=n.type&&"media_parens"!=n.type)&&("{"!=i||"at"!=n.type&&"media"!=n.type)||(r=n.indent-g,n=n.prev),r},electricChars:"}",blockCommentStart:"/*",blockCommentEnd:"*/",fold:"brace"}});var r=["all","aural","braille","handheld","print","projection","screen","tty","tv","embossed"],o=t(r),a=["width","min-width","max-width","height","min-height","max-height","device-width","min-device-width","max-device-width","device-height","min-device-height","max-device-height","aspect-ratio","min-aspect-ratio","max-aspect-ratio","device-aspect-ratio","min-device-aspect-ratio","max-device-aspect-ratio","color","min-color","max-color","color-index","min-color-index","max-color-index","monochrome","min-monochrome","max-monochrome","resolution","min-resolution","max-resolution","scan","grid"],s=t(a),l=["align-content","align-items","align-self","alignment-adjust","alignment-baseline","anchor-point","animation","animation-delay","animation-direction","animation-duration","animation-fill-mode","animation-iteration-count","animation-name","animation-play-state","animation-timing-function","appearance","azimuth","backface-visibility","background","background-attachment","background-clip","background-color","background-image","background-origin","background-position","background-repeat","background-size","baseline-shift","binding","bleed","bookmark-label","bookmark-level","bookmark-state","bookmark-target","border","border-bottom","border-bottom-color","border-bottom-left-radius","border-bottom-right-radius","border-bottom-style","border-bottom-width","border-collapse","border-color","border-image","border-image-outset","border-image-repeat","border-image-slice","border-image-source","border-image-width","border-left","border-left-color","border-left-style","border-left-width","border-radius","border-right","border-right-color","border-right-style","border-right-width","border-spacing","border-style","border-top","border-top-color","border-top-left-radius","border-top-right-radius","border-top-style","border-top-width","border-width","bottom","box-decoration-break","box-shadow","box-sizing","break-after","break-before","break-inside","caption-side","clear","clip","color","color-profile","column-count","column-fill","column-gap","column-rule","column-rule-color","column-rule-style","column-rule-width","column-span","column-width","columns","content","counter-increment","counter-reset","crop","cue","cue-after","cue-before","cursor","direction","display","dominant-baseline","drop-initial-after-adjust","drop-initial-after-align","drop-initial-before-adjust","drop-initial-before-align","drop-initial-size","drop-initial-value","elevation","empty-cells","fit","fit-position","flex","flex-basis","flex-direction","flex-flow","flex-grow","flex-shrink","flex-wrap","float","float-offset","flow-from","flow-into","font","font-feature-settings","font-family","font-kerning","font-language-override","font-size","font-size-adjust","font-stretch","font-style","font-synthesis","font-variant","font-variant-alternates","font-variant-caps","font-variant-east-asian","font-variant-ligatures","font-variant-numeric","font-variant-position","font-weight","grid","grid-area","grid-auto-columns","grid-auto-flow","grid-auto-position","grid-auto-rows","grid-column","grid-column-end","grid-column-start","grid-row","grid-row-end","grid-row-start","grid-template","grid-template-areas","grid-template-columns","grid-template-rows","hanging-punctuation","height","hyphens","icon","image-orientation","image-rendering","image-resolution","inline-box-align","justify-content","left","letter-spacing","line-break","line-height","line-stacking","line-stacking-ruby","line-stacking-shift","line-stacking-strategy","list-style","list-style-image","list-style-position","list-style-type","margin","margin-bottom","margin-left","margin-right","margin-top","marker-offset","marks","marquee-direction","marquee-loop","marquee-play-count","marquee-speed","marquee-style","max-height","max-width","min-height","min-width","move-to","nav-down","nav-index","nav-left","nav-right","nav-up","object-fit","object-position","opacity","order","orphans","outline","outline-color","outline-offset","outline-style","outline-width","overflow","overflow-style","overflow-wrap","overflow-x","overflow-y","padding","padding-bottom","padding-left","padding-right","padding-top","page","page-break-after","page-break-before","page-break-inside","page-policy","pause","pause-after","pause-before","perspective","perspective-origin","pitch","pitch-range","play-during","position","presentation-level","punctuation-trim","quotes","region-break-after","region-break-before","region-break-inside","region-fragment","rendering-intent","resize","rest","rest-after","rest-before","richness","right","rotation","rotation-point","ruby-align","ruby-overhang","ruby-position","ruby-span","shape-image-threshold","shape-inside","shape-margin","shape-outside","size","speak","speak-as","speak-header","speak-numeral","speak-punctuation","speech-rate","stress","string-set","tab-size","table-layout","target","target-name","target-new","target-position","text-align","text-align-last","text-decoration","text-decoration-color","text-decoration-line","text-decoration-skip","text-decoration-style","text-emphasis","text-emphasis-color","text-emphasis-position","text-emphasis-style","text-height","text-indent","text-justify","text-outline","text-overflow","text-shadow","text-size-adjust","text-space-collapse","text-transform","text-underline-position","text-wrap","top","transform","transform-origin","transform-style","transition","transition-delay","transition-duration","transition-property","transition-timing-function","unicode-bidi","vertical-align","visibility","voice-balance","voice-duration","voice-family","voice-pitch","voice-range","voice-rate","voice-stress","voice-volume","volume","white-space","widows","width","word-break","word-spacing","word-wrap","z-index","clip-path","clip-rule","mask","enable-background","filter","flood-color","flood-opacity","lighting-color","stop-color","stop-opacity","pointer-events","color-interpolation","color-interpolation-filters","color-rendering","fill","fill-opacity","fill-rule","image-rendering","marker","marker-end","marker-mid","marker-start","shape-rendering","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","text-rendering","baseline-shift","dominant-baseline","glyph-orientation-horizontal","glyph-orientation-vertical","text-anchor","writing-mode"],u=t(l),c=["scrollbar-arrow-color","scrollbar-base-color","scrollbar-dark-shadow-color","scrollbar-face-color","scrollbar-highlight-color","scrollbar-shadow-color","scrollbar-3d-light-color","scrollbar-track-color","shape-inside","searchfield-cancel-button","searchfield-decoration","searchfield-results-button","searchfield-results-decoration","zoom"],h=t(c),d=["aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","grey","green","greenyellow","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","rebeccapurple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen"],f=t(d),p=["above","absolute","activeborder","activecaption","afar","after-white-space","ahead","alias","all","all-scroll","alternate","always","amharic","amharic-abegede","antialiased","appworkspace","arabic-indic","armenian","asterisks","auto","avoid","avoid-column","avoid-page","avoid-region","background","backwards","baseline","below","bidi-override","binary","bengali","blink","block","block-axis","bold","bolder","border","border-box","both","bottom","break","break-all","break-word","button","button-bevel","buttonface","buttonhighlight","buttonshadow","buttontext","cambodian","capitalize","caps-lock-indicator","caption","captiontext","caret","cell","center","checkbox","circle","cjk-earthly-branch","cjk-heavenly-stem","cjk-ideographic","clear","clip","close-quote","col-resize","collapse","column","compact","condensed","contain","content","content-box","context-menu","continuous","copy","cover","crop","cross","crosshair","currentcolor","cursive","dashed","decimal","decimal-leading-zero","default","default-button","destination-atop","destination-in","destination-out","destination-over","devanagari","disc","discard","document","dot-dash","dot-dot-dash","dotted","double","down","e-resize","ease","ease-in","ease-in-out","ease-out","element","ellipse","ellipsis","embed","end","ethiopic","ethiopic-abegede","ethiopic-abegede-am-et","ethiopic-abegede-gez","ethiopic-abegede-ti-er","ethiopic-abegede-ti-et","ethiopic-halehame-aa-er","ethiopic-halehame-aa-et","ethiopic-halehame-am-et","ethiopic-halehame-gez","ethiopic-halehame-om-et","ethiopic-halehame-sid-et","ethiopic-halehame-so-et","ethiopic-halehame-ti-er","ethiopic-halehame-ti-et","ethiopic-halehame-tig","ew-resize","expanded","extra-condensed","extra-expanded","fantasy","fast","fill","fixed","flat","footnotes","forwards","from","geometricPrecision","georgian","graytext","groove","gujarati","gurmukhi","hand","hangul","hangul-consonant","hebrew","help","hidden","hide","higher","highlight","highlighttext","hiragana","hiragana-iroha","horizontal","hsl","hsla","icon","ignore","inactiveborder","inactivecaption","inactivecaptiontext","infinite","infobackground","infotext","inherit","initial","inline","inline-axis","inline-block","inline-table","inset","inside","intrinsic","invert","italic","justify","kannada","katakana","katakana-iroha","keep-all","khmer","landscape","lao","large","larger","left","level","lighter","line-through","linear","lines","list-item","listbox","listitem","local","logical","loud","lower","lower-alpha","lower-armenian","lower-greek","lower-hexadecimal","lower-latin","lower-norwegian","lower-roman","lowercase","ltr","malayalam","match","media-controls-background","media-current-time-display","media-fullscreen-button","media-mute-button","media-play-button","media-return-to-realtime-button","media-rewind-button","media-seek-back-button","media-seek-forward-button","media-slider","media-sliderthumb","media-time-remaining-display","media-volume-slider","media-volume-slider-container","media-volume-sliderthumb","medium","menu","menulist","menulist-button","menulist-text","menulist-textfield","menutext","message-box","middle","min-intrinsic","mix","mongolian","monospace","move","multiple","myanmar","n-resize","narrower","ne-resize","nesw-resize","no-close-quote","no-drop","no-open-quote","no-repeat","none","normal","not-allowed","nowrap","ns-resize","nw-resize","nwse-resize","oblique","octal","open-quote","optimizeLegibility","optimizeSpeed","oriya","oromo","outset","outside","outside-shape","overlay","overline","padding","padding-box","painted","page","paused","persian","plus-darker","plus-lighter","pointer","polygon","portrait","pre","pre-line","pre-wrap","preserve-3d","progress","push-button","radio","read-only","read-write","read-write-plaintext-only","rectangle","region","relative","repeat","repeat-x","repeat-y","reset","reverse","rgb","rgba","ridge","right","round","row-resize","rtl","run-in","running","s-resize","sans-serif","scroll","scrollbar","se-resize","searchfield","searchfield-cancel-button","searchfield-decoration","searchfield-results-button","searchfield-results-decoration","semi-condensed","semi-expanded","separate","serif","show","sidama","single","skip-white-space","slide","slider-horizontal","slider-vertical","sliderthumb-horizontal","sliderthumb-vertical","slow","small","small-caps","small-caption","smaller","solid","somali","source-atop","source-in","source-out","source-over","space","square","square-button","start","static","status-bar","stretch","stroke","sub","subpixel-antialiased","super","sw-resize","table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row","table-row-group","telugu","text","text-bottom","text-top","textarea","textfield","thai","thick","thin","threeddarkshadow","threedface","threedhighlight","threedlightshadow","threedshadow","tibetan","tigre","tigrinya-er","tigrinya-er-abegede","tigrinya-et","tigrinya-et-abegede","to","top","transparent","ultra-condensed","ultra-expanded","underline","up","upper-alpha","upper-armenian","upper-greek","upper-hexadecimal","upper-latin","upper-norwegian","upper-roman","uppercase","urdu","url","vertical","vertical-text","visible","visibleFill","visiblePainted","visibleStroke","visual","w-resize","wait","wave","wider","window","windowframe","windowtext","x-large","x-small","xor","xx-large","xx-small"],g=t(p),m=["font-family","src","unicode-range","font-variant","font-feature-settings","font-stretch","font-weight","font-style"],v=t(m),y=r.concat(a).concat(l).concat(c).concat(d).concat(p);
e.registerHelper("hintWords","css",y),e.defineMIME("text/css",{mediaTypes:o,mediaFeatures:s,propertyKeywords:u,nonStandardPropertyKeywords:h,colorKeywords:f,valueKeywords:g,fontProperties:v,tokenHooks:{"<":function(e,t){return e.match("!--")?(t.tokenize=i,i(e,t)):!1},"/":function(e,t){return e.eat("*")?(t.tokenize=n,n(e,t)):!1}},name:"css"}),e.defineMIME("text/x-scss",{mediaTypes:o,mediaFeatures:s,propertyKeywords:u,nonStandardPropertyKeywords:h,colorKeywords:f,valueKeywords:g,fontProperties:v,allowNested:!0,tokenHooks:{"/":function(e,t){return e.eat("/")?(e.skipToEnd(),["comment","comment"]):e.eat("*")?(t.tokenize=n,n(e,t)):["operator","operator"]},":":function(e){return e.match(/\s*\{/)?[null,"{"]:!1},$:function(e){return e.match(/^[\w-]+/),e.match(/^\s*:/,!1)?["variable-2","variable-definition"]:["variable-2","variable"]},"#":function(e){return e.eat("{")?[null,"interpolation"]:!1}},name:"css",helperType:"scss"}),e.defineMIME("text/x-less",{mediaTypes:o,mediaFeatures:s,propertyKeywords:u,nonStandardPropertyKeywords:h,colorKeywords:f,valueKeywords:g,fontProperties:v,allowNested:!0,tokenHooks:{"/":function(e,t){return e.eat("/")?(e.skipToEnd(),["comment","comment"]):e.eat("*")?(t.tokenize=n,n(e,t)):["operator","operator"]},"@":function(e){return e.match(/^(charset|document|font-face|import|(-(moz|ms|o|webkit)-)?keyframes|media|namespace|page|supports)\b/,!1)?!1:(e.eatWhile(/[\w\\\-]/),e.match(/^\s*:/,!1)?["variable-2","variable-definition"]:["variable-2","variable"])},"&":function(){return["atom","atom"]}},name:"css",helperType:"less"})}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror"),require("../xml/xml"),require("../javascript/javascript"),require("../css/css")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","../xml/xml","../javascript/javascript","../css/css"],e):e(CodeMirror)}(function(e){"use strict";e.defineMode("htmlmixed",function(t,n){function i(e,t){var n=t.htmlState.tagName;n&&(n=n.toLowerCase());var i=s.token(e,t.htmlState);if("script"==n&&/\btag\b/.test(i)&&">"==e.current()){var r=e.string.slice(Math.max(0,e.pos-100),e.pos).match(/\btype\s*=\s*("[^"]+"|'[^']+'|\S+)[^<]*$/i);r=r?r[1]:"",r&&/[\"\']/.test(r.charAt(0))&&(r=r.slice(1,r.length-1));for(var c=0;c<u.length;++c){var h=u[c];if("string"==typeof h.matches?r==h.matches:h.matches.test(r)){h.mode&&(t.token=o,t.localMode=h.mode,t.localState=h.mode.startState&&h.mode.startState(s.indent(t.htmlState,"")));break}}}else"style"==n&&/\btag\b/.test(i)&&">"==e.current()&&(t.token=a,t.localMode=l,t.localState=l.startState(s.indent(t.htmlState,"")));return i}function r(e,t,n){var i,r=e.current(),o=r.search(t);return o>-1?e.backUp(r.length-o):(i=r.match(/<\/?$/))&&(e.backUp(r.length),e.match(t,!1)||e.match(r)),n}function o(e,t){return e.match(/^<\/\s*script\s*>/i,!1)?(t.token=i,t.localState=t.localMode=null,i(e,t)):r(e,/<\/\s*script\s*>/,t.localMode.token(e,t.localState))}function a(e,t){return e.match(/^<\/\s*style\s*>/i,!1)?(t.token=i,t.localState=t.localMode=null,i(e,t)):r(e,/<\/\s*style\s*>/,l.token(e,t.localState))}var s=e.getMode(t,{name:"xml",htmlMode:!0,multilineTagIndentFactor:n.multilineTagIndentFactor,multilineTagIndentPastTag:n.multilineTagIndentPastTag}),l=e.getMode(t,"css"),u=[],c=n&&n.scriptTypes;if(u.push({matches:/^(?:text|application)\/(?:x-)?(?:java|ecma)script$|^$/i,mode:e.getMode(t,"javascript")}),c)for(var h=0;h<c.length;++h){var d=c[h];u.push({matches:d.matches,mode:d.mode&&e.getMode(t,d.mode)})}return u.push({matches:/./,mode:e.getMode(t,"text/plain")}),{startState:function(){var e=s.startState();return{token:i,localMode:null,localState:null,htmlState:e}},copyState:function(t){if(t.localState)var n=e.copyState(t.localMode,t.localState);return{token:t.token,localMode:t.localMode,localState:n,htmlState:e.copyState(s,t.htmlState)}},token:function(e,t){return t.token(e,t)},indent:function(t,n){return!t.localMode||/^\s*<\//.test(n)?s.indent(t.htmlState,n):t.localMode.indent?t.localMode.indent(t.localState,n):e.Pass},innerMode:function(e){return{state:e.localState||e.htmlState,mode:e.localMode||s}}}},"xml","javascript","css"),e.defineMIME("text/html","htmlmixed")}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror",require("../xml/xml"))):"function"==typeof define&&define.amd?define(["../../lib/codemirror","../xml/xml"],e):e(CodeMirror)}(function(e){"use strict";e.defineMode("markdown",function(t,n){function i(e,t,n){return t.f=t.inline=n,n(e,t)}function r(e,t,n){return t.f=t.block=n,n(e,t)}function o(e){return e.linkTitle=!1,e.em=!1,e.strong=!1,e.quote=0,_||e.f!=s||(e.f=h,e.block=a),e.trailingSpace=0,e.trailingSpaceNewLine=!1,e.thisLineHasContent=!1,null}function a(e,t){var o=e.sol(),a=t.list!==!1;t.list!==!1&&t.indentationDiff>=0?(t.indentationDiff<4&&(t.indentation-=t.indentationDiff),t.list=null):t.list!==!1&&t.indentation>0?(t.list=null,t.listDepth=Math.floor(t.indentation/4)):t.list!==!1&&(t.list=!1,t.listDepth=0);var s=null;if(t.indentationDiff>=4)return t.indentation-=4,e.skipToEnd(),S;if(e.eatSpace())return null;if(s=e.match(j))return t.header=s[0].length<=6?s[0].length:6,n.highlightFormatting&&(t.formatting="header"),t.f=t.inline,u(t);if(t.prevLineHasContent&&(s=e.match(F)))return t.header="="==s[0].charAt(0)?1:2,n.highlightFormatting&&(t.formatting="header"),t.f=t.inline,u(t);if(e.eat(">"))return t.indentation++,t.quote=o?1:t.quote+1,n.highlightFormatting&&(t.formatting="quote"),e.eatSpace(),u(t);if("["===e.peek())return i(e,t,g);if(e.match(W,!0))return P;if((!t.prevLineHasContent||a)&&(e.match(H,!1)||e.match(U,!1))){var c=null;return e.match(H,!0)?c="ul":(e.match(U,!0),c="ol"),t.indentation+=4,t.list=!0,t.listDepth++,n.taskLists&&e.match(V,!1)&&(t.taskList=!0),t.f=t.inline,n.highlightFormatting&&(t.formatting=["list","list-"+c]),u(t)}return n.fencedCodeBlocks&&e.match(/^```([\w+#]*)/,!0)?(t.localMode=x(RegExp.$1),t.localMode&&(t.localState=t.localMode.startState()),r(e,t,l),n.highlightFormatting&&(t.formatting="code-block"),t.code=!0,u(t)):i(e,t,t.inline)}function s(e,t){var n=b.token(e,t.htmlState);return(_&&null===t.htmlState.tagStart&&!t.htmlState.context||t.md_inside&&e.current().indexOf(">")>-1)&&(t.f=h,t.block=a,t.htmlState=null),n}function l(e,t){if(e.sol()&&e.match(/^```/,!0)){t.localMode=t.localState=null,t.f=h,t.block=a,n.highlightFormatting&&(t.formatting="code-block"),t.code=!0;var i=u(t);return t.code=!1,i}return t.localMode?t.localMode.token(e,t.localState):(e.skipToEnd(),S)}function u(e){var t=[];if(e.formatting){t.push(A),"string"==typeof e.formatting&&(e.formatting=[e.formatting]);for(var i=0;i<e.formatting.length;i++)t.push(A+"-"+e.formatting[i]),"header"===e.formatting[i]&&t.push(A+"-"+e.formatting[i]+"-"+e.header),"quote"===e.formatting[i]&&(!n.maxBlockquoteDepth||n.maxBlockquoteDepth>=e.quote?t.push(A+"-"+e.formatting[i]+"-"+e.quote):t.push("error"))}if(e.taskOpen)return t.push("meta"),t.length?t.join(" "):null;if(e.taskClosed)return t.push("property"),t.length?t.join(" "):null;if(e.linkHref)return t.push(B),t.length?t.join(" "):null;if(e.strong&&t.push(z),e.em&&t.push(R),e.linkText&&t.push(D),e.code&&t.push(S),e.header&&(t.push(C),t.push(C+"-"+e.header)),e.quote&&(t.push(T),!n.maxBlockquoteDepth||n.maxBlockquoteDepth>=e.quote?t.push(T+"-"+e.quote):t.push(T+"-"+n.maxBlockquoteDepth)),e.list!==!1){var r=(e.listDepth-1)%3;r?1===r?t.push(L):t.push(E):t.push(M)}return e.trailingSpaceNewLine?t.push("trailing-space-new-line"):e.trailingSpace&&t.push("trailing-space-"+(e.trailingSpace%2?"a":"b")),t.length?t.join(" "):null}function c(e,t){return e.match($,!0)?u(t):void 0}function h(t,i){var o=i.text(t,i);if("undefined"!=typeof o)return o;if(i.list)return i.list=null,u(i);if(i.taskList){var a="x"!==t.match(V,!0)[1];return a?i.taskOpen=!0:i.taskClosed=!0,n.highlightFormatting&&(i.formatting="task"),i.taskList=!1,u(i)}if(i.taskOpen=!1,i.taskClosed=!1,i.header&&t.match(/^#+$/,!0))return n.highlightFormatting&&(i.formatting="header"),u(i);var l=t.sol(),c=t.next();if("\\"===c&&(t.next(),n.highlightFormatting)){var h=u(i);return h?h+" formatting-escape":"formatting-escape"}if(i.linkTitle){i.linkTitle=!1;var p=c;"("===c&&(p=")"),p=(p+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1");var g="^\\s*(?:[^"+p+"\\\\]+|\\\\\\\\|\\\\.)"+p;if(t.match(new RegExp(g),!0))return B}if("`"===c){var m=i.formatting;n.highlightFormatting&&(i.formatting="code");var v=u(i),y=t.pos;t.eatWhile("`");var _=1+t.pos-y;return i.code?_===k?(i.code=!1,v):(i.formatting=m,u(i)):(k=_,i.code=!0,u(i))}if(i.code)return u(i);if("!"===c&&t.match(/\[[^\]]*\] ?(?:\(|\[)/,!1))return t.match(/\[[^\]]*\]/),i.inline=i.f=f,N;if("["===c&&t.match(/.*\](\(| ?\[)/,!1))return i.linkText=!0,n.highlightFormatting&&(i.formatting="link"),u(i);if("]"===c&&i.linkText){n.highlightFormatting&&(i.formatting="link");var h=u(i);return i.linkText=!1,i.inline=i.f=f,h}if("<"===c&&t.match(/^(https?|ftps?):\/\/(?:[^\\>]|\\.)+>/,!1)){i.f=i.inline=d,n.highlightFormatting&&(i.formatting="link");var h=u(i);return h?h+=" ":h="",h+I}if("<"===c&&t.match(/^[^> \\]+@(?:[^\\>]|\\.)+>/,!1)){i.f=i.inline=d,n.highlightFormatting&&(i.formatting="link");var h=u(i);return h?h+=" ":h="",h+O}if("<"===c&&t.match(/^\w/,!1)){if(-1!=t.string.indexOf(">")){var w=t.string.substring(1,t.string.indexOf(">"));/markdown\s*=\s*('|"){0,1}1('|"){0,1}/.test(w)&&(i.md_inside=!0)}return t.backUp(1),i.htmlState=e.startState(b),r(t,i,s)}if("<"===c&&t.match(/^\/\w*?>/))return i.md_inside=!1,"tag";var x=!1;if(!n.underscoresBreakWords&&"_"===c&&"_"!==t.peek()&&t.match(/(\w)/,!1)){var C=t.pos-2;if(C>=0){var S=t.string.charAt(C);"_"!==S&&S.match(/(\w)/,!1)&&(x=!0)}}if("*"===c||"_"===c&&!x)if(l&&" "===t.peek());else{if(i.strong===c&&t.eat(c)){n.highlightFormatting&&(i.formatting="strong");var v=u(i);return i.strong=!1,v}if(!i.strong&&t.eat(c))return i.strong=c,n.highlightFormatting&&(i.formatting="strong"),u(i);if(i.em===c){n.highlightFormatting&&(i.formatting="em");var v=u(i);return i.em=!1,v}if(!i.em)return i.em=c,n.highlightFormatting&&(i.formatting="em"),u(i)}else if(" "===c&&(t.eat("*")||t.eat("_"))){if(" "===t.peek())return u(i);t.backUp(1)}return" "===c&&(t.match(/ +$/,!1)?i.trailingSpace++:i.trailingSpace&&(i.trailingSpaceNewLine=!0)),u(i)}function d(e,t){var i=e.next();if(">"===i){t.f=t.inline=h,n.highlightFormatting&&(t.formatting="link");var r=u(t);return r?r+=" ":r="",r+I}return e.match(/^[^>]+/,!0),I}function f(e,t){if(e.eatSpace())return null;var i=e.next();return"("===i||"["===i?(t.f=t.inline=p("("===i?")":"]"),n.highlightFormatting&&(t.formatting="link-string"),t.linkHref=!0,u(t)):"error"}function p(e){return function(t,i){var r=t.next();if(r===e){i.f=i.inline=h,n.highlightFormatting&&(i.formatting="link-string");var o=u(i);return i.linkHref=!1,o}return t.match(y(e),!0)&&t.backUp(1),i.linkHref=!0,u(i)}}function g(e,t){return e.match(/^[^\]]*\]:/,!1)?(t.f=m,e.next(),n.highlightFormatting&&(t.formatting="link"),t.linkText=!0,u(t)):i(e,t,h)}function m(e,t){if(e.match(/^\]:/,!0)){t.f=t.inline=v,n.highlightFormatting&&(t.formatting="link");var i=u(t);return t.linkText=!1,i}return e.match(/^[^\]]+/,!0),D}function v(e,t){return e.eatSpace()?null:(e.match(/^[^\s]+/,!0),void 0===e.peek()?t.linkTitle=!0:e.match(/^(?:\s+(?:"(?:[^"\\]|\\\\|\\.)+"|'(?:[^'\\]|\\\\|\\.)+'|\((?:[^)\\]|\\\\|\\.)+\)))?/,!0),t.f=t.inline=h,B)}function y(e){return K[e]||(e=(e+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1"),K[e]=new RegExp("^(?:[^\\\\]|\\\\.)*?("+e+")")),K[e]}var _=e.modes.hasOwnProperty("xml"),b=e.getMode(t,_?{name:"xml",htmlMode:!0}:"text/plain"),w={html:"htmlmixed",js:"javascript",json:"application/json",c:"text/x-csrc","c++":"text/x-c++src",java:"text/x-java",csharp:"text/x-csharp","c#":"text/x-csharp",scala:"text/x-scala"},x=function(){var n,i,r={},o={},a=[];for(var s in e.modes)e.modes.propertyIsEnumerable(s)&&a.push(s);for(n=0;n<a.length;n++)r[a[n]]=a[n];var l=[];for(var s in e.mimeModes)e.mimeModes.propertyIsEnumerable(s)&&l.push({mime:s,mode:e.mimeModes[s]});for(n=0;n<l.length;n++)i=l[n].mime,o[i]=l[n].mime;for(var u in w)(w[u]in r||w[u]in o)&&(r[u]=w[u]);return function(n){return r[n]?e.getMode(t,r[n]):null}}();void 0===n.highlightFormatting&&(n.highlightFormatting=!1),void 0===n.maxBlockquoteDepth&&(n.maxBlockquoteDepth=0),void 0===n.underscoresBreakWords&&(n.underscoresBreakWords=!0),void 0===n.fencedCodeBlocks&&(n.fencedCodeBlocks=!1),void 0===n.taskLists&&(n.taskLists=!1);var k=0,C="header",S="comment",T="quote",M="variable-2",L="variable-3",E="keyword",P="hr",N="tag",A="formatting",I="link",O="link",D="link",B="string",R="em",z="strong",W=/^([*\-=_])(?:\s*\1){2,}\s*$/,H=/^[*\-+]\s+/,U=/^[0-9]+\.\s+/,V=/^\[(x| )\](?=\s)/,j=/^#+/,F=/^(?:\={1,}|-{1,})$/,$=/^[^#!\[\]*_\\<>` "'(]+/,K=[],q={startState:function(){return{f:a,prevLineHasContent:!1,thisLineHasContent:!1,block:a,htmlState:null,indentation:0,inline:h,text:c,formatting:!1,linkText:!1,linkHref:!1,linkTitle:!1,em:!1,strong:!1,header:0,taskList:!1,list:!1,listDepth:0,quote:0,trailingSpace:0,trailingSpaceNewLine:!1}},copyState:function(t){return{f:t.f,prevLineHasContent:t.prevLineHasContent,thisLineHasContent:t.thisLineHasContent,block:t.block,htmlState:t.htmlState&&e.copyState(b,t.htmlState),indentation:t.indentation,localMode:t.localMode,localState:t.localMode?e.copyState(t.localMode,t.localState):null,inline:t.inline,text:t.text,formatting:!1,linkTitle:t.linkTitle,em:t.em,strong:t.strong,header:t.header,taskList:t.taskList,list:t.list,listDepth:t.listDepth,quote:t.quote,trailingSpace:t.trailingSpace,trailingSpaceNewLine:t.trailingSpaceNewLine,md_inside:t.md_inside}},token:function(e,t){if(t.formatting=!1,e.sol()){var n=!!t.header;if(t.header=0,e.match(/^\s*$/,!0)||n)return t.prevLineHasContent=!1,o(t),n?this.token(e,t):null;t.prevLineHasContent=t.thisLineHasContent,t.thisLineHasContent=!0,t.taskList=!1,t.code=!1,t.trailingSpace=0,t.trailingSpaceNewLine=!1,t.f=t.block;var i=e.match(/^\s*/,!0)[0].replace(/\t/g,"    ").length,r=4*Math.floor((i-t.indentation)/4);r>4&&(r=4);var a=t.indentation+r;if(t.indentationDiff=a-t.indentation,t.indentation=a,i>0)return null}var s=t.f(e,t);return e.start==e.pos?this.token(e,t):s},innerMode:function(e){return e.block==s?{state:e.htmlState,mode:b}:e.localState?{state:e.localState,mode:e.localMode}:{state:e,mode:q}},blankLine:o,getType:u,fold:"markdown"};return q},"xml"),e.defineMIME("text/x-markdown","markdown")}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";e.overlayMode=function(t,n,i){return{startState:function(){return{base:e.startState(t),overlay:e.startState(n),basePos:0,baseCur:null,overlayPos:0,overlayCur:null,lineSeen:null}},copyState:function(i){return{base:e.copyState(t,i.base),overlay:e.copyState(n,i.overlay),basePos:i.basePos,baseCur:null,overlayPos:i.overlayPos,overlayCur:null}},token:function(e,r){return(e.sol()||e.string!=r.lineSeen||Math.min(r.basePos,r.overlayPos)<e.start)&&(r.lineSeen=e.string,r.basePos=r.overlayPos=e.start),e.start==r.basePos&&(r.baseCur=t.token(e,r.base),r.basePos=e.pos),e.start==r.overlayPos&&(e.pos=e.start,r.overlayCur=n.token(e,r.overlay),r.overlayPos=e.pos),e.pos=Math.min(r.basePos,r.overlayPos),null==r.overlayCur?r.baseCur:null!=r.baseCur&&r.overlay.combineTokens||i&&null==r.overlay.combineTokens?r.baseCur+" "+r.overlayCur:r.overlayCur},indent:t.indent&&function(e,n){return t.indent(e.base,n)},electricChars:t.electricChars,innerMode:function(e){return{state:e.base,mode:t}},blankLine:function(e){t.blankLine&&t.blankLine(e.base),n.blankLine&&n.blankLine(e.overlay)}}}}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror"),require("../markdown/markdown"),require("../../addon/mode/overlay")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","../markdown/markdown","../../addon/mode/overlay"],e):e(CodeMirror)}(function(e){"use strict";e.defineMode("gfm",function(t,n){function i(e){return e.code=!1,null}var r=0,o={startState:function(){return{code:!1,codeBlock:!1,ateSpace:!1}},copyState:function(e){return{code:e.code,codeBlock:e.codeBlock,ateSpace:e.ateSpace}},token:function(e,t){if(t.combineTokens=null,t.codeBlock)return e.match(/^```/)?(t.codeBlock=!1,null):(e.skipToEnd(),null);if(e.sol()&&(t.code=!1),e.sol()&&e.match(/^```/))return e.skipToEnd(),t.codeBlock=!0,null;if("`"===e.peek()){e.next();var n=e.pos;e.eatWhile("`");var i=1+e.pos-n;return t.code?i===r&&(t.code=!1):(r=i,t.code=!0),null}if(t.code)return e.next(),null;if(e.eatSpace())return t.ateSpace=!0,null;if(e.sol()||t.ateSpace){if(t.ateSpace=!1,e.match(/^(?:[a-zA-Z0-9\-_]+\/)?(?:[a-zA-Z0-9\-_]+@)?(?:[a-f0-9]{7,40}\b)/))return t.combineTokens=!0,"link";if(e.match(/^(?:[a-zA-Z0-9\-_]+\/)?(?:[a-zA-Z0-9\-_]+)?#[0-9]+\b/))return t.combineTokens=!0,"link"}return e.match(/^((?:[a-z][\w-]+:(?:\/{1,3}|[a-z0-9%])|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}\/)(?:[^\s()<>]|\([^\s()<>]*\))+(?:\([^\s()<>]*\)|[^\s`*!()\[\]{};:'".,<>?«»“”‘’]))/i)&&"]("!=e.string.slice(e.start-2,e.start)?(t.combineTokens=!0,"link"):(e.next(),null)},blankLine:i},a={underscoresBreakWords:!1,taskLists:!0,fencedCodeBlocks:!0};for(var s in n)a[s]=n[s];return a.name="markdown",e.defineMIME("gfmBase",a),e.overlayMode(e.getMode(t,"gfmBase"),o)},"markdown")}),function(){function use(e){_p.r([moduleMapping[e]])}var _p={r:function(e){if(_p[e].inited)return _p[e].value;if("function"!=typeof _p[e].value)return _p[e].inited=!0,_p[e].value;var t={exports:{}},n=_p[e].value(null,t.exports,t);if(_p[e].inited=!0,_p[e].value=n,void 0!==n)return n;for(var i in t.exports)if(t.exports.hasOwnProperty(i))return _p[e].inited=!0,_p[e].value=t.exports,t.exports}};_p[0]={value:function(e){function t(e){var t=parseFloat(e,10);return/ms/.test(e)?t:/s/.test(e)?1e3*t:/min/.test(e)?60*t*1e3:t}var n=_p.r(8),i=_p.r(1),r=_p.r(11).createClass("Animator",{constructor:function(e,t,n){if(1==arguments.length){var i=arguments[0];this.beginValue=i.beginValue,this.finishValue=i.finishValue,this.setter=i.setter}else this.beginValue=e,this.finishValue=t,this.setter=n},start:function(e,n,i,r,o){2===arguments.length&&"object"==typeof n&&(i=n.easing,r=n.delay,o=n.callback,n=n.duration),4===arguments.length&&"function"==typeof r&&(o=r,r=0);var a=this.create(e,n,i,o);return r=t(r),r>0?setTimeout(function(){a.play()},r):a.play(),a},create:function(e,o,a,s){var l;return o=o&&t(o)||r.DEFAULT_DURATION,a=a||r.DEFAULT_EASING,"string"==typeof a&&(a=i[a]),l=new n(this,e,o,a),"function"==typeof s&&l.on("finish",s),l},reverse:function(){return new r(this.finishValue,this.beginValue,this.setter)}});r.DEFAULT_DURATION=300,r.DEFAULT_EASING="linear";var o=_p.r(60);return _p.r(11).extendClass(o,{animate:function(e,t,n,i,r){function o(){a.shift(),a.length&&setTimeout(a[0].t.play.bind(a[0].t),a[0].d)}var a=this._KityAnimateQueue=this._KityAnimateQueue||[],s=e.create(this,t,n,r);return s.on("finish",o),a.push({t:s,d:i}),1==a.length&&setTimeout(s.play.bind(s),i),this},timeline:function(){return this._KityAnimateQueue[0].t},stop:function(){var e=this._KityAnimateQueue;if(e)for(;e.length;)e.shift().t.stop();return this}}),r}},_p[1]={value:function(e,t,n){var i={linear:function(e,t,n,i){return n*(e/i)+t},swing:function(e,t,n,r){return i.easeOutQuad(e,t,n,r)},ease:function(e,t,n,r){return i.easeInOutCubic(e,t,n,r)},easeInQuad:function(e,t,n,i){return n*(e/=i)*e+t},easeOutQuad:function(e,t,n,i){return-n*(e/=i)*(e-2)+t},easeInOutQuad:function(e,t,n,i){return(e/=i/2)<1?n/2*e*e+t:-n/2*(--e*(e-2)-1)+t},easeInCubic:function(e,t,n,i){return n*(e/=i)*e*e+t},easeOutCubic:function(e,t,n,i){return n*((e=e/i-1)*e*e+1)+t},easeInOutCubic:function(e,t,n,i){return(e/=i/2)<1?n/2*e*e*e+t:n/2*((e-=2)*e*e+2)+t},easeInQuart:function(e,t,n,i){return n*(e/=i)*e*e*e+t},easeOutQuart:function(e,t,n,i){return-n*((e=e/i-1)*e*e*e-1)+t},easeInOutQuart:function(e,t,n,i){return(e/=i/2)<1?n/2*e*e*e*e+t:-n/2*((e-=2)*e*e*e-2)+t},easeInQuint:function(e,t,n,i){return n*(e/=i)*e*e*e*e+t},easeOutQuint:function(e,t,n,i){return n*((e=e/i-1)*e*e*e*e+1)+t},easeInOutQuint:function(e,t,n,i){return(e/=i/2)<1?n/2*e*e*e*e*e+t:n/2*((e-=2)*e*e*e*e+2)+t},easeInSine:function(e,t,n,i){return-n*Math.cos(e/i*(Math.PI/2))+n+t},easeOutSine:function(e,t,n,i){return n*Math.sin(e/i*(Math.PI/2))+t},easeInOutSine:function(e,t,n,i){return-n/2*(Math.cos(Math.PI*e/i)-1)+t},easeInExpo:function(e,t,n,i){return 0===e?t:n*Math.pow(2,10*(e/i-1))+t},easeOutExpo:function(e,t,n,i){return e==i?t+n:n*(-Math.pow(2,-10*e/i)+1)+t},easeInOutExpo:function(e,t,n,i){return 0===e?t:e==i?t+n:(e/=i/2)<1?n/2*Math.pow(2,10*(e-1))+t:n/2*(-Math.pow(2,-10*--e)+2)+t},easeInCirc:function(e,t,n,i){return-n*(Math.sqrt(1-(e/=i)*e)-1)+t},easeOutCirc:function(e,t,n,i){return n*Math.sqrt(1-(e=e/i-1)*e)+t},easeInOutCirc:function(e,t,n,i){return(e/=i/2)<1?-n/2*(Math.sqrt(1-e*e)-1)+t:n/2*(Math.sqrt(1-(e-=2)*e)+1)+t},easeInElastic:function(e,t,n,i){var r=1.70158,o=0,a=n;return 0===e?t:1==(e/=i)?t+n:(o||(o=.3*i),a<Math.abs(n)?(a=n,r=o/4):r=o/(2*Math.PI)*Math.asin(n/a),-(a*Math.pow(2,10*(e-=1))*Math.sin((e*i-r)*(2*Math.PI)/o))+t)},easeOutElastic:function(e,t,n,i){var r=1.70158,o=0,a=n;return 0===e?t:1==(e/=i)?t+n:(o||(o=.3*i),a<Math.abs(n)?(a=n,r=o/4):r=o/(2*Math.PI)*Math.asin(n/a),a*Math.pow(2,-10*e)*Math.sin((e*i-r)*(2*Math.PI)/o)+n+t)},easeInOutElastic:function(e,t,n,i){var r=1.70158,o=0,a=n;if(0===e)return t;if(2==(e/=i/2))return t+n;if(o||(o=i*(.3*1.5)),a<Math.abs(n)){a=n;var r=o/4}else var r=o/(2*Math.PI)*Math.asin(n/a);return 1>e?-.5*(a*Math.pow(2,10*(e-=1))*Math.sin((e*i-r)*(2*Math.PI)/o))+t:a*Math.pow(2,-10*(e-=1))*Math.sin((e*i-r)*(2*Math.PI)/o)*.5+n+t},easeInBack:function(e,t,n,i,r){return void 0==r&&(r=1.70158),n*(e/=i)*e*((r+1)*e-r)+t},easeOutBack:function(e,t,n,i,r){return void 0==r&&(r=1.70158),n*((e=e/i-1)*e*((r+1)*e+r)+1)+t},easeInOutBack:function(e,t,n,i,r){return void 0==r&&(r=1.70158),(e/=i/2)<1?n/2*(e*e*(((r*=1.525)+1)*e-r))+t:n/2*((e-=2)*e*(((r*=1.525)+1)*e+r)+2)+t},easeInBounce:function(e,t,n,r){return n-i.easeOutBounce(r-e,0,n,r)+t},easeOutBounce:function(e,t,n,i){return(e/=i)<1/2.75?n*(7.5625*e*e)+t:2/2.75>e?n*(7.5625*(e-=1.5/2.75)*e+.75)+t:2.5/2.75>e?n*(7.5625*(e-=2.25/2.75)*e+.9375)+t:n*(7.5625*(e-=2.625/2.75)*e+.984375)+t},easeInOutBounce:function(e,t,n,r){return r/2>e?.5*i.easeInBounce(2*e,0,n,r)+t:.5*i.easeOutBounce(2*e-r,0,n,r)+.5*n+t}};return i}},_p[2]={value:function(e,t){function n(e){1===h.push(e)&&(l=u(i))}function i(){var e=h;for(h=[];e.length;)s(e.pop());l=0}function r(e){var t=a(e);return n(t),t}function o(e){var t=h.indexOf(e);~t&&h.splice(t,1),0===h.length&&c(l)}function a(e){var t={index:0,time:+new Date,elapsed:0,action:e,next:function(){n(t)}};return t}function s(e){var t=+new Date,n=t-e.time;n>200&&(n=1e3/60),e.dur=n,e.elapsed+=n,e.time=t,e.action.call(null,e),e.index++}var l,u=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||function(e){return setTimeout(e,1e3/60)},c=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame||window.clearTimeout,h=[];t.requestFrame=r,t.releaseFrame=o}},_p[3]={value:function(e){var t=_p.r(0),n=_p.r(34),i=_p.r(46),r=_p.r(60),o=_p.r(11).createClass("MotionAnimator",{base:t,constructor:function(e,t){var r=this;this.callBase({beginValue:0,finishValue:1,setter:function(e,t){var o=r.motionPath instanceof i?r.motionPath.getPathData():r.motionPath,a=n.pointAtPath(o,t);e.setTranslate(a.x,a.y),this.doRotate&&e.setRotate(a.tan.getAngle())}}),this.doRotate=t,this.motionPath=e}});return _p.r(11).extendClass(r,{motion:function(e,t,n,i,r){return this.animate(new o(e),t,n,i,r)}}),o}},_p[4]={value:function(e){var t=_p.r(0),n=_p.r(11).createClass("OpacityAnimator",{base:t,constructor:function(e){this.callBase({beginValue:function(e){return e.getOpacity()},finishValue:e,setter:function(e,t){e.setOpacity(t)}})}}),i=_p.r(60);return _p.r(11).extendClass(i,{fxOpacity:function(e,t,i,r,o){return this.animate(new n(e),t,i,r,o)},fadeTo:function(){return this.fxOpacity.apply(this,arguments)},fadeIn:function(){return this.fxOpacity.apply(this,[1].concat([].slice.call(arguments)))},fadeOut:function(){return this.fxOpacity.apply(this,[0].concat([].slice.call(arguments)))}}),n}},_p[5]={value:function(e){var t=_p.r(0),n=_p.r(34),i=_p.r(11).createClass("OpacityAnimator",{base:t,constructor:function(e){this.callBase({beginValue:function(e){return this.beginPath=e.getPathData(),0},finishValue:1,setter:function(t,i){t.setPathData(n.pathTween(this.beginPath,e,i))}})}}),r=_p.r(46);return _p.r(11).extendClass(r,{fxPath:function(e,t,n,r,o){return this.animate(new i(e),t,n,r,o)}}),i}},_p[6]={value:function(e){var t=_p.r(0),n=_p.r(11).createClass("RotateAnimator",{base:t,constructor:function(e){this.callBase({beginValue:0,finishValue:e,setter:function(e,t,n){var i=n.getDelta();e.rotate(i,ax,ay)}})}}),i=_p.r(60);return _p.r(11).extendClass(i,{fxRotate:function(e,t,i,r,o){return this.animate(new n(e),t,i,r,o)}}),n}},_p[7]={value:function(e){var t=_p.r(0),n=_p.r(11).createClass("ScaleAnimator",{base:t,constructor:function(e,t){this.callBase({beginValue:0,finishValue:1,setter:function(n,i,r){var o=r.getDelta(),a=Math.pow(e,o),s=Math.pow(t,o);n.scale(s,a)}})}}),i=_p.r(60);return _p.r(11).extendClass(i,{fxScale:function(e,t,i,r,o,a){return this.animate(new n(e,t),i,r,o,a)}}),n}},_p[8]={value:function(e){function t(e,t,n){return o.paralle(e,t,function(e,t){return e+(t-e)*n})}function n(e,t){return o.paralle(e,t,function(e,t){return t-e})}function i(e,t,n){this.timeline=e,this.target=e.target,this.type=t;for(var i in n)n.hasOwnProperty(i)&&(this[i]=n[i])}var r=_p.r(33),o=_p.r(12),a=_p.r(2),s=_p.r(11).createClass("Timeline",{mixins:[r],constructor:function(e,t,n,i){this.callMixin(),this.target=t,this.time=0,this.duration=n,this.easing=i,this.animator=e,this.beginValue=e.beginValue,this.finishValue=e.finishValue,this.setter=e.setter,this.status="ready"},nextFrame:function(e){"playing"==this.status&&(this.time+=e.dur,this.setValue(this.getValue()),this.time>=this.duration&&this.timeUp(),e.next())},getPlayTime:function(){return this.rollbacking?this.duration-this.time:this.time},getTimeProportion:function(){return this.getPlayTime()/this.duration},getValueProportion:function(){return this.easing(this.getPlayTime(),0,1,this.duration)},getValue:function(){var e=this.beginValue,n=this.finishValue,i=this.getValueProportion();return t(e,n,i)},setValue:function(e){this.lastValue=this.currentValue,this.currentValue=e,this.setter.call(this.target,this.target,e,this)},getDelta:function(){return this.lastValue=void 0===this.lastValue?this.beginValue:this.lastValue,n(this.lastValue,this.currentValue)},play:function(){var e=this.status;switch(this.status="playing",e){case"ready":o.isFunction(this.beginValue)&&(this.beginValue=this.beginValue.call(this.target,this.target)),o.isFunction(this.finishValue)&&(this.finishValue=this.finishValue.call(this.target,this.target)),this.time=0,this.setValue(this.beginValue),this.frame=a.requestFrame(this.nextFrame.bind(this));break;case"finished":case"stoped":this.time=0,this.frame=a.requestFrame(this.nextFrame.bind(this));break;case"paused":this.frame.next()}return this.fire("play",new i(this,"play",{lastStatus:e})),this},pause:function(){return this.status="paused",this.fire("pause",new i(this,"pause")),a.releaseFrame(this.frame),this},stop:function(){return this.status="stoped",this.setValue(this.finishValue),this.rollbacking=!1,this.fire("stop",new i(this,"stop")),a.releaseFrame(this.frame),this},timeUp:function(){this.repeatOption?(this.time=0,this.rollback?this.rollbacking?(this.decreaseRepeat(),this.rollbacking=!1):(this.rollbacking=!0,this.fire("rollback",new i(this,"rollback"))):this.decreaseRepeat(),this.repeatOption?this.fire("repeat",new i(this,"repeat")):this.finish()):this.finish()},finish:function(){this.setValue(this.finishValue),this.status="finished",this.fire("finish",new i(this,"finish")),a.releaseFrame(this.frame)},decreaseRepeat:function(){this.repeatOption!==!0&&this.repeatOption--},repeat:function(e,t){return this.repeatOption=e,this.rollback=t,this}});return s.requestFrame=a.requestFrame,s.releaseFrame=a.releaseFrame,s}},_p[9]={value:function(e){var t=_p.r(0),n=_p.r(11).createClass("TranslateAnimator",{base:t,constructor:function(e,t){this.callBase({x:0,y:0},{x:e,y:t},function(e,t,n){var i=n.getDelta();e.translate(i.x,i.y)})}}),i=_p.r(60);return _p.r(11).extendClass(i,{fxTranslate:function(e,t,i,r,o,a){return this.animate(new n(e,t),i,r,o,a)}}),n}},_p[10]={value:function(){var e=function(){var e,t=navigator.userAgent.toLowerCase(),n=window.opera;e={ie:/(msie\s|trident.*rv:)([\w.]+)/.test(t),opera:!!n&&n.version,webkit:t.indexOf(" applewebkit/")>-1,mac:t.indexOf("macintosh")>-1},e.gecko="Gecko"==navigator.product&&!e.webkit&&!e.opera&&!e.ie;var i=0;if(e.ie&&(i=1*(t.match(/(msie\s|trident.*rv:)([\w.]+)/)[2]||0),e.ie11Compat=11==document.documentMode,e.ie9Compat=9==document.documentMode),e.gecko){var r=t.match(/rv:([\d\.]+)/);r&&(r=r[1].split("."),i=1e4*r[0]+100*(r[1]||0)+1*(r[2]||0))}return/chrome\/(\d+\.\d)/i.test(t)&&(e.chrome=+RegExp.$1),/(\d+\.\d)?(?:\.\d)?\s+safari\/?(\d+\.\d+)?/i.test(t)&&!/chrome/i.test(t)&&(e.safari=+(RegExp.$1||RegExp.$2)),e.opera&&(i=parseFloat(n.version())),e.webkit&&(i=parseFloat(t.match(/ applewebkit\/(\d+)/)[1])),e.version=i,e.isCompatible=!e.mobile&&(e.ie&&i>=6||e.gecko&&i>=10801||e.opera&&i>=9.5||e.air&&i>=1||e.webkit&&i>=522||!1),e}();return e}},_p[11]={value:function(require,exports){function Class(){}function checkBaseConstructorCall(e,t){var n=e.toString();if(!/this\.callBase/.test(n))throw new Error(t+" : 类构造函数没有调用父类的构造函数！为了安全，请调用父类的构造函数")}function inherit(constructor,BaseClass,classname){var KityClass=eval("(function "+classname+"( __inherit__flag ) {if( __inherit__flag != KITY_INHERIT_FLAG ) {KityClass.__KityConstructor.apply(this, arguments);}this.__KityClassName = KityClass.__KityClassName;})");KityClass.__KityConstructor=constructor,KityClass.prototype=new BaseClass(KITY_INHERIT_FLAG);for(var methodName in BaseClass.prototype)BaseClass.prototype.hasOwnProperty(methodName)&&0!==methodName.indexOf("__Kity")&&(KityClass.prototype[methodName]=BaseClass.prototype[methodName]);return KityClass.prototype.constructor=KityClass,KityClass}function mixin(e,t){if(!1==t instanceof Array)return e;var n,i,r,o=t.length;for(e.__KityMixins={constructor:[]},n=0;o>n;n++){i=t[n].prototype;for(r in i)!1!==i.hasOwnProperty(r)&&0!==r.indexOf("__Kity")&&("constructor"===r?e.__KityMixins.constructor.push(i[r]):e.prototype[r]=e.__KityMixins[r]=i[r])}return e}function extend(e,t){t.__KityClassName&&(t=t.prototype);for(var n in t)if(t.hasOwnProperty(n)&&n.indexOf("__Kity")&&"constructor"!=n){var i=e.prototype[n]=t[n];i.__KityMethodClass=e,i.__KityMethodName=n}return e}exports.Class=Class,Class.__KityClassName="Class",Class.prototype.base=function(e){var t=arguments.callee.caller,n=t.__KityMethodClass.__KityBaseClass.prototype[e];return n.apply(this,Array.prototype.slice.call(arguments,1))},Class.prototype.callBase=function(){var e=arguments.callee.caller,t=e.__KityMethodClass.__KityBaseClass.prototype[e.__KityMethodName];return t.apply(this,arguments)},Class.prototype.mixin=function(e){var t=arguments.callee.caller,n=t.__KityMethodClass.__KityMixins;if(!n)return this;var i=n[e];return i.apply(this,Array.prototype.slice.call(arguments,1))},Class.prototype.callMixin=function(){var e=arguments.callee.caller,t=e.__KityMethodName,n=e.__KityMethodClass.__KityMixins;if(!n)return this;var i=n[t];if("constructor"==t){for(var r=0,o=i.length;o>r;r++)i[r].call(this);return this}return i.apply(this,arguments)},Class.prototype.pipe=function(e){return"function"==typeof e&&e.call(this,this),this},Class.prototype.getType=function(){return this.__KityClassName},Class.prototype.getClass=function(){return this.constructor};var KITY_INHERIT_FLAG="__KITY_INHERIT_FLAG_"+ +new Date;exports.createClass=function(e,t){
var n,i,r;return 1===arguments.length&&(t=arguments[0],e="AnonymousClass"),r=t.base||Class,t.hasOwnProperty("constructor")?(n=t.constructor,r!=Class&&checkBaseConstructorCall(n,e)):n=function(){this.callBase.apply(this,arguments),this.callMixin.apply(this,arguments)},i=inherit(n,r,e),i=mixin(i,t.mixins),i.__KityClassName=n.__KityClassName=e,i.__KityBaseClass=n.__KityBaseClass=r,i.__KityMethodName=n.__KityMethodName="constructor",i.__KityMethodClass=n.__KityMethodClass=i,delete t.mixins,delete t.constructor,delete t.base,i=extend(i,t)},exports.extendClass=extend}},_p[12]={value:function(){var e={each:function(e,t,n){if(null!==e)if(e.length===+e.length){for(var i=0,r=e.length;r>i;i++)if(t.call(n,e[i],i,e)===!1)return!1}else for(var o in e)if(e.hasOwnProperty(o)&&t.call(n,e[o],o,e)===!1)return!1},extend:function(e){for(var t=arguments,n=this.isBoolean(t[t.length-1])?t[t.length-1]:!1,i=this.isBoolean(t[t.length-1])?t.length-1:t.length,r=1;i>r;r++){var o=t[r];for(var a in o)n&&e.hasOwnProperty(a)||(e[a]=o[a])}return e},deepExtend:function(e,t){for(var n=arguments,i=this.isBoolean(n[n.length-1])?n[n.length-1]:!1,r=this.isBoolean(n[n.length-1])?n.length-1:n.length,o=1;r>o;o++){var a=n[o];for(var s in a)i&&e.hasOwnProperty(s)||(this.isObject(e[s])&&this.isObject(a[s])?this.deepExtend(e[s],a[s],i):e[s]=a[s])}return e},clone:function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t},copy:function(e){return"object"!=typeof e?e:"function"==typeof e?null:JSON.parse(JSON.stringify(e))},queryPath:function(e,t){for(var n=e.split("."),i=0,r=t,o=n.length;o>i;){if(!(n[i]in r))return;if(r=r[n[i]],i++,i>=o||void 0===r)return r}},getValue:function(e,t){return void 0!==e?e:t},flatten:function(t){var n,i=[],r=t.length;for(n=0;r>n;n++)t[n]instanceof Array?i=i.concat(e.flatten(t[n])):i.push(t[n]);return i},paralle:function(t,n,i){var r,o,a,s;if(t instanceof Array){for(s=[],o=0;o<t.length;o++)s.push(e.paralle(t[o],n[o],i));return s}if(t instanceof Object){if(r=t.getClass&&t.getClass(),r&&r.parse)t=t.valueOf(),n=n.valueOf(),s=e.paralle(t,n,i),s=r.parse(s);else{s={};for(a in t)t.hasOwnProperty(a)&&n.hasOwnProperty(a)&&(s[a]=e.paralle(t[a],n[a],i))}return s}return!1===isNaN(parseFloat(t))?i(t,n):s},parallelize:function(t){return function(n,i){return e.paralle(n,i,t)}}};return e.each(["String","Function","Array","Number","RegExp","Object","Boolean"],function(t){e["is"+t]=function(e){return Object.prototype.toString.apply(e)=="[object "+t+"]"}}),e}},_p[13]={value:function(e,t,n){var i=_p.r(16),r=_p.r(12),o=_p.r(11).createClass("ColorMatrixEffect",{base:i,constructor:function(e,t){this.callBase(i.NAME_COLOR_MATRIX),this.set("type",r.getValue(e,o.TYPE_MATRIX)),this.set("in",r.getValue(t,i.INPUT_SOURCE_GRAPHIC))}});return r.extend(o,{TYPE_MATRIX:"matrix",TYPE_SATURATE:"saturate",TYPE_HUE_ROTATE:"hueRotate",TYPE_LUMINANCE_TO_ALPHA:"luminanceToAlpha",MATRIX_ORIGINAL:"10000010000010000010".split("").join(" "),MATRIX_EMPTY:"00000000000000000000".split("").join(" ")}),o}},_p[14]={value:function(e,t,n){var i=_p.r(16),r=_p.r(12),o=_p.r(11).createClass("CompositeEffect",{base:i,constructor:function(e,t,n){this.callBase(i.NAME_COMPOSITE),this.set("operator",r.getValue(e,o.OPERATOR_OVER)),t&&this.set("in",t),n&&this.set("in2",n)}});return r.extend(o,{OPERATOR_OVER:"over",OPERATOR_IN:"in",OPERATOR_OUT:"out",OPERATOR_ATOP:"atop",OPERATOR_XOR:"xor",OPERATOR_ARITHMETIC:"arithmetic"}),o}},_p[15]={value:function(e,t,n){var i=_p.r(16),r=_p.r(12),o=_p.r(11).createClass("ConvolveMatrixEffect",{base:i,constructor:function(e,t){this.callBase(i.NAME_CONVOLVE_MATRIX),this.set("edgeMode",r.getValue(e,o.MODE_DUPLICATE)),this.set("in",r.getValue(t,i.INPUT_SOURCE_GRAPHIC))}});return r.extend(o,{MODE_DUPLICATE:"duplicate",MODE_WRAP:"wrap",MODE_NONE:"none"}),o}},_p[16]={value:function(e,t,n){var i=_p.r(67),r=_p.r(11).createClass("Effect",{constructor:function(e){this.node=i.createNode(e)},getId:function(){return this.node.id},setId:function(e){return this.node.id=e,this},set:function(e,t){return this.node.setAttribute(e,t),this},get:function(e){return this.node.getAttribute(e)},getNode:function(){return this.node},toString:function(){return this.node.getAttribute("result")||""}});return _p.r(12).extend(r,{NAME_GAUSSIAN_BLUR:"feGaussianBlur",NAME_OFFSET:"feOffset",NAME_COMPOSITE:"feComposite",NAME_COLOR_MATRIX:"feColorMatrix",NAME_CONVOLVE_MATRIX:"feConvolveMatrix",INPUT_SOURCE_GRAPHIC:"SourceGraphic",INPUT_SOURCE_ALPHA:"SourceAlpha",INPUT_BACKGROUND_IMAGE:"BackgroundImage",INPUT_BACKGROUND_ALPHA:"BackgroundAlpha",INPUT_FILL_PAINT:"FillPaint",INPUT_STROKE_PAINT:"StrokePaint"}),r}},_p[17]={value:function(e,t,n){var i=_p.r(16),r=_p.r(12);return _p.r(11).createClass("GaussianblurEffect",{base:i,constructor:function(e,t){this.callBase(i.NAME_GAUSSIAN_BLUR),this.set("stdDeviation",r.getValue(e,1)),this.set("in",r.getValue(t,i.INPUT_SOURCE_GRAPHIC))}})}},_p[18]={value:function(e,t,n){var i=_p.r(16),r=_p.r(12);return _p.r(11).createClass("OffsetEffect",{base:i,constructor:function(e,t,n){this.callBase(i.NAME_OFFSET),this.set("dx",r.getValue(e,0)),this.set("dy",r.getValue(t,0)),this.set("in",r.getValue(n,i.INPUT_SOURCE_GRAPHIC))}})}},_p[19]={value:function(e){return _p.r(11).createClass("EffectContainer",{base:_p.r(29),addEffect:function(e,t){return this.addItem.apply(this,arguments)},prependEffect:function(){return this.prependItem.apply(this,arguments)},appendEffect:function(){return this.appendItem.apply(this,arguments)},removeEffect:function(e){return this.removeItem.apply(this,arguments)},addEffects:function(){return this.addItems.apply(this,arguments)},setEffects:function(){return this.setItems.apply(this,arguments)},getEffect:function(){return this.getItem.apply(this,arguments)},getEffects:function(){return this.getItems.apply(this,arguments)},getFirstEffect:function(){return this.getFirstItem.apply(this,arguments)},getLastEffect:function(){return this.getLastItem.apply(this,arguments)},handleAdd:function(e,t){var n=this.getEffects().length,i=this.getItem(t+1);return n===t+1?void this.node.appendChild(e.getNode()):void this.node.insertBefore(e.getNode(),i.getNode())}})}},_p[20]={value:function(e,t,n){var i=_p.r(67),r=_p.r(11),o=r.createClass("Filter",{mixins:[_p.r(19)],constructor:function(e,t,n,r){this.node=i.createNode("filter"),void 0!==e&&this.set("x",e),void 0!==t&&this.set("y",t),void 0!==n&&this.set("width",n),void 0!==r&&this.set("height",r)},getId:function(){return this.id},setId:function(e){return this.node.id=e,this},set:function(e,t){return this.node.setAttribute(e,t),this},get:function(e){return this.node.getAttribute(e)},getNode:function(){return this.node}}),a=_p.r(60);return r.extendClass(a,{applyFilter:function(e){var t=e.get("id");return t&&this.node.setAttribute("filter","url(#"+t+")"),this}}),o}},_p[21]={value:function(e,t,n){var i=_p.r(17);return _p.r(11).createClass("GaussianblurFilter",{base:_p.r(20),constructor:function(e){this.callBase(),this.addEffect(new i(e))}})}},_p[22]={value:function(e,t,n){var i=_p.r(17),r=_p.r(16),o=_p.r(13),a=_p.r(28),s=_p.r(12),l=_p.r(14),u=_p.r(18);return _p.r(11).createClass("ProjectionFilter",{base:_p.r(20),constructor:function(e,t,n){this.callBase(),this.gaussianblurEffect=new i(e,r.INPUT_SOURCE_ALPHA),this.gaussianblurEffect.set("result","gaussianblur"),this.addEffect(this.gaussianblurEffect),this.offsetEffect=new u(t,n,this.gaussianblurEffect),this.offsetEffect.set("result","offsetBlur"),this.addEffect(this.offsetEffect),this.colorMatrixEffect=new o(o.TYPE_MATRIX,this.offsetEffect),this.colorMatrixEffect.set("values",o.MATRIX_ORIGINAL),this.colorMatrixEffect.set("result","colorOffsetBlur"),this.addEffect(this.colorMatrixEffect),this.compositeEffect=new l(l.OPERATOR_OVER,r.INPUT_SOURCE_GRAPHIC,this.colorMatrixEffect),this.addEffect(this.compositeEffect)},setColor:function(e){var t=null,n=[];if(s.isString(e)&&(e=a.parse(e)),!e)return this;t=o.MATRIX_EMPTY.split(" "),n.push(e.get("r")),n.push(e.get("g")),n.push(e.get("b"));for(var i=0,r=n.length;r>i;i++)t[5*i+3]=n[i]/255;return t[18]=e.get("a"),this.colorMatrixEffect.set("values",t.join(" ")),this},setOpacity:function(e){var t=this.colorMatrixEffect.get("values").split(" ");return t[18]=e,this.colorMatrixEffect.set("values",t.join(" ")),this},setOffset:function(e,t){this.setOffsetX(e),this.setOffsetY(t)},setOffsetX:function(e){this.offsetEffect.set("dx",e)},setOffsetY:function(e){this.offsetEffect.set("dy",e)},setDeviation:function(e){this.gaussianblurEffect.set("stdDeviation",e)}})}},_p[23]={value:function(e,t,n){return _p.r(11).createClass("Bezier",{mixins:[_p.r(51)],base:_p.r(46),constructor:function(e){this.callBase(),e=e||[],this.changeable=!0,this.setBezierPoints(e)},getBezierPoints:function(){return this.getPoints()},setBezierPoints:function(e){return this.setPoints(e)},onContainerChanged:function(){this.changeable&&this.update()},update:function(){var e=null,t=this.getBezierPoints();if(!(t.length<2)){e=this.getDrawer(),e.clear();var n=t[0].getVertex(),i=null,r=null;e.moveTo(n.x,n.y);for(var o=1,a=t.length;a>o;o++)n=t[o].getVertex(),r=t[o].getBackward(),i=t[o-1].getForward(),e.bezierTo(i.x,i.y,r.x,r.y,n.x,n.y);return this}}})}},_p[24]={value:function(e,t,n){var i=_p.r(63),r=_p.r(73),o=_p.r(11).createClass("BezierPoint",{constructor:function(e,t,n){this.vertex=new i(e,t),this.forward=new i(e,t),this.backward=new i(e,t),this.setSmooth(void 0===n||n),this.setSymReflaction(!0)},clone:function(){var e=new o,t=null;return t=this.getVertex(),e.setVertex(t.x,t.y),t=this.getForward(),e.setForward(t.x,t.y),t=this.getBackward(),e.setBackward(t.x,t.y),e.setSymReflaction(this.isSymReflaction),e.setSmooth(this.isSmooth()),e},setVertex:function(e,t){return this.vertex.setPoint(e,t),this.update(),this},moveTo:function(e,t){var n=this.forward.getPoint(),i=this.backward.getPoint(),r=this.vertex.getPoint(),o={left:e-r.x,top:t-r.y};this.forward.setPoint(n.x+o.left,n.y+o.top),this.backward.setPoint(i.x+o.left,i.y+o.top),this.vertex.setPoint(e,t),this.update()},setForward:function(e,t){return this.forward.setPoint(e,t),this.smooth&&this.updateAnother(this.forward,this.backward),this.update(),this.lastControlPointSet=this.forward,this},setBackward:function(e,t){return this.backward.setPoint(e,t),this.smooth&&this.updateAnother(this.backward,this.forward),this.update(),this.lastControlPointSet=this.backward,this},setSymReflaction:function(e){return this.symReflaction=e,this.smooth&&this.setSmooth(!0),this},isSymReflaction:function(){return this.symReflaction},updateAnother:function(e,t){var n=this.getVertex(),i=r.fromPoints(e.getPoint(),n),o=r.fromPoints(n,t.getPoint());return o=i.normalize(this.isSymReflaction()?i.length():o.length()),t.setPoint(n.x+o.x,n.y+o.y),this},setSmooth:function(e){var t;return this.smooth=!!e,this.smooth&&(t=this.lastControlPointSet)&&this.updateAnother(t,t==this.forward?this.backward:this.forward),this},isSmooth:function(){return this.smooth},getVertex:function(){return this.vertex.getPoint()},getForward:function(){return this.forward.getPoint()},getBackward:function(){return this.backward.getPoint()},update:function(){return this.container?void(this.container.update&&this.container.update(this)):this}});return o}},_p[25]={value:function(e,t,n){var i=_p.r(11).createClass("Box",{constructor:function(e,t,n,i){var r=arguments[0];r&&"object"==typeof r&&(e=r.x,t=r.y,n=r.width,i=r.height),0>n&&(e-=n=-n),0>i&&(t-=i=-i),this.x=e||0,this.y=t||0,this.width=n||0,this.height=i||0,this.left=this.x,this.right=this.x+this.width,this.top=this.y,this.bottom=this.y+this.height,this.cx=this.x+this.width/2,this.cy=this.y+this.height/2},getRangeX:function(){return[this.left,this.right]},getRangeY:function(){return[this.top,this.bottom]},merge:function(e){if(this.isEmpty())return new i(e.x,e.y,e.width,e.height);var t=Math.min(this.left,e.left),n=Math.max(this.right,e.right),r=Math.min(this.top,e.top),o=Math.max(this.bottom,e.bottom);return new i(t,r,n-t,o-r)},intersect:function(e){!e instanceof i&&(e=new i(e));var t=Math.max(this.left,e.left),n=Math.min(this.right,e.right),r=Math.max(this.top,e.top),o=Math.min(this.bottom,e.bottom);return t>n||r>o?new i:new i(t,r,n-t,o-r)},expand:function(e,t,n,r){if(arguments.length<1)return new i(this);arguments.length<2&&(t=e),arguments.length<3&&(n=e),arguments.length<4&&(r=t);var o=this.left-r,a=this.top-e,s=this.width+t,l=this.height+e;return new i(o,a,s,l)},valueOf:function(){return[this.x,this.y,this.width,this.height]},toString:function(){return this.valueOf().join(" ")},isEmpty:function(){return!this.width||!this.height}});return i.parse=function(e){return"string"==typeof e?i.parse(e.split(/[\s,]+/).map(parseFloat)):e instanceof Array?new i(e[0],e[1],e[2],e[3]):"x"in e?new i(e):null},i}},_p[26]={value:function(e,t,n){return _p.r(11).createClass("Circle",{base:_p.r(32),constructor:function(e,t,n){this.callBase(e,e,t,n)},getRadius:function(){return this.getRadiusX()},setRadius:function(e){return this.callBase(e,e)}})}},_p[27]={value:function(e,t,n){var i=_p.r(11),r=_p.r(60),o=i.createClass("Clip",{base:r,mixins:[_p.r(61)],constructor:function(e){this.callBase("clipPath",e)},clip:function(e){return e.getNode().setAttribute("clip-path",this),this}});return i.extendClass(r,{clipWith:function(e){return e instanceof r&&(e=new o(e.getPaper()).addShape(e)),e.clip(this),this}}),o}},_p[28]={value:function(e,t,n){var i=_p.r(12),r=_p.r(64),o={},a=_p.r(11).createClass("Color",{constructor:function(){var e=null;"string"==typeof arguments[0]?(e=o.parseToValue(arguments[0]),null===e&&(e={r:0,g:0,b:0,h:0,s:0,l:0,a:1})):(e={r:0|arguments[0],g:0|arguments[1],b:0|arguments[2],a:void 0===arguments[3]?1:parseFloat(arguments[3])},e=o.overflowFormat(e),e=i.extend(e,o.rgbValueToHslValue(e))),this._color=e},set:function(e,t){if(!a._MAX_VALUE[e])throw new Error("Color set(): Illegal parameter");return"a"!==e&&(t=Math.floor(t)),"h"==e&&(t=(t+360)%360),this._color[e]=Math.max(a._MIN_VALUE[e],Math.min(a._MAX_VALUE[e],t)),-1!=="rgb".indexOf(e)?this._color=i.extend(this._color,o.rgbValueToHslValue(this._color)):-1!=="hsl".indexOf(e)&&(this._color=i.extend(this._color,o.hslValueToRGBValue(this._color))),this},inc:function(e,t){return t=this.get(e)+t,"h"==e?t=(t+360)%360:(t=Math.min(a._MAX_VALUE[e],t),t=Math.max(a._MIN_VALUE[e],t)),this.clone().set(e,t)},dec:function(e,t){return this.inc(e,-t)},clone:function(){return new a(this.toRGBA())},get:function(e){return a._MAX_VALUE[e]?this._color[e]:null},getValues:function(){return i.clone(this._color)},valueOf:function(){return this.getValues()},toRGB:function(){return o.toString(this._color,"rgb")},toRGBA:function(){return o.toString(this._color,"rgba")},toHEX:function(){return o.toString(this._color,"hex")},toHSL:function(){return o.toString(this._color,"hsl")},toHSLA:function(){return o.toString(this._color,"hsla")},toString:function(){return 1===this._color.a?this.toRGB():this.toRGBA()}});return i.extend(a,{_MAX_VALUE:{r:255,g:255,b:255,h:360,s:100,l:100,a:1},_MIN_VALUE:{r:0,g:0,b:0,h:0,s:0,l:0,a:0},R:"r",G:"g",B:"b",H:"h",S:"s",L:"l",A:"a",parse:function(e){var t;return i.isString(e)&&(t=o.parseToValue(e)),i.isObject(e)&&"r"in e&&(t=e),null===t?new a:new a(t.r,t.g,t.b,t.a)},createHSL:function(e,t,n){return a.createHSLA(e,t,n,1)},createHSLA:function(e,t,n,i){var r=null;return t+="%",n+="%",r=["hsla("+e,t,n,i+")"],a.parse(r.join(", "))},createRGB:function(e,t,n){return a.createRGBA(e,t,n,1)},createRGBA:function(e,t,n,i){return new a(e,t,n,i)}}),i.extend(o,{parseToValue:function(e){var t={};if(e=r.EXTEND_STANDARD[e]||r.COLOR_STANDARD[e]||e,/^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(e))t=o.hexToValue(e);else if(/^(rgba?)/i.test(e))t=o.rgbaToValue(e);else{if(!/^(hsla?)/i.test(e))return null;t=o.hslaToValue(e)}return o.overflowFormat(t)},hexToValue:function(e){var t={},n=["r","g","b"];return/^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(e)?(e=RegExp.$1.split(""),i.each(n,function(n,i){3===e.length?t[n]=o.toNumber(e[i]+e[i]):t[n]=o.toNumber(e[2*i]+e[2*i+1])}),t=i.extend(t,o.rgbValueToHslValue(t)),t.a=1,t):null},rgbaToValue:function(e){var t={},n=!1,r=["r","g","b"];return/^(rgba?)/i.test(e)?(n=4===RegExp.$1.length,e=e.replace(/^rgba?/i,"").replace(/\s+/g,"").replace(/[^0-9,.]/g,"").split(","),i.each(r,function(n,i){t[n]=0|e[i]}),t=i.extend(t,o.rgbValueToHslValue(t)),t.a=n?parseFloat(e[3]):1,t):null},hslaToValue:function(e){var t={},n=!1;return/^(hsla?)/i.test(e)?(n=4===RegExp.$1.length,e=e.replace(/^hsla?/i,"").replace(/\s+/g,"").replace(/[^0-9,.]/g,"").split(","),t.h=0|e[0],t.s=0|e[1],t.l=0|e[2],t=i.extend(t,o.hslValueToRGBValue(t)),t=o.hslValueToRGBValue(t),t.a=n?parseFloat(e[3]):1,t):null},hslValueToRGBValue:function(e){function t(e,t,n){return 0>n?n+=1:n>1&&(n-=1),1>6*n?e+6*(t-e)*n:1>2*n?t:2>3*n?e+(t-e)*(6*(2/3-n)):e}var n=null,r=null,o={};return e=i.extend({},e),e.h=e.h/360,e.s=e.s/100,e.l=e.l/100,0===e.s?o.r=o.g=o.b=e.l:(n=e.l<.5?e.l*(1+e.s):e.l+e.s-e.l*e.s,r=2*e.l-n,o.r=t(r,n,e.h+1/3),o.g=t(r,n,e.h),o.b=t(r,n,e.h-1/3)),o.r=Math.min(Math.round(255*o.r),255),o.g=Math.min(Math.round(255*o.g),255),o.b=Math.min(Math.round(255*o.b),255),o},rgbValueToHslValue:function(e){var t=null,n=null,r={};return e=i.extend({},e),e.r=e.r/255,e.g=e.g/255,e.b=e.b/255,t=Math.max(e.r,e.g,e.b),n=Math.min(e.r,e.g,e.b),t===n?r.h=0:t===e.r?e.g>=e.b?r.h=60*(e.g-e.b)/(t-n):r.h=60*(e.g-e.b)/(t-n)+360:t===e.g?r.h=60*(e.b-e.r)/(t-n)+120:t===e.b&&(r.h=60*(e.r-e.g)/(t-n)+240),r.l=(t+n)/2,0===r.l||t===n?r.s=0:r.l>0&&r.l<=.5?r.s=(t-n)/(t+n):r.s=(t-n)/(2-t-n),r.h=Math.round(r.h),r.s=Math.round(100*r.s),r.l=Math.round(100*r.l),r},toString:function(e,t){var n=[];return e=i.extend({},e),-1!==t.indexOf("hsl")&&(e.s+="%",e.l+="%"),"hex"!==t?(i.each(t.split(""),function(t){n.push(e[t])}),(t+"("+n.join(", ")+")").toLowerCase()):(n.push(o.toHexValue(+e.r)),n.push(o.toHexValue(+e.g)),n.push(o.toHexValue(+e.b)),("#"+n.join("")).toLowerCase())},toNumber:function(e){return 0|Number("0x"+e)},toHexValue:function(e){var t=e.toString(16);return 1===t.length?"0"+t:t},overflowFormat:function(e){var t=i.extend({},e),n="rgba";return i.each(n.split(""),function(e){t.hasOwnProperty(e)&&(t[e]=Math.min(a._MAX_VALUE[e],t[e]),t[e]=Math.max(a._MIN_VALUE[e],t[e]))}),t}}),a}},_p[29]={value:function(e,t,n){function i(){return this.container.removeItem(this),this}return _p.r(11).createClass("Container",{getItems:function(){return this.items||(this.items=[])},getItem:function(e){return this.getItems()[e]},getFirstItem:function(){return this.getItem(0)},getLastItem:function(){return this.getItem(this.getItems().length-1)},indexOf:function(e){return this.getItems().indexOf(e)},eachItem:function(e){var t,n=this.getItems(),i=n.length;for(t=0;i>t;t++)e.call(this,t,n[t]);return this},addItem:function(e,t,n){var r=this.getItems(),o=r.length;return~r.indexOf(e)?this:(t>=0&&o>t||(t=o),r.splice(t,0,e),"object"==typeof e&&(e.container=this,e.remove=i),this.handleAdd(e,t),n||this.onContainerChanged("add",[e]),this)},addItems:function(e){for(var t=0,n=e.length;n>t;t++)this.addItem(e[t],-1,!0);return this.onContainerChanged("add",e),this},setItems:function(e){return this.clear().addItems(e)},appendItem:function(e){return this.addItem(e)},prependItem:function(e){return this.addItem(e,0)},removeItem:function(e,t){if("number"!=typeof e)return this.removeItem(this.indexOf(e));var n=this.getItems(),i=(n.length,n[e]);return void 0===i?this:(n.splice(e,1),i.container&&delete i.container,i.remove&&delete i.remove,this.handleRemove(i,e),t||this.onContainerChanged("remove",[i]),this)},clear:function(){for(var e,t=[];e=this.getFirstItem();)t.push(e),this.removeItem(0,!0);return this.onContainerChanged("remove",t),this},onContainerChanged:function(e,t){},handleAdd:function(e,t){},handleRemove:function(e,t){}})}},_p[30]={value:function(e,t,n){var i=_p.r(12),r={getCurvePanLines:function(e,t){var n=r.getCenterPoints(e),i=r.getPanLine(e.length,n);return r.getMovedPanLines(e,i,t)},getCenterPoints:function(e){for(var t={},n=null,i=0,r=0,o=e.length;o>i;i++)r=i===o-1?0:i+1,n=i+","+r,t[n]={x:(e[i].x+e[r].y)/2,y:(e[i].x+e[r].y)/2};return t},getPanLine:function(e,t){for(var n,i={},r=null,o=0;e>o;o++){var a=null,s=null;n=(o+1)%e,r=n,a=t[o+","+n],o=n,n=(o+1)%e,s=t[o+","+n],i[r]={points:[{x:a.x,y:a.y},{x:s.x,y:s.y}],center:{x:(a.x+s.x)/2,y:(a.y+s.y)/2}},o=(r+e-1)%e}return i},getMovedPanLines:function(e,t,n){var r={};return i.each(e,function(e,o){var a=t[o],s=a.center,l={x:s.x-e.x,y:s.y-e.y},u=r[o]={points:[],center:{x:e.x,y:e.y}};i.each(a.points,function(e,t){var i={x:e.x-l.x,y:e.y-l.y},r=u.center,o=i.x-r.x,a=i.y-r.y;i.x=r.x+n*o,i.y=r.y+n*a,u.points.push(i)})}),r}};return _p.r(11).createClass("Curve",{base:_p.r(46),mixins:[_p.r(51)],constructor:function(e,t){this.callBase(),this.setPoints(e||[]),this.closeState=!!t,this.changeable=!0,this.smoothFactor=1,this.update()},onContainerChanged:function(){this.changeable&&this.update()},setSmoothFactor:function(e){return this.smoothFactor=0>e?0:e,this.update(),this},getSmoothFactor:function(){return this.smoothFactor},update:function(){var e=this.getPoints(),t=null,n=this.getDrawer(),i=null,o=null,a=null;if(n.clear(),0===e.length)return this;if(n.moveTo(e[0]),1===e.length)return this;if(2===e.length)return n.lineTo(e[1]),this;t=r.getCurvePanLines(e,this.getSmoothFactor());for(var s=1,l=e.length;l>s;s++)i=t[s].center,o=this.closeState||s!=l-1?t[s].points[0]:t[s].center,a=this.closeState||1!=s?t[s-1].points[1]:t[s-1].center,n.bezierTo(a.x,a.y,o.x,o.y,i.x,i.y);return this.closeState&&(i=t[0].center,o=t[0].points[0],a=t[e.length-1].points[1],n.bezierTo(a.x,a.y,o.x,o.y,i.x,i.y)),this},close:function(){return this.closeState=!0,this.update()},open:function(){return this.closeState=!1,this.update()},isClose:function(){return!!this.closeState}})}},_p[31]={value:function(e,t,n){return _p.r(11).createClass("Data",{constructor:function(){this._data={}},setData:function(e,t){return this._data[e]=t,this},getData:function(e){return this._data[e]},removeData:function(e){return delete this._data[e],this}})}},_p[32]={value:function(e,t,n){var i=(_p.r(12),_p.r(50));return _p.r(11).createClass("Ellipse",{base:_p.r(46),constructor:function(e,t,n,i){this.callBase(),this.rx=e||0,this.ry=t||0,this.cx=n||0,this.cy=i||0,this.update()},update:function(){var e=this.rx,t=this.ry,n=this.cx+e,i=this.cx-e,r=this.cy,o=this.getDrawer();return o.clear(),o.moveTo(n,r),o.arcTo(e,t,0,1,1,i,r),o.arcTo(e,t,0,1,1,n,r),this},getRadius:function(){return{x:this.rx,y:this.ry}},getRadiusX:function(){return this.rx},getRadiusY:function(){return this.ry},getCenter:function(){return new i(this.cx,this.cy)},getCenterX:function(){return this.cx},getCenterY:function(){return this.cy},setRadius:function(e,t){return this.rx=e,this.ry=t,this.update()},setRadiusX:function(e){return this.rx=e,this.update()},setRadiusY:function(e){return this.ry=e,this.update()},setCenter:function(e,t){if(1==arguments.length){var n=i.parse(arguments[0]);e=n.x,t=n.y}return this.cx=e,this.cy=t,this.update()},setCenterX:function(e){return this.cx=e,this.update()},setCenterY:function(e){return this.cy=e,this.update()}})}},_p[33]={value:function(e,t,n){function i(e,t,n){return n=!!n,u.isString(e)&&(e=e.match(/\S+/g)),u.each(e,function(e){o.call(this,this.node,e,t,n)},this),this}function r(e,t){var n=null,i=this._EVNET_UID,r=void 0===t;return n=d[i][e],r||(r=!0,u.each(n,function(e,i){e===t?delete n[i]:r=!1})),r&&(s(this.node,e,h[i][e]),delete d[i][e],delete h[i][e]),this}function o(e,t,n,i){var r=this._EVNET_UID,o=this;h[r]||(h[r]={}),h[r][t]||(h[r][t]=function(e){e=new c(e||window.event),u.each(d[r][t],function(n){var r;return n&&(r=n.call(o,e),i&&o.off(t,n)),r},o)}),d[r]||(d[r]={}),d[r][t]?d[r][t].push(n):(d[r][t]=[n],e&&"on"+t in e&&a(e,t,h[r][t]))}function a(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent("on"+t,n)}function s(e,t,n){e.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent(t,n)}function l(e,t,n){var i=null,r=null,o=h[e._EVNET_UID];o&&(r=o[t],r&&(i=u.extend({type:t,target:e},n||{}),r.call(e,i)))}!function(){function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n}e.prototype=window.Event.prototype,window.CustomEvent=e}();var u=_p.r(12),c=_p.r(62),h={},d={},f=0;return _p.r(11).createClass("EventHandler",{constructor:function(){this._EVNET_UID=++f},addEventListener:function(e,t){return i.call(this,e,t,!1)},addOnceEventListener:function(e,t){return i.call(this,e,t,!0)},removeEventListener:function(e,t){return r.call(this,e,t)},on:function(e,t){return this.addEventListener.apply(this,arguments)},once:function(e,t){return this.addOnceEventListener.apply(this,arguments)},off:function(){return this.removeEventListener.apply(this,arguments)},fire:function(e,t){return this.trigger.apply(this,arguments)},trigger:function(e,t){return l(this,e,t),this}})}},_p[34]={value:function(e){function t(e){var t,n,i,r,o;for(t=[],n=0;n<e.length;n++)for(r=e[n],t.push(o=[]),i=0;i<r.length;i++)o.push(r[i]);return e.isUniform&&(t.isUniform=!0),e.isAbsolute&&(t.isAbsolute=!0),e.isCurve&&(t.isCurve=!0),t}function n(e,t,n){function i(e,t){for(var n=0,i=e.length;i>n;n++)if(e[n]===t)return e.push(e.splice(n,1)[0])}function r(){var o=Array.prototype.slice.call(arguments,0),a=o.join("␀"),s=r.cache=r.cache||{},l=r.count=r.count||[];return s.hasOwnProperty(a)?(i(l,a),n?n(s[a]):s[a]):(l.length>=1e3&&delete s[l.shift()],l.push(a),s[a]=e.apply(t,o),n?n(s[a]):s[a])}return r}function i(e,t,n,r,o,a,s,l,u,c){var h,d,f,p,g,m,v,y,_,b,w,x,k,C,S,T,M,L,E,P,N,A,I,O,D,B,R,z,W,H,U,V=Math,j=V.PI,F=Math.abs,$=120*j/180,K=j/180*(+o||0),q=[],G=function(e,t,n){var i=e*V.cos(n)-t*V.sin(n),r=e*V.sin(n)+t*V.cos(n);return{x:i,y:r}};if(c?(x=c[0],k=c[1],b=c[2],w=c[3]):(h=G(e,t,-K),e=h.x,t=h.y,h=G(l,u,-K),l=h.x,u=h.y,d=V.cos(j/180*o),f=V.sin(j/180*o),g=(e-l)/2,m=(t-u)/2,p=g*g/(n*n)+m*m/(r*r),p>1&&(p=V.sqrt(p),n=p*n,r=p*r),v=n*n,y=r*r,_=(a==s?-1:1)*V.sqrt(F((v*y-v*m*m-y*g*g)/(v*m*m+y*g*g))),b=_*n*m/r+(e+l)/2,w=_*-r*g/n+(t+u)/2,x=V.asin(((t-w)/r).toFixed(9)),k=V.asin(((u-w)/r).toFixed(9)),x=b>e?j-x:x,k=b>l?j-k:k,0>x&&(x=2*j+x),0>k&&(k=2*j+k),s&&x>k&&(x-=2*j),!s&&k>x&&(k-=2*j)),C=k-x,F(C)>$&&(S=k,T=l,M=u,k=x+$*(s&&k>x?1:-1),l=b+n*V.cos(k),u=w+r*V.sin(k),q=i(l,u,n,r,o,0,s,T,M,[k,S,b,w])),C=k-x,L=V.cos(x),E=V.sin(x),P=V.cos(k),N=V.sin(k),A=V.tan(C/4),I=4/3*n*A,O=4/3*r*A,D=[e,t],B=[e+I*E,t-O*L],R=[l+I*N,u-O*P],z=[l,u],B[0]=2*D[0]-B[0],B[1]=2*D[1]-B[1],c)return[B,R,z].concat(q);for(q=[B,R,z].concat(q).join().split(","),W=[],H=0,U=q.length;U>H;H++)W[H]=H%2?G(q[H-1],q[H],K).y:G(q[H],q[H+1],K).x;return W}function r(e,t,n,i,r,o){var a=1/3,s=2/3;return[a*e+s*n,a*t+s*i,a*r+s*n,a*o+s*i,r,o]}function o(e,t){function n(e){return function(t,n){return t+e*(n-t)}}var i=n(t||.5),r=e,o=r[0],a=r[1],s=r[2],l=r[3],u=r[4],c=r[5],h=r[6],d=r[7],f=i(o,s),p=i(a,l),g=i(s,u),m=i(l,c),v=i(u,h),y=i(c,d),_=i(f,g),b=i(p,m),w=i(g,v),x=i(m,y),k=i(_,w),C=i(b,x);return[[o,a,f,p,_,b,k,C],[k,C,w,x,v,y,h,d]]}var a=_p.r(12),s=_p.r(50),l=_p.r(73),u=_p.r(43),c={},h=/([achlmrqstvz])[\s,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\s]*,?\s*)+)/gi,d=/(-?\d*\.?\d*(?:e[\-+]?\d+)?)\s*,?\s*/gi,f={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0};c.pathToString=function(e){return e=e||this,"string"==typeof e?e:e instanceof Array?(e=a.flatten(e),e.join(",").replace(/,?([achlmqrstvxz]),?/gi,"$1")):void 0},c.parsePathString=n(function(e){var t=[];return e.replace(h,function(e,n,i){var r=[],o=n.toLowerCase();if(i.replace(d,function(e,t){t&&r.push(+t)}),"m"==o&&r.length>2&&(t.push([n].concat(r.splice(0,2))),o="l",n="m"==n?"l":"L"),"r"==o)t.push([n].concat(r));else for(;r.length>=f[o]&&(t.push([n].concat(r.splice(0,f[o]))),f[o]););}),t.isUniform=!0,t.toString=c.pathToString,t}),c.pathToAbsolute=n(function(e){var t,n,i,r,o,a,s,l,u=e.isUniform?e:c.parsePathString(c.pathToString(e)),h=[],d=0,f=0,p=0,g=0,m=0;for("M"==u[0][0]&&(d=+u[0][1],f=+u[0][2],p=d,g=f,m++,h[0]=["M",d,f]),i=m,a=u.length;a>i;i++){if(h.push(t=[]),n=u[i],n[0]!=n[0].toUpperCase())switch(t[0]=n[0].toUpperCase(),t[0]){case"A":t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=+(n[6]+d),t[7]=+(n[7]+f);break;case"V":t[1]=+n[1]+f;break;case"H":t[1]=+n[1]+d;break;case"M":p=+n[1]+d,g=+n[2]+f;break;default:for(r=1,s=n.length;s>r;r++)t[r]=+n[r]+(r%2?d:f)}else for(o=0,l=n.length;l>o;o++)t[o]=n[o];switch(t[0]){case"Z":d=p,f=g;break;case"H":d=t[1];break;case"V":f=t[1];break;case"M":p=t[t.length-2],g=t[t.length-1];break;default:d=t[t.length-2],f=t[t.length-1]}}return h.isUniform=!0,h.isAbsolute=!0,h.toString=c.pathToString,h}),c.pathToCurve=n(function(e){var t,n,o,a,s,l,u,h,d,f,p,g,m=[];for(e.isAbsolute||(e=c.pathToAbsolute(e)),t=0;t<e.length;t++)if(o=e[t][0],a=e[t].slice(1),"M"!=o){switch("Z"==o&&(h=!0,o="L",a=s),u=a.slice(a.length-2),"H"==o&&(u=[a[0],l[1]],o="L"),"V"==o&&(u=[l[0],a[0]],o="L"),("S"==o||"T"==o)&&(f=[l[0]+(l[0]-d[0]),l[1]+(l[1]-d[1])]),o){case"L":p=l,g=u;break;case"C":p=a.slice(0,2),g=a.slice(2,4);break;case"S":p=f.slice(),g=a.slice(0,2);break;case"Q":d=a.slice(0,2),a=r.apply(null,l.concat(a)),p=a.slice(0,2),g=a.slice(2,4);break;case"T":a=r.apply(null,l.concat(f).concat(a)),p=a.slice(0,2),g=a.slice(2,4);break;case"A":for(a=i.apply(null,l.concat(a)),n=0;n in a;)p=a.slice(n,n+2),g=a.slice(n+2,n+4),u=a.slice(n+4,n+6),m.push(["C"].concat(p).concat(g).concat(u)),n+=6}"A"!=o&&m.push(["C"].concat(p).concat(g).concat(u)),l=u,"Q"!=o&&(d=g),h&&(m.push(["Z"]),h=!1)}else s=d=l=a,m.push(e[t]);return m.isUniform=!0,m.isAbsolute=!0,m.isCurve=!0,m.toString=c.pathToString,m}),c.cutBezier=n(o),c.subBezier=function(e,t,n){var i=o(e,t)[0];return n?o(i,n/t)[1]:i},c.pointAtBezier=function(e,t){var n=o(e,t)[0],i=s.parse(n.slice(6)),r=s.parse(n.slice(4,2)),a=l.fromPoints(r,i);return 0===t?i.tan=c.pointAtBezier(e,.01).tan:i.tan=a.normalize(),i},c.bezierLength=n(function(e){function t(e){var t=l*Math.pow(e,4)+u*Math.pow(e,3)+c*Math.pow(e,2)+h*e+d;return 0>t&&(t=0),Math.pow(t,.5)}var n,i,r,o,a,s,l,u,c,h,d,f=e;return n=-3*f[0]+9*f[2]-9*f[4]+3*f[6],i=6*f[0]-12*f[2]+6*f[4],r=-3*f[0]+3*f[2],o=-3*f[1]+9*f[3]-9*f[5]+3*f[7],a=6*f[1]-12*f[3]+6*f[5],s=-3*f[1]+3*f[3],l=Math.pow(n,2)+Math.pow(o,2),u=2*(n*i+o*a),c=2*(n*r+o*s)+Math.pow(i,2)+Math.pow(a,2),h=2*(i*r+a*s),d=Math.pow(r,2)+Math.pow(s,2),(t(0)+t(1)+4*(t(.125)+t(.375)+t(.625)+t(.875))+2*(t(.25)+t(.5)+t(.75)))/24});var p=n(function(e){var t,n,i,r,o,a,s;for(a=[],s=0,t=0,n=e.length;n>t;t++)i=e[t],"M"!=i[0]?"Z"!=i[0]?(o=c.bezierLength(r.concat(i.slice(1))),a.push([s,s+o]),s+=o,r=i.slice(4)):a.push(null):(r=i.slice(1),a.push(null));return a.totalLength=s,a});c.subPath=function(e,t,n){var i;if(n=n||0,i=t-n,i-=0|i,n-=0|n,t=n+i,t>1)return c.subPath(e,1,n).concat(c.subPath(e,t-1));e.isCurve||(e=c.pathToCurve(e));var r,o,a,s,l,u,h,d,f,g=p(e),m=g.totalLength,v=m*t,y=m*(n||0),_=[];for(r=0,o=e.length;o>r;r++)if("M"!=e[r][0]){if("Z"!=e[r][0])if(a=g[r][0],s=g[r][1],l=s-a,h=u.concat(e[r].slice(1)),y>s)u=h.slice(h.length-2);else{if(y>=a)d=c.subBezier(h,Math.min((v-a)/l,1),(y-a)/l),f=!0,u=d.slice(0,2),_.push(["M"].concat(d.slice(0,2))),_.push(["C"].concat(d.slice(2)));else if(v>=s)_.push(e[r].slice());else{if(!(v>=a))break;d=c.subBezier(h,(v-a)/l),_.push(["C"].concat(d.slice(2))),f=!1}u=h.slice(h.length-2)}}else u=e[r].slice(1),f&&_.push(e[r].slice());return _.isAbsolute=!0,_.isCurve=!0,_.isUniform=!0,_.toString=c.pathToString,_},c.pointAtPath=function(e,t){e.isCurve||(e=c.pathToCurve(e));var n=c.subPath(e,t),i="Z"==n[n.length-1][0]?n[n.length-2]:n[n.length-1];i=i.slice(1);var r=s.parse(i.slice(4)),o=s.parse(i.slice(2,4));return r.tan=l.fromPoints(o,r).normalize(),r},c.pathLength=n(function(e){e.isCurve||(e=c.pathToCurve(e));var t=p(e);return t.totalLength}),c.pathKeyPoints=n(function(e){var t,n,i;for(e.isCurve||(e=c.pathToCurve(e)),i=[],t=0,n=e.length;n>t;t++)"z"!=e[t][0]&&i.push(e[t].slice(e[t].length-2));return i});var g=n(function(e,n){function i(e,t){return e[t||e.i]&&e[t||e.i][0]}function r(e,t){return e[t||e.i]&&e[t||e.i].slice(1)}function o(e,t){var n=r(e,t);return n&&n.slice(-2)}function a(e){return"Z"==i(e)?(e.splice(e.i,1),!0):!1}function s(e){
return"M"==i(e)?(e.o.splice(e.o.i,0,["M"].concat(o(e.o,e.o.i-1))),e.i++,e.o.i++,!0):!1}function l(e){for(var t,n=1;!t;)t=o(e,e.length-n++);for(e.o.i=e.i;e.length<e.o.length;)a(e.o)||s(e.o)||(e.push(["C"].concat(t).concat(t).concat(t)),e.i++,e.o.i++)}e.isCurve||(e=c.pathToCurve(e)),n.isCurve||(n=c.pathToCurve(n));var u=t(e),h=t(n);for(u.i=0,h.i=0,u.o=h,h.o=u;u.i<u.length&&h.i<h.length;)a(u)||a(h)||(i(u)!=i(h)?s(u)||s(h)||(u.i++,h.i++):(u.i++,h.i++));return u.i==u.length&&l(u),h.i==h.length&&l(h),delete u.i,delete u.o,delete h.i,delete h.o,[u,h]});return c.alignCurve=g,c.pathTween=function(e,t,n){if(0===n)return e;if(1===n)return t;var i,r,o,a=g(e,t),s=[];for(e=a[0],t=a[1],r=0;r<e.length;r++)for(s.push(i=[]),i.push(e[r][0]),o=1;o<e[r].length;o++)i.push(e[r][o]+n*(t[r][o]-e[r][o]));return s.isUniform=s.isCurve=s.isAbsolute=!0,s},c.transformPath=n(function(e,t){var n,i,r,o,a,l;for(e.isCurve||(e=c.pathToCurve(e)),o=[],n=0,i=e.length;i>n;n++)for(o.push(a=[e[n][0]]),r=1;r<e[n].length;r+=2)l=e[n].slice(r,r+2),l=t.transformPoint(s.parse(l)),o.push(l);return o}),_p.r(11).extendClass(u,{transformPath:function(e){return c.transformPath(e,this)}}),c}},_p[35]={value:function(e,t,n){var i=_p.r(67),r=_p.r(58),o=_p.r(28);return _p.r(11).createClass("GradientBrush",{base:r,constructor:function(e,t){this.callBase(e,t),this.stops=[]},addStop:function(e,t,n){var r=i.createNode("stop");return t instanceof o||(t=o.parse(t)),void 0===n&&(n=t.get("a")),r.setAttribute("offset",e),r.setAttribute("stop-color",t.toRGB()),1>n&&r.setAttribute("stop-opacity",n),this.node.appendChild(r),this}})}},_p[36]={value:function(e,t,n){var i=_p.r(61);return _p.r(11).createClass("Group",{mixins:[i],base:_p.r(60),constructor:function(){this.callBase("g")}})}},_p[37]={value:function(e,t,n){var i=_p.r(61);return _p.r(11).createClass("HyperLink",{mixins:[i],base:_p.r(60),constructor:function(e){this.callBase("a"),this.setHref(e)},setHref:function(e){return this.node.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",e),this},getHref:function(){return this.node.getAttributeNS("xlink:href")},setTarget:function(e){return this.node.setAttribute("target",e),this},getTarget:function(){return this.node.getAttribute("target")}})}},_p[38]={value:function(e,t,n){return _p.r(11).createClass("Image",{base:_p.r(60),constructor:function(e,t,n,i,r){this.callBase("image"),this.url=e,this.width=t||0,this.height=n||0,this.x=i||0,this.y=r||0,this.update()},update:function(){return this.node.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",this.url),this.node.setAttribute("x",this.x),this.node.setAttribute("y",this.y),this.node.setAttribute("width",this.width),this.node.setAttribute("height",this.height),this},setUrl:function(e){return this.url=""===e?null:e,this.update()},getUrl:function(){return this.url},setWidth:function(e){return this.width=e,this.update()},getWidth:function(){return this.width},setHeight:function(e){return this.height=e,this.update()},getHeight:function(){return this.height},setX:function(e){return this.x=e,this.update()},getX:function(){return this.x},setY:function(e){return this.y=e,this.update()},getY:function(){return this.y}})}},_p[39]={value:function(e,t,n){return _p.r(11).createClass("Line",{base:_p.r(46),constructor:function(e,t,n,i){this.callBase(),this.point1={x:e||0,y:t||0},this.point2={x:n||0,y:i||0},this.update()},setPoint1:function(e,t){return this.point1.x=e,this.point1.y=t,this.update()},setPoint2:function(e,t){return this.point2.x=e,this.point2.y=t,this.update()},getPoint1:function(){return{x:this.point1.x,y:this.point1.y}},getPoint2:function(){return{x:this.point2.x,y:this.point2.y}},update:function(){var e=this.getDrawer();return e.clear(),e.moveTo(this.point1.x,this.point1.y),e.lineTo(this.point2.x,this.point2.y),this}})}},_p[40]={value:function(e,t,n){var i=(_p.r(67),_p.r(35));return _p.r(11).createClass("LinearGradientBrush",{base:i,constructor:function(e){this.callBase("linearGradient",e),this.setStartPosition(0,0),this.setEndPosition(1,0)},setStartPosition:function(e,t){return this.node.setAttribute("x1",e),this.node.setAttribute("y1",t),this},setEndPosition:function(e,t){return this.node.setAttribute("x2",e),this.node.setAttribute("y2",t),this},getStartPosition:function(){return{x:+this.node.getAttribute("x1"),y:+this.node.getAttribute("y1")}},getEndPosition:function(){return{x:+this.node.getAttribute("x2"),y:+this.node.getAttribute("y2")}}})}},_p[41]={value:function(e,t,n){var i=_p.r(50),r=_p.r(11).createClass("Marker",{base:_p.r(58),mixins:[_p.r(61),_p.r(75)],constructor:function(){this.callBase("marker"),this.setOrient("auto")},setRef:function(e,t){return 1===arguments.length&&(t=e.y,e=e.x),this.node.setAttribute("refX",e),this.node.setAttribute("refY",t),this},getRef:function(){return new i(+this.node.getAttribute("refX"),+this.node.getAttribute("refY"))},setWidth:function(e){return this.node.setAttribute("markerWidth",this.width=e),this},setOrient:function(e){return this.node.setAttribute("orient",this.orient=e),this},getOrient:function(){return this.orient},getWidth:function(){return+this.width},setHeight:function(e){return this.node.setAttribute("markerHeight",this.height=e),this},getHeight:function(){return+this.height}}),o=_p.r(46);return _p.r(11).extendClass(o,{setMarker:function(e,t){return t=t||"end",e?this.node.setAttribute("marker-"+t,e.toString()):this.node.removeAttribute("marker-"+t),this}}),r}},_p[42]={value:function(e,t,n){var i=_p.r(11),r=_p.r(60),o=i.createClass("Mask",{base:r,mixins:[_p.r(61)],constructor:function(){this.callBase("mask")},mask:function(e){return e.getNode().setAttribute("mask","url(#"+this.getId()+")"),this}});return i.extendClass(r,{maskWith:function(e){return e.mask(this),this}}),o}},_p[43]={value:function(e,t,n){function i(e,t){return{a:t.a*e.a+t.c*e.b,b:t.b*e.a+t.d*e.b,c:t.a*e.c+t.c*e.d,d:t.b*e.c+t.d*e.d,e:t.a*e.e+t.c*e.f+t.e,f:t.b*e.e+t.d*e.f+t.f}}function r(e){return e*Math.PI/180}var o=_p.r(12),a=_p.r(25),s=/matrix\s*\((.+)\)/i,l=_p.r(50),u=_p.r(11).createClass("Matrix",{constructor:function(){arguments.length?this.setMatrix.apply(this,arguments):this.setMatrix(1,0,0,1,0,0)},translate:function(e,t){return this.m=i(this.m,{a:1,c:0,e:e,b:0,d:1,f:t}),this},rotate:function(e){var t=r(e),n=Math.sin(t),o=Math.cos(t);return this.m=i(this.m,{a:o,c:-n,e:0,b:n,d:o,f:0}),this},scale:function(e,t){return void 0===t&&(t=e),this.m=i(this.m,{a:e,c:0,e:0,b:0,d:t,f:0}),this},skew:function(e,t){void 0===t&&(t=e);var n=Math.tan(r(e)),o=Math.tan(r(t));return this.m=i(this.m,{a:1,c:n,e:0,b:o,d:1,f:0}),this},inverse:function(){var e,t,n,i,r,o,a,s=this.m,l=s.a,c=s.b,h=s.c,d=s.d,f=s.e,p=s.f;return e=l*d-c*h,t=d/e,n=-c/e,i=-h/e,r=l/e,o=(h*p-f*d)/e,a=(c*f-l*p)/e,new u(t,n,i,r,o,a)},setMatrix:function(e,t,n,i,r,a){return 1===arguments.length?this.m=o.clone(arguments[0]):this.m={a:e,b:t,c:n,d:i,e:r,f:a},this},getMatrix:function(){return o.clone(this.m)},getTranslate:function(){var e=this.m;return{x:e.e/e.a,y:e.f/e.d}},mergeMatrix:function(e){return new u(i(this.m,e.m))},merge:function(e){return this.mergeMatrix(e)},toString:function(){return this.valueOf().join(" ")},valueOf:function(){var e=this.m;return[e.a,e.b,e.c,e.d,e.e,e.f]},equals:function(e){var t=this.m,n=e.m;return t.a==n.a&&t.b==n.b&&t.c==n.c&&t.d==n.d&&t.e==n.e&&t.f==n.f},transformPoint:function(){return u.transformPoint.apply(null,[].slice.call(arguments).concat([this.m]))},transformBox:function(e){return u.transformBox(e,this.m)},clone:function(){return new u(this.m)}});return u.parse=function(e){var t,n=parseFloat;if(e instanceof Array)return new u({a:e[0],b:e[1],c:e[2],d:e[3],e:e[4],f:e[5]});if(t=s.exec(e)){var i=t[1].split(",");return 6!=i.length&&(i=t[1].split(" ")),new u({a:n(i[0]),b:n(i[1]),c:n(i[2]),d:n(i[3]),e:n(i[4]),f:n(i[5])})}return new u},u.transformPoint=function(e,t,n){return 2===arguments.length&&(n=t,t=e.y,e=e.x),new l(n.a*e+n.c*t+n.e,n.b*e+n.d*t+n.f)},u.transformBox=function(e,t){for(var n,i,r=Number.MAX_VALUE,s=-Number.MAX_VALUE,l=Number.MAX_VALUE,c=-Number.MAX_VALUE,h=[[e.x,e.y],[e.x+e.width,e.y],[e.x,e.y+e.height],[e.x+e.width,e.y+e.height]],d=[];n=h.pop();)i=u.transformPoint(n[0],n[1],t),d.push(i),r=Math.min(r,i.x),s=Math.max(s,i.x),l=Math.min(l,i.y),c=Math.max(c,i.y);return e=new a({x:r,y:l,width:s-r,height:c-l}),o.extend(e,{closurePoints:d}),e},u.getCTM=function(e,t){function n(e,t){var n;try{n=t.getScreenCTM().inverse()}catch(i){throw new Error("Can not inverse source element' ctm.")}return n.multiply(e.getScreenCTM())}var i={a:1,b:0,c:0,d:1,e:0,f:0},r=e.shapeNode||e.node;switch(t=t||"parent"){case"screen":i=r.getScreenCTM();break;case"doc":case"paper":i=r.getCTM();break;case"view":case"top":e.getPaper()&&(i=void 0!==r.getTransformToElement?r.getTransformToElement(e.getPaper().shapeNode):n(r,e.getPaper().shapeNode));break;case"parent":e.node.parentNode&&(i=void 0!==r.getTransformToElement?r.getTransformToElement(e.node.parentNode):n(r,e.node.parentNode));break;default:t.node&&(i=void 0!==r.getTransformToElement?r.getTransformToElement(t.shapeNode||t.node):n(r,t.shapeNode||t.node))}return i?new u(i.a,i.b,i.c,i.d,i.e,i.f):new u},u}},_p[44]={value:function(e,t,n){var i=_p.r(64),r=_p.r(28),o=_p.r(12),a=_p.r(11).createClass("Palette",{constructor:function(){this.color={}},get:function(e){var t=this.color[e]||i.EXTEND_STANDARD[e]||i.COLOR_STANDARD[e]||"";return t?new r(t):null},getColorValue:function(e){return this.color[e]||i.EXTEND_STANDARD[e]||i.COLOR_STANDARD[e]||""},add:function(e,t){return"string"==typeof t?this.color[e]=new r(t).toRGBA():this.color[e]=t.toRGBA(),t},remove:function(e){return this.color.hasOwnProperty(e)?(delete this.color[e],!0):!1}});return o.extend(a,{getColor:function(e){var t=i.EXTEND_STANDARD[e]||i.COLOR_STANDARD[e];return t?new r(t):null},getColorValue:function(e){return i.EXTEND_STANDARD[e]||i.COLOR_STANDARD[e]||""},addColor:function(e,t){return"string"==typeof t?i.EXTEND_STANDARD[e]=new r(t).toRGBA():i.EXTEND_STANDARD[e]=t.toRGBA(),t},removeColor:function(e){return i.EXTEND_STANDARD.hasOwnProperty(e)?(delete i.EXTEND_STANDARD[e],!0):!1}}),a}},_p[45]={value:function(e,t,n){var i=_p.r(11),r=_p.r(12),o=_p.r(67),a=_p.r(29),s=_p.r(61),l=_p.r(75),u=_p.r(33),c=_p.r(66),h=_p.r(43),d=i.createClass("Paper",{mixins:[s,u,c,l],constructor:function(e){this.callBase(),this.node=this.createSVGNode(),this.node.paper=this,this.node.appendChild(this.resourceNode=o.createNode("defs")),this.node.appendChild(this.shapeNode=o.createNode("g")),this.resources=new a,this.setWidth("100%").setHeight("100%"),e&&this.renderTo(e),this.callMixin()},renderTo:function(e){r.isString(e)&&(e=document.getElementById(e)),this.container=e,e.appendChild(this.node)},createSVGNode:function(){var e=o.createNode("svg");return e.setAttribute("xmlns","http://www.w3.org/2000/svg"),e.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink"),e.setAttribute("version","1.1"),e},getNode:function(){return this.node},getContainer:function(){return this.container},getWidth:function(){return this.node.clientWidth},setWidth:function(e){return this.node.setAttribute("width",e),this},getHeight:function(){return this.node.clientHeight},setHeight:function(e){return this.node.setAttribute("height",e),this},setViewPort:function(e,t,n){var i,r;1==arguments.length&&(i=arguments[0],e=i.center.x,t=i.center.y,n=i.zoom),n=n||1,r=this.getViewBox();var o=new h,a=r.x+r.width/2-e,s=r.y+r.height/2-t;return o.translate(-e,-t),o.scale(n),o.translate(e,t),o.translate(a,s),this.shapeNode.setAttribute("transform","matrix("+o+")"),this.viewport={center:{x:e,y:t},offset:{x:a,y:s},zoom:n},this},getViewPort:function(){if(!this.viewport){var e=this.getViewBox();return{zoom:1,center:{x:e.x+e.width/2,y:e.y+e.height/2},offset:{x:0,y:0}}}return this.viewport},getViewPortMatrix:function(){return h.parse(this.shapeNode.getAttribute("transform"))},getViewPortTransform:function(){var e=this.shapeNode.getCTM();return new h(e.a,e.b,e.c,e.d,e.e,e.f)},getTransform:function(){return this.getViewPortTransform().reverse()},addResource:function(e){return this.resources.appendItem(e),e.node&&this.resourceNode.appendChild(e.node),this},removeResource:function(e){return e.remove&&e.remove(),e.node&&this.resourceNode.removeChild(e.node),this},getPaper:function(){return this}}),f=_p.r(60);return i.extendClass(f,{getPaper:function(){for(var e=this.container;e&&e instanceof d==!1;)e=e.container;return e},isAttached:function(){return!!this.getPaper()},whenPaperReady:function(e){function t(){var t=n.getPaper();return t&&e&&e.call(n,t),t}var n=this;return t()||this.on("add treeadd",function i(){t()&&(n.off("add",i),n.off("treeadd",i))}),this}}),d}},_p[46]={value:function(e,t,n){var i=_p.r(12),r=_p.r(11).createClass,o=_p.r(60),a=_p.r(67),s=_p.r(34),l=Array.prototype.slice,u=(i.flatten,r("PathDrawer",{constructor:function(e){this.segment=[],this.path=e,this.__clear=!1},getPath:function(){return this.path},redraw:function(){return this._transation=this._transation||[],this.clear()},done:function(){var e=this._transation;return this._transation=null,this.push(e),this},clear:function(){return this._transation?this._transation=[]:this.path.setPathData("M 0 0"),this._clear=!0,this},push:function(){var e,t=l.call(arguments);return this._transation?(this._transation.push(t),this):(this._clear?(e="",this._clear=!1):e=this.path.getPathData(),e=e||"",this.path.setPathData(e+s.pathToString(t)),this)},moveTo:function(e,t){return this.push("M",l.call(arguments))},moveBy:function(e,t){return this.push("m",l.call(arguments))},lineTo:function(e,t){return this.push("L",l.call(arguments))},lineBy:function(e,t){return this.push("l",l.call(arguments))},arcTo:function(e,t,n,i,r,o,a){return this.push("A",l.call(arguments))},arcBy:function(e,t,n,i,r,o,a){return this.push("a",arguments)},carcTo:function(e,t,n,i,r){return this.push("A",[e,e,0].concat(l.call(arguments,1)))},carcBy:function(e,t,n,i,r){return this.push("a",[e,e,0].concat(l.call(arguments,1)))},bezierTo:function(e,t,n,i,r,o){return this.push("C",l.call(arguments))},bezierBy:function(e,t,n,i,r,o){return this.push("c",l.call(arguments))},close:function(){return this.push("z")}}));return r("Path",{base:o,constructor:function(e){this.callBase("path"),e&&this.setPathData(e),this.node.setAttribute("fill",a.defaults.fill),this.node.setAttribute("stroke",a.defaults.stroke)},setPathData:function(e){return e=e||"M0,0",this.pathdata=s.pathToString(e),this.node.setAttribute("d",this.pathdata),this.trigger("shapeupdate",{type:"pathdata"}),this},getPathData:function(){return this.pathdata||""},getDrawer:function(){return new u(this)},isClosed:function(){var e=this.getPathData();return!!~e.indexOf("z")||!!~e.indexOf("Z")}})}},_p[47]={value:function(e,t,n){var i=_p.r(58),r=_p.r(61);_p.r(67);return _p.r(11).createClass("PatternBrush",{base:i,mixins:[r],constructor:function(e){this.callBase("pattern",e),this.node.setAttribute("patternUnits","userSpaceOnUse")},setX:function(e){return this.x=e,this.node.setAttribute("x",e),this},setY:function(e){return this.y=e,this.node.setAttribute("y",e),this},setWidth:function(e){return this.width=e,this.node.setAttribute("width",e),this},setHeight:function(e){return this.height=e,this.node.setAttribute("height",e),this},getWidth:function(){return this.width},getHeight:function(){return this.height}})}},_p[48]={value:function(e,t,n){var i=_p.r(28);return _p.r(11).createClass("Pen",{constructor:function(e,t){this.brush=e,this.width=t||1,this.linecap=null,this.linejoin=null,this.dashArray=null,this.opacity=1},getBrush:function(){return this.brush},setBrush:function(e){return this.brush=e,this},setColor:function(e){return this.setBrush(e)},getColor:function(){return this.brush instanceof i?this.brush:null},getWidth:function(){return this.width},setWidth:function(e){return this.width=e,this},getOpacity:function(){return this.opacity},setOpacity:function(e){this.opacity=e},getLineCap:function(){return this.linecap},setLineCap:function(e){return this.linecap=e,this},getLineJoin:function(){return this.linejoin},setLineJoin:function(e){return this.linejoin=e,this},getDashArray:function(){return this.dashArray},setDashArray:function(e){return this.dashArray=e,this},stroke:function(e){var t=e.node;t.setAttribute("stroke",this.brush.toString()),t.setAttribute("stroke-width",this.getWidth()),this.getOpacity()<1&&t.setAttribute("stroke-opacity",this.getOpacity()),this.getLineCap()&&t.setAttribute("stroke-linecap",this.getLineCap()),this.getLineJoin()&&t.setAttribute("stroke-linejoin",this.getLineJoin()),this.getDashArray()&&t.setAttribute("stroke-dasharray",this.getDashArray())}})}},_p[49]={value:function(e,t,n){return _p.r(11).createClass({base:_p.r(68),constructor:function(e,t,n){this.callBase([0,e],t,n)},getRadius:function(){return this.getSectionArray()[1]},setRadius:function(e){this.setSectionArray([0,e])}})}},_p[50]={value:function(e,t,n){var i=_p.r(11).createClass("Point",{constructor:function(e,t){this.x=e||0,this.y=t||0},offset:function(e,t){return 1==arguments.length&&(t=e.y,e=e.x),new i(this.x+e,this.y+t)},valueOf:function(){return[this.x,this.y]},toString:function(){return this.valueOf().join(" ")},spof:function(){return new i((0|this.x)+.5,(0|this.y)+.5)},round:function(){return new i(0|this.x,0|this.y)},isOrigin:function(){return 0===this.x&&0===this.y}});return i.fromPolar=function(e,t,n){return"rad"!=n&&(t=t/180*Math.PI),new i(e*Math.cos(t),e*Math.sin(t))},i.parse=function(e){return e?e instanceof i?e:"string"==typeof e?i.parse(e.split(/\s*[\s,]\s*/)):"0"in e&&"1"in e?new i(e[0],e[1]):void 0:new i},i}},_p[51]={value:function(e,t,n){return _p.r(11).createClass("PointContainer",{base:_p.r(29),constructor:function(){this.callBase()},addPoint:function(e,t){return this.addItem.apply(this,arguments)},prependPoint:function(){return this.prependItem.apply(this,arguments)},appendPoint:function(){return this.appendItem.apply(this,arguments)},removePoint:function(e){return this.removeItem.apply(this,arguments)},addPoints:function(){return this.addItems.apply(this,arguments)},setPoints:function(){return this.setItems.apply(this,arguments)},getPoint:function(){return this.getItem.apply(this,arguments)},getPoints:function(){return this.getItems.apply(this,arguments)},getFirstPoint:function(){return this.getFirstItem.apply(this,arguments)},getLastPoint:function(){return this.getLastItem.apply(this,arguments)}})}},_p[52]={value:function(e,t,n){_p.r(12);return _p.r(11).createClass("Poly",{base:_p.r(46),mixins:[_p.r(51)],constructor:function(e,t){this.callBase(),this.closeable=!!t,this.setPoints(e||[]),this.changeable=!0,this.update()},onContainerChanged:function(){this.changeable&&this.update()},update:function(){var e=this.getDrawer(),t=this.getPoints();if(e.clear(),!t.length)return this;e.moveTo(t[0]);for(var n,i=1,r=t.length;r>i;i++)n=t[i],e.lineTo(n);return this.closeable&&t.length>2&&e.close(),this}})}},_p[53]={value:function(e,t,n){return _p.r(11).createClass("Polygon",{base:_p.r(52),constructor:function(e){this.callBase(e,!0)}})}},_p[54]={value:function(e,t,n){return _p.r(11).createClass("Polyline",{base:_p.r(52),constructor:function(e){this.callBase(e)}})}},_p[55]={value:function(e,t,n){var i=_p.r(35);return _p.r(11).createClass("RadialGradientBrush",{base:i,constructor:function(e){this.callBase("radialGradient",e),this.setCenter(.5,.5),this.setFocal(.5,.5),this.setRadius(.5)},setCenter:function(e,t){return this.node.setAttribute("cx",e),this.node.setAttribute("cy",t),this},getCenter:function(){return{x:+this.node.getAttribute("cx"),y:+this.node.getAttribute("cy")}},setFocal:function(e,t){return this.node.setAttribute("fx",e),this.node.setAttribute("fy",t),this},getFocal:function(){return{x:+this.node.getAttribute("fx"),y:+this.node.getAttribute("fy")}},setRadius:function(e){return this.node.setAttribute("r",e),this},getRadius:function(){return+this.node.getAttribute("r")}})}},_p[56]={value:function(e,t,n){var i={},r=_p.r(12),o=_p.r(50),a=_p.r(25);r.extend(i,{formatRadius:function(e,t,n){var i=Math.floor(Math.min(e/2,t/2));return Math.min(i,n)}});var s=_p.r(11).createClass("Rect",{base:_p.r(46),constructor:function(e,t,n,r,o){this.callBase(),this.x=n||0,this.y=r||0,this.width=e||0,this.height=t||0,this.radius=i.formatRadius(this.width,this.height,o||0),this.update()},update:function(){var e=this.x,t=this.y,n=this.width,i=this.height,r=this.radius,o=this.getDrawer().redraw();return r?(n-=2*r,i-=2*r,o.push("M",e+r,t),o.push("h",n),o.push("a",r,r,0,0,1,r,r),o.push("v",i),o.push("a",r,r,0,0,1,-r,r),o.push("h",-n),o.push("a",r,r,0,0,1,-r,-r),o.push("v",-i),o.push("a",r,r,0,0,1,r,-r),o.push("z")):(o.push("M",e,t),o.push("h",n),o.push("v",i),o.push("h",-n),o.push("z")),o.done(),this},setWidth:function(e){return this.width=e,this.update()},setHeight:function(e){return this.height=e,this.update()},setSize:function(e,t){return this.width=e,this.height=t,this.update()},setBox:function(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this.update()},getBox:function(){return new a(this.x,this.y,this.width,this.height)},getRadius:function(){return this.radius},setRadius:function(e){return this.radius=i.formatRadius(this.width,this.height,e||0),this.update()},getPosition:function(){return new o(this.x,this.y)},setPosition:function(e,t){if(1==arguments.length){var n=o.parse(arguments[0]);t=n.y,e=n.x}return this.x=e,this.y=t,this.update()},getWidth:function(){return this.width},getHeight:function(){return this.height},getPositionX:function(){return this.x},getPositionY:function(){return this.y},setPositionX:function(e){return this.x=e,this.update()},setPositionY:function(e){return this.y=e,this.update()}});return s}},_p[57]={value:function(e,t,n){var i=_p.r(50);return _p.r(11).createClass("RegularPolygon",{base:_p.r(46),constructor:function(e,t,n,r){this.callBase(),this.radius=t||0,this.side=Math.max(e||3,3),arguments.length>2&&3==arguments.length&&(r=n.y,n=n.x),this.center=new i(n,r),this.draw()},getSide:function(){return this.side},setSide:function(e){return this.side=e,this.draw()},getRadius:function(){return this.radius},setRadius:function(e){return this.radius=e,this.draw()},draw:function(){var e,t=this.radius,n=this.side,r=2*Math.PI/n,o=this.getDrawer();for(o.clear(),o.moveTo(i.fromPolar(t,Math.PI/2,"rad").offset(this.center)),e=0;n>=e;e++)o.lineTo(i.fromPolar(t,r*e+Math.PI/2,"rad").offset(this.center));return o.close(),this}})}},_p[58]={value:function(e,t,n){var i=_p.r(67);return _p.r(11).createClass("Resource",{constructor:function(e,t){this.callBase(),this.node=i.createNode(e),t&&t.addResource(this)},toString:function(){return"url(#"+this.node.id+")"}})}},_p[59]={value:function(e,t,n){return _p.r(11).createClass({base:_p.r(68),constructor:function(e,t){this.callBase([e,t],360,0)},getInnerRadius:function(){return this.getSectionArray()[0]},getOuterRadius:function(){return this.getSectionArray()[1]},setInnerRadius:function(e){this.setSectionArray([e,this.getOuterRadius()])},setOuterRadius:function(e){this.setSectionArray([this.getInnerRadius(),e])}})}},_p[60]={value:function(e,t,n){var i=_p.r(67),r=_p.r(12),o=_p.r(33),a=_p.r(66),s=_p.r(31),l=_p.r(43),u=(_p.r(48),Array.prototype.slice),c=_p.r(25),h=_p.r(11).createClass("Shape",{mixins:[o,a,s],constructor:function(e){this.node=i.createNode(e),this.node.shape=this,this.transform={translate:null,rotate:null,scale:null,matrix:null},this.callMixin()},getId:function(){return this.node.id},setId:function(e){return this.node.id=e,this},getNode:function(){return this.node},getBoundaryBox:function(){var e;try{e=this.node.getBBox()}catch(t){e={x:this.node.clientLeft,y:this.node.clientTop,width:this.node.clientWidth,height:this.node.clientHeight}}return new c(e)},getRenderBox:function(e){var t=this.getBoundaryBox(),n=this.getTransform(e);return n.transformBox(t)},getWidth:function(){return this.getRenderBox().width},getHeight:function(){return this.getRenderBox().height},getSize:function(){var e=this.getRenderBox();return delete e.x,delete e.y,e},setOpacity:function(e){return this.node.setAttribute("opacity",e),this},getOpacity:function(){var e=this.node.getAttribute("opacity");return e?+e:1},setVisible:function(e){return e?this.node.removeAttribute("display"):this.node.setAttribute("display","none"),this},getVisible:function(){this.node.getAttribute("display")},hasAncestor:function(e){for(var t=this.container;t;){if(t===e)return!0;t=t.container}return!1},getTransform:function(e){return l.getCTM(this,e)},clearTransform:function(){return this.node.removeAttribute("transform"),this.transform={translate:null,rotate:null,scale:null,matrix:null},this.trigger("shapeupdate",{type:"transform"}),this},_applyTransform:function(){var e=this.transform,t=[];return e.translate&&t.push(["translate(",e.translate,")"]),e.rotate&&t.push(["rotate(",e.rotate,")"]),e.scale&&t.push(["scale(",e.scale,")"]),e.matrix&&t.push(["matrix(",e.matrix,")"]),this.node.setAttribute("transform",r.flatten(t).join(" ")),this},setMatrix:function(e){return this.transform.matrix=e,this._applyTransform()},setTranslate:function(e){return this.transform.translate=null!==e&&u.call(arguments)||null,this._applyTransform()},setRotate:function(e){return this.transform.rotate=null!==e&&u.call(arguments)||null,this._applyTransform()},setScale:function(e){return this.transform.scale=null!==e&&u.call(arguments)||null,this._applyTransform()},translate:function(e,t){var n=this.transform.matrix||new l;return void 0===t&&(t=0),this.transform.matrix=n.translate(e,t),this._applyTransform()},rotate:function(e){var t=this.transform.matrix||new l;return this.transform.matrix=t.rotate(e),this._applyTransform()},scale:function(e,t){var n=this.transform.matrix||new l;return void 0===t&&(t=e),this.transform.matrix=n.scale(e,t),this._applyTransform()},skew:function(e,t){var n=this.transform.matrix||new l;return void 0===t&&(t=e),this.transform.matrix=n.skew(e,t),this._applyTransform()},stroke:function(e,t){return e&&e.stroke?e.stroke(this):e?(this.node.setAttribute("stroke",e.toString()),t&&this.node.setAttribute("stroke-width",t)):null===e&&this.node.removeAttribute("stroe"),this},fill:function(e){return e&&this.node.setAttribute("fill",e.toString()),null===e&&this.node.removeAttribute("fill"),this},setAttr:function(e,t){var n=this;return r.isObject(e)&&r.each(e,function(e,t){n.setAttr(t,e)}),void 0===t||null===t||""===t?this.node.removeAttribute(e):this.node.setAttribute(e,t),this},getAttr:function(e){return this.node.getAttribute(e)}});return h}},_p[61]={value:function(e,t,n){var i=_p.r(29),r=_p.r(12),o=_p.r(11).createClass("ShapeContainer",{base:i,isShapeContainer:!0,handleAdd:function(e,t){var n=this.getShapeNode();n.insertBefore(e.node,n.childNodes[t]||null),e.trigger("add",{container:this}),e.notifyTreeModification&&e.notifyTreeModification("treeadd",this)},handleRemove:function(e,t){var n=this.getShapeNode();n.removeChild(e.node),e.trigger("remove",{container:this}),e.notifyTreeModification&&e.notifyTreeModification("treeremove",this)},notifyTreeModification:function(e,t){this.eachItem(function(n,i){i.notifyTreeModification&&i.notifyTreeModification(e,t),i.trigger(e,{container:t})})},getShape:function(e){return this.getItem(e)},addShape:function(e,t){return this.addItem(e,t)},put:function(e){return this.addShape(e),e},appendShape:function(e){return this.addShape(e)},prependShape:function(e){return this.addShape(e,0)},replaceShape:function(e,t){var n=this.indexOf(t);if(-1!==n)return this.removeShape(n),this.addShape(e,n),this},addShapeBefore:function(e,t){var n=this.indexOf(t);return this.addShape(e,n)},addShapeAfter:function(e,t){var n=this.indexOf(t);return this.addShape(e,-1===n?void 0:n+1)},addShapes:function(e){return this.addItems(e)},removeShape:function(e){return this.removeItem(e)},getShapes:function(){return this.getItems()},getShapesByType:function(e){function t(i){e.toLowerCase()==i.getType().toLowerCase()&&n.push(i),i.isShapeContainer&&r.each(i.getShapes(),function(e){t(e)})}var n=[];return t(this),n},getShapeById:function(e){return this.getShapeNode().getElementById(e).shape},arrangeShape:function(e,t){return this.removeShape(e).addShape(e,t)},getShapeNode:function(){return this.shapeNode||this.node}}),a=_p.r(60);return _p.r(11).extendClass(a,{bringTo:function(e){return this.container.arrangeShape(this,e),this},bringFront:function(){return this.bringTo(this.container.indexOf(this)+1)},bringBack:function(){return this.bringTo(this.container.indexOf(this)-1)},bringTop:function(){return this.container.removeShape(this).addShape(this),this},bringRear:function(){return this.bringTo(0)},bringRefer:function(e,t){return e.container&&(this.remove&&this.remove(),e.container.addShape(this,e.container.indexOf(e)+(t||0))),this},bringAbove:function(e){return this.bringRefer(e)},bringBelow:function(e){return this.bringRefer(e,1)},replaceBy:function(e){return this.container&&(e.bringAbove(this),this.remove()),this}}),o}},_p[62]={value:function(e,t,n){var i=_p.r(43),r=_p.r(12),o=_p.r(50);return _p.r(11).createClass("ShapeEvent",{constructor:function(e){var t=null;r.isObject(e.target)?r.extend(this,e):(this.type=e.type,t=e.target,t.correspondingUseElement&&(t=t.correspondingUseElement),this.originEvent=e,this.targetShape=t.shape||t.paper||e.currentTarget&&(e.currentTarget.shape||e.currentTarget.paper),e._kityParam&&r.extend(this,e._kityParam))},preventDefault:function(){var e=this.originEvent;return e?e.preventDefault?(e.preventDefault(),e.cancelable):(e.returnValue=!1,!0):!0},getPosition:function(e,t){if(!this.originEvent)return null;var n=this.originEvent.touches?this.originEvent.touches[t||0]:this.originEvent,r=this.targetShape,a=r.shapeNode||r.node,s=new o(n&&n.clientX||0,n&&n.clientY||0),l=i.transformPoint(s,a.getScreenCTM().inverse()),u=i.getCTM(r,e||"view").transformPoint(l);return u},stopPropagation:function(){var e=this.originEvent;return e?void(e.stopPropagation?e.stopPropagation():e.cancelBubble=!1):!0}})}},_p[63]={value:function(e,t,n){return _p.r(11).createClass("ShapePoint",{base:_p.r(50),constructor:function(e,t){this.callBase(e,t)},setX:function(e){return this.setPoint(e,this.y)},setY:function(e){return this.setPoint(this.x,e)},setPoint:function(e,t){return this.x=e,this.y=t,this.update(),this},getPoint:function(){return this},update:function(){return this.container&&this.container.update&&this.container.update(),this}})}},_p[64]={value:{COLOR_STANDARD:{aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",
linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00"},EXTEND_STANDARD:{}}},_p[65]={value:function(e,t,n){var i={3:.2,5:.38196601125,6:.57735026919,8:.541196100146,10:.726542528005,12:.707106781187},r=_p.r(50);return _p.r(11).createClass("Star",{base:_p.r(46),constructor:function(e,t,n,i,o){this.callBase(),this.vertex=e||3,this.radius=t||0,this.shrink=n,this.offset=i||new r(0,0),this.angleOffset=o||0,this.draw()},getVertex:function(){return this.vertex},setVertex:function(e){return this.vertex=e,this.draw()},getRadius:function(){return this.radius},setRadius:function(e){return this.radius=e,this.draw()},getShrink:function(){return this.shrink},setShrink:function(e){return this.shrink=e,this.draw()},getOffset:function(){return this.offset},setOffset:function(e){return this.offset=e,this.draw()},getAngleOffset:function(){return this.angleOffset},setAngleOffset:function(e){return this.angleOffset=e,this.draw()},draw:function(){var e,t,n=this.radius,o=this.radius*(this.shrink||i[this.vertex]||.5),a=this.vertex,s=this.offset,l=90,u=180/a,c=this.angleOffset,h=this.getDrawer();for(h.clear(),h.moveTo(r.fromPolar(o,l)),e=1;2*a>=e;e++)t=l+u*e,e%2?h.lineTo(r.fromPolar(n,t+c).offset(s)):h.lineTo(r.fromPolar(o,t));h.close()}})}},_p[66]={value:function(e,t,n){function i(e){return e.classList||(e.classList=new r(e)),e.classList}var r=_p.r(11).createClass("ClassList",{constructor:function(e){this._node=e,this._list=e.className.toString().split(" ")},_update:function(){this._node.className=this._list.join(" ")},add:function(e){this._list.push(e),this._update()},remove:function(e){var t=this._list.indexOf(e);~t&&this._list.splice(t,1),this._update()},contains:function(e){return!!~this._list.indexOf(e)}});return _p.r(11).createClass("Styled",{addClass:function(e){return i(this.node).add(e),this},removeClass:function(e){return i(this.node).remove(e),this},hasClass:function(e){return i(this.node).contains(e)},setStyle:function(e){if(2==arguments.length)return this.node.style[arguments[0]]=arguments[1],this;for(var t in e)e.hasOwnProperty(t)&&(this.node.style[t]=e[t]);return this}})}},_p[67]={value:function(e,t,n){var i=document,r=0,o={createNode:function(e){var t=i.createElementNS(o.ns,e);return t.id="kity_"+e+"_"+r++,t},defaults:{stroke:"none",fill:"none"},xlink:"http://www.w3.org/1999/xlink",ns:"http://www.w3.org/2000/svg"};return o}},_p[68]={value:function(e,t,n){var i=_p.r(50);return _p.r(11).createClass("Sweep",{base:_p.r(46),constructor:function(e,t,n){this.callBase(),this.sectionArray=e||[],this.angle=t||0,this.angleOffset=n||0,this.draw()},getSectionArray:function(){return this.sectionArray},setSectionArray:function(e){return this.sectionArray=e,this.draw()},getAngle:function(){return this.angle},setAngle:function(e){return this.angle=e,this.draw()},getAngleOffset:function(){return this.angleOffset},setAngleOffset:function(e){return this.angleOffset=e,this.draw()},draw:function(){var e,t=this.sectionArray;for(e=0;e<t.length;e+=2)this.drawSection(t[e],t[e+1]);return this},drawSection:function(e,t){var n=this.angle&&(this.angle%360?this.angle%360:360),r=this.angleOffset,o=r+n/2,a=r+n,s=0>n?0:1,l=this.getDrawer();return l.redraw(),0===n?void l.done():(l.moveTo(i.fromPolar(e,r)),l.lineTo(i.fromPolar(t,r)),t&&(l.carcTo(t,0,s,i.fromPolar(t,o)),l.carcTo(t,0,s,i.fromPolar(t,a))),l.lineTo(i.fromPolar(e,a)),e&&(l.carcTo(e,0,s,i.fromPolar(e,o)),l.carcTo(e,0,s,i.fromPolar(e,r))),l.close(),void l.done())}})}},_p[69]={value:function(e,t,n){function i(e){var t=e._cachedFontHash;if(l[t])return l[t];var n=e.getContent();e.setContent("百度Fex");var i=e.getBoundaryBox(),r=e.getY(),o=r-i.y+ +e.node.getAttribute("dy"),a=o-i.height;return e.setContent(n),l[t]={top:o,bottom:a,middle:(o+a)/2}}var r=_p.r(70),o=_p.r(61),a=_p.r(67),s=_p.r(12),l={};return _p.r(11).createClass("Text",{base:r,mixins:[o],constructor:function(e){this.callBase("text"),void 0!==e&&this.setContent(e),this._buildFontHash()},_buildFontHash:function(){var e=window.getComputedStyle(this.node);this._cachedFontHash=[e.fontFamily,e.fontSize,e.fontStretch,e.fontStyle,e.fontVariant,e.fontWeight].join("-")},_fontChanged:function(e){var t=this._lastFont,n=s.extend({},t,e);if(!t)return this._lastFont=e,!0;var i=t.family!=n.family||t.size!=n.size||t.style!=n.style||t.weight!=n.weight;return this._lastFont=n,i},setX:function(e){return this.node.setAttribute("x",e),this},setPosition:function(e,t){return this.setX(e).setY(t)},setY:function(e){return this.node.setAttribute("y",e),this},getX:function(){return+this.node.getAttribute("x")||0},getY:function(){return+this.node.getAttribute("y")||0},setFont:function(e){return this.callBase(e),this._fontChanged(e)&&(this._buildFontHash(),this.setVerticalAlign(this.getVerticalAlign())),this},setTextAnchor:function(e){return this.node.setAttribute("text-anchor",e),this},getTextAnchor:function(){return this.node.getAttribute("text-anchor")||"start"},setVerticalAlign:function(e){return this.whenPaperReady(function(){var t;switch(e){case"top":t=i(this).top;break;case"bottom":t=i(this).bottom;break;case"middle":t=i(this).middle;break;default:t=0}this.node.setAttribute("dy",t)}),this.verticalAlign=e,this},getVerticalAlign:function(){return this.verticalAlign||"baseline"},setStartOffset:function(e){this.shapeNode!=this.node&&this.shapeNode.setAttribute("startOffset",100*e+"%")},addSpan:function(e){return this.addShape(e),this},setPath:function(e){var t=this.shapeNode;if(this.shapeNode==this.node){for(t=this.shapeNode=a.createNode("textPath");this.node.firstChild;)this.shapeNode.appendChild(this.node.firstChild);this.node.appendChild(t)}return t.setAttributeNS(a.xlink,"xlink:href","#"+e.node.id),this.setTextAnchor(this.getTextAnchor()),this}})}},_p[70]={value:function(e,t,n){var i=_p.r(60);return _p.r(11).createClass("TextContent",{base:i,constructor:function(e){this.callBase(e),this.shapeNode=this.shapeNode||this.node,this.shapeNode.setAttribute("text-rendering","geometricPrecision")},clearContent:function(){for(;this.shapeNode.firstChild;)this.shapeNode.removeChild(this.shapeNode.firstChild);return this},setContent:function(e){return this.shapeNode.textContent=e,this},getContent:function(){return this.shapeNode.textContent},appendContent:function(e){return this.shapeNode.textContent+=e,this},setSize:function(e){return this.setFontSize(e)},setFontSize:function(e){return this.setFont({size:e})},setFontFamily:function(e){return this.setFont({family:e})},setFontBold:function(e){return this.setFont({weight:e?"bold":"normal"})},setFontItalic:function(e){return this.setFont({style:e?"italic":"normal"})},setFont:function(e){var t=this.node;return["family","size","weight","style"].forEach(function(n){null===e[n]?t.removeAttribute("font-"+n):e[n]&&t.setAttribute("font-"+n,e[n])}),this},getExtentOfChar:function(e){return this.node.getExtentOfChar(e)},getRotationOfChar:function(e){return this.node.getRotationOfChar(e)},getCharNumAtPosition:function(e,t){return this.node.getCharNumAtPosition(this.node.viewportElement.createSVGPoint(e,t))}})}},_p[71]={value:function(e,t,n){var i=_p.r(70),r=_p.r(66);return _p.r(11).createClass("TextSpan",{base:i,mixins:[r],constructor:function(e){this.callBase("tspan"),this.setContent(e)}})}},_p[72]={value:function(e,t,n){var i=_p.r(67),r=_p.r(11),o=r.createClass("Use",{base:_p.r(60),constructor:function(e){this.callBase("use"),this.ref(e)},ref:function(e){if(!e)return this.node.removeAttributeNS(i.xlink,"xlink:href"),this;var t=e.getId();return t&&this.node.setAttributeNS(i.xlink,"xlink:href","#"+t),"none"===e.node.getAttribute("fill")&&e.node.removeAttribute("fill"),"none"===e.node.getAttribute("stroke")&&e.node.removeAttribute("stroke"),this}}),a=_p.r(60);return r.extendClass(a,{use:function(){return new o(this)}}),o}},_p[73]={value:function(e,t,n){var i=_p.r(50),r=_p.r(43),o=_p.r(11).createClass("Vector",{base:i,constructor:function(e,t){this.callBase(e,t)},square:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.square())},add:function(e){return new o(this.x+e.x,this.y+e.y)},minus:function(e){return new o(this.x-e.x,this.y-e.y)},dot:function(e){return this.x*e.x+this.y*e.y},project:function(e){return e.multipy(this.dot(e)/e.square())},normalize:function(e){return void 0===e&&(e=1),this.multipy(e/this.length())},multipy:function(e){return new o(this.x*e,this.y*e)},rotate:function(e,t){"rad"==t&&(e=e/Math.PI*180);var n=(new r).rotate(e).transformPoint(this);return new o(n.x,n.y)},vertical:function(){return new o(this.y,-this.x)},reverse:function(){return this.multipy(-1)},getAngle:function(){var e=this.length();if(0===e)return 0;var t=Math.acos(this.x/e),n=this.y>0?1:-1;return 180*n*t/Math.PI}});return o.fromPoints=function(e,t){return new o(t.x-e.x,t.y-e.y)},o.fromPolar=function(){var e=i.fromPolar.apply(i,arguments);return new o(e.x,e.y)},_p.r(11).extendClass(i,{asVector:function(){return new o(this.x,this.y)}}),o}},_p[74]={value:function(e,t,n){var i=_p.r(61),r=_p.r(75);return _p.r(11).createClass("View",{mixins:[i,r],base:_p.r(74),constructor:function(){this.callBase("view")}})}},_p[75]={value:function(e,t,n){return _p.r(11).createClass("ViewBox",{getViewBox:function(){var e=this.node.getAttribute("viewBox");return null===e?{x:0,y:0,width:this.node.clientWidth||this.node.parentNode.clientWidth,height:this.node.clientHeight||this.node.parentNode.clientHeight}:(e=e.split(" "),{x:+e[0],y:+e[1],width:+e[2],height:+e[3]})},setViewBox:function(e,t,n,i){return this.node.setAttribute("viewBox",[e,t,n,i].join(" ")),this}})}},_p[76]={value:function(e,t,n){var i={},r=_p.r(12);return i.version="2.0.0",r.extend(i,{createClass:_p.r(11).createClass,extendClass:_p.r(11).extendClass,Utils:r,Browser:_p.r(10),Box:_p.r(25),Bezier:_p.r(23),BezierPoint:_p.r(24),Circle:_p.r(26),Clip:_p.r(27),Color:_p.r(28),Container:_p.r(29),Curve:_p.r(30),Ellipse:_p.r(32),Group:_p.r(36),Gradient:_p.r(35),HyperLink:_p.r(37),Image:_p.r(38),Line:_p.r(39),LinearGradient:_p.r(40),Mask:_p.r(42),Matrix:_p.r(43),Marker:_p.r(41),Palette:_p.r(44),Paper:_p.r(45),Path:_p.r(46),Pattern:_p.r(47),Pen:_p.r(48),Point:_p.r(50),PointContainer:_p.r(51),Polygon:_p.r(53),Polyline:_p.r(54),Pie:_p.r(49),RadialGradient:_p.r(55),Resource:_p.r(58),Rect:_p.r(56),RegularPolygon:_p.r(57),Ring:_p.r(59),Shape:_p.r(60),ShapePoint:_p.r(63),ShapeContainer:_p.r(61),Sweep:_p.r(68),Star:_p.r(65),Text:_p.r(69),TextSpan:_p.r(71),Use:_p.r(72),Vector:_p.r(73),g:_p.r(34),Animator:_p.r(0),Easing:_p.r(1),OpacityAnimator:_p.r(4),RotateAnimator:_p.r(6),ScaleAnimator:_p.r(7),Timeline:_p.r(8),TranslateAnimator:_p.r(9),PathAnimator:_p.r(5),MotionAnimator:_p.r(3),requestFrame:_p.r(2).requestFrame,releaseFrame:_p.r(2).releaseFrame,Filter:_p.r(20),GaussianblurFilter:_p.r(21),ProjectionFilter:_p.r(22),ColorMatrixEffect:_p.r(13),CompositeEffect:_p.r(14),ConvolveMatrixEffect:_p.r(15),Effect:_p.r(16),GaussianblurEffect:_p.r(17),OffsetEffect:_p.r(18)}),window.kity=i}};var moduleMapping={kity:76};use("kity")}();var KityMinder=window.KM=window.KityMinder=function(){var e={},t=0,n={};return{version:"1.3.5",uuid:function(e){return e=e||"unknown",n[e]=n[e]||0,++n[e],e+"_"+n[e]},createMinder:function(e,t){t=t||{},t.renderTo=Utils.isString(e)?document.getElementById(e):e;var n=new Minder(t);return this.addMinder(t.renderTo,n),n},addMinder:function(n,i){var r;r="string"==typeof n?n:n.id||"KM_INSTANCE_"+t++,e[r]=i},getMinder:function(n,i){var r;return r="string"==typeof n?n:n.id||"KM_INSTANCE_"+t++,e[r]||this.createMinder(n,i)},LANG:{}}}(),utils=Utils=KityMinder.Utils={extend:kity.Utils.extend.bind(kity.Utils),listen:function(e,t,n){var i=utils.isArray(t)?t:utils.trim(t).split(/\s+/),r=i.length;if(r)for(;r--;)if(t=i[r],e.addEventListener)e.addEventListener(t,n,!1);else{n._d||(n._d={els:[]});var o=t+n.toString(),a=utils.indexOf(n._d.els,e);n._d[o]&&-1!=a||(-1==a&&n._d.els.push(e),n._d[o]||(n._d[o]=function(e){return n.call(e.srcElement,e||window.event)}),e.attachEvent("on"+t,n._d[o]))}e=null},trim:function(e){return e.replace(/(^[ \t\n\r]+)|([ \t\n\r]+$)/g,"")},each:function(e,t,n){if(null!=e)if(e.length===+e.length){for(var i=0,r=e.length;r>i;i++)if(t.call(n,i,e[i],e)===!1)return!1}else for(var o in e)if(e.hasOwnProperty(o)&&t.call(n,o,e[o],e)===!1)return!1},addCssRule:function(e,t,n){var i;return void 0===t||t&&t.nodeType&&9==t.nodeType?(n=t&&t.nodeType&&9==t.nodeType?t:n||document,i=n.getElementById(e),i?i.innerHTML:void 0):(n=n||document,i=n.getElementById(e),""===t?i?(i.parentNode.removeChild(i),!0):!1:void(i?i.innerHTML=t:(i=n.createElement("style"),i.id=e,i.innerHTML=t,n.getElementsByTagName("head")[0].appendChild(i))))},keys:function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t},proxy:function(e,t){return function(){return e.apply(t,arguments)}},indexOf:function(e,t,n){var i=-1;return n=this.isNumber(n)?n:0,this.each(e,function(e,r){return r>=n&&e===t?(i=r,!1):void 0}),i},argsToArray:function(e,t){return Array.prototype.slice.call(e,t||0)},clonePlainObject:function(e,t){var n;t=t||{};for(var i in e)e.hasOwnProperty(i)&&(n=e[i],utils.isObject(n)||utils.isArray(n)?(t[i]=utils.isArray(n)?[]:{},utils.clonePlainObject(e[i],t[i])):t[i]=n);return t},compareObject:function(e,t){var n;if(this.isEmptyObject(e)!==this.isEmptyObject(t))return!1;if(this.getObjectLength(e)!=this.getObjectLength(t))return!1;for(var i in e)if(e.hasOwnProperty(i)){if(n=e[i],void 0===t[i])return!1;if(this.isObject(n)||this.isArray(n)){if(this.isObject(t[i])!==this.isObject(n))return!1;if(this.isArray(n)!==this.isArray(t[i]))return!1;if(this.compareObject(n,t[i])===!1)return!1}else if(n!=t[i])return!1}return!0},getObjectLength:function(e){if(this.isArray(e)||this.isString(e))return e.length;var t=0;for(var n in e)e.hasOwnProperty(n)&&t++;return t},isEmptyObject:function(e){if(null==e)return!0;if(this.isArray(e)||this.isString(e))return 0===e.length;for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},loadFile:function(){function e(e,n){try{for(var i,r=0;i=t[r++];)if(i.doc===e&&i.url==(n.src||n.href))return i}catch(o){return null}}var t=[];return function(n,i,r){var o=e(n,i);if(o)return void(o.ready?r&&r():o.funs.push(r));if(t.push({doc:n,url:i.src||i.href,funs:[r]}),!n.body){var a=[];for(var s in i)"tag"!=s&&a.push(s+'="'+i[s]+'"');return void n.write("<"+i.tag+" "+a.join(" ")+" ></"+i.tag+">")}if(!i.id||!n.getElementById(i.id)){var l=n.createElement(i.tag);delete i.tag;for(var s in i)l.setAttribute(s,i[s]);l.onload=l.onreadystatechange=function(){if(!this.readyState||/loaded|complete/.test(this.readyState)){if(o=e(n,i),o.funs.length>0){o.ready=1;for(var t;t=o.funs.pop();)t()}l.onload=l.onreadystatechange=null}},n.getElementsByTagName("head")[0].appendChild(l)}}}(),clone:function(e,t){var n;t=t||{};for(var i in e)e.hasOwnProperty(i)&&(n=e[i],"object"==typeof n?(t[i]=utils.isArray(n)?[]:{},utils.clone(e[i],t[i])):t[i]=n);return t},unhtml:function(e,t){return e?e.replace(t||/[&<">'](?:(amp|lt|quot|gt|#39|nbsp);)?/g,function(e,t){return t?e:{"<":"&lt;","&":"&amp;",'"':"&quot;",">":"&gt;","'":"&#39;"}[e]}):""},cloneArr:function(e){return[].concat(e)},clearWhitespace:function(e){return e.replace(/[\u200b\t\r\n]/g,"")},getValueByIndex:function(e,t){var n=0,i=0;return utils.each(e,function(e,r){if(n+r.length>=t){if(t-n==r.length){if(1==r.length&&0===r[0].width)return void n++;i={x:r[r.length-1].x+r[r.length-1].width,y:r[r.length-1].y}}else i=r[t-n];return!1}n+=r.length+(1==r.length&&0===r[0].width?0:1)}),i},getNodeIndex:function(e,t){for(var n=e,i=0;n=n.previousSibling;)t&&3==n.nodeType?n.nodeType!=n.nextSibling.nodeType&&i++:i++;return i}};Utils.each(["String","Function","Array","Number","RegExp","Object"],function(e,t){KityMinder.Utils["is"+t]=function(e){return Object.prototype.toString.apply(e)=="[object "+t+"]"}});var browser=KityMinder.browser=function(){var e=navigator.userAgent.toLowerCase(),t=window.opera,n={ie:/(msie\s|trident.*rv:)([\w.]+)/.test(e),opera:!!t&&t.version,webkit:e.indexOf(" applewebkit/")>-1,mac:e.indexOf("macintosh")>-1,quirks:"BackCompat"==document.compatMode,ipad:e.indexOf("ipad")>-1};n.gecko="Gecko"==navigator.product&&!n.webkit&&!n.opera&&!n.ie;var i=0;if(n.ie){var r=e.match(/(?:msie\s([\w.]+))/),o=e.match(/(?:trident.*rv:([\w.]+))/);i=r&&o&&r[1]&&o[1]?Math.max(1*r[1],1*o[1]):r&&r[1]?1*r[1]:o&&o[1]?1*o[1]:0,n.ie11Compat=11==document.documentMode,n.ie9Compat=9==document.documentMode,n.ie8=!!document.documentMode,n.ie8Compat=8==document.documentMode,n.ie7Compat=7==i&&!document.documentMode||7==document.documentMode,n.ie6Compat=7>i||n.quirks,n.ie9above=i>8,n.ie9below=9>i}if(n.gecko){var a=e.match(/rv:([\d\.]+)/);a&&(a=a[1].split("."),i=1e4*a[0]+100*(a[1]||0)+1*(a[2]||0))}return/chrome\/(\d+\.\d)/i.test(e)&&(n.chrome=+RegExp.$1),/(\d+\.\d)?(?:\.\d)?\s+safari\/?(\d+\.\d+)?/i.test(e)&&!/chrome/i.test(e)&&(n.safari=+(RegExp.$1||RegExp.$2)),n.opera&&(i=parseFloat(t.version())),n.webkit&&(i=parseFloat(e.match(/ applewebkit\/(\d+)/)[1])),n.version=i,n.isCompatible=!n.mobile&&(n.ie&&i>=6||n.gecko&&i>=10801||n.opera&&i>=9.5||n.air&&i>=1||n.webkit&&i>=522||!1),n}(),ie=browser.ie,webkit=browser.webkit,gecko=browser.gecko,opera=browser.opera,Minder=KityMinder.Minder=kity.createClass("KityMinder",{constructor:function(e){this._options=Utils.extend(window.KITYMINDER_CONFIG||{},e);for(var t=Minder._initFnQueue.slice();t.length;)t.shift().call(this,e);this.fire("ready")}});Minder._initFnQueue=[],Minder.registerInit=function(e){Minder._initFnQueue.push(e)};var Command=kity.createClass("Command",{constructor:function(){this._isContentChange=!0,this._isSelectionChange=!1},execute:function(e,t){},setContentChanged:function(e){this._isContentChange=!!e},isContentChanged:function(){return this._isContentChange},setSelectionChanged:function(e){this._isSelectionChange=!!e},isSelectionChanged:function(){return this._isContentChange},queryState:function(e){return 0},queryValue:function(e){return 0},isNeedUndo:function(){return!0}});kity.extendClass(Minder,{_getCommand:function(e){return this._commands[e.toLowerCase()]},_queryCommand:function(e,t,n){var i=this._getCommand(e);if(i){var r=i["query"+t];if(r)return r.apply(i,[this].concat(n))}return 0},queryCommandState:function(e){return this._queryCommand(e,"State",Utils.argsToArray(1))},queryCommandValue:function(e){return this._queryCommand(e,"Value",Utils.argsToArray(1))},execCommand:function(e){e=e.toLowerCase();var t,n,i,r,o=Utils.argsToArray(arguments,1),a=this;return t=this._getCommand(e),r={command:t,commandName:e.toLowerCase(),commandArgs:o},t&&~this.queryCommandState(e)?(!this._hasEnterExecCommand&&t.isNeedUndo()?(this._hasEnterExecCommand=!0,n=this._fire(new MinderEvent("beforeExecCommand",r,!0)),n||(this._fire(new MinderEvent("saveScene")),this._fire(new MinderEvent("preExecCommand",r,!1)),i=t.execute.apply(t,[a].concat(o)),this._fire(new MinderEvent("execCommand",r,!1)),this._fire(new MinderEvent("saveScene")),t.isContentChanged()&&this._firePharse(new MinderEvent("contentchange")),this._interactChange()),this._hasEnterExecCommand=!1):(i=t.execute.apply(t,[a].concat(o)),this._hasEnterExecCommand||this._interactChange()),void 0===i?null:i):!1}});var MinderNode=KityMinder.MinderNode=kity.createClass("MinderNode",{constructor:function(e){this.parent=null,this.root=this,this.children=[],this.data={},this.tmpData={},this.initContainers(),Utils.isString(e)?this.setText(e):this.setData(e)},initContainers:function(){this.rc=(new kity.Group).setId(KityMinder.uuid("minder_node")),this.rc.minderNode=this},isRoot:function(){return this.root===this},isLeaf:function(){return 0===this.children.length},getRoot:function(){return this.root||this},getParent:function(){return this.parent},getLevel:function(){for(var e=0,t=this.parent;t;)e++,t=t.parent;return e},getComplex:function(){var e=0;return this.traverse(function(){e++}),e},getType:function(e){return this.type=["root","main","sub"][Math.min(this.getLevel(),2)],this.type},isAncestorOf:function(e){for(var t=e.parent;t;){if(t==this)return!0;t=t.parent}return!1},setText:function(e){return utils.isArray(e)&&(e=e.join("\n")),this.setData("text",e)},getText:function(e){var t=this.getData("text")||"";return e&&(t=t.split("\n")),t},preTraverse:function(e,t){var n=this.getChildren();t||e(this);for(var i=0;i<n.length;i++)n[i].preTraverse(e)},postTraverse:function(e,t){for(var n=this.getChildren(),i=0;i<n.length;i++)n[i].postTraverse(e);t||e(this)},traverse:function(e,t){return this.postTraverse(e,t)},getChildren:function(){return this.children},getIndex:function(){return this.parent?this.parent.children.indexOf(this):-1},insertChild:function(e,t){void 0===t&&(t=this.children.length),e.parent&&e.parent.removeChild(e),e.parent=this,e.root=this.root,this.children.splice(t,0,e)},appendChild:function(e){return this.insertChild(e)},prependChild:function(e){return this.insertChild(e,0)},removeChild:function(e){var t,n=e;e instanceof MinderNode&&(n=this.children.indexOf(e)),n>=0&&(t=this.children.splice(n,1)[0],t.parent=null,t.root=t)},getChild:function(e){return this.children[e]},getFirstChild:function(){return this.children[0]},getLastChild:function(){return this.children[this.children.length-1]},getData:function(e){return void 0===e?this.data:this.data[e]},setData:function(e,t){return void 0===e?this.data={}:utils.isObject(e)?Utils.extend(this.data,e):void 0===t?(this.data[e]=null,delete this.data[e]):this.data[e]=t,this},getRenderContainer:function(){return this.rc},getCommonAncestor:function(e){return Utils.getNodeCommonAncestor(this,e)},contains:function(e){return this==e||this.isAncestorOf(e)},clone:function(){function e(t,n){var i=new KM.MinderNode;i.data=Utils.clonePlainObject(n.getData()),i.tmpData=Utils.clonePlainObject(n.getTmpData()),t&&t.appendChild(i);for(var r,o=0;r=n.children[o++];)e(i,r);return i}return e(null,this)},equals:function(e,t){function n(){r&&i.setSelectedFlag(),o&&e.setSelectedFlag()}var i=this;if(t){var r=!1,o=!1;i.isSelected()&&(r=!0,i.clearSelectedFlag()),e.isSelected()&&(o=!0,e.clearSelectedFlag())}if(e.children.length!=this.children.length)return n(),!1;if(utils.compareObject(e.getData(),i.getData())===!1)return n(),!1;if(utils.compareObject(e.getTmpData(),i.getTmpData())===!1)return n(),!1;for(var a,s=0;a=i.children[s];s++)if(a.equals(e.children[s],t)===!1)return n(),!1;return n(),!0},clearChildren:function(){this.children=[]},setTmpData:function(e,t){var n=this;utils.isObject(e)&&utils.each(e,function(e,t){n.setTmpData(e,t)}),void 0===t||null===t||""===t?delete this.tmpData[e]:this.tmpData[e]=t},getTmpData:function(e){return void 0===e?this.tmpData:this.tmpData[e]},setValue:function(e){return this.data={},this.setData(utils.clonePlainObject(e.getData())),this.tmpData={},this.setTmpData(utils.clonePlainObject(e.getTmpData())),this}});MinderNode.getCommonAncestor=function(e,t){if(e instanceof Array)return MinderNode.getCommonAncestor.apply(this,e);switch(arguments.length){case 1:return e.parent||e;case 2:if(e.isAncestorOf(t))return e;if(t.isAncestorOf(e))return t;for(var n=e.parent;n&&!n.isAncestorOf(t);)n=n.parent;return n;default:return Array.prototype.reduce.call(arguments,function(e,t){return MinderNode.getCommonAncestor(e,t)},e)}},kity.extendClass(Minder,{getRoot:function(){return this._root},setRoot:function(e){this._root=e,e.minder=this},createNode:function(e,t,n){var i=new MinderNode(e);return this.fire("nodecreate",{node:i,parent:t,index:n}),this.appendNode(i,t,n),i},appendNode:function(e,t,n){return t&&t.insertChild(e,n),this.attachNode(e),this},removeNode:function(e){e.parent&&(e.parent.removeChild(e),this.detachNode(e),this.fire("noderemove",{node:e}))},attachNode:function(e){var t=this._rc;e.traverse(function(e){e.attached=!0,t.addShape(e.getRenderContainer())}),t.addShape(e.getRenderContainer()),this.fire("nodeattach",{node:e})},detachNode:function(e){var t=this._rc;e.traverse(function(e){e.attached=!1,t.removeShape(e.getRenderContainer())}),this.fire("nodedetach",{node:e})},getMinderTitle:function(){return this.getRoot().getText()}}),kity.extendClass(MinderNode,{getMinder:function(){return this.getRoot().minder}}),kity.extendClass(Minder,{getOptions:function(e){var t;return e?(t=this.getPreferences(e),t&&t[e]||this._options[e]):(t=this.getPreferences(),utils.extend(t,this._options,!0))},setDefaultOptions:function(e,t,n){var i={};Utils.isString(e)?i[e]=t:i=e,utils.extend(this._options,i,!n)},setOptions:function(e,t){this.setPreferences(e,t)}}),Minder.registerInit(function(e){this.setDefaultOptions(KM.defaultOptions)});var MinderEvent=kity.createClass("MindEvent",{constructor:function(e,t,n){t=t||{},t.getType&&"ShapeEvent"==t.getType()?(this.kityEvent=t,this.originEvent=t.originEvent,this.getPosition=t.getPosition.bind(t)):t.target&&t.preventDefault?this.originEvent=t:kity.Utils.extend(this,t),this.type=e,this._canstop=n||!1},getTargetNode:function(){var e=this.kityEvent&&this.kityEvent.targetShape;if(!e)return null;for(;!e.minderNode&&e.container;)e=e.container;var t=e.minderNode;return t&&e.getOpacity()<1?null:t||null},stopPropagation:function(){this._stoped=!0},stopPropagationImmediately:function(){this._immediatelyStoped=!0,this._stoped=!0},shouldStopPropagation:function(){return this._canstop&&this._stoped},shouldStopPropagationImmediately:function(){return this._canstop&&this._immediatelyStoped},preventDefault:function(){this.originEvent.preventDefault()},isRightMB:function(){var e=!1;return this.originEvent?("which"in this.originEvent?e=3==this.originEvent.which:"button"in this.originEvent&&(e=2==this.originEvent.button),e):!1},getKeyCode:function(){var e=this.originEvent;return e.keyCode||e.which}});Minder.registerInit(function(){this._initEvents()}),kity.extendClass(Minder,{_initEvents:function(){this._eventCallbacks={}},_bindEvents:function(){this._bindPaperEvents(),this._bindKeyboardEvents()},_resetEvents:function(){this._initEvents(),this._bindEvents()},_bindPaperEvents:function(){this._paper.on("click dblclick mousedown contextmenu mouseup mousemove mouseover mousewheel DOMMouseScroll touchstart touchmove touchend dragenter dragleave drop",this._firePharse.bind(this)),window&&(window.addEventListener("resize",this._firePharse.bind(this)),window.addEventListener("blur",this._firePharse.bind(this)))},_bindKeyboardEvents:function(){-1==navigator.userAgent.indexOf("iPhone")&&-1==navigator.userAgent.indexOf("iPod")&&-1==navigator.userAgent.indexOf("iPad")&&Utils.listen(document.body,"keydown keyup keypress paste",this._firePharse.bind(this))},_firePharse:function(e){var t,n,i;"DOMMouseScroll"==e.type&&(e.type="mousewheel",e.wheelDelta=e.originEvent.wheelDelta=-10*e.originEvent.detail,e.wheelDeltaX=e.originEvent.mozMovementX,e.wheelDeltaY=e.originEvent.mozMovementY),t=new MinderEvent("before"+e.type,e,!0),this._fire(t)||(n=new MinderEvent("pre"+e.type,e,!0),i=new MinderEvent(e.type,e,!0),(this._fire(n)||this._fire(i))&&this._fire(new MinderEvent("after"+e.type,e,!1)))},_interactChange:function(e){var t=this;t._interactScheduled||(setTimeout(function(){t._fire(new MinderEvent("interactchange")),t._interactScheduled=!1},100),t._interactScheduled=!0)},_listen:function(e,t){var n=this._eventCallbacks[e]||(this._eventCallbacks[e]=[]);n.push(t)},_fire:function(e){var t=this.getStatus(),n=this._eventCallbacks[e.type.toLowerCase()]||[];if(t&&(n=n.concat(this._eventCallbacks[t+"."+e.type.toLowerCase()]||[])),0!==n.length){for(var i=(this.getStatus(),0);i<n.length&&(n[i].call(this,e),!e.shouldStopPropagationImmediately());i++);return e.shouldStopPropagation()}},on:function(e,t){var n=this;return utils.each(e.split(/\s+/),function(e,i){n._listen(i.toLowerCase(),t)}),this},off:function(e,t){var n,i,r,o,a=e.split(/\s+/);for(n=0;n<a.length;n++)if(r=this._eventCallbacks[a[n].toLowerCase()]){for(o=null,i=0;i<r.length;i++)r[i]==t&&(o=i);null!==o&&r.splice(o,1)}},fire:function(e,t){var n=new MinderEvent(e,t);return this._fire(n),this}}),Minder.registerInit(function(){this._initStatus()}),kity.extendClass(Minder,{_initStatus:function(){this._status="normal",this._rollbackStatus="normal"},setStatus:function(){var e=~window.location.href.indexOf("status"),t=~window.location.href.indexOf("trace");return function(n,i){return"readonly"!=this._status||i?(n!=this._status&&(this._rollbackStatus=this._status,this._status=n,this.fire("statuschange",{lastStatus:this._rollbackStatus,currentStatus:this._status}),e&&(console.log(window.event.type,this._rollbackStatus,"->",this._status),t&&console.trace())),this):this}}(),rollbackStatus:function(){this.setStatus(this._rollbackStatus)},getRollbackStatus:function(){return this._rollbackStatus},getStatus:function(){return this._status}}),Minder.registerInit(function(){this._initPaper()}),kity.extendClass(Minder,{_initPaper:function(){this._paper=new kity.Paper,this._paper.getNode().setAttribute("contenteditable",!0),this._paper.getNode().ondragstart=function(e){e.preventDefault()},this._paper.shapeNode.setAttribute("transform","translate(0.5, 0.5)"),this._addRenderContainer(),this.setRoot(this.createNode(this.getLang().maintopic)),this._options.renderTo&&this.renderTo(this._options.renderTo)},_addRenderContainer:function(){this._rc=(new kity.Group).setId(KityMinder.uuid("minder")),this._paper.addShape(this._rc)},renderTo:function(e){this._paper.renderTo(this._renderTarget=e),this._bindEvents()},getRenderContainer:function(){return this._rc},getPaper:function(){return this._paper},getRenderTarget:function(){return this._renderTarget}}),Minder.registerInit(function(){this._initSelection()}),kity.extendClass(Minder,{_initSelection:function(){this._selectedNodes=[]},renderChangedSelection:function(e){var t=this.getSelectedNodes(),n=[],i=0;for(t.forEach(function(t){-1==e.indexOf(t)&&(n.push(t),t.setTmpData("selected",!0))}),e.forEach(function(e){-1==t.indexOf(e)&&(n.push(e),e.setTmpData("selected",!1))}),n.length&&(this._interactChange(),this.fire("selectionchange"));i<n.length;)n[i++].render()},getSelectedNodes:function(){return this._selectedNodes},getSelectedNode:function(){return this.getSelectedNodes()[0]||null},removeAllSelectedNodes:function(){var e=this._selectedNodes.splice(0);return this._selectedNodes=[],this.renderChangedSelection(e),this.fire("selectionclear")},removeSelectedNodes:function(e){var t=this,n=this._selectedNodes.slice(0);return e=Utils.isArray(e)?e:[e],Utils.each(e,function(e,n){var i;-1!==(i=t._selectedNodes.indexOf(n))&&t._selectedNodes.splice(i,1)}),this.renderChangedSelection(n),this},select:function(e,t){var n=this.getSelectedNodes().slice(0);t&&(this._selectedNodes=[]);var i=this;return e=Utils.isArray(e)?e:[e],Utils.each(e,function(e,t){-1===i._selectedNodes.indexOf(t)&&i._selectedNodes.push(t)}),this.renderChangedSelection(n),this},toggleSelect:function(e){return Utils.isArray(e)?e.forEach(this.toggleSelect.bind(this)):e.isSelected()?this.removeSelectedNodes(e):this.select(e),this},isSingleSelect:function(){return 1==this._selectedNodes.length},getSelectedAncestors:function(e){
function t(e,t){for(var n=e.length-1;n>=0;--n)if(e[n].isAncestorOf(t))return!0;return!1}var n,i=this.getSelectedNodes().slice(0),r=[],o=i.indexOf(this.getRoot());for(~o&&!e&&i.splice(o,1),i.sort(function(e,t){return e.getLevel()-t.getLevel()});n=i.pop();)t(i,n)||r.push(n);return r}}),kity.extendClass(MinderNode,{isSelected:function(){return this.getTmpData("selected")},clearSelectedFlag:function(){this.setTmpData("selected")},setSelectedFlag:function(){this.setTmpData("selected",!0)}}),kity.extendClass(MinderEvent,{isShortcutKey:function(e){var t=this.originEvent;return t?getMetaKeyCode(e)==getMetaKeyCode(t):!1}}),Minder.registerInit(function(){this._initShortcutKey()}),kity.extendClass(Minder,{_initShortcutKey:function(){this._bindShortcutKeys()},_bindShortcutKeys:function(){var e=this._shortcutKeys={},t="hasOwnProperty";this.on("keydown",function(n){for(var i in e)if(e[t](i)&&n.isShortcutKey(i)){var r=e[i];if(r.__statusCondition&&r.__statusCondition!=this.getStatus())return;r(),n.preventDefault()}})},addShortcut:function(e,t){var n=this._shortcutKeys;e.split(/\|\s*/).forEach(function(e){var i,r=e.split("::");r.length>1&&(e=r[1],i=r[0],t.__statusCondition=i),n[e]=t})},addCommandShortcutKeys:function(e,t){var n=this._commandShortcutKeys||(this._commandShortcutKeys={}),i={};t?i[e]=t:i=e;var r=this;utils.each(i,function(e,t){n[e]=t,r.addShortcut(t,function(){0===r.queryCommandState(e)&&r.execCommand(e)})})},getCommandShortcutKey:function(e){var t=this._commandShortcutKeys;return t&&t[e]||null}}),Minder.registerInit(function(){this._initContextMenu()}),kity.extendClass(Minder,{_initContextMenu:function(){this.contextmenus=[]},addContextMenu:function(e){return utils.isArray(e)?this.contextmenus=this.contextmenus.concat(e):this.contextmenus.push(e),this},getContextMenu:function(){return this.contextmenus}}),function(){var e;KityMinder.registerModule=function(t,n){e||(e={}),e[t]=n},KityMinder.getModules=function(){return e}}(),Minder.registerInit(function(){this._initModules()}),kity.extendClass(Minder,{_initModules:function(){var e=KityMinder.getModules(),t=this._options.modules||Utils.keys(e);this._commands={},this._query={},this._modules={},this._rendererClasses={};var n,i,r,o,a,s,l,u=this;for(n=0;n<t.length;n++)if(i=t[n],e[i]&&(o="function"==typeof e[i]?e[i].call(u):e[i],this._modules[i]=o,o)){o.init&&o.init.call(u,this._options),a=o.commands;for(i in a)this._commands[i.toLowerCase()]=new a[i];if(s=o.events)for(r in s)u.on(r,s[r]);if(l=o.renderers)for(r in l)this._rendererClasses[r]=this._rendererClasses[r]||[],Utils.isArray(l[r])?this._rendererClasses[r]=this._rendererClasses[r].concat(l[r]):this._rendererClasses[r].push(l[r]);o.defaultOptions&&this.setDefaultOptions(o.defaultOptions),o.commandShortcutKeys&&this.addCommandShortcutKeys(o.commandShortcutKeys),o.contextmenu&&this.addContextMenu(o.contextmenu)}},_garbage:function(){for(this.clearSelect();this._root.getChildren().length;)this._root.removeChild(0)},destroy:function(){var e=this._modules;this._resetEvents(),this._garbage();for(var t in e)e[t].destroy&&e[t].destroy.call(this)},reset:function(){var e=this._modules;this._garbage();for(var t in e)e[t].reset&&e[t].reset.call(this)}}),Utils.extend(KityMinder,{_protocols:{},registerProtocol:function(e,t){KityMinder._protocols[e]=t}});var DEFAULT_TEXT={root:"maintopic",main:"topic",sub:"topic"};Minder.registerInit(function(){this._initProtocols()}),kity.extendClass(Minder,{_initProtocols:function(e){var t=this._protocols={},n=KityMinder._protocols;for(var i in n)n.hasOwnProperty(i)&&(t[i]=n[i](this)),t[i].name=i},getProtocol:function(e){return this._protocols[e]||null},getSupportedProtocols:function(){var e=this._protocols;return Utils.keys(e).map(function(t){return e[t]})},exportJson:function(){function e(t){var n={};n.data=t.getData();var i=t.getChildren();if(i.length){n.children=[];for(var r=0;r<i.length;r++)n.children.push(e(i[r]))}return n}var t=e(this.getRoot());return t.template=this.getTemplate(),t.theme=this.getTheme(),t.version=KityMinder.version,t},importJson:function(e,t){function n(e,t,i){var r=t.data;e.data={};for(var o in r)e.setData(o,r[o]);e.setData("text",r.text||i.getLang(DEFAULT_TEXT[e.getType()]));for(var a=t.children||[],s=0;s<a.length;s++){var l=i.createNode(null,e);n(l,a[s],i)}return e}if(e){for(this._fire(new MinderEvent("preimport",t,!1));this._root.getChildren().length;)this.removeNode(this._root.getChildren()[0]);e=KityMinder.compatibility(e),n(this._root,e,this),this.setTemplate(e.template||"default"),this.setTheme(e.theme||null),this.refresh(),this.fire("import",t),this._firePharse({type:"contentchange"}),this._interactChange()}},exportData:function(e,t){var n,i;return n=this.exportJson(),!e||(i=this.getProtocol(e),i&&i.encode)?(this._fire(new MinderEvent("beforeexport",{json:n,protocolName:e,protocol:i})),i?Promise.resolve(i.encode(n,this,t)):Promise.resolve(n)):Promise.reject(new Error("Not supported protocol:"+e))},importData:function(e,t){var n,i=this;if(t&&(n=this.getProtocol(t),!n||!n.decode))return Promise.reject(new Error("Not supported protocol:"+t));var r={local:e,protocolName:t,protocol:n};return this._fire(new MinderEvent("beforeimport",r)),new Promise(function(t,i){t(n?n.decode(e):e)}).then(function(e){return i.importJson(e,r),e})}}),Minder.registerInit(function(e){e.readOnly&&this.setDisabled()}),kity.extendClass(Minder,{disable:function(){var e=this;e.bkqueryCommandState=e.queryCommandState,e.bkqueryCommandValue=e.queryCommandValue,e.queryCommandState=function(t){var n=this._getCommand(t);return n&&n.enableReadOnly?e.bkqueryCommandState.apply(e,arguments):-1},e.queryCommandValue=function(t){var n=this._getCommand(t);return n&&n.enableReadOnly?e.bkqueryCommandValue.apply(e,arguments):null},this.setStatus("readonly"),e._interactChange()},enable:function(){var e=this;e.bkqueryCommandState&&(e.queryCommandState=e.bkqueryCommandState,delete e.bkqueryCommandState),e.bkqueryCommandValue&&(e.queryCommandValue=e.bkqueryCommandValue,delete e.bkqueryCommandValue),this.setStatus("normal"),e._interactChange()}}),Utils.extend(KityMinder,{_layout:{},registerLayout:function(e,t){KityMinder._layout[e]=t,KityMinder._defaultLayout||(KityMinder._defaultLayout=e)},getLayoutList:function(){return this._layout},getLayoutInstance:function(e){var t=KityMinder._layout[e];if(!t)throw new Error("Missing Layout: "+e);var n=new t;return n}}),kity.extendClass(MinderNode,{getLayout:function(){var e=this.getData("layout");return e=e||(this.isRoot()?KityMinder._defaultLayout:this.parent.getLayout())},setLayout:function(e){return e&&("inherit"==e?this.setData("layout"):this.setData("layout",e)),this},layout:function(e,t){return this.setLayout(e).getMinder().layout(t),this},getLayoutInstance:function(){return KityMinder.getLayoutInstance(this.getLayout())},getOrderHint:function(e){return this.parent.getLayoutInstance().getOrderHint(this)},getExpandPosition:function(){return this.getLayoutInstance().getExpandPosition()},getLayoutTransform:function(){return this._layoutTransform||new kity.Matrix},getGlobalLayoutTransformPreview:function(){var e=this.parent?this.parent.getLayoutTransform():new kity.Matrix,t=this.getLayoutTransform(),n=this.getLayoutOffset();return n&&t.translate(n.x,n.y),e.merge(t)},getLayoutPointPreview:function(){return this.getGlobalLayoutTransformPreview().transformPoint(new kity.Point)},getGlobalLayoutTransform:function(){return this._globalLayoutTransform?this._globalLayoutTransform:this.parent?this.parent.getGlobalLayoutTransform():new kity.Matrix},setLayoutTransform:function(e){return this._layoutTransform=e,this},setGlobalLayoutTransform:function(e){return this.getRenderContainer().setMatrix(this._globalLayoutTransform=e),this},setVertexIn:function(e){this._vertexIn=e},setVertexOut:function(e){this._vertexOut=e},getVertexIn:function(){return this._vertexIn||new kity.Point},getVertexOut:function(){return this._vertexOut||new kity.Point},getLayoutVertexIn:function(){return this.getGlobalLayoutTransform().transformPoint(this.getVertexIn())},getLayoutVertexOut:function(){return this.getGlobalLayoutTransform().transformPoint(this.getVertexOut())},setLayoutVectorIn:function(e){return this._layoutVectorIn=e,this},setLayoutVectorOut:function(e){return this._layoutVectorOut=e,this},getLayoutVectorIn:function(){return this._layoutVectorIn||new kity.Vector},getLayoutVectorOut:function(){return this._layoutVectorOut||new kity.Vector},getLayoutBox:function(){var e=this.getGlobalLayoutTransform();return e.transformBox(this.getContentBox())},getLayoutPoint:function(){var e=this.getGlobalLayoutTransform();return e.transformPoint(new kity.Point)},getLayoutOffset:function(){if(!this.parent)return new kity.Point;var e=this.getData("layout_"+this.parent.getLayout()+"_offset");return e?new kity.Point(e.x,e.y):new kity.Point},setLayoutOffset:function(e){if(!this.parent)return this;if(e&&!this.hasLayoutOffset()){var t=this.getLayoutTransform().m;e=e.offset(t.e,t.f),this.setLayoutTransform(null)}return this.setData("layout_"+this.parent.getLayout()+"_offset",e?{x:e.x,y:e.y}:null),this},hasLayoutOffset:function(){return!!this.getData("layout_"+this.parent.getLayout()+"_offset")},resetLayoutOffset:function(){return this.setLayoutOffset(null)},getLayoutRoot:function(){return this.isLayoutRoot()?this:this.parent.getLayoutRoot()},isLayoutRoot:function(){return this.getData("layout")||this.isRoot()}}),Minder.registerInit(function(e){this.refresh()}),kity.extendClass(Minder,{layout:function(e){function t(e,n){e.isExpanded(),e.children.forEach(function(e){t(e,n)});var i=e.getLayoutInstance(),r=e.getChildren().filter(function(e){return!e.hasLayoutOffset()});i.doLayout(e,r,n)}this.getRoot().traverse(function(e){e.setLayoutTransform(null)}),t(this.getRoot(),1),t(this.getRoot(),2),e=e?300:0;var n=this;return this.applyLayoutResult(this.getRoot(),e).then(function(){n.fire("layoutallfinish")}),this.fire("layout")},refresh:function(e){return this.getRoot().renderTree(),this.layout(e).fire("contentchange")._interactChange(),this},applyLayoutResult:function(e,t){function n(){--l||a.resolve()}function i(e,t){e.setGlobalLayoutTransform(t),o.fire("layoutapply",{node:e,matrix:t})}function r(e,a){var s=e.getLayoutTransform().merge(a),l=e.getGlobalLayoutTransform()||new kity.Matrix,u=e.getLayoutOffset();s.translate(u.x,u.y),s.m.e=Math.round(s.m.e),s.m.f=Math.round(s.m.f),e._layoutTimeline&&(e._layoutTimeline.stop(),e._layoutTimeline=null),t?e._layoutTimeline=new kity.Animator(l,s,i).start(e,t,"ease").on("finish",function(){setTimeout(function(){i(e,s),o.fire("layoutfinish",{node:e,matrix:s}),n()},150)}):(i(e,s),o.fire("layoutfinish",{node:e,matrix:s}),n());for(var c=0;c<e.children.length;c++)r(e.children[c],s)}e=e||this.getRoot();var o=this,a={},s=new Promise(function(e,t){a.resolve=e,a.reject=t}),l=e.getComplex();return l>200&&(t=0),r(e,e.parent?e.parent.getGlobalLayoutTransform():new kity.Matrix),s}});var Layout=kity.createClass("Layout",{doLayout:function(e){throw new Error("Not Implement: Layout.doLayout()")},align:function(e,t,n){var i=this;n=n||0,e.forEach(function(e){var r=i.getTreeBox([e]),o=e.getLayoutTransform();switch(t){case"left":return o.translate(n-r.left,0);case"right":return o.translate(n-r.right,0);case"top":return o.translate(0,n-r.top);case"bottom":return o.translate(0,n-r.bottom)}})},stack:function(e,t,n){var i=this,r=0;return n=n||function(e,t,n){return e.getStyle({x:"margin-right",y:"margin-bottom"}[n])+t.getStyle({x:"margin-left",y:"margin-top"}[n])},e.forEach(function(e,o,a){var s=i.getTreeBox([e]),l={x:s.width,y:s.height}[t],u={x:s.left,y:s.top}[t],c=e.getLayoutTransform();"x"==t?c.translate(r-u,0):c.translate(0,r-u),r+=l,a[o+1]&&(r+=n(e,a[o+1],t))}),r},move:function(e,t,n){e.forEach(function(e){e.getLayoutTransform().translate(t,n)})},getBranchBox:function(e){var t,n,i,r,o=new kity.Box;for(t=0;t<e.length;t++)n=e[t],i=n.getLayoutTransform(),r=n.getContentBox(),o=o.merge(i.transformBox(r));return o},getTreeBox:function(e){var t,n,i,r,o=KityMinder.Geometry,a={x:0,y:0,height:0,width:0};for(e instanceof Array||(e=[e]),t=0;t<e.length;t++)n=e[t],i=n.getLayoutTransform(),r=n.getContentBox(),n.isExpanded()&&n.children.length&&(r=o.mergeBox(r,this.getTreeBox(n.children))),a=o.mergeBox(a,i.transformBox(r));return a},getOrderHint:function(e){return[]}}),LayoutCommand=kity.createClass("LayoutCommand",{base:Command,execute:function(e,t){var n=e.getSelectedNodes();n.forEach(function(e){e.layout(t)})},queryValue:function(e){var t=e.getSelectedNode();return t?t.getData("layout"):void 0},queryState:function(e){return e.getSelectedNode()?0:-1}}),ResetLayoutCommand=kity.createClass("ResetLayoutCommand",{base:Command,execute:function(e,t){var n=e.getSelectedNodes();n.length||(n=[e.getRoot()]),n.forEach(function(e){e.traverse(function(e){e.resetLayoutOffset(),e.isRoot()||e.setData("layout",null)})}),e.layout(300)},enableReadOnly:!0});KityMinder.registerModule("LayoutModule",{commands:{layout:LayoutCommand,resetlayout:ResetLayoutCommand},contextmenu:[{command:"resetlayout"},{divider:!0}],commandShortcutKeys:{resetlayout:"Ctrl+Shift+L"}});var cssLikeValueMatcher={left:function(e){return 3 in e&&e[3]||1 in e&&e[1]||e[0]},right:function(e){return 1 in e&&e[1]||e[0]},top:function(e){return e[0]},bottom:function(e){return 2 in e&&e[2]||e[0]}};Utils.extend(KityMinder,{_themes:{},registerTheme:function(e,t){KityMinder._themes[e]=t},getThemeList:function(){return KityMinder._themes}}),kity.extendClass(Minder,{useTheme:function(e){return this.setTheme(e),this.refresh(800),!0},setTheme:function(e){this._theme=e||null,this.getRenderTarget().style.background=this.getStyle("background"),this.fire("themechange",{theme:e})},getTheme:function(e){return this._theme||this.getOptions("defaultTheme")},getThemeItems:function(e){this.getTheme(e);return KityMinder._themes[this.getTheme(e)]},getStyle:function(e,t){var n,i,r,o,a=this.getThemeItems(t);if(e in a)return a[e];if(n=e.split("-"),n.length<2)return null;if(i=n.pop(),e=n.join("-"),e in a){if(r=a[e],Utils.isArray(r)&&(o=cssLikeValueMatcher[i]))return o(r);if(!isNaN(r))return r}return null},getNodeStyle:function(e,t){var n=this.getStyle(e.getType()+"-"+t,e);return null!==n?n:this.getStyle(t,e)}}),kity.extendClass(MinderNode,{getStyle:function(e){return this.getMinder().getNodeStyle(this,e)}}),KityMinder.registerModule("Theme",{defaultOptions:{defaultTheme:"fresh-blue"},commands:{theme:kity.createClass("ThemeCommand",{base:Command,execute:function(e,t){return e.useTheme(t)},queryValue:function(e){return e.getTheme()||"default"}})}}),Minder.registerInit(function(){this.setTheme()}),Utils.extend(KityMinder,{compatibility:function(e){function t(e,n){n(e),e.children&&e.children.forEach(function(e){t(e,n)})}function n(e){t(e,function(e){var t=e.data;delete t.layout_bottom_offset,delete t.layout_default_offset,delete t.layout_filetree_offset})}function i(e){var n=e.data.currentstyle;delete e.data.currentstyle,"bottom"==n?(e.template="structure",e.theme="snow"):"default"==n&&(e.template="default",e.theme="classic"),t(e,function(e){var t=e.data;"PriorityIcon"in t&&(t.priority=t.PriorityIcon,delete t.PriorityIcon),"ProgressIcon"in t&&(t.progress=1+(t.ProgressIcon-1<<1),delete t.ProgressIcon),delete t.point,delete t.layout})}var r=e.version||"1.1.3";switch(r){case"1.1.3":i(e);case"1.2.0":case"1.2.1":n(e)}return e}});var Renderer=KityMinder.Renderer=kity.createClass("Renderer",{constructor:function(e){this.node=e},create:function(e){throw new Error("Not implement: Renderer.create()")},shouldRender:function(e){return!0},watchChange:function(e){var t;t=void 0===this.watchingData?!0:this.watchingData!=e?!0:!1,this.watchingData=e},shouldDraw:function(e){return!0},update:function(e,t,n){return this.shouldDraw()&&this.draw(e,t),this.place(e,t,n)},draw:function(e,t){throw new Error("Not implement: Renderer.draw()")},place:function(e,t,n){throw new Error("Not implement: Renderer.place()")},getRenderShape:function(){return this._renderShape||null},setRenderShape:function(e){this._renderShape=e}});kity.extendClass(Minder,function(){function e(e,t){var n=[];["center","left","right","top","bottom","outline","outside"].forEach(function(e){var i="before"+e,r="after"+e;t[i]&&(n=n.concat(t[i])),t[e]&&(n=n.concat(t[e])),t[r]&&(n=n.concat(t[r]))}),e._renderers=n.map(function(t){return new t(e)})}return{renderNodeBatch:function(t){var n,i,r,o,a=this._rendererClasses,s=[],l=0;if(t.length){for(i=0;i<t.length;i++)o=t[i],o._renderers||e(o,a),o._contentBox=new kity.Box,this.fire("beforerender",{node:o});for(l=t[0]._renderers.length,n=0;l>n;n++){for(i=0;i<t.length;i++)"function"==typeof s[i]&&(s[i]=s[i]()),s[i]instanceof kity.Box||(s[i]=new kity.Box(s[i]));for(i=0;i<t.length;i++)o=t[i],r=o._renderers[n],s[i]&&(o._contentBox=o._contentBox.merge(s[i])),r.shouldRender(o)?(r.getRenderShape()||(r.setRenderShape(r.create(o)),r.bringToBack?o.getRenderContainer().prependShape(r.getRenderShape()):o.getRenderContainer().appendShape(r.getRenderShape())),r.getRenderShape().setVisible(!0),s[i]=r.update(r.getRenderShape(),o,o._contentBox)):r.getRenderShape()&&(r.getRenderShape().setVisible(!1),s[i]=null)}for(i=0;i<t.length;i++)this.fire("noderender",{node:t[i]})}},renderNode:function(t){var n,i=this._rendererClasses;KityMinder.Geometry;t._renderers||e(t,i),this.fire("beforerender",{node:t}),t._contentBox=new kity.Box,t._renderers.forEach(function(e){e.shouldRender(t)?(e.getRenderShape()||(e.setRenderShape(e.create(t)),e.bringToBack?t.getRenderContainer().prependShape(e.getRenderShape()):t.getRenderContainer().appendShape(e.getRenderShape())),e.getRenderShape().setVisible(!0),n=e.update(e.getRenderShape(),t,t._contentBox),"function"==typeof n&&(n=n()),n&&(t._contentBox=t._contentBox.merge(n))):e.getRenderShape()&&e.getRenderShape().setVisible(!1)}),this.fire("noderender",{node:t})}}}()),kity.extendClass(MinderNode,{render:function(){return this.attached?(this.getMinder().renderNode(this),this):void 0},renderTree:function(){if(this.attached){var e=[];return this.traverse(function(t){e.push(t)}),this.getMinder().renderNodeBatch(e),this}},getRenderer:function(e){for(var t=this._renderers,n=0;n<t.length;n++)if(t[n].getType()==e)return t[n];return null},getContentBox:function(){return this.parent&&this.parent.isCollapsed()?new kity.Box:this._contentBox||new kity.Box}}),utils.extend(KityMinder,{_connectProviders:{},_defaultConnectProvider:function(e,t,n){n.setPathData(["M",t.getLayoutVertexOut(),"L",e.getLayoutVertexIn()])},registerConnectProvider:function(e,t){KityMinder._connectProviders[e]=t},getConnectProvider:function(e){return KityMinder._connectProviders[e]||KityMinder._defaultConnectProvider}}),kity.extendClass(MinderNode,{getConnectProvider:function(){return KityMinder.getConnectProvider(this.getConnect())},getConnect:function(){return null},getConnection:function(){return this._connection||null}}),kity.extendClass(Minder,{getConnectContainer:function(){return this._connectContainer},createConnect:function(e){if(!e.isRoot()){var t=new kity.Path;e._connection=t,this._connectContainer.addShape(t),this.updateConnect(e)}},removeConnect:function(e){var t=this;e.traverse(function(e){t._connectContainer.removeShape(e._connection),e._connection=null})},updateConnect:function(e){var t=e._connection,n=e.parent;if(n&&t){if(n.isCollapsed())return void t.setVisible(!1);t.setVisible(!0);var i=e.getConnectProvider(),r=e.getStyle("connect-color")||"white",o=e.getStyle("connect-width")||2;t.stroke(r,o),i(e,n,t,o,r),o%2===0?t.setTranslate(.5,.5):t.setTranslate(0,0)}}}),KityMinder.registerModule("Connect",{init:function(){this._connectContainer=(new kity.Group).setId(KityMinder.uuid("minder_connect_group")),this.getRenderContainer().prependShape(this._connectContainer)},events:{nodeattach:function(e){this.createConnect(e.node)},nodedetach:function(e){this.removeConnect(e.node)},"layoutapply layoutfinish noderender":function(e){this.updateConnect(e.node)}}}),utils.extend(KityMinder,{_templates:{},registerTemplate:function(e,t){KityMinder._templates[e]=t},getTemplateList:function(){return KityMinder._templates}}),kity.extendClass(Minder,function(){var e=Minder.prototype.getTheme;return{useTemplate:function(e,t){this.setTemplate(e),this.refresh(t||800)},getTemplate:function(){return this._template||"default"},setTemplate:function(e){this._template=e||null},getTemplateSupport:function(e){var t=KityMinder._templates[this.getTemplate()];return t&&t[e]},getTheme:function(t){var n=this.getTemplateSupport("getTheme")||e;return n.call(this,t)}}}()),kity.extendClass(MinderNode,function(){var e=MinderNode.prototype.getLayout,t=MinderNode.prototype.getConnect;return{getLayout:function(){var t=this.getMinder().getTemplateSupport("getLayout")||e;return t.call(this,this)},getConnect:function(){var e=this.getMinder().getTemplateSupport("getConnect")||t;return e.call(this,this)}}}()),KityMinder.registerModule("TemplateModule",{commands:{template:kity.createClass("TemplateCommand",{base:Command,execute:function(e,t){e.useTemplate(t),e.execCommand("camera")},queryValue:function(e){return e.getTemplate()||"default"}})}}),kity.extendClass(Minder,{getLang:function(e){var t=KM.LANG[this.getOptions("lang")];if(!t)throw Error("not import language file");e=(e||"").split(".");for(var n,i=0;(n=e[i++])&&(t=t[n],t););if("string"==typeof t){var r=arguments;return t.replace(/\{(\d+)\}/gi,function(e,t){return void 0!=r[+t+1]&&r[+t+1].toString()||e})}return t}}),KM.defaultOptions={zIndex:1e3,lang:"zh-cn",readyOnly:!1},kity.extendClass(Minder,function(){var e="kityminder_preference",t=function(){var e=window.localStorage;return{saveLocalData:function(t,n){return e&&n?(e.setItem(t,n),!0):!1},getLocalData:function(t){return e?e.getItem(t):null},removeItem:function(t){e&&e.removeItem(t)}}}();return{setPreferences:function(n,i){var r={};Utils.isString(n)?r[n]=i:r=n;var o=t.getLocalData(e);o?(o=JSON.parse(o),utils.extend(o,r)):o=r,t.saveLocalData(e,JSON.stringify(o))},getPreferences:function(n){var i=t.getLocalData(e);return i?(i=JSON.parse(i),n?i[n]:i):{}},resetPreferences:function(e){var n=e?JSON.stringify(e):"";t.saveLocalData(n)}}}());var keymap=KityMinder.keymap=function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n],t[n.toLowerCase()]=e[n]);var i=65,r="a".charCodeAt(0);"abcdefghijklmnopqrstuvwxyz".split("").forEach(function(e){t[e]=i+(e.charCodeAt(0)-r)});var o=9;do t[o.toString()]=o+48;while(--o);return t}({Backspace:8,Tab:9,Enter:13,Shift:16,Control:17,Alt:18,CapsLock:20,Esc:27,Spacebar:32,PageUp:33,PageDown:34,End:35,Home:36,Insert:45,Left:37,Up:38,Right:39,Down:40,direction:{37:1,38:1,39:1,40:1},Del:46,NumLock:144,Cmd:91,CmdFF:224,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,"`":192,"=":187,"-":189,"/":191,".":190,controlKeys:{16:1,17:1,18:1,20:1,91:1,224:1},notContentChange:{13:1,9:1,33:1,34:1,35:1,36:1,16:1,17:1,18:1,20:1,91:1,37:1,38:1,39:1,40:1,113:1,114:1,115:1,144:1,27:1},isSelectedNodeKey:{37:1,38:1,39:1,40:1,13:1,9:1}});KityMinder.registerLayout("mind",kity.createClass({base:Layout,doLayout:function(e,t){var n=Math.ceil(e.children.length/2),i=[],r=[];t.forEach(function(e){e.getIndex()<n?i.push(e):r.push(e)});var o=KityMinder.getLayoutInstance("left"),a=KityMinder.getLayoutInstance("right");o.doLayout(e,r),a.doLayout(e,i);var s=e.getContentBox();e.setVertexOut(new kity.Point(s.cx,s.cy)),e.setLayoutVectorOut(new kity.Vector(0,0))},getOrderHint:function(e){var t=[],n=e.getLayoutBox(),i=5;return t.push({type:"up",node:e,area:{x:n.x,y:n.top-e.getStyle("margin-top")-i,width:n.width,height:e.getStyle("margin-top")},path:["M",n.x,n.top-i,"L",n.right,n.top-i]}),t.push({type:"down",node:e,area:{x:n.x,y:n.bottom+i,width:n.width,height:e.getStyle("margin-bottom")},path:["M",n.x,n.bottom+i,"L",n.right,n.bottom+i]}),t}})),[-1,1].forEach(function(e){var t="filetree-"+(e>0?"down":"up");KityMinder.registerLayout(t,kity.createClass({base:Layout,doLayout:function(t,n,i){var r=t.getContentBox(),o=20;if(t.setVertexOut(new kity.Point(r.left+o,e>0?r.bottom:r.top)),t.setLayoutVectorOut(new kity.Vector(0,e)),n.length){n.forEach(function(e){var t=e.getContentBox();e.setLayoutTransform(new kity.Matrix),e.setVertexIn(new kity.Point(t.left,t.cy)),e.setLayoutVectorIn(new kity.Vector(1,0))}),this.align(n,"left"),this.stack(n,"y");var a=0;a+=r.left,a+=o,a+=n[0].getStyle("margin-left");var s=0;e>0?(s+=r.bottom,s+=t.getStyle("margin-bottom"),s+=n[0].getStyle("margin-top")):(s-=this.getTreeBox(n).bottom,s+=r.top,s-=t.getStyle("margin-top"),s-=n[0].getStyle("margin-bottom")),this.move(n,a,s)}},getOrderHint:function(e){var t=[],n=e.getLayoutBox(),i=e.getLevel()>1?3:5;return t.push({type:"up",node:e,area:{x:n.x,y:n.top-e.getStyle("margin-top")-i,width:n.width,height:e.getStyle("margin-top")},path:["M",n.x,n.top-i,"L",n.right,n.top-i]}),t.push({type:"down",node:e,area:{x:n.x,y:n.bottom+i,width:n.width,height:e.getStyle("margin-bottom")},path:["M",n.x,n.bottom+i,"L",n.right,n.bottom+i]}),t}}))});var layouts=["left","right","top","bottom"];layouts.forEach(function(e){function t(e){var t=[],i=e.getLayoutBox(),r=5;return"x"==n?(t.push({type:"up",node:e,area:{x:i.x,y:i.top-e.getStyle("margin-top")-r,width:i.width,height:e.getStyle("margin-top")},path:["M",i.x,i.top-r,"L",i.right,i.top-r]}),t.push({type:"down",node:e,area:{x:i.x,y:i.bottom+r,width:i.width,height:e.getStyle("margin-bottom")},path:["M",i.x,i.bottom+r,"L",i.right,i.bottom+r]})):(t.push({type:"up",node:e,area:{x:i.left-e.getStyle("margin-left")-r,y:i.top,width:e.getStyle("margin-left"),height:i.height},path:["M",i.left-r,i.top,"L",i.left-r,i.bottom]}),t.push({type:"down",node:e,area:{x:i.right+r,y:i.top,width:e.getStyle("margin-right"),height:i.height},path:["M",i.right+r,i.top,"L",i.right+r,i.bottom]})),t}var n="left"==e||"right"==e?"x":"y",i="left"==e||"top"==e?-1:1,r={left:"right",right:"left",top:"bottom",bottom:"top",x:"y",y:"x"};KityMinder.registerLayout(e,kity.createClass({base:Layout,doLayout:function(t,o){var a=t.getContentBox();if("x"==n?(t.setVertexOut(new kity.Point(a[e],a.cy)),t.setLayoutVectorOut(new kity.Vector(i,0))):(t.setVertexOut(new kity.Point(a.cx,a[e])),t.setLayoutVectorOut(new kity.Vector(0,i))),!o.length)return!1;o.forEach(function(t){var o=t.getContentBox();t.setLayoutTransform(new kity.Matrix),"x"==n?(t.setVertexIn(new kity.Point(o[r[e]],o.cy)),t.setLayoutVectorIn(new kity.Vector(i,0))):(t.setVertexIn(new kity.Point(o.cx,o[r[e]])),t.setLayoutVectorIn(new kity.Vector(0,i)))}),this.align(o,r[e]),this.stack(o,r[n]);var s,l,u=this.getBranchBox(o);"x"==n?(s=a[e],s+=i*t.getStyle("margin-"+e),s+=i*o[0].getStyle("margin-"+r[e]),l=a.bottom,l-=a.height/2,l-=u.height/2,l-=u.y):(s=a.right,s-=a.width/2,s-=u.width/2,s-=u.x,l=a[e],l+=i*t.getStyle("margin-"+e),l+=i*o[0].getStyle("margin-"+r[e])),this.move(o,s,l)},getOrderHint:t}))}),KityMinder.registerLayout("fish-bone-master",kity.createClass("FishBoneMasterLayout",{base:Layout,doLayout:function(e,t,n){var i=[],r=[],o=t[0],a=e.getContentBox();if(e.setVertexOut(new kity.Point(a.right,a.cy)),e.setLayoutVectorOut(new kity.Vector(1,0)),o){var s=(o.getContentBox(),e.getStyle("margin-right")),l=o.getStyle("margin-left"),u=o.getStyle("margin-top"),c=o.getStyle("margin-bottom");t.forEach(function(e,t){e.setLayoutTransform(new kity.Matrix);var n=e.getContentBox();t%2?(r.push(e),e.setVertexIn(new kity.Point(n.left,n.top)),e.setLayoutVectorIn(new kity.Vector(1,1))):(i.push(e),e.setVertexIn(new kity.Point(n.left,n.bottom)),e.setLayoutVectorIn(new kity.Vector(1,-1)))}),this.stack(i,"x"),this.stack(r,"x"),this.align(i,"bottom"),this.align(r,"top");var h=a.right+s+l,d=a.cy-c-e.getStyle("margin-top"),f=a.cy+u+e.getStyle("margin-bottom");this.move(i,h,d),this.move(r,h+l,f)}}})),KityMinder.registerLayout("fish-bone-slave",kity.createClass("FishBoneSlaveLayout",{base:Layout,doLayout:function(e,t,n){var i=this,r=Math.abs,o=.382,a=e.getContentBox(),s=e.getLayoutVectorIn();e.setLayoutVectorOut(s);var l=a.left+a.width*o,u=new kity.Point(l,s.y>0?a.bottom:a.top);e.setVertexOut(u);var c=t[0];if(c){var h=c.getContentBox();t.forEach(function(e,t){e.setLayoutTransform(new kity.Matrix),e.setLayoutVectorIn(new kity.Vector(1,0)),e.setVertexIn(new kity.Point(h.left,h.cy))}),this.stack(t,"y"),this.align(t,"left");var d=0,f=0;d+=u.x,e.getLayoutVectorOut().y<0?(f-=this.getTreeBox(t).bottom,f+=e.getContentBox().top,f-=e.getStyle("margin-top"),f-=c.getStyle("margin-bottom")):(f+=e.getContentBox().bottom,f+=e.getStyle("margin-bottom"),f+=c.getStyle("margin-top")),this.move(t,d,f),2==n&&t.forEach(function(e){var t=e.getLayoutTransform(),n=e.getContentBox(),o=t.transformPoint(new kity.Point(n.left,0));i.move([e],r(o.y-u.y),0)})}}})),KityMinder.registerLayout("tianpan",kity.createClass({base:Layout,doLayout:function(e,t){if(0!=t.length){var n,i,r,o=this,a=e.getContentBox(),s=5,l=Math.max(a.width,50);t.forEach(function(e,t){e.setLayoutTransform(new kity.Matrix),r=o.getTreeBox(e),l=Math.max(Math.max(r.width,r.height),l)}),l=l/1.5/Math.PI,t.forEach(function(e,t){n=l*(Math.cos(s)+Math.sin(s)*s),i=l*(Math.sin(s)-Math.cos(s)*s),s+=.9-.02*t,e.setLayoutVectorIn(new kity.Vector(1,0)),e.setVertexIn(new kity.Point(a.cx,a.cy)),e.setLayoutTransform(new kity.Matrix),o.move([e],n,i)})}},getOrderHint:function(e){var t=[],n=e.getLayoutBox(),i=5;return t.push({type:"up",node:e,area:{x:n.x,y:n.top-e.getStyle("margin-top")-i,width:n.width,height:e.getStyle("margin-top")},path:["M",n.x,n.top-i,"L",n.right,n.top-i]}),t.push({type:"down",node:e,area:{x:n.x,y:n.bottom+i,width:n.width,height:e.getStyle("margin-bottom")},path:["M",n.x,n.bottom+i,"L",n.right,n.bottom+i]}),t}})),KityMinder.registerConnectProvider("bezier",function(e,t,n){var i=t.getLayoutVertexOut(),r=e.getLayoutVertexIn(),o=t.getLayoutVectorOut().normalize(),a=Math.round,s=Math.abs,l=[];if(l.push("M",a(i.x),a(i.y)),s(o.x)>s(o.y)){var u=(r.x+i.x)/2;l.push("C",u,i.y,u,r.y,r.x,r.y)}else{var c=(r.y+i.y)/2;l.push("C",i.x,c,r.x,c,r.x,r.y)}n.setMarker(null),n.setPathData(l)}),KityMinder.registerConnectProvider("poly",function(e,t,n,i){var r=t.getLayoutVertexOut(),o=e.getLayoutVertexIn(),a=t.getLayoutVectorOut().normalize(),s=Math.round,l=Math.abs,u=[];switch(u.push("M",s(r.x),s(r.y)),!0){case l(a.x)>l(a.y)&&a.x<0:u.push("h",-t.getStyle("margin-left")),u.push("v",o.y-r.y),u.push("H",o.x);break;case l(a.x)>l(a.y)&&a.x>=0:u.push("h",t.getStyle("margin-right")),u.push("v",o.y-r.y),u.push("H",o.x);break;case l(a.x)<=l(a.y)&&a.y<0:u.push("v",-t.getStyle("margin-top")),u.push("h",o.x-r.x),u.push("V",o.y);break;case l(a.x)<=l(a.y)&&a.y>=0:u.push("v",t.getStyle("margin-bottom")),u.push("h",o.x-r.x),u.push("V",o.y)}n.setMarker(null),n.setPathData(u)});var connectMarker=(new kity.Marker).pipe(function(){var e=7,t=new kity.Circle(e-1);this.addShape(t),this.setRef(e-1,0).setViewBox(-e,-e,e+e,e+e).setWidth(e).setHeight(e),this.dot=t,this.node.setAttribute("markerUnits","userSpaceOnUse")});KityMinder.registerConnectProvider("arc",function(e,t,n,i,r){var o,a,s,l=e.getLayoutBox(),u=t.getLayoutBox(),c=Math.abs,h=[],d=l.x>u.x?"right":"left";e.getMinder().getPaper().addResource(connectMarker),o=new kity.Point(u.cx,u.cy),a="left"==d?new kity.Point(l.right+2,l.cy):new kity.Point(l.left-2,l.cy),s=kity.Vector.fromPoints(o,a),h.push("M",o),h.push("A",c(s.x),c(s.y),0,0,s.x*s.y>0?0:1,a),n.setMarker(connectMarker),connectMarker.dot.fill(r),n.setPathData(h)}),KityMinder.registerConnectProvider("under",function(e,t,n,i,r){var o,a,s,l,u=e.getLayoutBox(),c=t.getLayoutBox(),h=(Math.abs,[]),d=u.x>c.x?"right":"left",f=(e.getStyle("connect-radius"),u.bottom+3),p="sub"==t.getType()?c.bottom+3:c.cy;"right"==d?(o=new kity.Point(c.right,p),a=new kity.Point(u.left-10,f),s=new kity.Point(u.right,f)):(o=new kity.Point(c.left,p),a=new kity.Point(u.right+10,f),s=new kity.Point(u.left,f)),l=(o.x+a.x)/2,h.push("M",o),h.push("C",l,o.y,l,a.y,a),h.push("L",s),n.setMarker(null),n.setPathData(h)}),KityMinder.registerConnectProvider("l",function(e,t,n){var i=t.getLayoutVertexOut(),r=e.getLayoutVertexIn(),o=t.getLayoutVectorOut(),a=[],s=Math.round,l=Math.abs;a.push("M",i.round()),
l(o.x)>l(o.y)?a.push("H",s(r.x)):a.push("V",r.y),a.push("L",r),n.setPathData(a)}),KityMinder.registerConnectProvider("fish-bone-master",function(e,t,n){var i=t.getLayoutVertexOut(),r=e.getLayoutVertexIn(),o=Math.abs,a=o(i.y-r.y),s=o(i.x-r.x),l=[];l.push("M",i.x,i.y),l.push("h",s-a),l.push("L",r.x,r.y),n.setMarker(null),n.setPathData(l)});var connectMarker=(new kity.Marker).pipe(function(){var e=7,t=new kity.Circle(e-1);this.addShape(t),this.setRef(e-1,0).setViewBox(-e,-e,e+e,e+e).setWidth(e).setHeight(e),this.dot=t,this.node.setAttribute("markerUnits","userSpaceOnUse")});KityMinder.registerConnectProvider("arc_tp",function(e,t,n,i,r){var o=e.getLayoutBox(),a=t.getLayoutBox();if(e.getIndex()>0){var s=e.getIndex();a=t.getChildren()[s-1].getLayoutBox()}var l,u,c,h=(Math.abs,[]);o.x>a.x?"right":"left";e.getMinder().getPaper().addResource(connectMarker),l=new kity.Point(a.cx,a.cy),u=new kity.Point(o.cx,o.cy);var d=Math.sqrt(Math.abs(l.x-u.x)*Math.abs(l.x-u.x)+Math.abs(l.y-u.y)*Math.abs(l.y-u.y));d=0==e.getIndex()?.4*d:d,c=kity.Vector.fromPoints(l,u),h.push("M",l),h.push("A",d,d,0,0,1,u),n.setMarker(connectMarker),connectMarker.dot.fill(r),n.setPathData(h)}),["classic","classic-compact"].forEach(function(e){var t="classic-compact"==e;KityMinder.registerTheme(e,{background:"#3A4144 url(ui/theme/default/images/grid.png) repeat","root-color":"#430","root-background":"#e9df98","root-stroke":"#e9df98","root-font-size":24,"root-padding":t?[10,25]:[15,25],"root-margin":t?[15,25]:[30,100],"root-radius":30,"root-space":10,"root-shadow":"rgba(0, 0, 0, .25)","main-color":"#333","main-background":"#a4c5c0","main-stroke":"#a4c5c0","main-font-size":16,"main-padding":t?[5,15]:[6,20],"main-margin":t?[5,10]:20,"main-radius":10,"main-space":5,"main-shadow":"rgba(0, 0, 0, .25)","sub-color":"white","sub-background":"transparent","sub-stroke":"none","sub-font-size":12,"sub-padding":[5,10],"sub-margin":t?[5,10]:[15,20],"sub-tree-margin":30,"sub-radius":5,"sub-space":5,"connect-color":"white","connect-width":2,"main-connect-width":3,"connect-radius":5,"selected-background":"rgb(254, 219, 0)","selected-stroke":"rgb(254, 219, 0)","selected-color":"black","marquee-background":"rgba(255,255,255,.3)","marquee-stroke":"white","drop-hint-color":"yellow","sub-drop-hint-width":2,"main-drop-hint-width":4,"root-drop-hint-width":4,"order-hint-area-color":"rgba(0, 255, 0, .5)","order-hint-path-color":"#0f0","order-hint-path-width":1,"text-selection-color":"rgb(27,171,255)","line-height":1.5})}),["snow","snow-compact"].forEach(function(e){var t="snow-compact"==e;KityMinder.registerTheme(e,{background:"#3A4144 url(ui/theme/default/images/grid.png) repeat","root-color":"#430","root-background":"#e9df98","root-stroke":"#e9df98","root-font-size":24,"root-padding":t?[5,10]:[15,25],"root-margin":t?15:30,"root-radius":5,"root-space":10,"root-shadow":"rgba(0, 0, 0, .25)","main-color":"#333","main-background":"#a4c5c0","main-stroke":"#a4c5c0","main-font-size":16,"main-padding":t?[4,10]:[6,20],"main-margin":t?[5,10]:[20,40],"main-radius":5,"main-space":5,"main-shadow":"rgba(0, 0, 0, .25)","sub-color":"black","sub-background":"white","sub-stroke":"white","sub-font-size":12,"sub-padding":[5,10],"sub-margin":t?[5,10]:[10,20],"sub-radius":5,"sub-space":5,"connect-color":"white","connect-width":2,"main-connect-width":3,"connect-radius":5,"selected-background":"rgb(254, 219, 0)","selected-stroke":"rgb(254, 219, 0)","marquee-background":"rgba(255,255,255,.3)","marquee-stroke":"white","drop-hint-color":"yellow","drop-hint-width":4,"order-hint-area-color":"rgba(0, 255, 0, .5)","order-hint-path-color":"#0f0","order-hint-path-width":1,"text-selection-color":"rgb(27,171,255)","line-height":1.5})}),function(){function e(e,t,n){return kity.Color.createHSL(e,t,n)}function t(t,n){return{background:"#fbfbfb","root-color":"white","root-background":e(t,37,60),"root-stroke":e(t,37,60),"root-font-size":16,"root-padding":n?[6,12]:[12,24],"root-margin":n?10:[30,100],"root-radius":5,"root-space":10,"main-color":"black","main-background":e(t,33,95),"main-stroke":e(t,37,60),"main-stroke-width":1,"main-font-size":14,"main-padding":[6,20],"main-margin":n?8:20,"main-radius":3,"main-space":5,"sub-color":"black","sub-background":"transparent","sub-stroke":"none","sub-font-size":12,"sub-padding":n?[3,5]:[5,10],"sub-margin":n?[4,8]:[15,20],"sub-radius":5,"sub-space":5,"connect-color":e(t,37,60),"connect-width":1,"connect-radius":5,"selected-stroke":e(t,26,30),"selected-stroke-width":"3","marquee-background":e(t,100,80).set("a",.1),"marquee-stroke":e(t,37,60),"drop-hint-color":e(t,26,35),"drop-hint-width":5,"order-hint-area-color":e(t,100,30).set("a",.5),"order-hint-path-color":e(t,100,25),"order-hint-path-width":1,"text-selection-color":e(t,100,20),"line-height":1.5}}var n,i={red:0,soil:25,green:122,blue:204,purple:246,pink:334};for(n in i)KityMinder.registerTheme("fresh-"+n,t(i[n])),KityMinder.registerTheme("fresh-"+n+"-compat",t(i[n],!0))}(),KityMinder.registerTheme("fish",{background:"#3A4144 url(ui/theme/default/images/grid.png) repeat","root-color":"#430","root-background":"#e9df98","root-stroke":"#e9df98","root-font-size":24,"root-padding":[35,35],"root-margin":30,"root-radius":100,"root-space":10,"root-shadow":"rgba(0, 0, 0, .25)","main-color":"#333","main-background":"#a4c5c0","main-stroke":"#a4c5c0","main-font-size":16,"main-padding":[6,20],"main-margin":[20,20],"main-radius":5,"main-space":5,"main-shadow":"rgba(0, 0, 0, .25)","sub-color":"black","sub-background":"white","sub-stroke":"white","sub-font-size":12,"sub-padding":[5,10],"sub-margin":[10],"sub-radius":5,"sub-space":5,"connect-color":"white","connect-width":3,"main-connect-width":3,"connect-radius":5,"selected-background":"rgb(254, 219, 0)","selected-stroke":"rgb(254, 219, 0)","marquee-background":"rgba(255,255,255,.3)","marquee-stroke":"white","drop-hint-color":"yellow","drop-hint-width":4,"order-hint-area-color":"rgba(0, 255, 0, .5)","order-hint-path-color":"#0f0","order-hint-path-width":1,"text-selection-color":"rgb(27,171,255)","line-height":1.5}),KityMinder.registerTheme("wire",{background:"black",color:"#999",stroke:"none",padding:10,margin:20,"font-size":14,"connect-color":"#999","connect-width":1,"selected-background":"#999","selected-color":"black","marquee-background":"rgba(255,255,255,.3)","marquee-stroke":"white","drop-hint-color":"yellow","sub-drop-hint-width":2,"main-drop-hint-width":4,"root-drop-hint-width":4,"order-hint-area-color":"rgba(0, 255, 0, .5)","order-hint-path-color":"#0f0","order-hint-path-width":1,"text-selection-color":"rgb(27,171,255)","line-height":1.5}),["tianpan","tianpan-compact"].forEach(function(e){var t="tianpan-compact"==e;KityMinder.registerTheme(e,{background:"#3A4144 url(ui/theme/default/images/grid.png) repeat","root-color":"#430","root-background":"#e9df98","root-stroke":"#e9df98","root-font-size":25,"root-padding":t?15:20,"root-margin":t?[15,25]:100,"root-radius":30,"root-space":10,"root-shadow":"rgba(0, 0, 0, .25)","root-shape":"circle","main-color":"#333","main-background":"#a4c5c0","main-stroke":"#a4c5c0","main-font-size":15,"main-padding":t?10:12,"main-margin":t?10:12,"main-radius":10,"main-space":5,"main-shadow":"rgba(0, 0, 0, .25)","main-shape":"circle","sub-color":"#333","sub-background":"#99ca6a","sub-stroke":"#a4c5c0","sub-font-size":13,"sub-padding":5,"sub-margin":t?6:10,"sub-tree-margin":30,"sub-radius":5,"sub-space":5,"sub-shadow":"rgba(0, 0, 0, .25)","sub-shape":"circle","connect-color":"white","connect-width":2,"main-connect-width":3,"connect-radius":5,"selected-background":"rgb(254, 219, 0)","selected-stroke":"rgb(254, 219, 0)","selected-color":"black","marquee-background":"rgba(255,255,255,.3)","marquee-stroke":"white","drop-hint-color":"yellow","sub-drop-hint-width":2,"main-drop-hint-width":4,"root-drop-hint-width":4,"order-hint-area-color":"rgba(0, 255, 0, .5)","order-hint-path-color":"#0f0","order-hint-path-width":1,"text-selection-color":"rgb(27,171,255)","line-height":1.4})}),KityMinder.registerTemplate("default",{getLayout:function(e){if(e.getData("layout"))return e.getData("layout");var t=e.getLevel();return 0===t?"mind":1===t?e.getLayoutPointPreview().x>0?"right":"left":e.parent.getLayout()},getConnect:function(e){return 1==e.getLevel()?"arc":"under"}}),KityMinder.registerTemplate("structure",{getLayout:function(e){return e.getData("layout")||"bottom"},getConnect:function(e){return"poly"}}),KityMinder.registerTemplate("filetree",{getLayout:function(e){return e.getData("layout")?e.getData("layout"):e.isRoot()?"bottom":"filetree-down"},getConnect:function(e){return 1==e.getLevel()?"poly":"l"}}),KityMinder.registerTemplate("right",{getLayout:function(e){return e.getData("layout")||"right"},getConnect:function(e){return 1==e.getLevel()?"arc":"bezier"}}),KityMinder.registerTemplate("fish-bone",{getLayout:function(e){if(e.getData("layout"))return e.getData("layout");var t=e.getLevel();return 0===t?"fish-bone-master":1===t?"fish-bone-slave":e.getLayoutPointPreview().y>0?"filetree-up":"filetree-down"},getConnect:function(e){switch(e.getLevel()){case 1:return"fish-bone-master";case 2:return"line";default:return"l"}}}),KityMinder.registerTemplate("tianpan",{getLayout:function(e){if(e.getData("layout"))return e.getData("layout");var t=e.getLevel();return 0===t?"tianpan":e.parent.getLayout()},getConnect:function(e){return"arc_tp"}});var AppendChildCommand=kity.createClass("AppendChildCommand",{base:Command,execute:function(e,t){var n=e.getSelectedNode();if(!n)return null;t=t||e.getLang("topic"),n.expand();var i=e.createNode(t,n);e.select(i,!0),i.render(),e.layout(600)},queryState:function(e){var t=e.getSelectedNode();return t?0:-1}}),AppendSiblingCommand=kity.createClass("AppendSiblingCommand",{base:Command,execute:function(e,t){var n=e.getSelectedNode(),i=n.parent;if(!i)return e.execCommand("AppendChildNode",t);t=t||e.getLang("topic");var r=e.createNode(t,i,n.getIndex()+1);e.select(r,!0),r.render(),e.layout(600)},queryState:function(e){var t=e.getSelectedNode();return t?0:-1}}),RemoveNodeCommand=kity.createClass("RemoverNodeCommand",{base:Command,execute:function(e,t){var n=e.getSelectedNodes(),i=MinderNode.getCommonAncestor.apply(null,n);n.forEach(function(t){t.isRoot()||e.removeNode(t)}),e.select(i||e.getRoot(),!0),e.layout(600)},queryState:function(e){var t=e.getSelectedNode();return t?0:-1}}),EditNodeCommand=kity.createClass("EditNodeCommand",{base:Command,execute:function(e){var t=e.getSelectedNode();return t?(e.select(t,!0),void e.textEditNode(t)):null},queryState:function(e){var t=e.getSelectedNode();return t?0:-1},isNeedUndo:function(){return!1}}),$importDialog,$exportDialog,ImportTextNode=kity.createClass("ImportTextNode",{base:Command,execute:function(e,t){function n(e){var t;if(e)try{a=i.decode(e,!0)}catch(n){t="文本格式解析错误. "+n.message}else t="内容不能为空";t?(s.addClass("validate-error"),u.text(t),l.disable()):(s.removeClass("validate-error"),u.text(""),l.enable())}if(!$importDialog){var i=e.getProtocol("plain"),r=400;$importDialog=new FUI.Dialog({width:600,height:r,prompt:!0,caption:e.getLang("ui.importtextnode")}).appendTo(document.getElementById("content-wrapper"));var o=$($importDialog.getBodyElement());o.html(['<textarea style="width: 100%; height: '+(r-130)+'px"></textarea>'].join(""));var a,s=o.find("textarea"),l=$importDialog.getButton(0),u=$('<span class="validate-error"></span>');s.after(u),s.on("input",function(){n(s.val())}),s.on("keydown keyup",function(e){if(9===e.keyCode&&"keydown"===e.type){e.preventDefault();var t=this.selectionStart;this.value=this.value.substring(0,this.selectionStart)+"	"+this.value.substring(this.selectionEnd),this.selectionEnd=t+1}(13!==e.keyCode||e.shiftKey)&&e.stopPropagation()}),$importDialog.on("open",function(){n(s.val()),setTimeout(function(){s[0].focus()},10)}),$importDialog.on("ok",function(){function t(n,i,r){if(n&&i){var o=e.createNode(i.data.text,n);return i.children&&i.children.forEach(function(e){t(o,e)}),o.render(),o}}var n=[],i=e.getSelectedNode();a&&a.children&&i&&(i.expand(),a.children.forEach(function(e){n.push(t(i,e))})),e.select(n,!0),e.layout(300),s.val(""),n=null,a=null})}$importDialog.open()},queryState:function(e){var t=e.getSelectedNode();return t?0:-1}}),ExportTextNode=kity.createClass("ExportTextNode",{base:Command,execute:function(e,t){if(!$exportDialog){var n=e.getProtocol("plain"),i=400;$exportDialog=new FUI.Dialog({width:600,height:i,prompt:!0,caption:e.getLang("ui.exporttextnode")}).appendTo(document.getElementById("content-wrapper"));var r=$($exportDialog.getBodyElement());r.html(['<textarea style="width: 100%; height: '+(i-130)+'px"></textarea>'].join(""));var o=r.find("textarea");o.on("keydown keyup",function(e){if(9===e.keyCode&&"keydown"===e.type){e.preventDefault();var t=this.selectionStart;this.value=this.value.substring(0,this.selectionStart)+"	"+this.value.substring(this.selectionEnd),this.selectionEnd=t+1}(13!==e.keyCode||e.shiftKey)&&e.stopPropagation()}),$exportDialog.on("open",function(){o.val(n.encode(e.getSelectedNode())),setTimeout(function(){o[0].focus()},10)})}$exportDialog.open()},queryState:function(e){var t=e.getSelectedNode();return t?0:-1}});KityMinder.registerModule("NodeModule",function(){return{commands:{AppendChildNode:AppendChildCommand,AppendSiblingNode:AppendSiblingCommand,ImportTextNode:ImportTextNode,ExportTextNode:ExportTextNode,RemoveNode:RemoveNodeCommand,EditNode:EditNodeCommand},contextmenu:[{command:"appendsiblingnode"},{command:"appendchildnode"},{command:"editnode"},{command:"removenode"},{command:"importtextnode"},{command:"exporttextnode"},{divider:1}],commandShortcutKeys:{appendsiblingnode:"normal::Enter",appendchildnode:"normal::Insert|Tab",editnode:"normal::F2",removenode:"normal::Del|Backspace"}}});var FONT_ADJUST={"微软雅黑,Microsoft YaHei":-.15,"arial black,avant garde":-.17,"default":-.15},TextRenderer=KityMinder.TextRenderer=kity.createClass("TextRenderer",{base:Renderer,create:function(){return(new kity.Group).setId(KityMinder.uuid("node_text"))},update:function(e,t){function n(e){return t.getData(e)||t.getStyle(e)}var i=t.getText(!0),r=t.getStyle("line-height"),o=n("font-size"),a=n("font-family")||"default",s=r*o*i.length-(r-1)*o,l=-s/2,u=FONT_ADJUST[a]||0;e.setTranslate(0,u*o);var c=new kity.Box,h=Math.round;this.setTextStyle(t,e);var d=i.length,f=e.getItems().length;if(f>d)for(var p,g=d;p=e.getItem(g);)e.removeItem(g);else if(d>f)for(var m=d-f,g=0;m>g;g++){var v=(new kity.Text).setAttr("text-rendering","inherit");kity.Browser.ie?v.setVerticalAlign("top"):v.setAttr("dominant-baseline","text-before-edge"),e.addItem(v)}for(var y,v,g=0;y=i[g],v=e.getItem(g);g++)v.setContent(y);this.setTextStyle(t,e);var _=t.getText()+[n("font-size"),n("font-name"),n("font-weight"),n("font-style")].join("/");return t._currentTextHash==_&&t._currentTextGroupBox?t._currentTextGroupBox:(t._currentTextHash=_,function(){e.eachItem(function(e,t){var n=l+e*o*r;t.setY(n),c=c.merge(new kity.Box(0,n,t.getBoundaryBox().width||1,o))});var n=0,i=t.getStyle("shape");i&&"circle"==i&&(n=Math.max(c.width,c.height)/2-c.height/2);var a=new kity.Box(h(c.x),h(c.y-n),h(c.width),h(c.height));return t._currentTextGroupBox=a,a})},setTextStyle:function(e,t){var n=TextRenderer._styleHooks;n.forEach(function(n){n(e,t)})}});utils.extend(TextRenderer,{_styleHooks:[],registerStyleHook:function(e){TextRenderer._styleHooks.push(e)}}),kity.extendClass(MinderNode,{getTextGroup:function(){return this.getRenderer("TextRenderer").getRenderShape()}}),KityMinder.registerModule("text",{renderers:{center:TextRenderer}}),KityMinder.registerModule("Expand",function(){var e=this,t="expandState",n="expand",i="collapse";kity.extendClass(MinderNode,{expand:function(){return this.setData(t,n),this},collapse:function(){return this.setData(t,i),this},isExpanded:function(){var e=this.getData(t)!==i;return e&&(this.isRoot()||this.parent.isExpanded())},isCollapsed:function(){return!this.isExpanded()}});var r=kity.createClass("ExpandCommand",{base:Command,execute:function(e,t){var n=e.getSelectedNode();if(n){for(t&&(n=n.parent);n.parent;)n.expand(),n=n.parent;n.renderTree(),e.layout(100)}},queryState:function(e){return e.getSelectedNode()?0:-1}}),o=kity.createClass("ExpandToLevelCommand",{base:Command,execute:function(e,t){e.getRoot().traverse(function(e){e.getLevel()<t&&e.expand(),e.getLevel()==t&&e.collapse()}),e.refresh(100)},enableReadOnly:!0}),a=kity.createClass("Expander",{base:kity.Group,constructor:function(e){this.callBase(),this.radius=6,this.outline=new kity.Circle(this.radius).stroke("gray").fill("white"),this.sign=(new kity.Path).stroke("gray"),this.addShapes([this.outline,this.sign]),this.initEvent(e),this.setId(KityMinder.uuid("node_expander")),this.setStyle("cursor","pointer")},initEvent:function(e){this.on("mousedown",function(t){e.isExpanded()?e.collapse():e.expand(),e.renderTree().getMinder().layout(100),e.getMinder().fire("contentchange"),t.stopPropagation(),t.preventDefault()}),this.on("dblclick click mouseup",function(e){e.stopPropagation(),e.preventDefault()})},setState:function(e){if("hide"==e)return void this.setVisible(!1);this.setVisible(!0);var t=["M",1.5-this.radius,0,"L",this.radius-1.5,0];e==i&&t.push(["M",0,1.5-this.radius,"L",0,this.radius-1.5]),this.sign.setPathData(t)}}),s=kity.createClass("ExpanderRenderer",{base:Renderer,create:function(e){return e.isRoot()?void 0:(this.expander=new a(e),e.getRenderContainer().prependShape(this.expander),e.expanderRenderer=this,this.node=e,this.expander)},shouldRender:function(e){return!e.isRoot()},update:function(e,n,i){if(n.parent){var r=n.parent.isExpanded();e.setState(r&&n.children.length?n.getData(t):"hide");var o=n.getLayoutVectorIn().normalize(e.radius+n.getStyle("stroke-width")),a=n.getVertexIn().offset(o.reverse());this.expander.setTranslate(a)}}});return{commands:{expand:r,expandtolevel:o},events:{layoutapply:function(e){var t=e.node.getRenderer("ExpanderRenderer");t.getRenderShape()&&t.update(t.getRenderShape(),e.node)},beforerender:function(e){var t=e.node,n=!t.parent||t.parent.isExpanded();t.getRenderContainer().setVisible(n),n||e.stopPropagation()},"normal.keydown":function(e){if("textedit"!=this.getStatus()){if(e.originEvent.keyCode==keymap["/"]){var t=this.getSelectedNode();if(!t||t==this.getRoot())return;var n=t.isExpanded();this.getSelectedNodes().forEach(function(e){n?e.collapse():e.expand(),e.renderTree()}),this.layout(100),this.fire("contentchange"),e.preventDefault(),e.stopPropagationImmediately()}e.isShortcutKey("Alt+`")&&this.execCommand("expandtolevel",9999);for(var i=1;6>i;i++)e.isShortcutKey("Alt+"+i)&&this.execCommand("expandtolevel",i)}}},renderers:{outside:s},contextmenu:[{command:"expandtoleaf",query:function(){return!e.getSelectedNode()},fn:function(e){e.execCommand("expandtolevel",9999)}},{command:"expandtolevel1",query:function(){return!e.getSelectedNode()},fn:function(e){e.execCommand("expandtolevel",1)}},{command:"expandtolevel2",query:function(){return!e.getSelectedNode()},fn:function(e){e.execCommand("expandtolevel",2)}},{command:"expandtolevel3",query:function(){return!e.getSelectedNode()},fn:function(e){e.execCommand("expandtolevel",3)}},{divider:!0}]}});var OutlineRenderer=kity.createClass("OutlineRenderer",{base:Renderer,create:function(e){var t=(new kity.Rect).setId(KityMinder.uuid("node_outline"));return this.bringToBack=!0,t},update:function(e,t,n){var i=t.getStyle("shape");if(i&&"circle"==i)return updateCircle(e,t,n);var r=t.getStyle("padding-left"),o=t.getStyle("padding-right"),a=t.getStyle("padding-top"),s=t.getStyle("padding-bottom"),l={x:n.x-r,y:n.y-a,width:n.width+r+o,height:n.height+a+s},u=t.isSelected()?"selected-":"";return e.setPosition(l.x,l.y).setSize(l.width,l.height).setRadius(t.getStyle("radius")).fill(t.getData("background")||t.getStyle(u+"background")||t.getStyle("background")).stroke(t.getStyle(u+"stroke"||t.getStyle("stroke")),t.getStyle(u+"stroke-width")),new kity.Box(l)}}),ShadowRenderer=kity.createClass("ShadowRenderer",{base:Renderer,create:function(e){return this.bringToBack=!0,new kity.Rect},shouldRender:function(e){return e.getStyle("shadow")},update:function(e,t,n){e.setPosition(n.x+4,n.y+5).fill(t.getStyle("shadow"));var i=t.getStyle("shape");if(i){if("circle"==i){var r=Math.max(n.width,n.height);e.setSize(r,r),e.setRadius(r/2)}}else e.setSize(n.width,n.height),e.setRadius(t.getStyle("radius"))}}),marker=new kity.Marker;marker.setWidth(10),marker.setHeight(12),marker.setRef(0,0),marker.setViewBox(-6,-4,8,10),marker.addShape((new kity.Path).setPathData("M-5-3l5,3,-5,3").stroke("#33ffff"));var wireframeOption=/wire/.test(window.location.href),WireframeRenderer=kity.createClass("WireframeRenderer",{base:Renderer,create:function(){var e=new kity.Group,t=this.oxy=(new kity.Path).stroke("#f6f").setPathData("M0,-50L0,50M-50,0L50,0"),n=this.wireframe=(new kity.Rect).stroke("lightgreen"),i=this.vectorIn=(new kity.Path).stroke("#66ffff"),r=this.vectorOut=(new kity.Path).stroke("#66ffff");return i.setMarker(marker,"end"),r.setMarker(marker,"end"),e.addShapes([t,n,i,r])},shouldRender:function(){return wireframeOption},update:function(e,t,n){this.wireframe.setPosition(n.x,n.y).setSize(n.width,n.height);var i=t.getVertexIn(),r=t.getVertexOut(),o=t.getLayoutVectorIn().normalize(30),a=t.getLayoutVectorOut().normalize(30);this.vectorIn.setPathData(["M",i.offset(o.reverse()),"L",i]),this.vectorOut.setPathData(["M",r,"l",a])}});KityMinder.registerModule("OutlineModule",function(){return{events:wireframeOption?{ready:function(){this.getPaper().addResource(marker)},layoutallfinish:function(){this.getRoot().traverse(function(e){e.getRenderer("WireframeRenderer").update(null,e,e.getContentBox())})}}:null,renderers:{outline:OutlineRenderer,outside:[ShadowRenderer,WireframeRenderer]}}}),KityMinder.Geometry=function(){function e(e){return e.width=e.right-e.left,e.height=e.bottom-e.top,e.x=e.left,e.y=e.top,e.cx=e.x+e.width/2,e.cy=e.y+e.height/2,e}function t(e){"x"in e&&(e.left=e.x,e.right=e.x+e.width,e.top=e.y,e.bottom=e.y+e.height)}var n={},i=Math.min,r=Math.max,o=(Math.abs,Object.prototype.hasOwnProperty);return n.isNumberInRange=function(e,t){return e>t[0]&&e<t[1]},n.getDistance=function(e,t){return kity.Vector.fromPoints(e,t).length()},n.wrapBox=e,n.getBox=function(t,n){return e({left:i(t.x,n.x),right:r(t.x,n.x),top:i(t.y,n.y),bottom:r(t.y,n.y)})},n.mergeBox=function(n,o){return t(n),t(o),e({left:i(n.left,o.left),right:r(n.right,o.right),top:i(n.top,o.top),bottom:r(n.bottom,o.bottom)})},n.getBoxRange=function(e){return{x:[e.left,e.right],y:[e.top,e.bottom]}},n.getBoxVertex=function(e){return{leftTop:{x:e.left,y:e.top},rightTop:{x:e.right,y:e.top},leftBottom:{x:e.left,y:e.bottom},rightBottom:{x:e.right,y:e.bottom}}},n.isPointInsideBox=function(e,i){t(i);var r=n.getBoxRange(i);return n.isNumberInRange(e.x,r.x)&&n.isNumberInRange(e.y,r.y)},n.getIntersectBox=function(n,o){t(n),t(o);var a=r(n.left,o.left),s=r(n.top,o.top),l=i(n.right,o.right),u=i(n.bottom,o.bottom);return l>a&&u>s?e({left:a,right:l,top:s,bottom:u}):null},n.snapToSharp=function(e){return utils.isNumber(e)?(0|e)+.5:utils.isArray(e)?e.map(n.snapToSharp):(["x","y","left","top","right","bottom"].forEach(function(t){o.call(e,t)&&(e[t]=n.snapToSharp(e[t]))}),e)},n.expandBox=function(t,n,i){return void 0===i&&(i=n),e({left:t.left-n,top:t.top-i,right:t.right+n,bottom:t.bottom+i})},n}(),KityMinder.registerModule("HistoryModule",function(){var e=this,t=kity.createClass("Scene",{constructor:function(e,t){this.data=e.clone(),this.inputStatus=t},getData:function(){return this.data},cloneData:function(){return this.getData().clone()},equals:function(e){return this.getData().equals(e.getData())},isInputStatus:function(){return this.inputStatus},setInputStatus:function(e){this.inputStatus=e}}),n=kity.createClass("HistoryManager",{constructor:function(e){this.list=[],this.index=0,this.hasUndo=!1,this.hasRedo=!1,this.km=e},undo:function(){if(this.hasUndo){var e=this.list[this.index];if(e&&e.isInputStatus())return this.saveScene(),this.restore(--this.index),void e.setInputStatus(!1);if(1==this.list.length)return void this.restore(0);if(!this.list[this.index-1]&&1==this.list.length)return void this.reset();for(;this.list[this.index].equals(this.list[this.index-1]);)if(this.index--,0===this.index)return this.restore(0);this.restore(--this.index)}},redo:function(){if(this.hasRedo){for(;this.list[this.index].equals(this.list[this.index+1]);)if(this.index++,this.index==this.list.length-1)return this.restore(this.index);this.restore(++this.index)}},partialRenewal:function(t){function n(e,t){return e.getText()!=t.getText()?!1:utils.compareObject(e.getData(),t.getData())===!1?!1:utils.compareObject(e.getTmpData(),t.getTmpData())===!1?!1:!0}function i(t,n){n.isSelected()&&o.push(n),e.appendNode(n,t),n.render();for(var r,a=utils.cloneArr(n.children),s=0;r=a[s++];)i(n,r)}function r(t,a){n(t,a)===!1&&t.setValue(a),t.render(),t.isSelected()&&o.push(t);for(var s,l,u=0,c=0;s=t.children[u],l=a.children[c],s||l;u++,c++)s&&!l?(u--,e.removeNode(s)):!s&&l?(c--,i(t,l)):r(s,l)}var o=[];r(e.getRoot(),t),e.layout(200),e.select(o,!0),o=[]},restore:function(e){e=void 0===e?this.index:e;var t=this.list[e];this.partialRenewal(t.cloneData()),this.update(),this.km.fire("restoreScene"),this.km.fire("contentChange")},getScene:function(e){return new t(this.km.getRoot(),e)},saveScene:function(e){var t=this.getScene(e),n=this.list[this.index];return n&&n.equals(t)?void(e&&(n.setInputStatus(!0),this.update())):(this.list=this.list.slice(0,this.index+1),this.list.push(t),this.list.length>this.km.getOptions("maxUndoCount")&&this.list.shift(),this.index=this.list.length-1,void this.update())},update:function(){this.hasRedo=!!this.list[this.index+1],this.hasUndo=!!this.list[this.index-1];var e=this.list[this.index];e&&e.isInputStatus()&&(this.hasUndo=!0)},reset:function(){this.list=[],this.index=0,this.hasUndo=!1,this.hasRedo=!1}});return this.historyManager=new n(this),{defaultOptions:{maxUndoCount:20,maxInputCount:20},commands:{undo:kity.createClass("UndoCommand",{base:Command,execute:function(e){e.historyManager.undo()},queryState:function(e){return e.historyManager.hasUndo?0:-1},isNeedUndo:function(){return!1}}),redo:kity.createClass("RedoCommand",{base:Command,execute:function(e){e.historyManager.redo()},queryState:function(e){return e.historyManager.hasRedo?0:-1},isNeedUndo:function(){return!1}})},commandShortcutKeys:{undo:"ctrl+z",redo:"ctrl+y"},events:{saveScene:function(e){this.historyManager.saveScene(e.inputStatus)},"import":function(){this.historyManager.reset()}}}}),KityMinder.registerModule("ProgressModule",function(){var e=this,t="progress",n="#FFED83",i="#43BC00",r="M10,3c4.418,0,8,3.582,8,8h1c0-5.523-3.477-10-9-10S1,5.477,1,11h1C2,6.582,5.582,3,10,3z",o="#8E8E8E",a="M10,0C4.477,0,0,4.477,0,10c0,5.523,4.477,10,10,10s10-4.477,10-10C20,4.477,15.523,0,10,0zM10,18c-4.418,0-8-3.582-8-8s3.582-8,8-8s8,3.582,8,8S14.418,18,10,18z",s=(new kity.LinearGradient).pipe(function(e){e.setStartPosition(0,0),e.setEndPosition(0,1),e.addStop(0,"#fff"),e.addStop(1,"#ccc")}),l="M15.812,7.896l-6.75,6.75l-4.5-4.5L6.25,8.459l2.812,2.803l5.062-5.053L15.812,7.896z",u="#EEE";e.getPaper().addResource(s);var c=kity.createClass("ProgressIcon",{base:kity.Group,constructor:function(e){this.callBase(),this.setSize(20),this.create(),this.setValue(e),this.setId(KityMinder.uuid("node_progress")),this.translate(.5,.5)},setSize:function(e){this.width=this.height=e},create:function(){var e,t,c,h,d;e=new kity.Circle(9).fill(n),t=new kity.Pie(9,0).fill(i),c=(new kity.Path).setPathData(r).setTranslate(-10,-10).fill(o),h=(new kity.Path).setTranslate(-10,-10).setPathData(a).fill(s),d=(new kity.Path).setTranslate(-10,-10).setPathData(l).fill(u),this.addShapes([e,t,c,d,h]),this.pie=t,this.check=d},setValue:function(e){this.pie.setAngle(-360*(e-1)/8),this.check.setVisible(9==e)}}),h=kity.createClass("ProgressCommand",{base:Command,execute:function(e,n){for(var i=e.getSelectedNodes(),r=0;r<i.length;r++)i[r].setData(t,n||null).render();e.layout()},queryValue:function(e){for(var n,i=e.getSelectedNodes(),r=0;r<i.length&&!(n=i[r].getData(t));r++);return n||null},queryState:function(e){return e.getSelectedNodes().length?0:-1}});return{commands:{progress:h},renderers:{left:kity.createClass("ProgressRenderer",{base:KityMinder.Renderer,create:function(e){return new c},shouldRender:function(e){return e.getData(t)},update:function(e,n,i){var r,o,a=n.getData(t),s=n.getStyle("space-left");return e.setValue(a),r=i.left-e.width-s,o=-e.height/2,e.setTranslate(r+e.width/2,o+e.height/2),new kity.Box(r,o,e.width,e.height)}})}}}),KityMinder.registerModule("PriorityModule",function(){var e=[null,["#FF1200","#840023"],["#0074FF","#01467F"],["#00AF00","#006300"],["#FF962E","#B25000"],["#A464FF","#4720C4"],["#A3A3A3","#515151"],["#A3A3A3","#515151"],["#A3A3A3","#515151"],["#A3A3A3","#515151"]],t="M0,13c0,3.866,3.134,7,7,7h6c3.866,0,7-3.134,7-7V7H0V13z",n="M20,10c0,3.866-3.134,7-7,7H7c-3.866,0-7-3.134-7-7V7c0-3.866,3.134-7,7-7h6c3.866,0,7,3.134,7,7V10z",i="priority",r=kity.createClass("PriorityIcon",{base:kity.Group,constructor:function(){this.callBase(),this.setSize(20),this.create(),this.setId(KityMinder.uuid("node_priority"))},setSize:function(e){this.width=this.height=e},create:function(){var e,i,r,o;e=(new kity.Path).setPathData(n).fill("white"),i=(new kity.Path).setPathData(t).setTranslate(.5,.5),r=(new kity.Path).setPathData(n).setOpacity(.8).setTranslate(.5,.5),o=(new kity.Text).setX(this.width/2-.5).setY(this.height/2-1.5).setTextAnchor("middle").setVerticalAlign("middle").setFontItalic(!0).setFontSize(14).fill("white"),this.addShapes([i,r,o]),this.mask=r,this.back=i,this.number=o},setValue:function(t){var n=this.back,i=this.mask,r=this.number,o=e[t];o&&(n.fill(o[1]),i.fill(o[0])),r.setContent(t)}}),o=kity.createClass("SetPriorityCommand",{base:Command,execute:function(e,t){for(var n=e.getSelectedNodes(),r=0;r<n.length;r++)n[r].setData(i,t||null).render();e.layout()},queryValue:function(e){for(var t,n=e.getSelectedNodes(),r=0;r<n.length&&!(t=n[r].getData(i));r++);return t||null},queryState:function(e){return e.getSelectedNodes().length?0:-1}});return{commands:{priority:o},renderers:{left:kity.createClass("PriorityRenderer",{base:KityMinder.Renderer,create:function(e){return new r},shouldRender:function(e){return e.getData(i)},update:function(e,t,n){var r,o,a=t.getData(i),s=t.getStyle("space-left");return e.setValue(a),r=n.left-e.width-s,o=-e.height/2,e.setTranslate(r,o),new kity.Box({x:r,y:o,width:e.width,height:e.height})}})}}}),KityMinder.registerModule("image",function(){function e(e,t){var n=document.createElement("img");n.onload=function(){t(n.width,n.height)},n.onerror=function(){t(null)},n.src=e}function t(e,t,n,i){var r=e/t,o=n/i;return e>n&&r>o?(e=n,t=e/r):t>i&&(t=i,e=t*r),{width:0|e,height:0|t}}var n=kity.createClass("ImageCommand",{base:Command,execute:function(n,i,r){var o=n.getSelectedNodes();e(i,function(e,a){e&&(utils.each(o,function(o,s){var l=t(e,a,n.getOptions("maxImageWidth"),n.getOptions("maxImageHeight"));s.setData("image",i),s.setData("imageTitle",r),s.setData("imageSize",l),s.render()}),n.fire("saveScene"),n.layout(300))})},queryState:function(e){var t=e.getSelectedNodes(),n=0;return 0===t.length?-1:(utils.each(t,function(e,t){return t&&t.getData("image")?(n=0,!1):void 0}),n)},queryValue:function(e){var t=e.getSelectedNode();return{url:t.getData("image"),title:t.getData("imageTitle")}}}),i=kity.createClass("RemoveImageCommand",{base:Command,execute:function(e){var t=e.getSelectedNodes();utils.each(t,function(e,t){t.setData("image").render()}),e.layout(300)},queryState:function(e){var t=e.getSelectedNodes();if(0===t.length)return-1;var n=!1;return utils.each(t,function(e,t){return t.getData("image")?(n=!0,!1):void 0}),n?0:-1}}),r=kity.createClass("ImageRenderer",{base:KityMinder.Renderer,create:function(e){return new kity.Image(e.getData("image"))},shouldRender:function(e){return e.getData("image")},update:function(e,t,n){var i=t.getData("image"),r=t.getData("imageTitle"),o=t.getData("imageSize"),a=t.getStyle("space-top");
if(o){r&&e.node.setAttributeNS("http://www.w3.org/1999/xlink","title",r);var s=n.cx-o.width/2,l=n.y-o.height-a;return e.setUrl(i).setX(0|s).setY(0|l).setWidth(0|o.width).setHeight(0|o.height),new kity.Box(0|s,0|l,0|o.width,0|o.height)}}});return{defaultOptions:{maxImageWidth:200,maxImageHeight:200},commands:{image:n,removeimage:i},renderers:{top:r}}}),KityMinder.registerModule("Resource",function(){var e=function(){var e,t,n,i,r,o,a,s,l,u,c;return c=4*(1<<30),e=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],r=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479],u=function(e){return 0>e&&(e+=c),("00000000"+e.toString(16)).slice(-8)},o=[[16,50,84,118,152,186,220,254],[174,132,249,109,193,32,123,53],[139,12,37,223,234,99,23,73],[151,19,205,235,98,165,4,143],[9,117,66,250,30,203,134,211],[194,166,176,56,212,87,239,145],[92,241,222,164,112,54,41,184],[189,231,28,147,5,79,104,162],[246,158,59,128,44,125,65,90],[42,72,103,81,191,233,195,13]],a=function(e,t,n){var i=s[e]^s[t];s[e]=i>>>n|i<<32-n},t=function(e,t,u,c,h){var d=i+o[n][e]%16,f=i+(o[n][e]>>4);t%=4,u=4+u%4,c=8+c%4,h=12+h%4,s[t]+=s[u]+(l[d]^r[f%16]),a(h,t,16),s[c]+=s[h],a(u,c,12),s[t]+=s[u]+(l[f]^r[d%16]),a(h,t,8),s[c]+=s[h],a(u,c,7)},function(o,a){a instanceof Array&&4===a.length||(a=[0,0,0,0]);var c,h,d,f,p,g,m,v;for(h=e.slice(0),c=r.slice(0,8),n=0;4>n;n+=1)c[n]^=a[n];if(d=16*o.length,p=d%512>446||d%512===0?0:d,d%512===432)o+="老";else{for(o+="耀";o.length%32!==27;)o+="\x00";o+=""}for(l=[],v=0;v<o.length;v+=2)l.push(65536*o.charCodeAt(v)+o.charCodeAt(v+1));for(l.push(0),l.push(d),g=l.length-16,m=0,i=0;i<l.length;i+=16){for(m+=512,f=i===g?p:Math.min(d,m),s=h.concat(c),s[12]^=f,s[13]^=f,n=0;10>n;n+=1)for(v=0;8>v;v+=1)4>v?t(v,v,v,v,v):t(v,v,v+1,v+2,v+3);for(v=0;8>v;v+=1)h[v]^=a[v%4]^s[v]^s[v+8]}return h.map(u).join("")}}(),t=[51,303,75,200,157,0,26,254].map(function(e){return kity.Color.createHSL(e,100,85)});kity.extendClass(Minder,{getHashCode:function(t){t=e(t);var n,i,r=1315423911;for(n=t.length-1;n>=0;n--)i=t.charCodeAt(n),r^=(r<<5)+i+(r>>2);return 2147483647&r},getResourceColor:function(e){var n,i=this._getResourceColorIndexMapping();return i.hasOwnProperty(e)||(n=this._getNextResourceColorIndex(),i[e]=n),t[i[e]]||kity.Color.createHSL(Math.floor(this.getHashCode(e)/2147483647*359),100,85)},getUsedResource:function(){var e,t=this._getResourceColorIndexMapping(),n=[];for(e in t)t.hasOwnProperty(e)&&n.push(e);return n},_getNextResourceColorIndex:function(){var e,n,i,r=this._getResourceColorIndexMapping();n=[];for(e in r)r.hasOwnProperty(e)&&n.push(r[e]);for(i=0;i<t.length;i++)if(!~n.indexOf(i))return i;return-1},_getResourceColorIndexMapping:function(){return this._resourceColorMapping||(this._resourceColorMapping={})}});var n=kity.createClass("ResourceCommand",{base:Command,execute:function(e,t){var n=e.getSelectedNodes();"string"==typeof t&&(t=[t]),n.forEach(function(e){e.setData("resource",t).render()}),e.layout(200)},queryValue:function(e){var t=e.getSelectedNodes(),n=[];return t.forEach(function(e){var t=e.getData("resource");t&&t.forEach(function(e){~n.indexOf(e)||n.push(e)})}),n},queryState:function(e){return e.getSelectedNode()?0:-1}}),i=kity.createClass("ResourceOverlay",{base:kity.Group,constructor:function(){this.callBase();var e,t;t=this.rect=(new kity.Rect).setRadius(4),e=this.text=(new kity.Text).setFontSize(12).setVerticalAlign("middle"),this.addShapes([t,e])},setValue:function(e,t){var n,i,r,o=8,a=4;n=this.text,e==this.lastResourceName?i=this.lastBox:(n.setContent(e),i=n.getBoundaryBox(),this.lastResourceName=e,this.lastBox=i),n.setX(o).fill(t.dec("l",70)),r=this.rect,r.setPosition(0,i.y-a),this.width=Math.round(i.width+2*o),this.height=Math.round(i.height+2*a),r.setSize(this.width,this.height),r.fill(t)}}),r=kity.createClass("ResourceRenderer",{base:KityMinder.Renderer,create:function(e){return this.overlays=[],new kity.Group},shouldRender:function(e){return e.getData("resource")&&e.getData("resource").length},update:function(e,t,n){var r,o,a,s=t.getStyle("space-right"),l=this.overlays,u=t.getData("resource"),c=t.getMinder();for(a=0,r=0;r<u.length;r++)a+=s,o=l[r],o||(o=new i,l.push(o),e.addShape(o)),o.setVisible(!0),o.setValue(u[r],c.getResourceColor(u[r])),o.setTranslate(a,-1),a+=o.width;for(;o=l[r++];)o.setVisible(!1);return e.setTranslate(n.right,0),new kity.Box({x:n.right,y:Math.round(-l[0].height/2),width:a,height:l[0].height})}});return{commands:{resource:n},renderers:{right:r}}}),KityMinder.registerModule("NoteModule",function(){var e="M9,9H3V8h6L9,9L9,9z M9,7H3V6h6V7z M9,5H3V4h6V5z M8.5,11H2V2h8v7.5 M9,12l2-2V1H1v11",t=kity.createClass("NoteCommand",{base:Command,execute:function(e,t){var n=e.getSelectedNode();n.setData("note",t),n.render(),n.getMinder().layout(300)},queryState:function(e){return 1===e.getSelectedNodes().length?0:-1},queryValue:function(e){var t=e.getSelectedNode();return t&&t.getData("note")}}),n=kity.createClass("NoteIcon",{base:kity.Group,constructor:function(){this.callBase(),this.width=16,this.height=17,this.rect=new kity.Rect(16,17,.5,-8.5,2).fill("transparent"),this.path=(new kity.Path).setPathData(e).setTranslate(2.5,-6.5),this.addShapes([this.rect,this.path]),this.on("mouseover",function(){this.rect.fill("rgba(255, 255, 200, .8)")}).on("mouseout",function(){this.rect.fill("transparent")}),this.setStyle("cursor","pointer")}}),i=kity.createClass("NoteIconRenderer",{base:KityMinder.Renderer,create:function(e){var t=new n;return t.on("mousedown",function(t){t.preventDefault(),e.getMinder().fire("editnoterequest")}),t.on("mouseover",function(){e.getMinder().fire("shownoterequest",{node:e,icon:t})}),t.on("mouseout",function(){e.getMinder().fire("hidenoterequest",{node:e,icon:t})}),t},shouldRender:function(e){return e.getData("note")},update:function(e,t,n){var i=n.right+t.getStyle("space-left"),r=n.cy;return e.path.fill(t.getStyle("color")),e.setTranslate(i,r),new kity.Box(i,Math.round(r-e.height/2),e.width,e.height)}});return{renderers:{right:i},commands:{note:t}}});var ViewDragger=kity.createClass("ViewDragger",{constructor:function(e){this._minder=e,this._enabled=!1,this._bind();var t=this;this._minder.getViewDragger=function(){return t}},isEnabled:function(){return this._enabled},setEnabled:function(e){var t=this._minder.getPaper();t.setStyle("cursor",e?"pointer":"default"),t.setStyle("cursor",e?"-webkit-grab":"default"),this._enabled=e},move:function(e,t){var n=(this._minder,this.getMovement().offset(e));this.moveTo(n,t)},moveTo:function(e,t){if(t){var n=this;return this._moveTimeline&&this._moveTimeline.stop(),this._moveTimeline=this._minder.getRenderContainer().animate(new kity.Animator(this.getMovement(),e,function(e,t){n.moveTo(t)}),t,"easeOutCubic"),this._moveTimeline.on("finish",function(){n._moveTimeline=null}),this}this._minder.getRenderContainer().setTranslate(e.round()),this._minder.fire("viewchange")},getMovement:function(){var e=this._minder.getRenderContainer().transform.translate;return e?e[0]:new kity.Point},getView:function(){var e=this._minder,t={width:e.getRenderTarget().clientWidth,height:e.getRenderTarget().clientHeight},n=this.getMovement(),i=new kity.Box(0,0,t.width,t.height),r=e.getPaper().getViewPortMatrix();return r.inverse().translate(-n.x,-n.y).transformBox(i)},_bind:function(){function e(e){if(i){i=null,e.stopPropagation(),n&&(t.setEnabled(!1),n=!1,"hand"==t._minder.getStatus()&&t._minder.rollbackStatus());var r=t._minder.getPaper();r.setStyle("cursor","hand"==t._minder.getStatus()?"-webkit-grab":"default")}}var t=this,n=!1,i=null,r=null;this._minder.on("normal.mousedown normal.touchstart inputready.mousedown inputready.touchstart readonly.mousedown readonly.touchstart",function(e){2==e.originEvent.button&&e.originEvent.preventDefault(),(e.getTargetNode()==this.getRoot()||2==e.originEvent.button||e.originEvent.altKey)&&(i=e.getPosition(),n=!0)}).on("normal.mousemove normal.touchmove readonly.mousemove readonly.touchmove inputready.mousemove inputready.touchmove",function(e){if("touchmove"==e.type&&e.preventDefault(),n){var r=kity.Vector.fromPoints(i,e.getPosition());if(r.length()>10){this.setStatus("hand",!0);var o=t._minder.getPaper();o.setStyle("cursor","-webkit-grabbing")}}}).on("hand.beforemousedown hand.beforetouchstart",function(e){if(t.isEnabled()){i=e.getPosition(),e.stopPropagation();var n=t._minder.getPaper();n.setStyle("cursor","-webkit-grabbing")}}).on("hand.beforemousemove hand.beforetouchmove",function(e){if(i){r=e.getPosition();var n=kity.Vector.fromPoints(i,r);t.move(n),e.stopPropagation(),e.preventDefault(),e.originEvent.preventDefault(),i=r}}).on("mouseup touchend",e),window.addEventListener("mouseup",e),this._minder.on("contextmenu",function(e){e.preventDefault()})}});KityMinder.registerModule("View",function(){var e=kity.createClass("ToggleHandCommand",{base:Command,execute:function(e){"hand"!=e.getStatus()?e.setStatus("hand",!0):e.rollbackStatus(),this.setContentChanged(!1)},queryState:function(e){return"hand"==e.getStatus()?1:0},enableReadOnly:!0}),t=kity.createClass("CameraCommand",{base:Command,execute:function(e,t,n){t=t||e.getRoot();var i=e.getPaper().getViewPort(),r=t.getRenderContainer().getRenderBox("view"),o=i.center.x-r.x-r.width/2,a=i.center.y-r.y,s=e._viewDragger;s.move(new kity.Point(o,a),n),this.setContentChanged(!1)},enableReadOnly:!0}),n=kity.createClass("MoveCommand",{base:Command,execute:function(e,t,n){var i=e._viewDragger,r=e._lastClientSize;switch(t){case"up":i.move(new kity.Point(0,r.height/2),n);break;case"down":i.move(new kity.Point(0,-r.height/2),n);break;case"left":i.move(new kity.Point(r.width/2,0),n);break;case"right":i.move(new kity.Point(-r.width/2,0),n)}},enableReadOnly:!0});return{init:function(){this._viewDragger=new ViewDragger(this)},commands:{hand:e,camera:t,move:n},events:{keydown:function(e){var t=this;["up","down","left","right"].forEach(function(n){e.isShortcutKey("ctrl+"+n)&&"textedit"!=t.getStatus()&&(t.removeAllSelectedNodes(),t.execCommand("move",n,100),e.preventDefault())}),e.isShortcutKey("ctrl+enter")&&t.execCommand("camera",t.getRoot(),100)},statuschange:function(e){this._viewDragger.setEnabled("hand"==e.currentStatus)},mousewheel:function(e){var t,n;e=e.originEvent,e.ctrlKey||e.shiftKey||("wheelDeltaX"in e?(t=e.wheelDeltaX||0,n=e.wheelDeltaY||0):(t=0,n=e.wheelDelta),this._viewDragger.move({x:t/2.5,y:n/2.5}),e.preventDefault())},"normal.dblclick readonly.dblclick":function(e){e.kityEvent.targetShape instanceof kity.Paper&&this.execCommand("camera",this.getRoot(),800)},ready:function(){this.execCommand("camera",null,0),this._lastClientSize={width:this.getRenderTarget().clientWidth,height:this.getRenderTarget().clientHeight}},resize:function(e){var t={width:this.getRenderTarget().clientWidth,height:this.getRenderTarget().clientHeight},n=this._lastClientSize;this._viewDragger.move(new kity.Point((t.width-n.width)/2|0,(t.height-n.height)/2|0)),this._lastClientSize=t},"selectionchange layoutallfinish":function(e){var t=this.getSelectedNode();if(t){var n=this._viewDragger,i=n.getView(),r=t.getLayoutBox(),o=50,a=0,s=0;r.right>i.right?a+=i.right-r.right-o:r.left<i.left&&(a+=i.left-r.left+o),r.bottom>i.bottom&&(s+=i.bottom-r.bottom-o),r.top<i.top&&(s+=i.top-r.top+o),(a||s)&&n.move(new kity.Point(a,s),100)}}}}});var GM=KityMinder.Geometry,MoveToParentCommand=kity.createClass("MoveToParentCommand",{base:Command,execute:function(e,t,n){for(var i,r=t.length-1;r>=0;r--)i=t[r],i.parent&&(i.parent.removeChild(i),n.appendChild(i),i.render());n.expand(),e.select(t,!0)}}),DropHinter=kity.createClass("DropHinter",{base:kity.Group,constructor:function(){this.callBase(),this.rect=new kity.Rect,this.addShape(this.rect)},render:function(e){this.setVisible(!!e),e&&(this.rect.setBox(e.getLayoutBox()).setRadius(e.getStyle("radius")||0).stroke(e.getStyle("drop-hint-color")||"yellow",e.getStyle("drop-hint-width")||2),this.bringTop())}}),OrderHinter=kity.createClass("OrderHinter",{base:kity.Group,constructor:function(){this.callBase(),this.area=new kity.Rect,this.path=new kity.Path,this.addShapes([this.area,this.path])},render:function(e){this.setVisible(!!e),e&&(this.area.setBox(e.area),this.area.fill(e.node.getStyle("order-hint-area-color")||"rgba(0, 255, 0, .5)"),this.path.setPathData(e.path),this.path.stroke(e.node.getStyle("order-hint-path-color")||"#0f0",e.node.getStyle("order-hint-path-width")||1))}}),TreeDragger=kity.createClass("TreeDragger",{constructor:function(e){this._minder=e,this._dropHinter=new DropHinter,this._orderHinter=new OrderHinter,e.getRenderContainer().addShapes([this._dropHinter,this._orderHinter])},dragStart:function(e){this._startPosition=e},dragMove:function(e){var t=10;if(this._startPosition){var n=kity.Vector.fromPoints(this._dragPosition||this._startPosition,e),i=this._minder;if(this._dragPosition=e,!this._dragMode){if(GM.getDistance(this._dragPosition,this._startPosition)<t)return;if(!this._enterDragMode())return}for(var r=0;r<this._dragSources.length;r++)this._dragSources[r].setLayoutOffset(this._dragSources[r].getLayoutOffset().offset(n)),i.applyLayoutResult(this._dragSources[r]);this._dropTest()?this._renderOrderHint(this._orderSucceedHint=null):this._orderTest()}},dragEnd:function(){if(this._startPosition=null,this._dragPosition=null,this._dragMode){if(this._fadeDragSources(1),this._dropSucceedTarget)this._dragSources.forEach(function(e){e.setLayoutOffset(null)}),this._minder.layout(-1),this._minder.execCommand("movetoparent",this._dragSources,this._dropSucceedTarget);else if(this._orderSucceedHint){var e=this._orderSucceedHint,t=e.node.getIndex(),n=this._dragSources.map(function(e){return e.setLayoutOffset(null),e.getIndex()}),i=Math.max.apply(Math,n),r=Math.min.apply(Math,n);r>t&&"down"==e.type&&t++,t>i&&"up"==e.type&&t--,e.node.setLayoutOffset(null),this._minder.execCommand("arrange",this._dragSources,t),this._renderOrderHint(null)}else this._minder.fire("savescene");this._minder.layout(300),this._leaveDragMode(),this._minder.fire("contentchange")}},_enterDragMode:function(){return this._calcDragSources(),this._dragSources.length?(this._fadeDragSources(.5),this._calcDropTargets(),this._calcOrderHints(),this._dragMode=!0,this._minder.setStatus("dragtree"),!0):(this._startPosition=null,!1)},_calcDragSources:function(){this._dragSources=this._minder.getSelectedAncestors()},_fadeDragSources:function(e){var t=this._minder;this._dragSources.forEach(function(n){n.getRenderContainer().setOpacity(e,200),n.traverse(function(n){1>e?t.detachNode(n):t.attachNode(n)},!0)})},_calcDropTargets:function(){function e(t,n){var i,r=[];return r.push(n),n.getChildren().forEach(function(n){for(i=0;i<t.length;i++)if(t[i]==n)return;r=r.concat(e(t,n))}),r}this._dropTargets=e(this._dragSources,this._minder.getRoot()),this._dropTargetBoxes=this._dropTargets.map(function(e){return e.getLayoutBox()})},_calcOrderHints:function(){var e=this._dragSources,t=MinderNode.getCommonAncestor(e);if(t==e[0]&&(t=e[0].parent),0===e.length||t!=e[0].parent)return void(this._orderHints=[]);var n=t.children;this._orderHints=n.reduce(function(t,n){return-1==e.indexOf(n)&&(t=t.concat(n.getOrderHint())),t},[])},_leaveDragMode:function(){this._dragMode=!1,this._dropSucceedTarget=null,this._orderSucceedHint=null,this._renderDropHint(null),this._renderOrderHint(null),this._minder.rollbackStatus()},_drawForDragMode:function(){this._text.setContent(this._dragSources.length+" items"),this._text.setPosition(this._startPosition.x,this._startPosition.y+5),this._minder.getRenderContainer().addShape(this)},_boxTest:function(e,t,n){var i,r,o,a,s,l=this._dragSources.map(function(e){return e.getLayoutBox()});for(n=n||function(e,t,n){return e},i=0;i<e.length;i++)for(o=e[i],s=t.call(this,o,i),r=0;r<l.length;r++){a=l[r];var u=GM.getIntersectBox(a,s);if(n(u,a,s))return o}return null},_dropTest:function(){return this._dropSucceedTarget=this._boxTest(this._dropTargets,function(e,t){return this._dropTargetBoxes[t]},function(e,t,n){function i(e){return e.width*e.height}return e?i(e)>.5*Math.min(i(t),i(n))?!0:e.width+1>=Math.min(t.width,n.width)?!0:e.height+1>=Math.min(t.height,n.height)?!0:!1:!1}),this._renderDropHint(this._dropSucceedTarget),!!this._dropSucceedTarget},_orderTest:function(){return this._orderSucceedHint=this._boxTest(this._orderHints,function(e){return e.area}),this._renderOrderHint(this._orderSucceedHint),!!this._orderSucceedHint},_renderDropHint:function(e){this._dropHinter.render(e)},_renderOrderHint:function(e){this._orderHinter.render(e)},preventDragMove:function(){this._startPosition=null}});KityMinder.registerModule("DragTree",function(){var e;return{init:function(){e=new TreeDragger(this),window.addEventListener("mouseup",function(){e.dragEnd()})},events:{"normal.mousedown inputready.mousedown":function(t){t.originEvent.button||t.getTargetNode()&&t.getTargetNode()!=this.getRoot()&&e.dragStart(t.getPosition(this.getRenderContainer()))},"normal.mousemove dragtree.mousemove":function(t){e.dragMove(t.getPosition(this.getRenderContainer()))},"normal.mouseup dragtree.beforemouseup":function(t){e.dragEnd(),t.preventDefault()},statuschange:function(t){"textedit"==t.lastStatus&&"normal"==t.currentStatus&&e.preventDragMove()}},commands:{movetoparent:MoveToParentCommand}}}),KityMinder.registerModule("KeyboardModule",function(){function e(e){var t,i=[];e.traverse(function(e){t=e.getLayoutBox(),t.width&&t.height&&i.push({left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height,width:t.width,height:t.height,node:e,text:e.getText()})});for(var r=0;r<i.length;r++)n(i,r)}function t(e,t){var n,i,s,l,u,c,h;return n=r(e.left,t.left),i=o(e.right,t.right),s=r(e.top,t.top),l=o(e.bottom,t.bottom),u=i-n-e.width-t.width,c=l-s-e.height-t.height,h=0>u?c:0>c?u:a(u*u+c*c),{cx:h,cy:h}}function n(e,n){for(var i,r,o=e[n],a={},s=0;s<e.length;s++)s!=n&&(i=e[s],r=t(i,o),i.right<o.left&&(!a.left||r.cx<a.left.dist)&&(a.left={dist:r.cx,node:i.node}),i.left>o.right&&(!a.right||r.cx<a.right.dist)&&(a.right={dist:r.cx,node:i.node}),i.bottom<o.top&&(!a.top||r.cy<a.top.dist)&&(a.top={dist:r.cy,node:i.node}),i.top>o.bottom&&(!a.down||r.cy<a.down.dist)&&(a.down={dist:r.cy,node:i.node}));o.node._nearestNodes={right:a.right&&a.right.node||null,top:a.top&&a.top.node||null,left:a.left&&a.left.node||null,down:a.down&&a.down.node||null}}function i(t,n){var i=t.getSelectedNode();if(!i)return t.select(t.getRoot()),void e(t.getRoot());i._nearestNodes||e(t.getRoot());var r=i._nearestNodes[n];r&&t.select(r,!0)}var r=Math.min,o=Math.max,a=(Math.abs,Math.sqrt),s=(Math.exp,kity.createClass({base:Command,execute:function(e){var t=e.getSelectedNode();t&&t.parent&&e.select(t.parent,!0),this.setContentChanged(!1)},queryState:function(e){return e.getSelectedNode()?0:-1},enableReadOnly:!0}));return{commands:{navparent:s},commandShortcutKeys:{navparent:"shift+tab"},events:{layoutallfinish:function(){var t=this.getRoot();e(t)},"normal.keydown readonly.keydown":function(e){var t=this;["left","right","up","down"].forEach(function(n){e.isShortcutKey(n)&&i(t,"up"==n?"top":n)})},"normal.keyup":function(e){if(browser.ipad){var t=KityMinder.keymap,n=e.getTargetNode(),i=this.getLang();this.receiver&&(this.receiver.keydownNode=n);var r=e.originEvent;if(r.altKey||r.ctrlKey||r.metaKey||r.shiftKey)return;switch(r.keyCode){case t.Enter:this.execCommand("AppendSiblingNode",i.topic),e.preventDefault();break;case t.Backspace:case t.Del:e.preventDefault(),this.execCommand("RemoveNode")}}}}}}),KityMinder.registerModule("Select",function(){var e=this,t=e.getRenderContainer(),n=KityMinder.Geometry,i=function(){var i=null,r=new kity.Path,o=!1,a=10;return{selectStart:function(e){return e.originEvent.button||e.originEvent.altKey?void 0:i?this.selectEnd():void(i=n.snapToSharp(e.getPosition(t)))},selectMove:function(s){if("textedit"!=e.getStatus()&&i){var l=i,u=s.getPosition(t);if(!o){if(n.getDistance(l,u)<a)return;o=!0,t.addShape(r),r.fill(e.getStyle("marquee-background")).stroke(e.getStyle("marquee-stroke")).setOpacity(.8).getDrawer().clear()}var c=n.getBox(l,u),h=[];c.left=Math.round(c.left),c.top=Math.round(c.top),c.right=Math.round(c.right),c.bottom=Math.round(c.bottom),r.getDrawer().pipe(function(){this.clear(),this.moveTo(c.left,c.top),this.lineTo(c.right,c.top),this.lineTo(c.right,c.bottom),this.lineTo(c.left,c.bottom),this.close()}),e.getRoot().traverse(function(e){var t=e.getLayoutBox();n.getIntersectBox(t,c)&&h.push(e)}),e.select(h,!0),window.getSelection().removeAllRanges()}},selectEnd:function(e){i&&(i=null),o&&(r.fadeOut(200,"ease",0,function(){r.remove&&r.remove()}),o=!1)}}}(),r=null,o=null;return{init:function(){window.addEventListener("mouseup",function(){i.selectEnd()})},events:{mousedown:function(e){var t=e.getTargetNode();t?e.originEvent.shiftKey?this.toggleSelect(t):t.isSelected()?this.isSingleSelect()||(r=t,o=e.getPosition(this.getRenderContainer())):this.select(t,!0):(this.removeAllSelectedNodes(),i.selectStart(e),this.setStatus("normal"))},mousemove:i.selectMove,mouseup:function(e){var t=e.getTargetNode();if(t&&t==r){var n=e.getPosition(this.getRenderContainer()),a=kity.Vector.fromPoints(o,n);a.length()<1&&this.select(r,!0),r=null}i.selectEnd(e)},"normal.keydown inputready.keydown":function(e){if(e.isShortcutKey("ctrl+a")){var t=[];this.getRoot().traverse(function(e){t.push(e)}),this.select(t,!0),e.preventDefault()}}}}}),KityMinder.registerModule("TextEditModule",function(){function e(e){if(e&&t.isSingleSelect()&&e.isSelected()){e.getTextGroup().setStyle("cursor","default");var o=e.getStyle("text-selection-color");if(r.updateByMinderNode(e),n.setHide().setStartOffset(0).setEndOffset(r.getTxtOfContainer().length).setColor(o),r.updateContainerRangeBySel(),browser.ie)var a=setInterval(function(){var e=i.nativeSel.getRangeAt(0);!e||e.collapsed?i.select():clearInterval(a)});t.setStatus("inputready")}}var t=this,n=new Minder.Selection,i=new Minder.Range,r=new Minder.Receiver(this,n,i);new Minder.keyboarder(r);this.receiver=r;var o,a,s,l,u=!1,c=!1,h=!1;return t.textEditNode=function(n){e(n),t.setStatus("textedit"),r.updateSelection()},{events:{ready:function(){document.body.appendChild(r.container)},"normal.beforemousedown textedit.beforemousedown inputready.beforemousedown":function(e){if(e.isRightMB())return void(e.getTargetNode()||this.setStatus("normal"));u=!0,h=n.isShow(),n.setHide();var a=e.getTargetNode();if(!a){var d=e.kityEvent.targetShape;d&&"Selection"==d.getType()&&(a=r.getMinderNode(),e.stopPropagationImmediately())}if(a&&this.isSingleSelect()&&a.isSelected()){l=a,o=a;var f=a.getTextGroup();return n.collapse(!0),n.setColor(a.getStyle("text-selection-color")),r.updateByMinderNode(a).updateIndexByMouse(e.getPosition(a.getRenderContainer())).setRange(i).setReady(),void(h&&(n.setShowStatus(),clearTimeout(s),s=setTimeout(function(){return c?void(c=!1):(n.collapse(!0).updatePosition(r.getOffsetByIndex()).setShow(),void f.setStyle("cursor","text"))},200),t.setStatus("textedit")))}r.clearReady(),r.clear(),l&&l.getTextGroup().setStyle("cursor","default")},"inputready.keyup":function(){n.isHide()&&e(this.getSelectedNode())},"normal.keyup":function(t){var i=this.getSelectedNode(),r=t.getKeyCode();if(i&&this.isSingleSelect()&&i.isSelected()&&!n.isShow()){var o=t.originEvent;!keymap.isSelectedNodeKey[r]||o.ctrlKey||o.metaKey||o.shiftKey||o.altKey||e(i)}},"normal.mouseup textedit.mouseup inputready.mouseup":function(i){u=!1;var s=i.getTargetNode();return o=null,s&&!h&&r.isReady()?(n.collapse(!0),n.setColor(s.getStyle("text-selection-color")),browser.ipad&&r.focus(),clearTimeout(a),a=setTimeout(function(){return c?void(c=!1):(n.collapse(!0).updatePosition(r.getOffsetByIndex()).setShow(),void s.getTextGroup().setStyle("cursor","text"))},200),void t.setStatus("textedit")):void(n.isHide()?e(i.getTargetNode()):n.collapsed||r.updateContainerRangeBySel())},"textedit.beforemousemove inputready.beforemousemove":function(e){if(!browser.ipad)if(u&&r.isReady()&&h){if(e.stopPropagationImmediately(),o){var n=e.getPosition(o.getRenderContainer());r.updateSelectionByMousePosition(n).updateSelection(n),setTimeout(function(){r.updateContainerRangeBySel()})}}else u&&!h&&(t.setStatus("normal"),r.clearReady())},"normal.dblclick textedit.dblclick inputready.dblclick":function(n){var i=n.getTargetNode();c=!0,i&&(e(i),t.setStatus("textedit"),r.updateSelection())},restoreScene:function(){r.clear(),e(this.getSelectedNode())},stopTextEdit:function(){r.clear(),t.setStatus("normal")},resize:function(e){n.setHide()},execCommand:function(i){var o={appendchildnode:1,appendsiblingnode:1,editnode:1};return o[i.commandName]?(e(t.getSelectedNode()),void r.updateSelection()):void(n.isShow()&&r.updateTextOffsetData().updateSelection())},layoutfinish:function(e){e.node!==r.minderNode||"textedit"!=this.getStatus()&&"inputready"!=this.getStatus()||r.setContainerStyle()},selectionclear:function(){var n=t.getSelectedNode();n?e(n):(t.setStatus("normal"),r.clear())},blur:function(){!/\?debug#?/.test(location.href)&&r.clear()},"textedit.import":function(){t.setStatus("normal"),r.clear()},"inputready.mousewheel textedit.mousewheel":function(){r.setContainerStyle()},statuschange:function(e){"textedit"==e.lastStatus&&this.fire("contentchange")}}}}),Minder.keyboarder=kity.createClass("keyboarder",function(){return{constructor:function(e){this.re=e,this.container=e.container,this.selection=e.selection,this.range=e.range,this.km=e.km,this.lastMinderNode=null,this.isTypeText=!1,this._initEvent(),this.isShortcutCopyKey=!1},_initEvent:function(){var e=this;browser.ipad&&utils.listen(this.container,"keydown keypress keyup input",function(t){e._handleEvents.call(e,new MinderEvent("keyup"==t.type?"beforekeyup":t.type,t)),"keyup"==t.type&&"normal"==e.km.getStatus()&&e.km.fire("keyup",t)}),this.km.on("inputready.beforekeyup inputready.beforekeydown textedit.beforekeyup normal.keydown normal.keyup textedit.beforekeydown textedit.keypress textedit.paste",utils.proxy(this._handleEvents,this))},_handleEvents:function(e){switch(e.type){case"input":this._input(e);break;case"beforekeydown":this._beforeKeydown(e);break;case"beforekeyup":this._beforeKeyup(e);break;case"keyup":this._keyup(e)}},_setTextToContainer:function(e,t){var n=this;if(n.minderNode=n.re.minderNode,clearTimeout(n.timer),n.range.hasNativeRange()&&(!keymap.controlKeys[e]||t)){n.lastMinderNode===n.minderNode||keymap.notContentChange[e]||(n.km.fire("saveScene",{inputStatus:!0}),n.lastMinderNode=n.minderNode);var i=n.re.getTxtOfContainer();n.minderNode.setText(i),n.re.setContainerStyle(),n.minderNode.getRenderContainer().bringTop(),n.minderNode.render(),keymap.notContentChange[e]||(clearTimeout(n.inputTextTimer),n.inputTextTimer=setTimeout(function(){n.km.layout(300)},300)),n.re.updateTextOffsetData().updateRange().updateSelectionByRange(),n.selection.updateOffsetByTextData(n.re.textData).updatePosition(),"inputready"!=n.km.getStatus()&&n.selection.setHoldShow(),n.timer=setTimeout(function(){n.selection.isShow()&&n.selection.setShow()},200),n.km.setStatus("textedit")}},_input:function(){var e=this;browser.ipad&&setTimeout(function(){e._setTextToContainer()})},_beforeKeydown:function(e){var t=this,n=e.originEvent,i=n.keyCode;switch(this.isTypeText=229==i||0===i,i){case keymap.Enter:if(e.originEvent.shiftKey&&t.selection.isShow())return t._handlerEnterkey(),e.preventDefault(),!1;case keymap.Tab:case keymap.Insert:return void(this.selection.isShow()?(this.re.clear(),this.km.setStatus("inputready"),clearTimeout(t.inputTextTimer),e.preventDefault()):(this.km.setStatus("normal"),this.km.fire("contentchange")));case keymap.left:case keymap.right:case keymap.up:case keymap.down:case keymap.Backspace:case keymap.Del:case keymap["/"]:case keymap.F2:case keymap.Insert:if(this.selection.isHide())return void this.km.setStatus("normal");break;case keymap.Control:case keymap.Alt:case keymap.Cmd:if(this.selection.isHide()&&"textedit"!=this.km.getStatus()&&"inputready"!=this.km.getStatus())return void this.km.setStatus("normal")}if(e.originEvent.ctrlKey||e.originEvent.metaKey){if(this.selection.isHide()&&{86:1,88:1,67:1}[i])return this.isShortcutCopyKey=!0,void this.km.setStatus("normal");if(i==keymap.v)return void setTimeout(function(){t.range.updateNativeRange().insertNode($("<span>$$_kityminder_bookmark_$$</span>")[0]);var e=[];utils.each(t.container.getElementsByTagName("br"),function(t,n){e.push(n)}),utils.each(e,function(e,t){var n=document.createTextNode("\n");t.parentNode.insertBefore(n,t),t.parentNode.removeChild(t)});var n=t.container.textContent.replace(/[\u200b\t\r]/g,""),r=n.indexOf("$$_kityminder_bookmark_$$");t.re.setContainerTxt(n.replace("$$_kityminder_bookmark_$$","")),t.range.setStartOffset(r).collapse(!0).select(),t._setTextToContainer(i)},50);if(i==keymap.x)return void setTimeout(function(){t._setTextToContainer(i)},50)}this.isShortcutCopyKey=!1,t._setTextToContainer(i)},_beforeKeyup:function(e){var t=this,n=e.originEvent,i=n.keyCode;switch(i){case keymap.Enter:case keymap.Tab:case keymap.Insert:case keymap.F2:return browser.ipad?void(this.selection.isShow()?(this.re.clear(),this.km.setStatus("inputready"),clearTimeout(t.inputTextTimer),e.preventDefault()):(this.km.setStatus("normal"),this.km.fire("contentchange"))):(keymap.Enter==i&&(this.isTypeText||browser.mac&&browser.gecko)&&t._setTextToContainer(i,!0),this.re.keydownNode===this.re.minderNode&&(this.km.rollbackStatus(),this.re.clear()),void e.preventDefault());case keymap.Del:case keymap.Backspace:case keymap.Spacebar:return browser.ipad&&this.selection.isHide()?void this.km.setStatus("normal"):void t._setTextToContainer(i,!0)}return this.isTypeText?void t._setTextToContainer(i,!0):browser.mac&&browser.gecko?void t._setTextToContainer(i,!0):(t._setTextToContainer(i,!0),!0)},_keyup:function(e){var t,n=this,i=this.km.getSelectedNode();if("normal"==this.km.getStatus()&&i&&this.selection.isHide()){if(this.isShortcutCopyKey)return;i&&this.km.isSingleSelect()&&i.isSelected()&&(this.re.updateByMinderNode(i),this.selection.setHide().setStartOffset(0).setEndOffset(this.re.getTxtOfContainer().length).setColor(i.getStyle("text-selection-color")),setTimeout(function(){n.re.updateContainerRangeBySel()}),browser.ie&&(t=setInterval(function(){var e=n.range.nativeSel.getRangeAt(0);!e||e.collapsed?n.range.select():clearInterval(t)})),this.km.setStatus("inputready"))}},_handlerEnterkey:function(){function e(e){e&&3==e.nodeType&&0===e.nodeValue.length&&e.parentNode.removeChild(e)}var t=this.range,n=document.createElement("br"),i=this;t.collapsed||t.deleteContents(),t.insertNode(n),e(n.previousSibling),e(n.nextSibling),t.setStartAfter(n),t.collapse(!0);var r=t.startContainer.childNodes[t.startOffset];r||(n=n.cloneNode(!1),t.startContainer.appendChild(n),t.setStartBefore(n),t.collapse(!0)),t.select(),i._setTextToContainer(keymap.Enter)}}}()),Minder.Range=kity.createClass("Range",function(){function e(e,t){var n=e[t+"Container"],i=e[t+"Offset"],r=0;return 1==n.nodeType&&(n=n.childNodes[i],!n&&e.startContainer&&"DIV"==e.startContainer.nodeName?(e.startContainer.innerHTML="<p></p>",i=0):3==n.nodeType&&(i=0)),utils.each(e.container.childNodes,function(e,t){return t===n?1==t.nodeType?!1:(r+=i,!1):void(r+=1==t.nodeType?1:utils.clearWhitespace(t.nodeValue).length)}),r}function t(e,t,n){var i=0,r=e.container;utils.each(r.childNodes,function(o,a){if(1==a.nodeType)return i==t?(e["set"+n](r,o),!1):void i++;var s=utils.clearWhitespace(a.nodeValue).length;return i+s>=t?(e["set"+n](a,t-i),!1):void(i+=s)})}return{constructor:function(e){this.nativeRange=document.createRange(),this.nativeSel=window.getSelection(),this.startContainer=this.endContainer=this.startOffset=this.endOffset=null,this.collapsed=!1,this.container=e||null},hasNativeRange:function(){return 0!==this.nativeSel.rangeCount},deleteContents:function(){return this.nativeRange.deleteContents(),this._updateBoundary()},select:function(){var e=this.nativeRange.startContainer;if(1==e.nodeType&&0===e.childNodes.length){var t=document.createTextNode("​");e.appendChild(t),
this.nativeRange.setStart(t,1),this.nativeRange.collapse(!0)}else this.collapsed&&1==e.nodeType&&(e=e.childNodes[this.startOffset],e&&3==e.nodeType&&0===e.nodeValue.length&&(this.nativeRange.setStart(e,1),this.nativeRange.collapse(!0)));try{this.nativeSel.removeAllRanges()}catch(n){}return this.nativeSel.addRange(this.nativeRange),this},_updateBoundary:function(){var e=this.nativeRange;return this.startContainer=e.startContainer,this.startContainer=e.startContainer,this.endContainer=e.endContainer,this.startOffset=e.startOffset,this.endOffset=e.endOffset,this.collapsed=e.collapsed,this},setStartOffset:function(e){return t(this,e,"Start"),this},setEndOffset:function(e){return t(this,e,"End"),this},setStart:function(e,t){return this.nativeRange.setStart(e,t),this._updateBoundary(),this},setStartAfter:function(e){return this.setStart(e.parentNode,utils.getNodeIndex(e)+1)},setStartBefore:function(e){return this.setStart(e.parentNode,utils.getNodeIndex(e))},setEnd:function(e,t){return this.nativeRange.setEnd(e,t),this._updateBoundary(),this},update:function(){return this.updateNativeRange()._updateBoundary(),this},getStart:function(){return this.update(),{startContainer:this.startContainer,startOffset:this.startOffset}},getStartOffset:function(){return e(this,"start")},getEndOffset:function(){return e(this,"end")},collapse:function(e){return this.nativeRange.collapse(e===!0),this._updateBoundary(),this},isCollapsed:function(){return this._updateBoundary(),this.collapsed},insertNode:function(e){return this.nativeRange.insertNode(e),this._updateBoundary()},updateNativeRange:function(){return this.nativeRange=this.nativeSel.getRangeAt(0),this},clear:function(){return this.nativeSel.removeAllRanges(),this}}}()),Minder.Receiver=kity.createClass("Receiver",{clear:function(){return this.container.innerHTML="",this.selection&&this.selection.setHide(),this.range&&this.range.clear(),this.index=0,this},constructor:function(e,t,n){this.setKityMinder(e);var i=document.createElement("div");i.setAttribute("contenteditable",!0),i.className="km_receiver",this.container=i,utils.addCssRule("km_receiver_css"," .km_receiver{white-space:nowrap;position:absolute;padding:0;margin:0;word-wrap:break-word;"+(/\?debug#?/.test(location.href)?"":"clip:rect(1em 1em 1em 1em);")),this.index=0,this.selection=t,this.range=n,this.range.container=i},setRange:function(e,t){this.index=t||this.index,this.range=e,e.setStartOffset(this.index),e.collapse(!0);var n=this;return setTimeout(function(){n.container.focus(),e.select()}),this},setTextGroup:function(e){return this.textGroup=e,this},setKityMinder:function(e){return this.km=e,this},updateByMinderNode:function(e){return this.setMinderNode(e),this._addSelection(),this.setTextGroup(e.getTextGroup()),this.setContainerStyle(),this.updateTextOffsetData(),this.setSelectionHeight(),this.setContainerTxt(),this},setMinderNode:function(e){return this.minderNode=e,this.selection.setMinderNode(e),this},_addSelection:function(){return this.selection.container&&this.selection.remove(),this.minderNode.getRenderContainer().addShape(this.selection),this},getMinderNode:function(){return this.minderNode},updateIndex:function(){return this.index=this.range.getStartOffset(),this},setSelection:function(e){return this.selection=e,this},updateSelection:function(e){return this.selection.update(this.textData,e),this},getOffsetByIndex:function(e){return utils.getValueByIndex(this.textData,void 0!==e?e:this.index)},getBaseOffset:function(){var e=this.textGroup.getRenderBox("screen");return e},setContainerStyle:function(){var e=this.getBaseOffset();return this.container.style.cssText=";left:"+(browser.ipad?"-":"")+e.x+"px;top:"+(e.y+(/\?debug#?/.test(location.href)?this.textGroup.getItems().length*this.getlineHeight():0))+"px;width:"+e.width+"px;height:"+e.height+"px;",this},updateTextOffsetData:function(){var e,t=this,n=this.minderNode.getData("font-size")||this.minderNode.getStyle("font-size"),i=this.minderNode.getStyle("line-height")*n,r=(t.textGroup.getShapes().length*i-(i-n))/2;return this.textData=[],t.textGroup.eachItem(function(n,o){t.textData[n]=[];for(var a=n*i+1,s=o.getContent(),l=0,u=s.length;u>l;l++){try{e=o.getExtentOfChar(l)}catch(c){console.log(c)}t.textData[n].push({x:e.x,y:a-r,width:e.width,height:e.height})}0===s.length&&t.textData[n].push({x:0,y:a-r,width:0,height:i})}),this},getlineHeight:function(){return this.minderNode.getStyle("line-height")*(this.minderNode.getData("font-size")||this.minderNode.getStyle("font-size"))},updateIndexByMouse:function(e){var t=this;t.updateTextOffsetData(),this.index=0;var n=this.getlineHeight();return utils.each(this.textData,function(i,r){var o=r[0];return o.y<=e.y&&o.y+n>=e.y?(utils.each(r,function(n,i){return 0===n&&e.x<=i.x?!1:e.x>=i.x&&e.x<=i.x+i.width?(e.x-i.x>i.width/2?t.index+=n+1:t.index+=n,!1):n==r.length-1&&e.x>=i.x?(t.index+=1==r.length&&0===r[0].width?0:r.length,!1):void 0}),!1):void(t.index+=r.length+(1==r.length&&0===r[0].width?0:1))}),this.selection.setStartOffset(this.index).collapse(!0),this},setSelectionHeight:function(){return this.selection.setHeight(1*(this.minderNode.getData("font-size")||this.minderNode.getStyle("font-size"))),this},updateSelectionByMousePosition:function(e){var t=this,n=0,i=this.getlineHeight();return utils.each(this.textData,function(r,o){var a=o[0];return a.y<=e.y&&a.y+i>=e.y?(utils.each(o,function(t,i){return 0===t&&e.x<=i.x?!1:e.x>=i.x&&e.x<=i.x+i.width?(n+=t,e.x-i.x>i.width/2&&(n+=1),!1):t==o.length-1&&e.x>=i.x?(n+=1==o.length&&0===o[0].width?0:o.length,!1):void 0}),!1):a.y>e.y&&0===r?(n=0,!1):r==t.textData.length-1&&a.y+i<e.y?(n+=o.length+1,!1):void(n+=o.length+(1==o.length&&0===o[0].width?0:1))}),n<t.index?(this.selection.setStartOffset(n),this.selection.setEndOffset(t.index)):n==t.index?this.selection.setStartOffset(n).collapse(!0):(this.selection.setStartOffset(t.index),this.selection.setEndOffset(n)),this},updateRange:function(){return this.range.update(),this},updateContainerRangeBySel:function(){var e=this;return this.range.setStartOffset(this.selection.startOffset),this.range.setEndOffset(this.selection.endOffset),browser.gecko?(this.container.focus(),setTimeout(function(){e.range.select()})):this.range.select(),this},updateSelectionByRange:function(){return this.selection.setStartOffset(this.range.getStartOffset()),this.selection.setEndOffset(this.range.getEndOffset()),this},setIndex:function(e){return this.index=e,this},setContainerTxt:function(e){function t(e){return e.replace(/</g,"&lt;").replace(/>/g,"&gt;")}return e?(e=t(e),e=e.replace(/[\n]/g,"<br/>")):(e="",this.textGroup.eachItem(function(n,i){e+=t(i.getContent())+"<br/>"})),this.container.innerHTML=e,this},setReady:function(){this._ready=!0},clearReady:function(){this._ready=!1},isReady:function(){return this._ready},focus:function(){this.container.focus()},getTxtOfContainer:function(){var e="",t=this.container;return utils.each(t.childNodes,function(n,i){3==i.nodeType?e+=i.nodeValue.replace(/[\u200b]/g,""):i!==t.lastChild&&(e+="\n")}),e}}),Minder.Selection=kity.createClass("Selection",{base:kity.Path,constructor:function(e,t,n){this.callBase(),this.height=e||20,this.setAttr("id","_kity_selection"),this.width=2,this.fill("rgb(27,171,255)"),this.setHide(),this.timer=null,this.collapsed=!0,this.startOffset=this.endOffset=0,this.setOpacity(.5),this.setStyle("cursor","text"),this._show=!1,this.offset=[],this.setTranslate(-.5,-1.5)},setMinderNode:function(e){this.minderNode=e},setColor:function(e){this.fill(e)},updateOffsetByTextData:function(e,t){if(this.collapsed)return this.offset=utils.getValueByIndex(e,this.startOffset),this;var n=[],i={},r=this.startOffset,o=this.endOffset,a=0;return utils.each(e,function(e,t){return i={width:0,x:0,y:0},utils.each(t,function(e,t){if(a>=r&&o>=a)if(0===e||a===r)i.x=t.x,i.y=t.y,i.width=t.width;else if(o>a)i.width+=t.width;else if(a===o)return!1;a++}),void 0!==i.x&&n.push(i),a===o?!1:void((1!=t.length||0!==t[0].width)&&a++)}),this.offset=n,this},updatePosition:function(e){var t=this,n=Math.round,i=function(e,t,i,r){return["M",n(e),n(t),"h",n(i),"v",n(r),"h",-n(i),"v",-n(r),"z"]};if(e=void 0!==e?e:this.offset,this.collapsed){if(isNaN(e.x)||isNaN(e.y))return console&&console.warn("editor.selection.js 不正确的偏移位置"),this;this.setPathData(i(e.x,e.y,this.width,this.height))}else this.setPathData(e.reduce(function(e,n){return e.concat(i(n.x,n.y,n.width,t.height))},[]));return this._show=!0,this},collapse:function(e){return this.setOpacity(1),this.collapsed=!0,e?this.endOffset=this.startOffset:this.startOffset=this.endOffset,this},setStartOffset:function(e){return this.startOffset=e,this.startOffset>=this.endOffset?(this.collapse(!0),this):(this.collapsed=!1,this.setOpacity(.5),this)},setEndOffset:function(e){return this.endOffset=e,this.endOffset<=this.startOffset?(this.startOffset=e,this.collapse(!0),this):(this.collapsed=!1,this.setOpacity(.5),this)},update:function(e,t){return e&&this.updateOffsetByTextData(e,t),this.updatePosition(),this.setShow(),this},setHeight:function(e){return this.height=Math.round(e)+2,this},setHide:function(){return clearInterval(this.timer),this.setStyle("display","none"),this._show=!1,this},setHoldShow:function(){return this.setStyle("display",""),clearInterval(this.timer),this},setShow:function(){this.bringTop(),clearInterval(this.timer);var e=this,t="";return e.setStyle("display",""),e._show=!0,this.collapsed&&(e.setOpacity(1),this.timer=setInterval(function(){e.setStyle("display",t),t=t?"":"none"},400)),this},setShowStatus:function(){return this._show=!0,this},isShow:function(){return this._show},isHide:function(){return!this._show}}),KityMinder.registerModule("basestylemodule",function(){function e(e,t){return e.getData(t)||e.getStyle(t)}var t=this;return KityMinder.TextRenderer.registerStyleHook(function(t,n){var i=e(t,"font-weight"),r=e(t,"font-style");[i,r].join("/");n.eachItem(function(e,t){t.setFont({weight:i,style:r})})}),{commands:{bold:kity.createClass("boldCommand",{base:Command,execute:function(e){var t=e.getSelectedNodes();1==this.queryState("bold")?utils.each(t,function(e,t){t.setData("font-weight").render()}):utils.each(t,function(e,t){t.setData("font-weight","bold").render()}),e.layout()},queryState:function(){var e=t.getSelectedNodes(),n=0;return 0===e.length?-1:(utils.each(e,function(e,t){return t&&t.getData("font-weight")?(n=1,!1):void 0}),n)}}),italic:kity.createClass("italicCommand",{base:Command,execute:function(e){var t=e.getSelectedNodes();1==this.queryState("italic")?utils.each(t,function(e,t){t.setData("font-style").render()}):utils.each(t,function(e,t){t.setData("font-style","italic").render()}),e.layout()},queryState:function(){var e=t.getSelectedNodes(),n=0;return 0===e.length?-1:(utils.each(e,function(e,t){return t&&t.getData("font-style")?(n=1,!1):void 0}),n)}})},commandShortcutKeys:{bold:"ctrl+b",italic:"ctrl+i"}}}),KityMinder.registerModule("fontmodule",function(){function e(e,t){return e.getData(t)||e.getStyle(t)}return KityMinder.TextRenderer.registerStyleHook(function(t,n){var i=t.getData("color"),r=t.getStyle("selected-color"),o=t.getStyle("color"),a=i||(t.isSelected()&&r?r:o),s=e(t,"font-family"),l=e(t,"font-size"),u=[s,l].join("/");n.fill(a),t.setTmpData("fore-color",a.toString()),n.eachItem(function(e,t){t.setFont({family:s,size:l})}),t.setTmpData("font-hash",u)}),{defaultOptions:{fontfamily:[{name:"宋体",val:"宋体,SimSun"},{name:"微软雅黑",val:"微软雅黑,Microsoft YaHei"},{name:"楷体",val:"楷体,楷体_GB2312,SimKai"},{name:"黑体",val:"黑体, SimHei"},{name:"隶书",val:"隶书, SimLi"},{name:"Andale Mono",val:"andale mono"},{name:"Arial",val:"arial,helvetica,sans-serif"},{name:"arialBlack",val:"arial black,avant garde"},{name:"Comic Sans Ms",val:"comic sans ms"},{name:"Impact",val:"impact,chicago"},{name:"Times New Roman",val:"times new roman"},{name:"Sans-Serif",val:"sans-serif"}],fontsize:[10,12,16,18,24,32,48]},commands:{forecolor:kity.createClass("fontcolorCommand",{base:Command,execute:function(e,t){var n=e.getSelectedNodes();utils.each(n,function(e,n){n.setData("color",t),n.render()})},queryState:function(e){return 0==e.getSelectedNodes().length?-1:0},queryValue:function(e){return 1==e.getSelectedNodes().length?e.getSelectedNodes()[0].getData("color"):"mixed"}}),background:kity.createClass("backgroudCommand",{base:Command,execute:function(e,t){var n=e.getSelectedNodes();utils.each(n,function(e,n){n.setData("background",t),n.render()})},queryState:function(e){return 0==e.getSelectedNodes().length?-1:0},queryValue:function(e){return 1==e.getSelectedNodes().length?e.getSelectedNodes()[0].getData("background"):"mixed"}}),fontfamily:kity.createClass("fontfamilyCommand",{base:Command,execute:function(e,t){var n=e.getSelectedNodes();utils.each(n,function(n,i){i.setData("font-family",t),i.render(),e.layout()})},queryState:function(e){return 0===e.getSelectedNodes().length?-1:0},queryValue:function(e){var t=e.getSelectedNode();return t?t.getData("font-family"):null}}),fontsize:kity.createClass("fontsizeCommand",{base:Command,execute:function(e,t){var n=e.getSelectedNodes();utils.each(n,function(n,i){i.setData("font-size",t),i.render(),e.layout(300)})},queryState:function(e){return 0==e.getSelectedNodes().length?-1:0},queryValue:function(e){var t=e.getSelectedNode();return t?t.getData("font-size"):null}})}}}),KityMinder.registerModule("Zoom",function(){function e(){var e=r._zoomValue>=100?"optimize-speed":"geometricPrecision";r.getRenderContainer().setAttr("text-rendering",e)}function t(e){var t=e.shapeNode,n=t.getCTM(),i=new kity.Matrix(n.a,n.b,n.c,n.d,(0|n.e)+.5,(0|n.f)+.5);t.setAttribute("transform","matrix("+i.toString()+")")}function n(t,n){var r=t.getPaper();r.getViewPort();if(n){if(e(),t.getRoot().getComplex()>200)t._zoomValue=n,t.zoom(n),t.fire("viewchange");else{var o=new kity.Animator({beginValue:t._zoomValue,finishValue:n,setter:function(e,t){e.zoom(t)}});t._zoomValue=n,i&&i.pause(),i=o.start(t,300,"easeInOutSine"),i.on("finish",function(){t.fire("viewchange")})}t.fire("zoom",{zoom:n})}}var i,r=this;r.setDefaultOptions("zoom",[10,20,30,50,80,100,120,150,200]),kity.extendClass(Minder,{zoom:function(e){var n=this.getPaper(),i=n.getViewPort();i.zoom=e/100,i.center={x:i.center.x,y:i.center.y},n.setViewPort(i),100==e&&t(n)},getZoomValue:function(){return this._zoomValue}});var o=kity.createClass("Zoom",{base:Command,execute:n,queryValue:function(e){return e._zoomValue}}),a=kity.createClass("ZoomInCommand",{base:Command,execute:function(e){n(e,this.nextValue(e))},queryState:function(e){return+!this.nextValue(e)},nextValue:function(e){var t,n=e.getOptions("zoom");for(t=0;t<n.length;t++)if(n[t]>e._zoomValue)return n[t];return 0},enableReadOnly:!0}),s=kity.createClass("ZoomOutCommand",{base:Command,execute:function(e){n(e,this.nextValue(e))},queryState:function(e){return+!this.nextValue(e)},nextValue:function(e){var t,n=e.getOptions("zoom");for(t=n.length-1;t>=0;t--)if(n[t]<e._zoomValue)return n[t];return 0},enableReadOnly:!0});return{init:function(){this._zoomValue=100,e()},commands:{"zoom-in":a,"zoom-out":s,zoom:o},events:{"normal.mousewheel readonly.mousewheel":function(e){if(e.originEvent.ctrlKey||e.originEvent.metaKey){var t=e.originEvent.wheelDelta,n=this;kity.Browser.mac||(t=-t),Math.abs(t)>100&&(clearTimeout(this._wheelZoomTimeout),this._wheelZoomTimeout=setTimeout(function(){n.getPaper()._zoom||1;0>t?n.execCommand("zoom-in"):t>0&&n.execCommand("zoom-out")},100),e.originEvent.preventDefault())}}},commandShortcutKeys:{"zoom-in":"ctrl+=","zoom-out":"ctrl+-"}}}),KityMinder.registerModule("hyperlink",function(){var e="M16.614,10.224h-1.278c-1.668,0-3.07-1.07-3.599-2.556h4.877c0.707,0,1.278-0.571,1.278-1.278V3.834 c0-0.707-0.571-1.278-1.278-1.278h-4.877C12.266,1.071,13.668,0,15.336,0h1.278c2.116,0,3.834,1.716,3.834,3.834V6.39 C20.448,8.508,18.73,10.224,16.614,10.224z M5.112,5.112c0-0.707,0.573-1.278,1.278-1.278h7.668c0.707,0,1.278,0.571,1.278,1.278 S14.765,6.39,14.058,6.39H6.39C5.685,6.39,5.112,5.819,5.112,5.112z M2.556,3.834V6.39c0,0.707,0.573,1.278,1.278,1.278h4.877 c-0.528,1.486-1.932,2.556-3.599,2.556H3.834C1.716,10.224,0,8.508,0,6.39V3.834C0,1.716,1.716,0,3.834,0h1.278 c1.667,0,3.071,1.071,3.599,2.556H3.834C3.129,2.556,2.556,3.127,2.556,3.834z";return{commands:{hyperlink:kity.createClass("hyperlink",{base:Command,execute:function(e,t,n){var i=e.getSelectedNodes();utils.each(i,function(e,i){i.setData("hyperlink",t),i.setData("hyperlinkTitle",n),i.render()}),e.layout()},queryState:function(e){var t=e.getSelectedNodes(),n=0;return 0===t.length?-1:(utils.each(t,function(e,t){return t&&t.getData("hyperlink")?(n=0,!1):void 0}),n)},queryValue:function(e){var t=e.getSelectedNode();return{url:t.getData("hyperlink"),title:t.getData("hyperlinkTitle")}}}),unhyperlink:kity.createClass("hyperlink",{base:Command,execute:function(e){var t=e.getSelectedNodes();utils.each(t,function(e,t){t.setData("hyperlink"),t.render()}),e.layout()},queryState:function(e){var t=e.getSelectedNodes();if(0===t.length)return-1;var n=!1;return utils.each(t,function(e,t){return t.getData("hyperlink")?(n=!0,!1):void 0}),n?0:-1}})},renderers:{right:kity.createClass("hyperlinkrender",{base:KityMinder.Renderer,create:function(){var t=new kity.HyperLink,n=new kity.Path,i=new kity.Rect(24,22,-2,-6,4).fill("rgba(255, 255, 255, 0)");return n.setPathData(e).fill("#666"),t.addShape(i),t.addShape(n),t.setTarget("_blank"),t.setStyle("cursor","pointer"),t.on("mouseover",function(){i.fill("rgba(255, 255, 200, .8)")}).on("mouseout",function(){i.fill("rgba(255, 255, 255, 0)")}),t},shouldRender:function(e){return e.getData("hyperlink")},update:function(e,t,n){var i=t.getData("hyperlink");e.setHref(i);var r=t.getData("hyperlinkTitle");r=r?[r,"(",i,")"].join(""):i,e.node.setAttributeNS("http://www.w3.org/1999/xlink","title",r);var o=t.getStyle("space-right");return e.setTranslate(n.right+o+2,-5),new kity.Box({x:n.right+o,y:-11,width:24,height:22})}})}}}),kity.extendClass(MinderNode,{arrange:function(e){var t=this.parent;if(t){var n=t.children;if(!(0>e||e>=n.length))return n.splice(this.getIndex(),1),n.splice(e,0,this),this}}});var ArrangeUpCommand=kity.createClass("ArrangeUpCommand",{base:Command,execute:function(e){var t=e.getSelectedNodes();t.sort(asc);var n=t.map(function(e){return e.getIndex()});t.forEach(function(e,t){e.arrange(n[t]-1)}),e.layout(300)},queryState:function(e){var t=e.getSelectedNode();return t?0:-1}}),ArrangeDownCommand=kity.createClass("ArrangeUpCommand",{base:Command,execute:function(e){var t=e.getSelectedNodes();t.sort(desc);var n=t.map(function(e){return e.getIndex()});t.forEach(function(e,t){e.arrange(n[t]+1)}),e.layout(300)},queryState:function(e){var t=e.getSelectedNode();return t?0:-1}}),ArrangeCommand=kity.createClass("ArrangeCommand",{base:Command,execute:function(e,t,n){if(t=t&&t.slice()||e.getSelectedNodes().slice(),t.length){var i=MinderNode.getCommonAncestor(t);if(i==t[0].parent){var r=t.map(function(e){return{index:e.getIndex(),node:e}}),o=Math.min.apply(Math,r.map(function(e){return e.index}))>=n;r.sort(function(e,t){return o?t.index-e.index:e.index-t.index}),r.forEach(function(e){e.node.arrange(n)}),e.layout(300)}}},queryState:function(e){var t=e.getSelectedNode();return t?0:-1}});KityMinder.registerModule("ArrangeModule",{commands:{arrangeup:ArrangeUpCommand,arrangedown:ArrangeDownCommand,arrange:ArrangeCommand},contextmenu:[{command:"arrangeup"},{command:"arrangedown"},{divider:!0}],commandShortcutKeys:{arrangeup:"normal::alt+Up",arrangedown:"normal::alt+Down"}}),KityMinder.registerModule("ClipboardModule",function(){function e(t,i){r.push(i),n.appendNode(i,t),i.render(),i.setLayoutOffset(null);for(var o,a=utils.cloneArr(i.children),s=0;o=a[s];s++)e(i,o)}function t(e){e.length&&(e.sort(function(e,t){return e.getIndex()-t.getIndex()}),i=e.map(function(e){return e.clone()}))}var n=this,i=[],r=[],o=kity.createClass("CopyCommand",{base:Command,execute:function(e){t(e.getSelectedAncestors(!0)),this.setContentChanged(!1)}}),a=kity.createClass("CutCommand",{base:Command,execute:function(e){var n=e.getSelectedAncestors();0!==n.length&&(t(n),e.select(MinderNode.getCommonAncestor(n),!0),n.slice().forEach(function(t){e.removeNode(t)}),e.layout(300))}}),s=kity.createClass("PasteCommand",{base:Command,execute:function(t){if(i.length){var n=t.getSelectedNode();if(!n)return;for(var o,a=0;o=i[a];a++)e(n,o.clone());t.select(r,!0),r=[],t.layout(300)}},queryState:function(e){return e.getSelectedNode()?0:-1}});return{commands:{copy:o,cut:a,paste:s},commandShortcutKeys:{copy:"normal::ctrl+c|",cut:"normal::ctrl+x",paste:"normal::ctrl+v"}}}),KityMinder.registerModule("StyleModule",function(){function e(e){for(var n=e.getData(),i=0;i<t.length;i++)if(t[i]in n)return!0}var t=["font-size","font-family","font-weight","font-style","background","color"],n=null;return{commands:{copystyle:kity.createClass("CopyStyleCommand",{base:Command,execute:function(e){var i=e.getSelectedNode(),r=i.getData();return n={},t.forEach(function(e){e in r?n[e]=r[e]:(n[e]=null,delete n[e])}),n},queryState:function(t){var n=t.getSelectedNodes();return 1!==n.length?-1:e(n[0])?0:-1}}),pastestyle:kity.createClass("PastStyleCommand",{base:Command,execute:function(e){return e.getSelectedNodes().forEach(function(e){for(var t in n)n.hasOwnProperty(t)&&e.setData(t,n[t])}),e.renderNodeBatch(e.getSelectedNodes()),e.layout(300),n},queryState:function(e){return n&&e.getSelectedNodes().length?0:-1}}),clearstyle:kity.createClass("ClearStyleCommand",{base:Command,execute:function(e){return e.getSelectedNodes().forEach(function(e){t.forEach(function(t){e.setData(t)})}),e.renderNodeBatch(e.getSelectedNodes()),e.layout(300),n},queryState:function(t){var n=t.getSelectedNodes();if(!n.length)return-1;for(var i=0;i<n.length;i++)if(e(n[i]))return 0;return-1}})}}}),KityMinder.registerProtocol("xmind",function(e){var t={"priority-1":["priority",1],"priority-2":["priority",2],"priority-3":["priority",3],"priority-4":["priority",4],"priority-5":["priority",5],"priority-6":["priority",6],"priority-7":["priority",7],"priority-8":["priority",8],"task-start":["progress",1],"task-oct":["progress",2],"task-quarter":["progress",3],"task-3oct":["progress",4],"task-half":["progress",5],"task-5oct":["progress",6],"task-3quar":["progress",7],"task-7oct":["progress",8],"task-done":["progress",9]};return{fileDescription:"XMind 格式",fileExtension:".xmind",dataType:"blob",mineType:"application/octet-stream",decode:function(e){function n(e,i){if(i.data={text:e.title},e.marker_refs&&e.marker_refs.marker_ref){var r,o=e.marker_refs.marker_ref;if(o.length&&o.length>0)for(var a in o)r=t[o[a].marker_id],r&&(i.data[r[0]]=r[1]);else r=t[o.marker_id],r&&(i.data[r[0]]=r[1])}e["xlink:href"]&&(i.data.hyperlink=e["xlink:href"]);var s=e.children&&e.children.topics,l=s&&(s.topic||s[0]&&s[0].topic);if(l){var u=l;if(u.length&&u.length>0){i.children=[];for(var a in u)i.children.push({}),n(u[a],i.children[a])}else i.children=[{}],n(u,i.children[0])}}function i(e){var t=$.xml2json(e),i={},r=t.sheet,o=utils.isArray(r)?r[0].topic:r.topic;return n(o,i),i}function r(e,t){return new Promise(function(t,n){zip.createReader(new zip.BlobReader(e),function(e){e.getEntries(t)},n)})}function o(e){return new Promise(function(t,n){for(var r,o;(r=e.pop())&&"content.xml"!=r.filename.split("/").pop();)r=null;r?r.getData(new zip.TextWriter,function(e){try{o=i($.parseXML(e)),t(o)}catch(r){n(r)}}):n(new Error("Content document missing"))})}return r(e).then(o)},encode:function(e,t,n){function i(){return new Promise(function(e,t){var n=new XMLHttpRequest;n.open("POST",o),n.responseType="blob",n.onload=e,n.onerror=t;var i=new FormData;i.append("type","xmind"),i.append("data",a),n.send(i)}).then(function(e){return e.target.response})}function r(){function e(e,t){var n=document.createElement("input");return n.type="hidden",n.name=e,n.value=t,n}var t=n.filename||"xmind.xmind",i=document.createElement("form");i.setAttribute("action",o),i.setAttribute("method","POST"),i.appendChild(e("filename",t)),i.appendChild(e("type","xmind")),i.appendChild(e("data",a)),i.appendChild(e("download","1")),document.body.appendChild(i),i.submit(),document.body.removeChild(i)}var o="native-support/export.php",a=JSON.stringify(e);return n&&n.download?r():i()},recognizePriority:-1}}),KityMinder.registerProtocol("freemind",function(e){function t(e,n){n.data={text:e.TEXT};var r;if(e.icon){var o,a=e.icon;if(a.length&&a.length>0)for(r in a)o=i[a[r].BUILTIN],o&&(n.data[o[0]]=o[1]);else o=i[a.BUILTIN],o&&(n.data[o[0]]=o[1])}if(e.LINK&&(n.data.hyperlink=e.LINK),e.node){var s=e.node;if(s.length&&s.length>0){n.children=[];for(r in s)n.children.push({}),t(s[r],n.children[r])}else n.children=[{}],t(s,n.children[0])}}function n(e){var n=$.xml2json(e),i={};return t(n.node,i),i}var i={"full-1":["priority",1],"full-2":["priority",2],"full-3":["priority",3],"full-4":["priority",4],"full-5":["priority",5],"full-6":["priority",6],"full-7":["priority",7],"full-8":["priority",8]};return{fileDescription:"Freemind 格式",fileExtension:".mm",dataType:"text",decode:function(e){return new Promise(function(t,i){try{t(n(e))}catch(r){i(new Error("XML 文件损坏！"))}})},encode:function(e,t,n){function i(){return new Promise(function(e,t){var n=new XMLHttpRequest;n.open("POST",o),n.responseType="blob",n.onload=e,n.onerror=t;var i=new FormData;i.append("type","freemind"),i.append("data",a),n.send(i)}).then(function(e){return e.target.response})}function r(){function e(e,t){var n=document.createElement("input");return n.type="hidden",n.name=e,n.value=t,n}var t=n.filename||"freemind.mm",i=document.createElement("form");i.setAttribute("action",o),i.setAttribute("method","POST"),i.appendChild(e("filename",t)),i.appendChild(e("type","freemind")),i.appendChild(e("data",a)),i.appendChild(e("download","1")),document.body.appendChild(i),i.submit(),document.body.removeChild(i)}var o="native-support/export.php",a=JSON.stringify(e);return n&&n.download?r():i()}}}),KityMinder.registerProtocol("mindmanager",function(e){function t(e,n){if(n.data={text:e.Text&&e.Text.PlainText||""},e.Task){var i;e.Task.TaskPriority&&(i=o[e.Task.TaskPriority],i&&(n.data[i[0]]=i[1])),e.Task.TaskPercentage&&(i=o[e.Task.TaskPercentage],i&&(n.data[i[0]]=i[1]))}if(e.Hyperlink&&(n.data.hyperlink=e.Hyperlink.Url),e.SubTopics&&e.SubTopics.Topic){var r=e.SubTopics.Topic;if(r.length&&r.length>0){n.children=[];for(var a in r)n.children.push({}),t(r[a],n.children[a])}else n.children=[{}],t(r,n.children[0])}}function n(e){var n=$.xml2json(e),i={};return t(n.OneTopic.Topic,i),i}function i(e){return new Promise(function(t,n){zip.createReader(new zip.BlobReader(e),function(e){e.getEntries(t)},n)})}function r(e){return new Promise(function(t,i){for(var r,o;(r=e.pop())&&"Document.xml"!=r.filename.split("/").pop();)r=null;r?r.getData(new zip.TextWriter,function(e){o=n($.parseXML(e)),t(o)}):i(new Error("Main document missing"))})}var o={"urn:mindjet:Prio1":["PriorityIcon",1],"urn:mindjet:Prio2":["PriorityIcon",2],"urn:mindjet:Prio3":["PriorityIcon",3],"urn:mindjet:Prio4":["PriorityIcon",4],"urn:mindjet:Prio5":["PriorityIcon",5],0:["ProgressIcon",1],25:["ProgressIcon",2],50:["ProgressIcon",3],75:["ProgressIcon",4],100:["ProgressIcon",5]};return{fileDescription:"MindManager 格式",fileExtension:".mmap",dataType:"blob",decode:function(e){return i(e).then(r)},encode:null,recognizePriority:-1}}),KityMinder.registerProtocol("plain",function(e){function t(e,t){for(var n="";t--;)n+=e;return n}function n(e,i){var r="";return i=i||0,r+=t(u,i),r+=e.data.text+s,e.children&&e.children.forEach(function(e){r+=n(e,i+1)}),r}function i(e){return!/\S/.test(e)}function r(e){for(var t=0;e.charAt(t)===u;)t++;return t}function o(e){return{data:{text:e.replace(new RegExp("^"+u+"*"),"")}}}function a(e,t){function n(e,t){var n=e.children||(e.children=[]);n.push(t)}var a,s,u,c,h,d={},f=e.split(l);t?(d[0]=a=o("root"),s=1):s=0;for(var p=0;p<f.length;p++)if(u=f[p],!i(u)){if(c=r(u)+s,h=o(u),0===c){if(a)throw new Error("Invalid local format");a=h}else{if(!d[c-1])throw new Error("Invalid local format");n(d[c-1],h)}d[c]=h}return a}var s="\r",l=/\r\n|\r|\n/,u="	";return{fileDescription:"大纲文本",fileExtension:".txt",mineType:"text/plain",dataType:"text",encode:function(e){return n(e,0)},decode:function(e,t){return a(e,t)},recognizePriority:-1}}),KityMinder.registerProtocol("markdown",function(){function e(e){return t(e,1).join("\n")}function t(e,i){var r=[];i=i||1;var o=n(i);r.push(o+" "+e.data.text),r.push(u);var a=e.data.note;if(a){var s=/^#/.test(a);s&&(r.push(c),a=a.replace(/^#+/gm,function(e){return o+e})),r.push(a),s&&r.push(h),r.push(u)}return e.children&&e.children.forEach(function(e){r=r.concat(t(e,i+1))}),r}function n(e){for(var t="";e--;)t+="#";return t}function i(e){var t,n,i,u,c,h,d,f={};e=e.replace(/^(.+)\n={3,}/,function(e,t){return"# "+t}),t=e.split(l);for(var p=0;p<t.length;p++)n=t[p],i=a(n),i.noteClose?h=!1:i.noteStart?h=!0:(d=i.codeBlock?!d:d,h||d||!i.level||i.level>u+1?c&&o(c,n):(u=i.level,c=r(i.content,f[u-1]),f[u]=c));return s(f[1]),f[1]}function r(e,t){var n={data:{text:e,note:""}};return t&&(t.children?t.children.push(n):t.children=[n]),n}function o(e,t){e.data.note+=t+"\n"}function a(e){var t=/^(#+)?\s*(.*)$/.exec(e);return{level:t[1]&&t[1].length||null,content:t[2],noteStart:e==c,noteClose:e==h,codeBlock:/^\s*```/.test(e)}}function s(e){if(/\S/.test(e.data.note)){for(var t=e.data.note.split("\n");t.length&&!/\S/.test(t[0]);)t.shift();for(;t.length&&!/\S/.test(t[t.length-1]);)t.pop();e.data.note=t.join("\n")}else e.data.note=null,delete e.data.note;e.children&&e.children.forEach(s)}var l=/\r\n|\r|\n/,u="",c="<!--Note-->",h="<!--/Note-->";return{fileDescription:"Markdown/GFM 格式",fileExtension:".md",mineType:"text/markdown",dataType:"text",encode:function(t){return e(t)},decode:function(e){return i(e)},recognizePriority:-1}}),KityMinder.registerProtocol("json",function(e){return{fileDescription:"KityMinder 格式",fileExtension:".km",dataType:"text",mineType:"application/json",encode:function(e){return JSON.stringify(e)},decode:function(e){return JSON.parse(e)}}}),kity.Browser.ie||KityMinder.registerProtocol("png",function(e){function t(e,t){return new Promise(function(t,n){var i=document.createElement("img");i.onload=function(){t(this)},i.onerror=function(e){n(e)},i.crossOrigin="",i.src=e})}function n(){var t,n,i,o,a,s=e.getPaper(),l=(s.container,e.getRenderContainer()),u=l.getRenderBox(),c=u.width+1,h=u.height+1;return t=s.shapeNode.getAttribute("transform"),s.shapeNode.setAttribute("transform","translate(0.5, 0.5)"),l.translate(-u.x,-u.y),n=s.container.innerHTML,l.translate(u.x,u.y),s.shapeNode.setAttribute("transform",t),i=$(n).filter("svg"),i.attr({width:u.width+1,height:u.height+1,style:'font-family: Arial, "Microsoft Yahei","Heiti SC";'}),n=$("<div></div>").append(i).html(),n=n.replace(' xmlns="http://www.w3.org/2000/svg" xmlns:NS1="" NS1:ns1:xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:NS2="" NS2:xmlns:ns1=""',""),n=n.replace(/&nbsp;/g,"&#xa0;"),o=new Blob([n],{type:"image/svg+xml"}),a=r.createObjectURL(o),{width:c,height:h,dataUrl:a,xml:n}}function i(i){function o(e,t){e.save(),e.fillStyle=t,e.fillRect(0,0,u.width,u.height),e.restore()}function a(e,t,n,i){e.drawImage(t,n,i)}function s(e){try{var t=e.toDataURL("png");return t}catch(n){throw new Error("当前浏览器版本不支持导出 PNG 功能，请尝试升级到最新版本！")}}function l(){return"undefined"!=typeof window.canvg?new Promise(function(e){window.canvg(u,p.xml,{ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0,ignoreClear:!0,offsetX:y,offsetY:y,renderCallback:function(){e(s(u))}})}):t(v).then(function(e){return a(c,e,y,y),r.revokeObjectURL(v),s(u)})}var u=document.createElement("canvas"),c=u.getContext("2d"),h=e.getStyle("background").toString(),d=/url\((.+)\)/.exec(h),f=kity.Color.parse(h),p=n(),g=p.width,m=p.height,v=p.dataUrl,y=20;return u.width=g+2*y,u.height=m+2*y,d?t(d[1]).then(function(e){return o(c,c.createPattern(e,"repeat")),l()}):(o(c,f.toString()),l())}var r=window.URL||window.webkitURL||window;return{fileDescription:"PNG 图片",fileExtension:".png",mineType:"image/png",dataType:"base64",encode:i,recognizePriority:-1
}}),kity.Browser.ie||KityMinder.registerProtocol("svg",function(e){return{fileDescription:"SVG 矢量图",fileExtension:".svg",mineType:"image/svg+xml",dataType:"text",encode:function(t){var n,i,r=e.getPaper(),o=r.shapeNode.getAttribute("transform"),a=e.getRenderContainer(),s=a.getRenderBox(),l=(a.getTransform(),s.width),u=s.height,c=20;return r.shapeNode.setAttribute("transform","translate(0.5, 0.5)"),n=r.container.innerHTML,r.shapeNode.setAttribute("transform",o),i=$(n).filter("svg"),i.attr({width:l+2*c|0,height:u+2*c|0,style:'font-family: Arial, "Microsoft Yahei",  "Heiti SC"; background: '+e.getStyle("background")}),i[0].setAttribute("viewBox",[s.x-c|0,s.y-c|0,l+2*c|0,u+2*c|0].join(" ")),n=$("<div></div>").append(i).html(),n=$("<div></div>").append(i).html(),n=n.replace(/&nbsp;/g,"&#xa0;")},recognizePriority:-1}}),function(){var e=[];KityMinder.registerUI=function(t,n,i){"function"==typeof n&&(i=n,n=null),e.push({id:t,ui:i,deps:n})},kity.extendClass(Minder,{initUI:function(){var t=this._ui={},n=this;e.forEach(function(e){var i=e.deps;i&&(i=i.map(function(e){return n.getUI(e)})),t[e.id]=e.ui.apply(null,[n].concat(i||[]))}),$("#content-wrapper").delegate("#panel, #tab-container, .fui-dialog, #main-menu","keydown keyup",function(e){e.stopPropagation()}),$("#content-wrapper").delegate("input","mousedown mousemove mouseup contextmenu",function(e){e.stopPropagation()}),n.getPaper().addClass("loading-target"),this.fire("interactchange"),this.fire("uiready")},getUI:function(e){return this._ui[e]}}),$.ajaxSetup({cache:!1}),$.extend($,{pajax:function(){var e=$.ajax.apply($,arguments);return new Promise(function(t,n){e.done(t),e.fail(function(e,t,i){var r=new Error(t);r.getDetail=function(){try{return"jQuery XHR Error: \n"+JSON.stringify(i)}catch(e){return i}},n(r)})})}}),$(function(){var e=["kmcat_warn.png","kmcat_sad.png","icons.png","template_large.png","history.png","feedback.png","iconpriority.png","iconprogress.png","template.png","layout.png","next-level.png","prev-level.png"];e.forEach(function(e){(new Image).src="ui/theme/default/images/"+e})})}(),KityMinder.registerUI("eve",function(e){return{setup:function(e){var t={};return e.on=function(e,n){var i=t[e]||(t[e]=[]);return i.push(n),this},e.off=function(e,n){var i=t[e];if(i){var r=i.indexOf(n);~r?i.splice(r,1):n[e]=null}return this},e.once=function(t,n){return this.on(t,function i(){n.apply(e,arguments),e.off(t,i)})},e.fire=function(n){var i=t[n],r=[].slice.call(arguments,1);return i&&i.forEach(function(t){t.apply(e,r)}),this},e}}}),KityMinder.registerUI("memory",function(){var e=window.localStorage,t=e.uiMemory?JSON.parse(e.uiMemory):{};return{get:function(e){return t[e]||null},set:function(n,i){t[n]=i,e.uiMemory=JSON.stringify(t)}}}),kity.extendClass(FUI.Widget,{setEnable:function(e){e===!1?this.disable():this.enable()},setActive:function(e){e===!1?this.removeClass("active"):this.addClass("active")},bindExecution:function(e,t){var n=this;n.on(e,function(){n.interactFlag||t.apply(n,arguments)})},bindCommandState:function(e,t,n){var i=this;e.on("interactchange",function(){if(i.interactFlag=!0,n){var e=this.queryCommandValue(t);e!=i.lastHandleCommandValue&&(n.call(i,e),i.lastHandleCommandValue=e)}i.setEnable(-1!==this.queryCommandState(t)),i.setActive(1===this.queryCommandState(t)),i.interactFlag=!1})}}),KityMinder.registerUI("axss",function(){function e(e){var t=document.createElement("div");t.innerHTML=e,$(t).find("script, iframe, link").remove();for(var n in t)0===n.indexOf("on")&&t.removeAttribute(n);return t.innerHTML}return e}),KityMinder.registerUI("fiox",function(e){var t=e.getUI("eve");t.setup(fio.user),fio.user.init({apiKey:"wiE55BGOG8BkGnpPs6UNtPbb"})}),KityMinder.registerUI("widget/commandbutton",function(e){return{generate:function(t,n){var i=new FUI.Button({label:e.getLang("ui.command."+t)||e.getLang("ui."+t),text:e.getLang("ui.command."+t)||e.getLang("ui."+t),className:["command-widget","command-button",t]});return i.bindExecution("click",n||function(){e.execCommand(t)}),i.bindCommandState(e,t),i}}}),KityMinder.registerUI("widget/commandbuttonset",function(e){function t(t,n){return n.map(function(n){var i=e.getLang([t,n].join("."))||n;return{label:i,text:i,value:n,className:[t,n].join(" ")}})}function n(n,i){var r=new FUI.Buttonset({id:"template-set",buttons:"object"==typeof i[0]?i:t(n,i),className:["command-widget","command-buttonset",n].join(" ")});return r.bindExecution("change",function(){e.execCommand(n,r.getValue())}),r.bindCommandState(e,n,function(e){this.selectByValue(e)}),r}return{generate:n}}),KityMinder.registerUI("widget/commandinputmenu",function(e){function t(t,n){var i=new FUI.InputMenu({menu:{items:n},input:{placeholder:e.getLang("ui."+t)},className:["command-widget","command-inputmenu",t]});i.bindCommandState(e,t,function(e){i.selectByValue(e)||i.clearSelect()});var r=-1;return i.bindExecution("select",function(n,o){~o.index?e.execCommand(t,o.value):i.select(r),r=o.index}),i}return{generate:t}}),KityMinder.registerUI("widget/commandselectmenu",function(e){function t(t,n){return n.map(function(n){var i=e.getLang([t,n].join("."))||n;return{clazz:"Button",label:i,text:i,value:n,className:[t,n].join(" ")}})}function n(n,i,r){var o=new FUI.SelectMenu({widgets:"object"==typeof i[0]?i:t(n,i),className:["command-widget","command-selectmenu",n].join(" "),column:r||3});return o.bindExecution("change",function(){e.execCommand(n,o.getValue())}),o.bindCommandState(e,n,function(e){void 0!==e&&this.selectByValue(e)}),o}return{generate:n}}),KityMinder.registerUI("widget/notice",function(e){function t(e,t){function n(){var t=e.text(),n=new RegExp("at.+"+p+".+\\:(\\d+)\\:(\\d+)\\)?","g");e.text(t.replace(n,function(e,t,n){var i={line:+t,column:+n},r=d.originalPositionFor(i),o=r.name;i={line:r.line,column:r.column},r=h.originalPositionFor(i),o=o||"<Anonymous>";var a="at "+o+" ("+r.source.replace("../","")+":"+r.line+":"+r.column+")";return-1!=a.indexOf("promise")&&(a="at <async> Promise."+o),a}))}if(p){if(h)return n();t.addClass("loading"),setTimeout(function(){t.removeClass("loading")},5e3);var i=document.createElement("script");i.onload=function(){Promise.all([$.pajax({url:p.replace("min.js","js.map"),dataType:"json"}),$.pajax({url:p.replace(".js",".map"),dataType:"json"})]).then(function(e){h=new window.sourceMap.SourceMapConsumer(e[0]),d=new window.sourceMap.SourceMapConsumer(e[1]),n(),t.removeClass("loading")})},i.src="lib/source-map.min.js",document.head.appendChild(i)}}function n(t,i,r){u.hasClass("show")||u.empty(),clearTimeout(n.ttl2),i?u.addClass("warn"):u.removeClass("warn");var o=e.getUI("menu/menu");u.css({top:o&&o.isVisible()?$("#main-menu .main-menu-level1").offset().top:$("#kityminder").offset().top+20}),u.append($("<p>").text(t)),u.addClass("show"),clearTimeout(n.ttl),r=r||(i?5e3:3e3),n.ttl=setTimeout(function(){u.removeClass("show"),n.ttl2=setTimeout(function(){u.empty()},1e3)},r)}function i(e){n(e,i)}function r(e){return e=e||new Error,"string"==typeof e&&(e=new Error(e)),e.getDetail?e:("undefined"!=typeof fio&&e instanceof fio.FileRequestError?(e.status?e.description=s.pcs_code[e.detail.error_code]:e.description=s.err_network,e.getDetail=function(){return JSON.stringify(e,null,4)}):"readyState"in e||(e.getDetail=function(){return e.stack||(new Error).stack}),e)}function o(n,i){1==arguments.length&&(i=n,n="unknown"),f.empty(),i=r(i);var u=$("<div>").addClass("error-content").appendTo(f);$("<h3>").text(s[n]||s.err_unknown).appendTo(u),$("<p>").text(i.message||i.description||s.unknownreason).appendTo(u);if(i.getDetail){var h=$("<div>").addClass("error-detail").append($('<a class="expander"></a>').text(e.getLang("ui.error_detail"))).appendTo(f),d=$("<div>").addClass("error-detail-wrapper").appendTo(h),p=$("<textarea>").attr("id","error-detail-content").text(i.getDetail()+"\n\n浏览器信息："+navigator.userAgent).appendTo(d);t(p,d);var g=$("<button>").addClass("copy-and-feedback").text(e.getLang("ui.copy_and_feedback")).appendTo(d);g.attr("data-clipboard-target","error-detail-content"),a(g),l.get("show-error-detail")&&h.addClass("expanded")}return c.show(),c.getElement().style.top="180px",new Promise(function(e){o.resolve=e})}function a(t){if(window.ZeroClipboard){ZeroClipboard.config({swfPath:"lib/ZeroClipboard.swf",hoverClass:"hover",activeClass:"active"});var n=new window.ZeroClipboard(t);n.on("ready",function(){n.on("aftercopy",function(){c.hide(),e.getUI("topbar/feedback").click()})})}else t.remove()}var s=e.getLang("error_message"),l=e.getUI("memory"),u=$("<div>").addClass("notice-widget").appendTo("#content-wrapper"),c=($("<div>").addClass("error-mask"),new FUI.Dialog({width:500,height:"auto",prompt:!0,caption:s.title,className:"error-dialog"}).appendTo(document.getElementById("content-wrapper")));c.on("ok cancel",function(e){o.resolve&&o.resolve(e)});var h,d,f=$(c.getBodyElement()),p=function(){for(var e,t,n=[].slice.apply(document.getElementsByTagName("script"));e=n.pop();)if(t=/kityminder.*\.min\.js/.exec(e.src))return t[0];return!1}();return f.delegate(".error-detail a.expander","click",function(e){var t=$(e.target).closest(".error-detail").toggleClass("expanded"),n=t.hasClass("expanded");l.set("show-error-detail",n)}),{info:n,error:o,warn:i}}),KityMinder.registerUI("widget/friendlytimespan",function(e){function t(t){var n=Math.abs(t-new Date),i=n/1e3,r=i/60,o=r/60,a=o/24;return 60>i?e.getLang("ui.justnow",0|i):60>r?e.getLang("ui.minutesago",0|r):24>o?e.getLang("ui.hoursago",0|o):2>a?e.getLang("ui.yesterday"):30>=a?e.getLang("ui.daysago",0|a):e.getLang("ui.longago")}function n(e){e.text(t(e.data("time")))}function i(){$(".friendly-time").each(function(){n($(this))})}$.extend($.fn,{displayFriendlyTime:function(e){return this.each(function(){n($(this).addClass("friendly-time").data("time",e))})}}),setInterval(i,6e4)}),KityMinder.registerUI("widget/locallist",function(){function e(e,t){function n(){d=localStorage.getItem(e),d=d?JSON.parse(d):[],this.length=d.length}function i(){for(;d.length>t;)d.pop();localStorage.setItem(e,JSON.stringify(d)),this.length=d.length}function r(e){return d[e]}function o(e){d.splice(e,1),i()}function a(){d=[],i()}function s(e){d.unshift(e),i()}function l(e){return function(t,n){return t[e]==n}}function u(e,t){"string"==typeof e&&(e=l(e));for(var n=0;n<d.length;n++)if(e(d[n],t))return n;return-1}function c(e,t){return r(u(e,t))}function h(e){d.forEach(e),i()}var d;t=t||10,n.call(this),this.get=r,this.remove=o,this.findIndex=u,this.find=c,this.forEach=h,this.unshift=s,this.clear=a}return{use:function(t){return new e(t)}}}),KityMinder.registerUI("widget/netdiskfinder",function(e){function t(t,c){function h(){function n(r){function o(e){c.remove(),r.find(".icon").after('<span class="filename">'+e+"</span>"),r.removeClass("renaming"),r.attr("draggable",!0)}function a(){o(l.filename)}function s(){var n=c.val(),r=l.parentPath+n;return l.filename==n?a():fio.file.anlysisPath(n).extension!=l.extension?(c.addClass("invalid-name"),setTimeout(function(){c.removeClass("invalid-name")},500),c.select()):(t.addClass("loading"),void y(l.path,r).then(function(){var t=l.path;l.filename=n,l.path=r,o(n),u.fire("mv",t,r,A),i.info(e.getLang("ui.rename_success",n))})["catch"](function(e){i.error("err_rename",e),a()}).then(function(){t.removeClass("loading")}))}n.onprogress=!0;var l=r.data("file"),c=$("<input>").attr("type","text").addClass("new-dir-name fui-widget fui-selectable").val(l.filename).appendTo(r);r.removeAttr("draggable"),c.on("keydown",function(e){return 13==e.keyCode?s():27==e.keyCode?(e.stopPropagation(),a()):void 0}).on("blur",a),c.on("dragstart mousedown mouseup click dblclick",function(e){e.stopPropagation()}),setTimeout(function(){c[0].select()})}z.delegate(".file-list-item a.rename-button","click",function(e){var t=$(e.target).closest("li");t.find("span.filename").remove(),n(t),t.addClass("renaming"),e.stopPropagation()})}function d(){z.delegate(".file-list-item","dblclick",function(e){if(I!=a+"/"){if(_.onprogress)return _.onprogress.select();var t=$(e.target).closest("li"),n=t.data("file");n&&w(n)}}),z.delegate(".file-list-item","mousedown",function(e){if(_.onprogress)return _.onprogress.select();var t=$(e.target).closest("li"),n=t.data("file");n&&E(n&&n.path)})}function f(){R.delegate("a","click",function(e){if(_.onprogress)return _.onprogress.select();if($(e.target).hasClass("dir-back")){var t=I.split("/");return t.pop(),t.pop(),S(t.join("/"))}S($(e.target).data("path"))})}function p(){function n(e){var t=$(e.target);if(t.hasClass("file-list-item")){try{var n=kity.Browser.ie&&10==kity.Browser.version?"text":"text/plain";e.originalEvent.dataTransfer.setData(n,"FEX"),e.originalEvent.dataTransfer.setDragImage(t.find(".icon").get(0),12,12)}catch(i){}p=t.addClass("dragging"),O.addClass("drop-mode")}}function o(e){$(e.target).removeClass("dragging"),e.originalEvent.dataTransfer.dropEffect="move",e.preventDefault(),O.removeClass("drop-mode")}function a(e){$(e.target).hasClass("filename")&&e.preventDefault()}function l(e){var t=$(e.target).closest(".dir");t.addClass("drag-enter"),e.target!=t[0]&&t.addClass("enter-child")}function c(e){if($(e.target).hasClass("dir")){if($(e.target).hasClass("enter-child"))return $(e.target).removeClass("enter-child");$(e.target).removeClass("drag-enter")}}function h(n){function o(){y(d,h).then(function(){p.remove(),u.fire("mv",d,h,A),i.info(e.getLang("ui.move_success",l.filename,c.filename))})["catch"](function(e){i.error("err_move_file",e)}).then(function(){t.removeClass("loading")})}n.preventDefault();var a=$(n.target).closest(".dir").removeClass("drag-enter");if(a.hasClass("dir")){var l=p.data("file"),c=a.data("file"),h=c.path+"/"+l.filename,d=l.path;0!==h.indexOf(d)&&(!s||window.confirm(e.getLang("ui.move_file_confirm",l.filename,c.filename)))&&(t.addClass("loading"),r.then(o),s=!1)}}var d=".file-list-item",f=".dir",p=null;z.delegate(d,"dragstart",n).delegate(d,"dragend",o).delegate(f,"dragover",a).delegate(f,"dragenter",l).delegate(f,"dragleave",c).delegate(f,"drop",h),D.delegate(f,"dragover",a).delegate(f,"dragenter",l).delegate(f,"dragleave",c).delegate(f,"drop",h),z.delegate(d+" input","dragstart",function(e){e.stopPropagation(),e.preventDefault()})}function g(){S(a)}function m(){return fio.file.mkdir({path:a})}function v(){window.confirm(e.getLang("ui.recycle_clear_confirm"))&&(t.addClass("loading"),fio.file["delete"]({path:a}).then(function(){return r=m()}).then(function(){M([]),t.removeClass("loading")}))}function y(e,t){return fio.file.move({path:e,newPath:t,ondup:0===t.indexOf(a)?fio.file.DUP_RENAME:fio.file.DUP_FAIL})}function _(){function n(){r.remove(),_.onprogress=!1}function i(){var n=o.val();n&&(t.addClass("loading"),fio.file.mkdir({path:I+n}).then(function(){return new Promise(function(e){setTimeout(function(){e(C())},200)})},function(t){t.detail&&31061==t.detail.error_code&&(t.message="已存在同名目录");var n=e.getUI("widget/notice");n.error("err_mkdir",t),r.remove()}).then(function(){t.removeClass("loading"),_.onprogress=!1}))}if(_.onprogress)return _.onprogress.select();var r=$("<li>").addClass("file-list-item dir").prependTo(z);r.append('<span class="icon"></span>');var o=$("<input>").attr("type","text").addClass("new-dir-name fui-widget fui-selectable").val(e.getLang("ui.newdir")).appendTo(r);_.onprogress=o[0],o[0].select(),o.on("keydown",function(e){13==e.keyCode&&i(),27==e.keyCode&&(n(),e.stopPropagation())}).on("blur",i)}function b(e){return e>0?1:0>e?-1:0}function w(e){return e.isDir?S(e.path):void A.fire("fileclick",e)}function x(e){return new Promise(function(t,n){z.transit({x:e,opacity:0},100,t)})}function k(){return new Promise(function(e){z.css({x:-parseInt(z.css("x"))}).stop().transit({x:0,opacity:1},100,e)})}function C(){return S(I,!0)}function S(t,n){function i(e){if(!r&&t==o){for(var n=0;n<e.length;n++){e[n].path==a&&(r=Promise.resolve(!0));break}r=r||m()}}t=t||o;var s=fio.file.list({path:t}),l=n?Promise.resolve():x(-100*b(t.length-I.length));return I="/"==t.charAt(t.length-1)?t:t+"/",L(),Promise.all([s,l]).then(function(e){var t=e[0];return i(t),M(t)},function(t){var n=e.getUI("widget/notice");n.error("err_ls",t)})}function T(t){z.empty(),t.length?t.forEach(function(t){(t.isDir||c&&c(t))&&t.path!=a&&$("<li></li>").append('<span class="icon"></span>').append('<span class="filename">'+t.filename+"</span>").append('<a class="rename-button" title="'+e.getLang("ui.rename")+'">"'+e.getLang("ui.rename")+'"</a>').addClass("file-list-item").addClass(t.isDir?"dir":"file").data("file",t).attr("draggable",!0).appendTo(z)}):z.append('<li class="empty" disabled="disabled">'+e.getLang("ui.emptydir")+"</li>")}function M(e){e.sort(function(e,t){return e.isDir>t.isDir?-1:e.isDir==t.isDir&&e.createTime>t.createTime?-1:1}),T(e),l.forEach(function(t){t!=A&&t.pwd()==I&&t._renderFileList(e)}),k(),P(),A.fire("cd",I)}function L(){function t(t){r+=t+"/";var n=$("<a></a>").addClass("dir");return t==o?n.text(e.getLang("ui.mydocument")):".recycle"==t?(n.text(e.getLang("ui.recycle")),O.addClass("recycle-bin")):n.text(t),n.data("path",r).data("file",{path:r.substr(0,r.length-1),filename:t==o?e.getLang("ui.mydocument"):t})}R.empty(),I!=o&&I!=o+"/"?R.append('<a class="dir-back">Back</a>'):R.append('<span class="my-document"></span>');var n=I.substr(o.length),i=n.split("/"),r="";O.removeClass("recycle-bin"),R.append(t(o)),i.forEach(function(e){e&&(R.append('<span class="spliter"></span>'),R.append(t(e)))})}function E(e){return W=e,P()}function P(){var e=!1;return z.find(".file-list-item").removeClass("selected").each(function(){var t=$(this).data("file");t&&t.path==W&&($(this).addClass("selected"),e=!0,z[0].focus(),A.fire("select",t,this))}),e||(W=!1),e}function N(){return I}var A=n.setup({});l.push(A);var I=o,O=$('<div class="netdisk-finder"></div>').appendTo(t),D=$('<div class="head"></div>').appendTo(O),B=$('<div class="control"></div>').appendTo(D),R=($("<a></a>").text(e.getLang("ui.mkdir")).attr("title",e.getLang("ui.mkdir")).addClass("button mkdir").appendTo(B).click(_),$("<a></a>").text(e.getLang("ui.recycle")).attr("title",e.getLang("ui.recycle")).addClass("button recycle dir").data("file",{path:a,filename:e.getLang("ui.recycle")}).appendTo(B).click(g),$("<a></a>").text(e.getLang("ui.recycle_clear")).attr("title",e.getLang("ui.recycle_clear")).addClass("button recycle-clear").appendTo(B).click(v),$('<div class="nav"></div>').appendTo(D)),z=$('<ul class="file-list"></ul>').appendTo(O),W=null;return e.on("uiready",function(){var n=e.getUI("topbar/user");n.requireLogin(t),fio.user.on("login",function(){S()})}),d(),p(),f(),h(),A._renderFileList=T,A.list=S,A.select=E,A.pwd=N,A.refresh=C,A}var n=e.getUI("eve"),i=e.getUI("widget/notice"),r=null,o="/apps/kityminder",a=o+"/.recycle",s=!0,l=[],u=n.setup({});return u.BASE_PATH=o+"/",u.RECYCLE_PATH=a+"/",u.on("mv",function(e,t,n){l.forEach(function(e){n!=e&&e.refresh()})}),u.generate=t,u}),KM.registerUI("widget/menutab",function(e){function t(t,n,i){var r=t.getButtons().length,o=t.appendTab({buttons:[{label:e.getLang("ui.menu."+n+"tab"),className:"tab-"+n}]});return i&&t.select(r),o[0].panel.getContentElement()}return{generate:t}}),KityMinder.registerUI("doc",function(e){function t(e,t){function n(e,t){for(var n=0;n in e&&n in t&&e[n]==t[n];)n++;return n in t?0:n}if("netdisk"==s.source){var i=e.split("/"),r=t.split("/"),o=s.path.split("/"),l=n(o,i);if(l){var u=r.concat(o.slice(l));s.path=u.join("/"),s.title=u.pop(),a.fire("docchange",s)}}}function n(t){if(h)return Promise.reject(new Error("doc was locked"));var n=t;return s=t,l=!0,e.importData(t.content,t.protocol).then(function(n){return t.title=t.title||e.getMinderTitle(),e.execCommand("camera",e.getRoot(),300),t.data=n,t.json=JSON.stringify(n),a.fire("docload",t),a.fire("docchange",t),t})["catch"](function(e){s=n,u.error("err_doc_resolve",e)}).then(function(t){return l=!1,t&&u.info(e.getLang("ui.load_success",t.title)),t})}function i(t){s=t,t.data=e.exportJson(),t.json=JSON.stringify(t.data),t.saved=!0,a.fire("docsave",t),a.fire("docchange",t)}function r(){return s}function o(t){return fio.user.current()?h?!1:t?s.saved:s.saved||window.confirm(e.getLang("ui.unsavedcontent","* "+s.title)):!0}var a=e.getUI("eve").setup({}),s={saved:!0},l=!1,u=e.getUI("widget/notice"),c=e.getUI("widget/netdiskfinder");c&&c.on("mv",t);var h=!1;return a.lock=function(){h=!0},a.unlock=function(){h=!1},setTimeout(function(){e.on("contentchange",function(){l||("netdisk"!=s.source?(s.title=e.getMinderTitle(),s.saved=!1):s.saved=s.json==JSON.stringify(e.exportJson()),a.fire("docchange",s))})},1e3),a.load=n,a.save=i,a.current=r,a.checkSaved=o,a}),KityMinder.registerUI("contextmenu",function(e){function t(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()}function n(e,t){var n=e[0]-t[0],i=e[1]-t[1],r=Math.sqrt(n*n+i*i);return r}var i,r=kity.Browser.mac,o=$("<ul>").addClass("km-context-menu fui-popup-menu").appendTo("#content-wrapper");o.delegate("li","mousedown",function(t,n){var i=$(t.target).closest("li").data("menu");return i.fn?i.fn.call(e,e):i.command?e.execCommand(i.command):void 0}),$("#content-wrapper").on("contextmenu",function(e){e.preventDefault()}),$("#content-wrapper").on("mousedown",function(e){o.hide(),i=2==e.button?[e.pageX,e.pageY]:null}),e.on("mouseup",function(a){if(a.isRightMB()){a=a.originEvent;var s=n(i,[a.pageX,a.pageY]);if(!(isNaN(s)||s>5)){o.empty();var l=e.getContextMenu(),u=!0;if(l.forEach(function(n){var i=n.query||function(){return n.command&&0===e.queryCommandState(n.command)};if(i()){var a=e.getLang("ui.command."+n.command),s=$("<li>").addClass("fui-item").data("menu",n).appendTo(o),l=e.getCommandShortcutKey(n.command);l&&l.split("|").forEach(function(e){var n=$("<span>").addClass("shortcut").appendTo(s);e.split("+").forEach(function(e){var i=e.split("::");e=i.length>1?i[1]:i[0],$("<span>").addClass("shortcut-key "+e.toLowerCase()).text(t(e)).appendTo(n)}),r&&n.addClass("mac")}),s.append($("<div>").text(a).addClass("menu-label")),u=!1}n.divider&&!u&&($("<li>").addClass("divider").appendTo(o),u=!0)}),l.length){o.show();var c=a.pageX,h=a.pageY,d=o.outerWidth(),f=o.outerHeight(),p=document.body.clientWidth,g=document.body.clientHeight;c+d>p&&(c-=d),h+f>g&&(h-=f),o.offset({left:c,top:h})}}}})}),KityMinder.registerUI("nav",function(e){function t(t){function n(e){return(1-(e-a)/l)*u}function i(e){h.animate({y:n(e)},200)}var r=$("<div>").addClass("zoom-pan").appendTo(t),o=e.getOptions("zoom"),a=o[0],s=o[o.length-1],l=s-a,u=r.height(),c=$("<div>").addClass("origin").appendTo(r).css("y",n(100)),h=$("<div>").addClass("indicator").appendTo(r).css("y",n(100));return e.on("zoom",function(e){i(e.zoom)}),c.click(function(){e.execCommand("zoom",100)}),r}function n(){function t(){e.on("layout layoutallfinish",r),e.on("viewchange",o)}function n(){e.off("layout layoutallfinish",r),e.off("viewchange",o)}function i(){function t(t,n){var i=d;t.x=-t.x,t.y=-t.y;var r=e.getPaper().getViewPortMatrix();i=r.transformBox(i);var o=t.offset(i.width/2,i.height/2);e.getViewDragger().moveTo(o,n)}var n=!1;s.on("mousedown",function(e){n=!0,t(e.getPosition("top"),200),a.addClass("grab")}),s.on("mousemove",function(e){n&&t(e.getPosition("top"))}),$(window).on("mouseup",function(){n=!1,a.removeClass("grab")})}function r(){var t=e.getRenderContainer().getBoundaryBox();h=t;var n=30;s.setViewBox(t.x-n-.5,t.y-n-.5,t.width+2*n+1,t.height+2*n+1);var i=[],r=[];e.getRoot().traverse(function(e){var t=e.getLayoutBox();i.push("M",t.x,t.y,"h",t.width,"v",t.height,"h",-t.width,"z"),e.getConnection()&&e.parent&&e.parent.isExpanded()&&r.push(e.getConnection().getPathData())}),s.setStyle("background",e.getStyle("background")),i.length?l.fill(e.getStyle("root-background")).setPathData(i):l.setPathData(null),r.length?u.stroke(e.getStyle("connect-color"),"0.5%").setPathData(r):u.setPathData(null),o()}function o(){d=e.getViewDragger().getView(),c.setBox(d.intersect(h))}var a=$("<div>").addClass("preview-navigator").appendTo("#content-wrapper"),s=new kity.Paper(a[0]),l=s.put(new kity.Path),u=s.put(new kity.Path),c=s.put(new kity.Rect(100,100).stroke("red","1%")),h=new kity.Box,d=new kity.Box;return i(),a.show=function(){$.fn.show.call(this),t(),r(),o()},a.hide=function(){$.fn.hide.call(this),n()},window.u=r,a}function i(t){function n(){i.toggleClass("active").hasClass("active")?(t.show(),r.set("navigator-hidden",!1)):(t.hide(),r.set("navigator-hidden",!0))}var i=$("<div>").addClass("command-button nav-trigger");return i.append('<div class="fui-icon">'),i.click(n),i.attr("title",e.getLang("ui.navigator")),r.get("navigator-hidden")&&n(),n(),i}var r=e.getUI("memory"),o=$("<div>").addClass("nav-bar").appendTo("#content-wrapper"),a=e.getUI("widget/commandbutton"),s=(a.generate("zoom-in").appendTo(o[0]),t(o),a.generate("zoom-out").appendTo(o[0]),n());a.generate("hand").appendTo(o[0]),a.generate("camera",function(){e.execCommand("camera",e.getRoot(),600)}).appendTo(o[0]),i(s).appendTo(o)}),KityMinder.registerUI("topbar/moreservice",function(e){function t(){n.prependTo("#panel").moreService({button:{"float":"left",width:"40px",height:"40px","border-right":"1px solid rgba(255, 255, 255, .5)"}})}var n,i=$("<link>").attr("href","http://baiduoffice.duapp.com/public/assets/style/moreService.css").attr("rel","stylesheet");return $("head").append(i),$.getScript("http://baiduoffice.duapp.com/public/widget/moreService.js",t),n=$('<div id="moreservice"></div>')}),KityMinder.registerUI("menu/menu",function(e){function t(){c.css("display","block"),clearTimeout(s),s=setTimeout(function(){c.addClass("show"),l.fire("show")})}function n(){l.fire("hide"),c.removeClass("show"),e.getRenderTarget().focus(),s=setTimeout(function(){c.css("display","none")})}function i(){return c.hasClass("show")}function r(){$("#content-wrapper").hasClass("fullscreen")||(i()?n:t)()}function o(t,n){var i=u.generate(d,t,n);$("<h2></h2>").text(e.getLang("ui.menu."+t+"header")).appendTo(i);return i}function a(e,t){var n=o(e,t),i=(new FUI.Tabs).appendTo(n);return{$tabs:i,createSub:function(e,t){return u.generate(i,e,t)}}}var s,l=e.getUI("eve").setup({}),u=e.getUI("widget/menutab"),c=$("<div>").attr("id","main-menu").css("display","none").appendTo("#content-wrapper"),h=new FUI.Button({id:"main-menu-btn",label:e.getLang("ui.menu.mainmenutext")}).appendTo(document.getElementById("panel")),d=new FUI.Tabs({className:"main-menu-level1"}).appendTo(c[0]);return h.on("click",r),e.addShortcut("esc",r),l.show=t,l.hide=n,l.toggle=r,l.isVisible=i,l.createSub=o,l.createSubMenu=a,l.$panel=c,l.$button=h,l.$tabs=d,l}),KityMinder.registerUI("menu/header",function(e){var t=e.getUI("menu/menu"),n=$('<div class="main-menu-header"></div>').prependTo(t.$panel),i=$('<div class="main-menu-back-panel"></div>').appendTo(n),r=$('<div class="main-menu-title">百度脑图</div>').appendTo(n);new FUI.Button({className:"main-menu-back-button",label:e.getLang("ui.back")}).appendTo(i[0]).on("click",t.hide);return t.on("show",function(){var t=e.getUI("topbar/title");r.text(t.getTitle())}),n}),KityMinder.registerUI("menu/default",function(e){e.on("uiready",function(){function t(){i.$tabs.select(1),r.$tabs.select(2),a.$tabs.select(1),fio.user.check().then(function(e){e&&a.$tabs.select(0)}),s.$menu.$tabs.select(0)}function n(){var e=/(?:shareId|share_id)=(\w+)([&#]|$)/,t=e.exec(window.location)||e.exec(document.referrer);return t?s.loadShareFile():void fio.user.check().then(function(e){function t(){r.$tabs.select(3),l.openLast()}function n(){r.$tabs.select(0),o.loadLast()}var i=l.last(),a=o.last();e?a?i?a.time>i.time?n():t():n():i?t():r.$tabs.select(1):i?t():r.$tabs.select(2)})}var i=e.getUI("menu/menu"),r=e.getUI("menu/open/open"),o=e.getUI("menu/open/recent"),a=e.getUI("menu/save/save"),s=e.getUI("menu/share/share"),l=e.getUI("menu/open/draft");t(),n()})}),KityMinder.registerUI("menu/new/new",function(e){var t,n=e.getUI("menu/menu"),i=e.getUI("doc"),r=e.getUI("eve").setup({}),o=n.createSub("new"),a=$("<ul></ul>").addClass("new-file-template-select").appendTo(o),s=KityMinder.getTemplateList();for(var l in s)t=$("<li></li>").addClass("template-item").addClass(l).data("template",l).append("<a>"+e.getLang("template")[l]+"</a>").appendTo(a);return a.delegate(".template-item","click",function(t){if(i.checkSaved()){var r=$(t.target).data("template");i.load({content:{template:r,version:KityMinder.version,data:{text:e.getLang("template")[r]}},protocol:null,saved:!0}),n.hide()}}),r}),KityMinder.registerUI("menu/open/open",function(e){return e.getUI("menu/menu").createSubMenu("open",!0)}),KityMinder.registerUI("menu/open/recent",function(e){function t(e,t){function n(e,t){for(var n=0;n in e&&n in t&&e[n]==t[n];)n++;return n in t?0:n}var r=e.split("/"),o=t.split("/");a.forEach(function(e){var t=e.path.split("/"),i=n(t,r);if(i){var a=o.concat(t.slice(i));e.path=a.join("/"),e.filename=o.pop()}}),i()}function n(t){if("netdisk"==t.source){var n=a.findIndex("path",t.path);~n&&a.remove(n),a.unshift({path:t.path,filename:fio.file.anlysisPath(t.path).filename,title:e.getMinderTitle(),time:+new Date}),i()}}function i(){c.empty(),a.forEach(function(e){var t=$("<li></li>").addClass("recent-file-item").data("path",e.path).appendTo(c);$("<h4></h4>").addClass("file-name").text(e.filename).appendTo(t),$("<p></p>").addClass("file-title").text(e.title).appendTo(t),$("<span></span>").addClass("file-time").displayFriendlyTime(e.time).appendTo(t)})}var r=(e.getUI("menu/menu"),e.getUI("menu/open/open")),o=(e.getUI("widget/fileloader"),e.getUI("widget/friendlytimespan"),e.getUI("doc")),a=e.getUI("widget/locallist").use("recent"),s=e.getUI("widget/netdiskfinder"),l=$(r.createSub("recent")).addClass("recent-file-panel");e.on("uiready",function(){e.getUI("topbar/user").requireLogin(l)});var u=($("<h2></h2>").text(e.getLang("ui.recent")).appendTo(l),$("<button></button>").addClass("clear-recent-list").text(e.getLang("ui.clearrecent")).appendTo(l)),c=$("<ul></ul>").addClass("recent-file-list").appendTo(l);return c.delegate(".recent-file-item","click",function(t){if(o.checkSaved()){var n=e.getUI("menu/open/netdisk"),i=$(t.target).closest(".recent-file-item").data("path");n.open(i)}}),u.on("click",function(){window.confirm(e.getLang("ui.clearrecentconfirm"))&&(a.clear(),i())}),o.on("docload",n),o.on("docsave",n),s.on("mv",t),i(),{hasRecent:function(){return a.length},loadLast:function(){c.find(".recent-file-item").eq(0).click()},last:function(){return a.get(0)||null}}}),KityMinder.registerUI("menu/open/netdisk",function(e){function t(t,i){function r(){return fio.file.read({path:t,dataType:h.dataType})}function o(e){var t={protocol:c[e.extension].name,content:e.data.content,title:e.filename,source:"netdisk",path:e.path,saved:!0};return a.load(t)}function s(e){return i&&i(e)||l.error("err_load",e)}n.hide(),$(e.getRenderTarget()).addClass("loading");var u=fio.file.anlysisPath(t),h=c[u.extension];return r().then(o)["catch"](s).then(function(){$(e.getRenderTarget()).removeClass("loading")})}var n=e.getUI("menu/menu"),i=e.getUI("menu/open/open"),r=e.getUI("widget/netdiskfinder"),o=e.getUI("eve"),a=e.getUI("doc"),s=o.setup({}),l=e.getUI("widget/notice"),u=$(i.createSub("netdisk")).addClass("netdisk-open-panel"),c={};e.getSupportedProtocols().forEach(function(e){e.decode&&(c[e.fileExtension]=e)});var h=r.generate(u,function(e){return c[e.extension]});return h.on("fileclick",function(e){return a.checkSaved()?t(e.path):void 0}),s.open=t,s}),KityMinder.registerUI("menu/open/local",function(e){function t(t){function n(e,n){return new Promise(function(e,i){var r;"blob"==n.dataType?e(new fio.file.Data(t)):(r=new FileReader,r.onload=function(){e(new fio.file.Data(this.result))},r.onerror=i,r.readAsText(t,"utf-8"))})}function i(){var t=e.getUI("widget/notice");t.error("err_localfile_read")}function s(e){var t={content:e.content,protocol:u.name,title:l.filename,source:"local"};return r.load(t)}if(t){var l=new fio.file.anlysisPath(t.name),u=a[l.extension];return u&&u.decode?($(e.getRenderTarget()).addClass("loading"),n(t,u).then(s,i).then(function(){$(e.getRenderTarget()).removeClass("loading")})):(o.warn(e.getLang("ui.unsupportedfile")),Promise.reject());
}}var n=e.getUI("menu/menu"),i=e.getUI("menu/open/open"),r=e.getUI("doc"),o=e.getUI("widget/notice"),a={},s=[];e.getSupportedProtocols().forEach(function(e){e.decode&&(a[e.fileExtension]=e,s.push(e.fileExtension))});var l=$(i.createSub("local")).addClass("local-file-open-panel");$("<h2>本地文件</h2>").appendTo(l);var u=$('<div class="pick-file"></div>').appendTo(l),c=$("<a></a>").text(e.getLang("ui.pickfile")).appendTo(u);$("<span></span>").text(e.getLang("ui.acceptfile",s.map(function(e){var t=a[e];return t.fileDescription+"("+e+")"}).join(", "))).appendTo(u);$('<div class="drop-file"></div>').append($("<span></span>").html(e.getLang("ui.dropfile"))).appendTo(l);c.click(function(){r.checkSaved()&&$('<input type="file" />').attr("accept",s.join()).on("change",function(e){t(this.files[0]),n.hide()}).click()});var h=$("#content-wrapper")[0];return h.addEventListener("dragover",function(e){e.preventDefault(),e.stopPropagation()},!1),h.addEventListener("drop",function(e){if(e.dataTransfer.files.length){if(e.preventDefault(),!r.checkSaved())return;t(e.dataTransfer.files[0]),n.hide()}},!1),{read:t}}),KityMinder.registerUI("menu/open/draft",function(e){function t(t){t.saved||(t==p?f&&u.remove(0):f=null,p=t,f=f||{},f.json=JSON.stringify(e.exportJson()),f.title=t.title,f.time=+new Date,f.path=t.path,f.source=t.source,u.unshift(f),i())}function n(){f&&(u.remove(0),f=null),i()}function i(){d.empty(),u.forEach(function(e){var t=$("<li></li>").addClass("draft-list-item").data("item",e).appendTo(d);$("<h4></h4>").addClass("draft-title").text(e.title).appendTo(t),$("<span></span>").addClass("file-time").displayFriendlyTime(e.time).appendTo(t)})}var r=e.getUI("menu/menu"),o=e.getUI("menu/open/open"),a=(e.getUI("widget/fileloader"),e.getUI("widget/friendlytimespan"),e.getUI("doc"));if(localStorage.drafts){var s=JSON.parse(localStorage.drafts),l=s.map(function(e){var t={};return t.json=e.data,t.time=+new Date(e.update),t.title=JSON.parse(e.data).data.text,t});delete localStorage.drafts,localStorage.draft=JSON.stringify(l)}var u=e.getUI("widget/locallist").use("draft"),c=$(o.createSub("draft")).addClass("draft-panel"),h=($("<h2></h2>").text(e.getLang("ui.menu.draftheader")).appendTo(c),$("<button></button>").addClass("clear-draft").text(e.getLang("ui.cleardraft")).appendTo(c)),d=$("<ul></ul>").addClass("draft-list").appendTo(c),f=null,p=null;return d.delegate(".draft-list-item","click",function(e){if(a.checkSaved()){var t=$(e.target).closest(".draft-list-item").data("item"),n=u.findIndex(function(e){return e==t});n>-1&&(f=t,u.remove(n),u.unshift(f),p={title:f.title,protocol:"json",content:f.json,path:f.path,source:f.source,saved:!1},a.load(p)),r.hide()}}),h.on("click",function(){window.confirm(e.getLang("ui.cleardraftconfirm"))&&(u.clear(),f=null,i())}),a.on("docsave",n),a.on("docchange",t),i(),{hasDraft:function(){return u.length},openLast:function(){d.find(".draft-list-item").eq(0).click()},last:function(){return u.get(0)||null}}}),KityMinder.registerUI("menu/save/save",function(e){return e.getUI("menu/menu").createSubMenu("save")}),KityMinder.registerUI("menu/save/netdisk",function(e){function t(){function e(e){e.saved||(clearTimeout(L),L=setTimeout(i,M))}m.on("docchange",e)}function n(){var e=m.current();return"netdisk"==e.source||d.isVisible()?void i():(d.$tabs.select(2),f.$tabs.select(0),d.show())}function i(){var t=m.current();if("netdisk"!=t.source)return Promise.resolve();var n=e.getUI("topbar/title").$title;return k.val(t.title),s(t.path,t.protocol,t,n,"leaveTheMenu")}function r(){var e=k.val(),t=fio.file.anlysisPath(e),n=t.extension;return n!=C.val()&&(n in _?k.val(t.name+C.val()):k.val(e+C.val()),k[0].select()),k.val()}function o(){var e=r(),t=w.pwd()+e,n=m.current(),i=_[C.val()],o=w.select(t),a=n.path==t,s=o&&!a;return{filename:e,path:t,doc:n,protocol:i,exist:o,match:a,duplicated:s}}function a(){var t=o();(t.match||!t.exist||t.duplicated&&window.confirm(e.getLang("ui.overrideconfirm",t.filename)))&&s(t.path,t.protocol.name,t.doc,b)}function s(t,n,i,r,o,a){function s(e){return fio.file.write({path:t,content:e,ondup:fio.file.DUP_OVERWRITE})}function l(e){if(!e.modifyTime)throw new Error("File Save Error");o||d.hide(),i.path=e.path,i.title=e.filename,i.source="netdisk",i.protocol=n,m.save(i),m.unlock(),setTimeout(function(){w.list(w.pwd(),!0)},1499)}function u(e){y.error("err_save",e)}if(!E)return E=!0,m.lock(),r&&r.addClass("loading"),e.exportData(n).then(s).then(l,u).then(function(){r&&r.removeClass("loading"),E=!1})}function l(){var e=m.current();switch(e.source){case"netdisk":c(e);break;default:h(e)}k[0].select()}function u(e){k.val(e),r(e)}function c(e){if(fio.user.current()){var t=e.path,n=fio.file.anlysisPath(t);w.pwd()!=n.parentPath?w.list(n.parentPath).then(function(){w.select(t)}):w.select(t),u(n.filename)}}function h(e){u(e.title),w.select(null)}var d=e.getUI("menu/menu"),f=e.getUI("menu/save/save"),p=e.getUI("widget/netdiskfinder"),g=e.getUI("eve"),m=e.getUI("doc"),v=g.setup({}),y=e.getUI("widget/notice"),_={};e.getSupportedProtocols().forEach(function(e){e.encode&&e.decode&&(_[e.fileExtension]=e)}),delete _[".mm"],delete _[".xmind"];var b=$(f.createSub("netdisk",!0)).addClass("netdisk-save-panel"),w=p.generate(b,function(e){return _[e.extension]}),x=$('<div class="netdisk-save-select"></div>').appendTo(b);$("<label>").text(e.getLang("ui.saveas")).appendTo(x);var k=$("<input>").addClass("fui-widget fui-selectable").attr("type","text").attr("placeholder",e.getLang("ui.filename")).attr("title",e.getLang("ui.filename")).on("keydown",function(e){27==e.keyCode&&d.toggle(),13==e.keyCode&&a()}).appendTo(x),C=$("<select>").attr("title",e.getLang("ui.fileformat")).appendTo(x);for(var S in _){var T=_[S];if(!T.encode)return;$("<option>").text(T.fileDescription+"("+T.fileExtension+")").val(S).appendTo(C)}C.val(".km"),C.on("change",r);$("<button></button>").addClass("save-button").text(e.getLang("ui.save")).click(a).appendTo(x);d.on("show",l),w.on("fileclick",function(e){w.select(e.path),k.val(e.filename)}),v.quickSave=n,window.onbeforeunload=function(){var t=v.mute||window.location.href.indexOf("noask")>0;return m.checkSaved(!0)||t?void 0:e.getLang("ui.unsavedcontent","* "+m.current().title)};var M=e.getOptions("autoSave");M!==!1&&(M=isNaN(M)?3e3:1e3*M,t());var L=0,E=0;return v}),KityMinder.registerUI("menu/save/download",function(e){function t(t){var r=e.getMinderTitle()+t.fileExtension,a=t.mineType||"text/plain";o.addClass("loading");var s={download:!0,filename:r};e.exportData(t.name,s).then(function(e){if("freemind"!=t.name){switch(t.dataType){case"text":return n(i(a,e),r,"text");case"base64":return n(e,r,"base64");case"blob":return null}return null}})["catch"](function(t){var n=e.getUI("widget/notice");return n.error("err_download",t)}).then(function(e){o.removeClass("loading")})}function n(t,n,i){var r=1e5*+new Date+Math.floor(99999*Math.random());r=r.toString(36);var o=new Promise(function(e,t){function n(){return-1!=document.cookie.indexOf(r+"=1")?e([r,i]):(++i>o&&e([r,i]),void setTimeout(n,a))}var i=0,o=30,a=1e3;setTimeout(n,a)}),a=t.split(",")[1],s=$("<form></form>").attr({action:"download.php",method:"POST","accept-charset":"utf-8"});$("<input />").attr({name:"content",type:"hidden",value:decodeURIComponent(a)}).appendTo(s),$("<input />").attr({name:"type",type:"hidden",value:i}).appendTo(s),$("<input />").attr({name:"filename",type:"hidden",value:n}).appendTo(s);kity.Browser.ie&&$('<input name="iehack" value="1" />').appendTo(s),$('<input name="stamp" />').val(r).appendTo(s);var l=e.getUI("menu/save/netdisk");return l&&(l.mute=!0,setTimeout(function(){l.mute=!1},1e3)),s.appendTo("body").submit().remove(),o}function i(e,t){return"data:"+e+"; utf-8,"+encodeURIComponent(t)}var r=(e.getUI("menu/menu"),e.getUI("menu/save/save")),o=$(r.createSub("download")).addClass("download-panel"),a=($("<h2></h2>").text(e.getLang("ui.menu.downloadheader")).appendTo(o),$("<ul>").addClass("download-list").appendTo(o)),s=[];e.getSupportedProtocols().forEach(function(e){e.encode&&s.push(e)}),s.forEach(function(e){$("<li>").addClass(e.name).text(e.fileDescription+" ("+e.fileExtension+")").data("protocol",e).appendTo(a)}),a.delegate("li","click",function(e){var n=$(e.target).data("protocol");o.hasClass("loading")||t(n)})}),KityMinder.registerUI("menu/share/share",function(e){function t(t,n){function i(e,t){for(var n=0;n in e&&n in t&&e[n]==t[n];)n++;return n in t?0:n}var r=t.split("/"),o=n.split("/");I.then(function(t){var n=fio.user.check();t.forEach(function(t){var a=t.path.split("/"),s=i(a,r);if(s){var l=o.concat(a.slice(s));n.then(function(n){$.pajax({url:P,type:"POST",data:{action:"move",ak:n.access_token,id:t.id||t.shareMinder.id,path:l.join("/")}}).then(function(){L.info(e.getLang("ui.share_sync_success",t.title))})["catch"](function(e){L.error("err_share_sync_failed",e)})}),t.path=l.join("/")}}),b(t)})}function n(){var t=/(?:shareId|share_id)=(\w+)([&#]|$)/,n=t.exec(window.location)||t.exec(document.referrer);if(!n)return Promise.resolve(null);var o=n[1];$(e.getRenderTarget()).addClass("loading"),I.then(function(e){for(var t=0;t<e.length;t++){var n=e[t].id||e[t].shareMinder&&e[t].shareMinder.id;if(n==o&&e[t].path)return i(e[t])}return r(o)})}function i(t){var n=e.getUI("menu/open/netdisk");return L.info(e.getLang("ui.load_share_for_edit",t.title)),n.open(t.path,function(){return r(t)})}function r(t){function n(e){if(e.error)return void L.error("err_share_data",e.error);var t=e.shareMinder.data;return M.load({source:"share",content:t,protocol:"json",saved:!0,ownerId:e.uid,ownerName:e.uname})}var i=$(e.getRenderTarget()).addClass("loading");return $.pajax({url:"http://naotu.baidu.com/share.php",data:{action:"find",id:t},dataType:"json"}).then(n)["catch"](function(e){L.error("err_share_data",e)}).then(function(){i.removeClass("loading")})}function o(e){if(!e||!A)return null;for(var t=A.length;t--;)if(A[t].path==e)return A[t];return null}function a(e){N=e,e?y(e):v("none")}function s(){return $.pajax({url:"static/pages/createshare.html"}).then(function(t){var n=jhtmls.render(t);return C.html(n({lang:e.getLang("ui"),minder:e})),setTimeout(x,10),C})}function l(){S.append($("<h2>").text(e.getLang("ui.manage_share")).attr("id","manage-share-header"))}function u(t){t.delegate("input[name=sharetype]","click",function(e){var t={none:d,"public":g};t[e.target.value]()}),t.delegate("input#share-url","dblclick",function(){this.select()}),t.delegate("#copy-share-url","click",function(){if(kity.Browser.safari&&kity.Browser.safari<8){var t=$("#share-url");t.focus(),t.select(),window.alert(e.getLang("ui.clipboardunsupported"))}})}function c(){S.delegate(".share-item a","click",function(e){var t=$(e.target),n=t.closest(".share-item"),r=n.data("share");switch(!0){case t.hasClass("view-action"):return void window.open(m(r.id||r.shareMinder.id),"_blank");case t.hasClass("remove-action"):return n.addClass("loading"),void h(r).then(function(e){e&&e.deleted&&(A.splice(A.indexOf(r),1),n.slideUp(function(){n.remove()}),r==N&&f())}).then(function(){n.removeClass("loading")});case t.hasClass("edit-action"):return void i(r)}})}function h(t){return fio.user.check().then(function(n){return $.pajax(P,{type:"POST",data:{action:"remove",ak:n&&n.access_token,id:t.id||t.shareMinder.id},dataType:"json"})["catch"](function(t){var n=e.getUI("widget/notice");n.error("err_remove_share",t)})})}function d(){return N?(C.addClass("loading"),h(N).then(function(e){e&&e.deleted&&f(),C.removeClass("loading")})):void 0}function f(){N.$listItem&&N.$listItem.remove(),N=null,v("none")}function p(){var e=1e6;return(+new Date*e+Math.random()*--e).toString(36)}function g(t){return N?void 0:(C.addClass("loading"),fio.user.check().then(function(t){var n={shareMinder:{id:p(),data:JSON.stringify(e.exportJson())}},i=M.current();return"netdisk"==i.source&&(n.path=i.path),$.pajax(P,{type:"POST",data:{action:"insert",record:JSON.stringify(n),ak:t&&t.access_token},dataType:"json"}).then(function(e){if(e.error)throw new Error(e.error);return e})["catch"](function(t){var n=e.getUI("widget/notice");n.error("err_create_share",t)})}).then(function(e){e&&(a(e),I.then(function(){A.unshift(e),$("#manage-share-list").prepend(N.$listItem=w(e))})),C.removeClass("loading")}))}function m(e){var t=/^(.*?)(\?|\#|$)/.exec(window.location.href)[1];return t=t.split("edit.html")[0],t+"viewshare.html?shareId="+e}function v(e){var t=$("#public-share .share-body",C);"public"==e?t.show():t.hide(),$("#share-select input[name=sharetype][value="+e+"]",C).prop("checked",!0)}function y(t){var n=$("#public-share .share-body",C),i=m(t.id||t.shareMinder.id);$("#share-url",n).val(i)[0].select();var r=n.find(".share-qr-code").empty();new window.QRCode(r[0],{text:i,width:128,height:128,correctLevel:window.QRCode.CorrectLevel.M});var o=window._bd_share_config&&window._bd_share_config.common,a=window._bd_share_main&&window._bd_share_main.init;o&&a&&(o.bdTitle=o.bdText=e.getMinderTitle(),o.bdDesc=o.bdText=e.getLang("ui.sns_share_text",e.getMinderTitle(),i),o.bdUrl=i,a()),v("public")}function _(){return fio.user.check().then(function(e){return e?$.pajax(P,{type:"GET",data:{action:"list",ak:e&&e.access_token},dataType:"json"}).then(function(e){return A=e.list||[]}):void 0})}function b(t){e.getUI("widget/friendlytimespan");t&&(T.empty(),t.forEach(function(e){T.append(e.$listItem=w(e))}))}function w(t){var n=t.id||t.shareMinder&&t.shareMinder.id;if(n){var i=$("<li>").addClass("share-item").data("share",t);return $("<span>").addClass("title").text(t.title).appendTo(i),$("<span>").addClass("url").text(t.path?t.path.replace("/apps/kityminder",e.getLang("ui.mydocument")):m(n)).appendTo(i),t.ctime&&$("<span>").addClass("ctime").displayFriendlyTime(+t.ctime).appendTo(i),$("<a>").addClass("remove-action").text(e.getLang("ui.share_remove_action")).attr("title",e.getLang("ui.share_remove_action")).appendTo(i),$("<a>").addClass("view-action").text(e.getLang("ui.share_view_action")).attr("title",e.getLang("ui.share_view_action")).appendTo(i),t.path&&$("<a>").addClass("edit-action").text(e.getLang("ui.share_edit_action")).attr("title",e.getLang("ui.share_edit_action")).appendTo(i),i}}function x(){var t=$("#copy-share-url",C);if(window.ZeroClipboard){ZeroClipboard.config({swfPath:"lib/ZeroClipboard.swf",hoverClass:"hover",activeClass:"active"});var n=new window.ZeroClipboard(t);n.on("ready",function(){n.on("aftercopy",function(){t.text(e.getLang("ui.copied")).attr("disabled","disabled"),setTimeout(function(){t.text(e.getLang("ui.copy")).removeAttr("disabled")},3e3)})})}}var k=e.getUI("menu/menu").createSubMenu("share"),C=$(k.createSub("createshare")),S=$(k.createSub("manageshare")),T=$("<ul>").attr("id","manage-share-list").appendTo(S),M=e.getUI("doc"),L=e.getUI("widget/notice"),E=e.getUI("widget/netdiskfinder"),P="http://naotu.baidu.com/share.php";"local.host"==window.location.host;var N=null,A=[];s().then(u),l();var I=_();return I.then(b),I.then(c),e.on("uiready",function(){e.getUI("topbar/user").requireLogin(S)}),M.on("docload",function(e){"netdisk"!=e.source&&(N=null,v("none")),I.then(function(){var t=o(e.path);a(t)})}),M.on("docsave",function(e){if("netdisk"==e.source){var t=o(e.path);t&&fio.user.check().then(function(n){$.pajax({url:P,type:"POST",data:{action:"update",ak:n.access_token,id:t.id||t.shareMinder.id,record:e.json}}).then(function(){})["catch"](function(e){L.error("err_share_sync_fail",e)})})}}),E.on("mv",t),{$menu:k,loadShareFile:n}}),KityMinder.registerUI("menu/help/help",function(e){function t(t,i){function r(e){e=e.split("z").map(function(e){return parseInt(e,35)});var t=305,n=[],i=0;for(n.push(e[i]^t);void 0!==e[++i];)n.push(e[i]^n[i-1]);return String.fromCharCode.apply(null,n)}var a=jhtmls.render(t);o.html(a({lang:e.getLang("ui"),minder:e})),o.find(".shortcut-content").html(n(i)),kity.Browser.mac&&o.addClass("mac"),o.removeClass("loading"),o.find(".km-version").text(KityMinder.version);var s=0,l={1:"gctz8m5z8cpz61kz5vvz3uuz1a3az1hwtzbqdz124y",10:"gctz8m5z8cpz9tdz1dz2p1zcn3zalez6d3z2f7zbqdz124y",100:"hctz77uzd0az123kzr6u",1000:"gctzbs8z3kpz8nzclpz8nrzw8z8wwz3syz5oyzoiuz0zi7yzbqz7nbz77uzd0az123kzuu5z2f9z8ny",1000000:"96z1zjzoz27z2kz2oz23z22zbz2izrzoz2az5z27zpz2az3z24z3zbznzvzfzdzczez25z2cznzhzvz25z2dz2cz1z25z25z4z1vz29z1vz25z2ez2cz2nzgz1vz2lzizbzpzazjziz2nzdz1vz22z2z24z23z23zezez22z2ezsz25z22z3zbzbz25z2hzsz3z3z23z23z1vz1vzuzuziziz22z2ozmz22z5z27zpzpz22"};o.delegate(".shortcut-key","click",function(){var e=l[++s];e&&(window.alert(r(e)),s>1e6&&console.log(e))})}function n(e){function t(e){var t=i.exec(e);if(t)return o&&(n+="</section>"),n+="<section><h3>"+t[1]+"</h3>",void(o=!0);if(t=r.exec(e)){var a=t[1],s=t[2];return n+='<div class="shortcut-group"><span class="shortcut">',n+=a.replace(/\`(.+?)\`/g,function(e,t){return'<span class="shortcut-key '+t.toLowerCase()+'" title="'+t+'">'+t+"</span>"}),n+="</span>",n+='<span class="description">'+s+"</span>",void(n+="</div>")}}var n="",i=/##\s(.+)$/,r=/(.+?)\:\s(.+)$/,o=!1;return e.split("\n").forEach(t),o&&(n+="</section>"),n}var i=e.getUI("menu/menu"),r=$(i.createSub("help")),o=$('<div id="help-panel">').appendTo(r).addClass("loading");Promise.all([$.pajax({url:"static/pages/helpcontent.html",dataType:"text"}),$.pajax({url:"static/pages/operation."+e.getOptions("lang")+".txt",dataType:"text"})]).then(function(e){var n=e[0],i=e[1];t(n,i)})}),KityMinder.registerUI("menu/help/feedback",function(e){function t(t){var n=jhtmls.render(t);r.html(n({lang:e.getLang("ui"),minder:e})),r.on("click contextmenu keydown",function(e){e.stopPropagation()}),r.removeClass("loading"),r.find(".km-version").text(KityMinder.version)}var n=e.getUI("menu/menu"),i=$(n.createSub("feedback")),r=$('<div id="feedback-panel">').appendTo(i).addClass("loading");$.pajax({url:"static/pages/feedback.html",dataType:"text"}).then(t)}),KityMinder.registerUI("topbar/quickvisit",function(e){function t(t,i){var r=$('<a class="quick-visit-button"></a>').text(e.getLang("ui.quickvisit."+t)).attr("title",e.getLang("ui.quickvisit."+t)).addClass(t);return i?n.push(r):r.appendTo("#panel"),r}var n=[],i=t("new"),r=t("save"),o=t("share"),a={$new:i,$save:r,$share:o};return e.on("uiready",function(){function t(){var t=e.getUI("doc");t.checkSaved()&&t.load({content:{template:"default",version:KityMinder.version,data:{text:e.getLang("maintopic")}},saved:!0})}function s(){e.getUI("menu/save/netdisk").quickSave()}function l(){var t=e.getUI("menu/menu");t.$tabs.select(3),t.show()}for(;n.length;)$("#panel #search").after(n.shift());i.click(t),r.click(s),o.click(l),e.addShortcut("ctrl+alt+n",t),e.addShortcut("ctrl+s",s),e.addShortcut("ctrl+alt+s",l),e.addShortcut("ctrl+shift+s",function(){var t=e.getUI("menu/menu");t.$tabs.select(2),t.show()}),a.ready=!0,a.quickNew=t,a.quickSave=s,a.quickShare=l}),a.add=t,a}),KityMinder.registerUI("topbar/history",function(e){var t={},n=e.getUI("widget/commandbutton");return["undo","redo"].forEach(function(e){t[e]=n.generate(e).appendTo(document.getElementById("panel"))}),t}),KityMinder.registerUI("topbar/user",function(e){function t(e){e?(c.setLabel(e.username),c.getIconWidget().setImage(e.smallImage),c.show(),u.hide(),fio.user.fire("login",e)):-1==window.location.href.indexOf("nocheck")||u.show(),l.hide(),a=e}function n(){fio.user.logout(),u.show(),c.hide(),fio.user.fire("logout"),window.location.href=window.location.href.split("edit.html")[0]+"index.html"}function i(){u.setLabel(e.getLang("ui.loggingin")),fio.user.login({remember:604800})}function r(){fio.user.login({remember:604800,force:!0})}function o(t){var n=$('<p class="login-tip"></p>').html(e.getLang("ui.requirelogin"));t.append(n),fio.user.on("login",function(){t.removeClass("login-required")}),fio.user.on("logout",function(){t.addClass("login-required")})}var a,s=(e.getUI("eve"),$('<div class="user-panel"></div>').appendTo("#panel")),l=$('<span class="loading-tip"></span>').text(e.getLang("ui.checklogin")).appendTo(s),u=new FUI.Button({label:e.getLang("ui.login"),text:e.getLang("ui.login"),className:"login-button"}).appendTo(s[0]).hide(),c=new FUI.Button({icon:{img:"data:image/gif;base64,R0lGODlhAQABAIAAAAUEBAAAACwAAAAAAQABAAACAkQBADs="},className:"user-button"}).appendTo(s[0]).hide(),h=new FUI.PopupMenu({id:"user-menu"}).appendTo(document.getElementById("content-wrapper")).positionTo(c),d=h.getMenuWidget().show();return["userinfo","gotonetdisk","fui-spliter","switchuser","logout"].forEach(function(t){d.appendItem(new FUI.Item({label:e.getLang("ui."+t),className:t,value:t}))}),c.on("click",function(){h.open();var e=$(h.getElement()),t=$(c.getElement());e.offset({left:t.offset().left-e.outerWidth()+t.outerWidth()-10,top:t.offset().top+t.outerHeight()})}),d.on("select",function(e,t){switch(t.value){case"userinfo":window.open("http://i.baidu.com");break;case"gotonetdisk":window.open("http://pan.baidu.com/disk/home#path=/apps/kityminder");break;case"switchuser":r();break;case"logout":n()}d.clearSelect(),h.hide()}),e.on("uiready",function(){fio.user.check().then(t)["catch"](function(e){u.show(),c.hide(),l.hide()})}),u.on("click",i),$("#content-wrapper").delegate(".login-button","click",i),{getCurrent:function(){return a},loginLink:function(){return $("<a></a>").click(i)},requireLogin:o}}),KityMinder.registerUI("topbar/feedback",function(e){function t(){var t=e.getUI("menu/menu");t.$tabs.select(5),t.show()}var n=e.getUI("topbar/quickvisit"),i=n.add("feedback","right");return i.click(t),e.addShortcut("f1",t),i}),KityMinder.registerUI("topbar/search",function(e){function t(){o=[],e.getRoot().traverse(function(e){o.push(e)})}function n(t){function i(t,n){var i=e.getUI("ribbon/idea/notepreview");i&&i.hide(),e.execCommand("camera",t,50),setTimeout(function(){e.select(t,!0),t.isExpanded()||e.execCommand("expand",!0),n&&i&&i.preview(t,n)},60)}if(!/\S/.exec(t))return r[0].focus(),void r[0].select();t=t.toLowerCase();var a=n.lastKeyword!=t;n.lastKeyword=t;for(var s=a?0:n.lastIndex+1||0,l=s+o.length-1,u=s;l>=u;u++){var c=o[u%o.length],h=c.getText().toLowerCase();if(-1!=h.indexOf(t)){i(c),n.lastIndex=u;break}var d=c.getData("note");if(d&&-1!=d.indexOf(t)){i(c,t),n.lastIndex=u;break}}}var i=$('<div id="search"><input type="search" /></div>').appendTo("#panel"),r=i.find("input");e.addShortcut("ctrl+f",function(){r[0].focus(),r[0].select()}),r.on("keydown",function(e){13==e.keyCode&&n(r.val()),27==e.keyCode&&r[0].blur()});var o;return e.on("contentchange",t),i}),KityMinder.registerUI("topbar/title",function(e){function t(){function t(){setTimeout(function(){u=!1})}function n(){i(),t()}function c(){var o=d.val(),l=fio.file.anlysisPath(f),u=fio.file.anlysisPath(o);if(!u.name.length)return n();o=u.name+l.extension;var c=fio.file.anlysisPath(p).parentPath+o;return c==p?n():(r.addClass("loading"),void fio.file.move({path:p,newPath:c}).then(function(){h.path=c,h.title=o,a.fire("mv",p,c),s.info(e.getLang("ui.rename_success",o))})["catch"](function(e){s.error("err_rename",e)}).then(function(){r.removeClass("loading"),i(),t()}))}if(l&&!u){var h=o.current(),d=$("<input>").width(r.find(".title-content").width()),f=h.title,p=h.path;d.val(f),setTimeout(function(){d[0].select()}),r.addClass("rename-mode"),r.empty(),r.append(d),u=!0,d.on("keydown",function(e){13==e.keyCode?c():27==e.keyCode&&(n(),e.stopPropagation())}).on("blur",n)}}function n(e){l=e,e?r.addClass("rename-enabled"):r.removeClass("rename-enabled")}function i(){function t(n){t.lastValue!=n&&(n=n||e.getLang("ui.untitleddoc"),r.empty().append($('<span class="title-content"></span>').text(n)),document.title=n?n+" - 百度脑图":"百度脑图",t.lastValue=n)}var i=o.current();t(i.saved?i.title:"* "+i.title),n("netdisk"==i.source&&i.saved)}var r=$("<h1>").appendTo("#panel"),o=e.getUI("doc"),a=e.getUI("widget/netdiskfinder"),s=e.getUI("widget/notice"),l=!1,u=!1;return o.on("docchange",i),r.on("click",t),i(),{$title:r,getTitle:function(){return o.current().title}}}),KityMinder.registerUI("ribbon/tabs",function(e){var t=e.getUI("memory"),n=new FUI.Tabs({buttons:["idea","appearence","view"].map(function(t){return e.getLang("ui.tabs."+t)})}),i=e.getUI("topbar/title").$title,r=$('<div id="tab-select"></div>'),o=$('<div id="tab-container"></div>');i.before(r),$("#panel").after(o),n.appendButtonTo(r[0]),n.appendPanelTo(o[0]);var a=0,s=!1;n.on("tabsselect",function(e,n){n.index==a?(o.toggleClass("collapsed"),r.toggleClass("collapsed")):(o.removeClass("collapsed"),r.removeClass("collapsed")),s||(t.set("ribbon-tab-collapsed",o.hasClass("collapsed")),t.set("ribbon-tab-index",n.index)),a=n.index}),n.idea=n.getPanel(0),n.appearence=n.getPanel(1),n.view=n.getPanel(2);var l=t.get("ribbon-tab-index"),u=t.get("ribbon-tab-collapsed");return s=!0,n.select(l||0),s=!1,u?(o.addClass("collapsed"),r.addClass("collapsed")):(o.removeClass("collapsed"),r.removeClass("collapsed")),n}),KityMinder.registerUI("ribbon/idea/insert",function(e){var t=e.getUI("widget/commandbutton"),n=e.getUI("ribbon/tabs"),i=new FUI.LabelPanel({label:e.getLang("panels.insert"),column:!0});return t.generate("appendchildnode").appendTo(i),t.generate("appendsiblingnode").appendTo(i),n.idea.appendWidget(i),i}),KityMinder.registerUI("ribbon/idea/arrange",function(e){var t=e.getUI("ribbon/tabs"),n=e.getUI("widget/commandbutton"),i=new FUI.LabelPanel({label:e.getLang("panels.arrange"),column:!0});return n.generate("arrangeup").appendTo(i),n.generate("arrangedown").appendTo(i),t.idea.appendWidget(i),i}),KityMinder.registerUI("ribbon/idea/operation",function(e){var t=e.getUI("widget/commandbutton"),n=e.getUI("ribbon/tabs"),i=new FUI.LabelPanel({label:e.getLang("panels.nodeop"),column:!0}).appendTo(n.idea);["editnode","removenode"].forEach(function(e){t.generate(e).appendTo(i)})}),KityMinder.registerUI("ribbon/idea/attachment",function(e){var t=e.getUI("ribbon/tabs"),n=new FUI.LabelPanel({label:e.getLang("panels.attachment"),coloum:!0}).appendTo(t.idea);return n}),KityMinder.registerUI("ribbon/idea/link",function(e){function t(e){e?(s.addClass("validate-error"),c.text("地址格式错误"),u.disable()):(s.removeClass("validate-error"),c.text(""),u.enable())}var n=/(http|ftp|https):\/\/[\w\-_]+(\.[\w\-_]+)+([\w\-\.,@?^=%&amp;:\/~\+#]*[\w\-\@?^=%&amp;\/~\+#])?/,i=e.getUI("ribbon/idea/attachment"),r=new FUI.ButtonMenu({id:"link-button-menu",text:e.getLang("ui.link"),layout:"bottom",buttons:[{},{label:e.getLang("ui.link")}],menu:{items:[e.getLang("ui.removelink")]}}).appendTo(i);r.bindCommandState(e,"hyperlink");var o=new FUI.Dialog({width:600,height:200,prompt:!0,caption:e.getLang("ui.link")}).appendTo(document.getElementById("content-wrapper")),a=$(o.getBodyElement());a.html(['<p><label>连接地址：</label><input type="url" class="link-href fui-widget fui-selectable" /></p>','<p><label>提示文本：</label><input type="text" class="link-title fui-widget fui-selectable" /></p>'].join(""));var s=a.find(".link-href"),l=a.find(".link-title"),u=o.getButton(0),c=$('<span class="validate-error"></span>');return s.after(c),s.on("input",function(){var e=s.val();t(!n.test(e))}),r.on("buttonclick",function(){o.open(),s[0].focus()}),r.on("select",function(){e.execCommand("unhyperlink")}),o.on("ok",function(){e.execCommand("hyperlink",s.val(),l.val()||"")}),o.on("open",function(){var n=e.queryCommandValue("hyperlink");s.val(n.url),l.val(n.title),t(!1)}),$(e.getPaper().getNode()).delegate("a","click",function(t){var n=$(t.target).closest("a"),i=n.prop("href").baseVal;window.confirm(e.getLang("ui.redirect",i))&&window.open(i,"_blank"),t.preventDefault()}),r}),KityMinder.registerUI("ribbon/idea/image",function(e){function t(){this.init()}function n(e){return e?(u.addClass("validate-error"),d.text("图片无法加载")):(u.removeClass("validate-error"),d.text("")),e}var i=e.getUI("ribbon/idea/attachment"),r=new FUI.ButtonMenu({id:"image-button-menu",text:e.getLang("ui.image"),layout:"bottom",buttons:[{},{label:e.getLang("ui.image")}],menu:{items:[e.getLang("ui.removeimage")]}}).appendTo(i);r.bindCommandState(e,"image");var o=new FUI.Dialog({width:600,height:600,prompt:!0,className:"image-dialog",caption:e.getLang("ui.image")}).appendTo(document.getElementById("content-wrapper")),a=$(o.getBodyElement()),s=new FUI.Tabs({buttons:["图片搜索","插入图片"]});a.html(['<div id="img_buttons"></div>','<div id="img_panels"></div>'].join("")),s.appendButtonTo(document.getElementById("img_buttons")),s.appendPanelTo(document.getElementById("img_panels")),s.getPanel(0).getContentElement().innerHTML=['<div class="searchBar"><label>关键字：</label><input id="img_searchTxt" type="text" placeholder="请输入搜索关键词">','<button id="img_searchBtn">百度一下</button></div>','<div id="img_searchList"><ul id="img_searchListUl"></ul></div>'].join(""),s.getPanel(1).getContentElement().innerHTML=['<p><label>图片地址：</label><input type="url" class="image-url fui-widget fui-selectable" /></p>','<p><label>提示文本：</label><input type="text" class="image-title fui-widget fui-selectable" /></p>','<img class="image-preview" src="" style="max-height: 200px;" />'].join(""),$G=function(e){return document.getElementById(e)},t.prototype={lang:{searchRemind:"请输入搜索关键词",searchLoading:"图片加载中，请稍后……",searchRetry:"抱歉，没有找到图片！请重试一次！"},data:{imgUrl:"",imgTitle:""},init:function(){this.initEvents()},initEvents:function(){var e=this;$("#img_searchBtn").on("click",function(){var t=$G("img_searchTxt").value;t&&t!=e.lang.searchRemind&&e.getImageData()}),$("#img_searchTxt").on("focus",function(){var t=$G("img_searchTxt").value;t&&t==e.lang.searchRemind&&($G("img_searchTxt").value="")}),$("#img_searchTxt").on("keydown",function(e){var t=e.keyCode||e.which;return 13==t?($G("img_searchBtn").click(),!1):void 0}),$("#img_searchList").on("click",function(t){var n=t.target||t.srcElement,i=$(n).closest("li");e.data.imgUrl=i.find("img").attr("src"),e.data.imgTitle=i.find("span").attr("title"),i.siblings(".selected").removeClass("selected"),i.addClass("selected")})},scale:function(e,t,n){var i=e.width,r=e.height;i>=r?(e.width=t*i/r,e.height=n,e.style.marginLeft="-"+parseInt((e.width-t)/2)+"px"):(e.width=t,e.height=n*r/i,e.style.marginTop="-"+parseInt((e.height-n)/2)+"px")},getImageData:function(){var e=this,t=$G("img_searchTxt").value,n="1";url="http://image.baidu.com/i?ct=201326592&cl=2&lm=-1&st=-1&tn=baiduimagejson&istype=2&rn=3200&fm=index&pv=&word="+t+"&ie=utf-8&oe=utf-8&keeporiginname="+n+"&"+ +new Date,$G("img_searchListUl").innerHTML=e.lang.searchLoading,$.ajax({url:url,dataType:"jsonp",scriptCharset:"GB18030",success:function(t){var n=[];if(t&&t.data)for(var i=0;i<t.data.length;i++)t.data[i].objURL&&n.push({title:t.data[i].fromPageTitleEnc,src:t.data[i].objURL,url:t.data[i].fromURL});e.setList(n)},error:function(){$G("img_searchListUl").innerHTML=e.lang.searchRetry}})},setList:function(e){var t,n,i,r,o=this,a=$G("img_searchListUl");if(a.innerHTML="",e.length)for(t=0;t<e.length;t++)n=document.createElement("li"),i=document.createElement("img"),r=document.createElement("span"),i.setAttribute("src",e[t].src),r.innerHTML=e[t].title,n.appendChild(i),n.appendChild(r),a.appendChild(n),i.onerror=function(){$(this).closest("li").remove()};else a.innerHTML=o.lang.searchRetry},getInsertList:function(){for(var e,t,n=getAlign(),i=[],r=$G("img_searchListUl").children,o=0;o<r.length;o++)e=r[o].firstChild&&r[o].firstChild.firstChild,e.tagName&&"img"==e.tagName.toLowerCase()&&$(r[o]).hasClass("selected")&&(t=e.src,i.push({src:t,_src:t,alt:t.substr(t.lastIndexOf("/")+1),floatStyle:n}));return i}};var l=new t,u=a.find(".image-url"),c=a.find(".image-title"),h=a.find(".image-preview"),d=$('<span class="validate-error"></span>');return o.on("ok",function(){var t=s.getSelectedIndex();switch(t){case 1:e.execCommand("image",u.val(),c.val());break;case 0:e.execCommand("image",l.data.imgUrl,l.data.imgTitle)}}),o.on("open",function(){var t=e.queryCommandValue("image");u.val(t.url),c.val(t.title),h.attr("src",t.url||""),n(!1)}),u.after(d),u.on("input",function(){var e=u.val();/^https?\:\/\/(\w+\.)+\w+/.test(e)?(h.attr("src",e),n(!1),h.addClass("loading")):n(!0)}),h.on("load",function(){n(!1),h.removeClass("loading")}).on("error",function(){h.attr("src")&&n(!0),h.removeClass("loading")}),r.on("buttonclick",function(){o.open(),u[0].focus()}),
r.on("select",function(){e.execCommand("removeimage")}),r}),KityMinder.registerUI("ribbon/idea/note",function(e){function t(){if(v&&_!=e.getSelectedNode()){_=e.getSelectedNode();var t=e.queryCommandValue("note")||"";y.setValue(t),_?(c.removeAttr("disabled"),h.text("备注 - "+_.getText())):(c.attr("disabled","disabled"),h.text("选择节点添加备注")),p.hasClass(b)&&(m.html(s(marked(t))),m.find("a").attr("target","_blank"))}}function n(){_&&-1!=e.queryCommandState("note")&&e.execCommand("note",y.getValue())}function i(){if(!f.hasClass(b)){m.hide(),p.removeClass(b),g.show().addClass(b),f.addClass(b);var t=e.queryCommandValue("note")||"";y.setValue(t)}}function r(){p.hasClass(b)||(g.hide(),f.removeClass(b),m.html(s(marked(y.getValue()))).show(),m.find("a").attr("target","_blank"),p.addClass(b))}function o(){v=!0,c.show(),i(),t(),$("#content-wrapper").addClass("note-panel-visible")}function a(){v=!1,c.hide(),$("#content-wrapper").removeClass("note-panel-visible")}var s=e.getUI("axss");marked.setOptions({gfm:!0,breaks:!0});var l=e.getUI("ribbon/idea/attachment"),u=new FUI.ButtonMenu({id:"note-button-menu",text:e.getLang("ui.note"),layout:"bottom",buttons:[{},{label:e.getLang("ui.note")}],menu:{items:[e.getLang("ui.removenote")]}}).appendTo(l);u.on("select",function(){e.execCommand("note",null)});var c=$('<div id="note-panel"></div>'),h=$("<h2>节点备注</h2>").appendTo(c),d=($('<a class="close"></a>').appendTo(c).click(a),$('<div class="tab"><a class="edit-tab">编辑</a><a class="preview-tab">预览</a><a class="help" href="https://www.zybuluo.com/techird/note/46064" target="_blank">支持 GFM 语法书写</a></div>').appendTo(c)),f=d.find(".edit-tab"),p=d.find(".preview-tab"),g=$('<div class="note-editor"></div>').appendTo(c),m=$('<div class="note-preview"></div>').appendTo(c),v=!1;c.on("keydown keyup keypress mouedown mouseup click contextmenu",function(e){e.stopPropagation()});var y=new window.CodeMirror(g[0],{mode:"gfm",lineWrapping:!0,dragDrop:!1});e.on("uiready",function(){y.setSize("100%","100%")});var _=null;e.on("interactchange",t),y.on("change",n),u.bindCommandState(e,"note"),u.on("buttonclick",o),e.on("editnoterequest",o),$("#kityminder").after(c),a();var b="active-tab";f.click(i),p.click(r)}),KityMinder.registerUI("ribbon/idea/notepreview",function(e){function t(e,t){var i=e.getRenderer("NoteIconRenderer").getRenderShape(),a=i.getRenderBox("screen"),s=e.getData("note");r[0].scrollTop=0;var l=marked(s);t&&(l=l.replace(new RegExp("("+t+")","ig"),'<span class="highlight">$1</span>')),r.html(n(l));var u=$("#content-wrapper").width(),c=$("#content-wrapper").height(),h=r.outerWidth(),d=r.outerHeight(),f=a.cx-h/2,p=a.bottom+10;0>f&&(f=10),f+h>u&&(f=u-h-10),p+d>c&&(p=a.top-d-10),r.css({left:Math.round(f),top:Math.round(p)}),r.show();var g=r[0].querySelector(".highlight");g&&g.scrollIntoView(),o=!0}var n=e.getUI("axss");marked.setOptions({gfm:!0,breaks:!0});var i,r=$('<div id="note-previewer"></div>').appendTo("#content-wrapper");e.on("shownoterequest",function(e){i=setTimeout(function(){t(e.node)},300)}),e.on("hidenoterequest",function(){clearTimeout(i)});var o=!1;return $("#kityminder").on("mousedown mousewheel DOMMouseScroll",function(){o&&(r.fadeOut(),o=!1)}),r.hide(),r.delegate("a","click",function(t){var n=$(t.target).closest("a"),i=n.prop("href");window.confirm(e.getLang("ui.redirect",i))&&window.open(i,"_blank"),t.preventDefault()}),{preview:t,hide:function(){r.hide()}}}),KityMinder.registerUI("ribbon/idea/priority",function(e){var t=e.getUI("widget/commandbuttonset"),n=e.getUI("ribbon/tabs"),i=new FUI.LabelPanel({label:e.getLang("panels.priority")}).appendTo(n.idea);return t.generate("priority",[1,2,3,4,5,6,7,8,9,0].map(function(t){return{label:t,text:e.getLang("ui.priority")+t,value:t,className:["priority",t].join("-")}})).appendTo(i),i}),KityMinder.registerUI("ribbon/idea/progress",function(e){var t=e.getUI("widget/commandbuttonset"),n=e.getUI("ribbon/tabs"),i=new FUI.LabelPanel({label:e.getLang("panels.progress")}).appendTo(n.idea);return t.generate("progress",[1,2,3,4,5,6,7,8,9,0].map(function(t){return{label:t,text:e.getLang("ui.progress.p"+t),value:t,className:["progress",t].join("-")}})).appendTo(i),i}),KityMinder.registerUI("ribbon/idea/resource",function(e){function t(){var t=s.getValue(),n=e.queryCommandValue("resource");/\S/.test(t)&&(~n.indexOf(t)||n.push(t),n.sort(),e.execCommand("resource",n)),s.setValue(null),r(),s.focus()}function n(e,t){return[e.join(","),t.join(",")].join(";")}function i(e,t){var r=n(e,t);return r==i.lastHash?!1:(i.lastHash=r,!0)}function r(){var t=e.queryCommandValue("resource"),n=e.getUsedResource();switch(n.sort(),e.queryCommandState("resource")){case 0:s.enable(),l.enable(),u.enable(),h.find("input[type=checkbox]").removeAttr("disabled");break;case-1:s.disable(),l.disable(),u.disable(),h.find("input[type=checkbox]").attr("disabled",!0)}if(i(t,n)){for(var r=n.length-h.children().length;r--;)h.append('<li><label><input type="checkbox" /><span></span></label></li>');for(;++r;)h.children().first().remove();n.forEach(function(n,i){var r=h.children().eq(i),o=r.find("label"),a=o.find("input"),s=o.find("span");a.data("resource",n),a.prop("checked",~t.indexOf(n)),s.text(n);var l=e.getResourceColor(n);r.css({color:l.dec("l",60).toString(),backgroundColor:~t.indexOf(n)?l:l.dec("a",.85).toRGBA()})})}}var o=(e.getUI("widget/commandbuttonset"),e.getUI("ribbon/tabs")),a=new FUI.LabelPanel({label:e.getLang("panels.resource"),id:"resource-panel"}).appendTo(o.idea),s=(new FUI.Input).appendTo(a);s.getElement().type="text";var l=new FUI.Button({label:"添加"}).appendTo(a),u=(new FUI.DropPanel).appendTo(a),c=$(u.getPanelElement()),h=$("<ul></ul>").addClass("resource-list").appendTo(c);return s.on("inputcomplete",function(e){t()}),l.on("click",t),c.delegate("input[type=checkbox]","change",function(){e.execCommand("resource",c.find("input[type=checkbox]:checked").map(function(e,t){return $(t).data("resource")}).toArray()),r()}),e.on("interactchange",r),a}),KityMinder.registerUI("ribbon/appearence/template",function(e){var t=e.getUI("widget/commandselectmenu"),n=e.getUI("ribbon/tabs"),i=new FUI.LabelPanel({id:"template-panel",label:e.getLang("panels.template")}),r=KityMinder.Utils.keys(KityMinder.getTemplateList()),o=t.generate("template",r,2);return n.appearence.appendWidget(i),i.appendWidget(o),i}),KityMinder.registerUI("ribbon/appearence/theme",function(e){var t=e.getUI("widget/commandselectmenu"),n=e.getUI("ribbon/tabs"),i=new FUI.LabelPanel({id:"theme-panel",label:e.getLang("panels.theme")}),r=KityMinder.Utils.keys(KityMinder.getThemeList()),o=t.generate("theme",r.map(function(t){var n=KityMinder._themes[t];return{clazz:"Button",label:{text:e.getLang("theme."+t),style:{background:n["root-background"],color:n["root-color"],borderRadius:n["root-radius"]/2}},text:e.getLang("theme."+t),value:t,className:["theme",t].join(" ")}}));return n.appearence.appendWidget(i),i.appendWidget(o),e.on("themechange",function(t){$("#content-wrapper").css("background",e.getStyle("background"))}),i}),KityMinder.registerUI("ribbon/appearence/layout",function(e){var t=e.getUI("ribbon/tabs"),n=e.getUI("widget/commandbutton"),i=new FUI.LabelPanel({id:"layout-panel",label:e.getLang("panels.layout")}).appendTo(t.appearence);return n.generate("resetlayout").appendTo(i).addClass("large"),i}),KityMinder.registerUI("ribbon/appearence/style",function(e){var t=e.getUI("ribbon/tabs"),n=e.getUI("widget/commandbutton"),i=new FUI.LabelPanel({label:e.getLang("panels.style")}).appendTo(t.appearence);n.generate("clearstyle").addClass("large").appendTo(i);var r=new FUI.Panel({column:!0}).appendTo(i);return n.generate("copystyle").appendTo(r),n.generate("pastestyle").appendTo(r),i}),KityMinder.registerUI("ribbon/appearence/font",function(e){var t=e.getUI("ribbon/tabs"),n=e.getUI("widget/commandinputmenu"),i=e.getUI("widget/commandbutton"),r=new FUI.LabelPanel({label:e.getLang("panels.font"),id:"font-panel"}),o=new FUI.Panel({column:!0}),a=new FUI.Panel({column:!0}),s=n.generate("fontfamily",e.getOptions("fontfamily").map(function(e){return{label:{text:e.name,style:{fontFamily:e.val}},text:e.name,value:e.val}})),l=n.generate("fontsize",e.getOptions("fontsize").map(function(e){return{label:{text:e,style:{fontSize:e}},text:e,value:e}}));o.appendWidgets([s,l]);var u=i.generate("bold"),c=i.generate("italic");a.appendWidgets([u,c]),r.appendWidgets([o,a]),t.appearence.appendWidget(r)}),KityMinder.registerUI("ribbon/appearence/color",function(e){function t(){return["#e75d66","#fac75b","#99ca6a","#00c5ad","#3bbce0","#c9ced1","#425b71","white"]}var n=e.getUI("widget/commandbuttonset"),i=e.getUI("ribbon/tabs"),r=new FUI.LabelPanel({label:e.getLang("panels.color")}).appendTo(i.appearence),o=new FUI.LabelPanel({label:e.getLang("panels.background")}).appendTo(i.appearence),a=t();return r.appendWidget(n.generate("forecolor",a.map(function(e){return{icon:{style:{background:e}},label:e,text:e,value:e}})).addClass("color-picker")),o.appendWidget(n.generate("background",a.map(function(e){return{icon:{style:{background:e}},label:e,text:e,value:e}})).addClass("color-picker")),{color:r,background:o}}),KityMinder.registerUI("ribbon/view/fullscreen",function(e){function t(){$("#content-wrapper").toggleClass("fullscreen").hasClass("fullscreen")&&r.info(e.getLang("ui.fullscreen_exit_hint"),!1,4e3)}var n=e.getUI("widget/commandbutton"),i=e.getUI("ribbon/tabs"),r=e.getUI("widget/notice"),o=new FUI.LabelPanel({label:e.getLang("panels.level"),column:!0}).appendTo(i.view),a=n.generate("fullscreen",t).addClass("large").appendTo(o);return e.addShortcut("F11",t),e.addShortcut("Esc",function(){$("#content-wrapper").hasClass("fullscreen")&&$("#content-wrapper").removeClass("fullscreen")}),a}),KityMinder.registerUI("ribbon/view/level",function(e){var t=(e.getUI("widget/commandbutton"),e.getUI("ribbon/tabs")),n=new FUI.LabelPanel({label:e.getLang("panels.level"),column:!0}).appendTo(t.view),i=new FUI.ButtonMenu({id:"level-button-menu",text:e.getLang("ui.level"),layout:"bottom",buttons:[{},{label:e.getLang("ui.expandtoleaf")}],menu:{items:[1,2,3,4,5,6].map(function(t){return{label:e.getLang("ui.command.expandtolevel"+t),value:t}})}}).appendTo(n);i.on("buttonclick",function(){e.execCommand("expandtolevel",9999)}),i.on("select",function(t,n){e.execCommand("expandtolevel",n.value)})}),KityMinder.registerUI("ribbon/view/select",function(e){var t=e.getUI("ribbon/tabs"),n=new FUI.LabelPanel({label:e.getLang("panels.level"),column:!0}).appendTo(t.view),i=new FUI.ButtonMenu({id:"select-button-menu",text:e.getLang("ui.select"),layout:"bottom",buttons:[{},{label:e.getLang("ui.selectall")}],menu:{items:["revert","siblings","level","path","tree"].map(function(t){return{label:e.getLang("ui.select"+t),value:t}})}}).appendTo(n),r={all:function(){var t=[];e.getRoot().traverse(function(e){t.push(e)}),e.select(t,!0)},revert:function(){var t=e.getSelectedNodes(),n=[];e.getRoot().traverse(function(e){-1==t.indexOf(e)&&n.push(e)}),e.select(n,!0)},siblings:function(){var t=e.getSelectedNodes(),n=[];t.forEach(function(e){e.parent&&e.parent.children.forEach(function(e){-1==n.indexOf(e)&&n.push(e)})}),e.select(n,!0)},level:function(){var t=e.getSelectedNodes().map(function(e){return e.getLevel()}),n=[];e.getRoot().traverse(function(e){-1!=t.indexOf(e.getLevel())&&n.push(e)}),e.select(n,!0)},path:function(){var t=e.getSelectedNodes(),n=[];t.forEach(function(e){for(;e&&-1==n.indexOf(e);)n.push(e),e=e.parent}),e.select(n,!0)},tree:function(){var t=e.getSelectedNodes(),n=[];t.forEach(function(e){e.traverse(function(e){-1==n.indexOf(e)&&n.push(e)})}),e.select(n,!0)}};i.on("buttonclick",r.all),i.on("select",function(e,t){r[t.value]()})})}(window);
//# sourceMappingURL=kityminder.edit.min.js.map