var handleAvatar=function(){var a=$(".username").data("avatar"),t=function(){return getRootPath(1)+"/demo/upload/"+a+".jpg?"+Date.parse(new Date)},e=function(t){"undefined"==typeof t&&(t=a);var e=getRootPath(1)+"/demo/avatar/"+t+".jpg?"+Date.parse(new Date);$(".profile-userpic img").attr("src",e),$(".username").parent().find("img").attr("src",e)},n=(function(){var a=t();$.ajax({url:a,success:function(){n()},error:function(){bsTips("尚未上传头像文件，请选择图像并上传")}})}(),function(){var a='<div id="preview-pane">\n<div class="preview-container">\n<img name="hisAvatar" src="../../assets/pages/media/profile/Avatar_none.jpg" class="jcrop-preview" alt="Preview" />\n</div>\n</div>';$("#demo8_form").parent().prepend(a),$('[name="hisAvatar"]').attr("src",t()),"undefined"!=typeof r&&r.destroy(),i()});$("#submitAvatar").on("click",function(){var t=new FormData($("#avatarForm")[0]);t.append("avatarName",a),$.ajax({url:getRootPath(1)+"/demo/upload_avatar.php",type:"POST",data:t,async:!1,cache:!1,contentType:!1,processData:!1,success:function(a){var t=$.parseJSON(a);bsTips(t.msg,t.status),n()},error:function(a){infoTips(a)}})});var r,i=function(){function n(a){$("#crop_x").val(a.x),$("#crop_y").val(a.y),$("#crop_w").val(a.w),$("#crop_h").val(a.h),i(a)}function i(a){if(parseInt(a.w)>0){var t=d/a.w,e=v/a.h;u.css({width:Math.round(t*o)+"px",height:Math.round(e*s)+"px",marginLeft:"-"+Math.round(t*a.x)+"px",marginTop:"-"+Math.round(e*a.y)+"px"})}}var o,s,c=$("#preview-pane"),p=$("#preview-pane .preview-container"),u=$("#preview-pane .preview-container img"),d=p.width(),v=p.height();$("#demo8").Jcrop({aspectRatio:1,onSelect:n,onChange:i},function(){var a=this.getBounds();o=a[0],s=a[1],r=this,c.appendTo(r.ui.holder)}),$("#saveAvatar").on("click",function(){if(""==$("#crop_w").val())return bsTips("请选择头像裁切区域后再保存."),!1;$.ajax({url:getRootPath(1)+"/demo/cropImage.php",data:{src:t(),filename:a,x:$("#crop_x").val(),y:$("#crop_y").val(),w:$("#crop_w").val(),h:$("#crop_h").val()},success:function(a){var t=$.parseJSON(a);bsTips(t.msg,t.status),e()},error:function(a){console.log(a)}})})},o=function(){$(window).width()<=1024&&$(window).width()>=678?$(".responsive-1024").each(function(){$(this).attr("data-class",$(this).attr("class")),$(this).attr("class","responsive-1024 col-md-12")}):$(".responsive-1024").each(function(){$(this).attr("data-class")&&($(this).attr("class",$(this).attr("data-class")),$(this).removeAttr("data-class"))})};return{init:function(){jQuery().Jcrop&&(App.addResizeHandler(o),o())}}}(),handleBasicInfo=function(){function a(){}return{init:function(){a()}}}();jQuery(document).ready(function(){initDom(),UIIdleTimeout.init(),handleAvatar.init()}),jQuery(window).resize(function(){HeadFix()});
//# sourceMappingURL=settings_account.min.js.map