function GetJsonUrl(e){var t=getDateRange(),a=window.location.href.split("?")[1].split("&"),n="";a.map(function(e,t){"tid="!==jsLeft(e,4)&&(n+="&"+e)});var o=getRootPath()+"/DataInterface/Api?Token=79d84495ca776ccb523114a2120e273ca80b315b&ID="+e+"&M=3&tstart="+t.start+"&tend="+t.end+"&tstart2="+t.start+"&tend2="+t.end+"&tstart3="+t.start+"&tend3="+t.end+"&tstart4="+t.start+"&tend4="+t.end+n+"&t="+Math.random();return o}$("#HideTips").on("click",function(){$(this).parent().hide()});var dataTable=function(){function e(e){var t;if(1==App.getURLParameter("debug")||null===App.getURLParameter("tid"))$("#Preview").show(),t=$("#Preview input").val(),n('[name="sampleTable"]',t);else{var a,o={id:getUrlParam("tid").split(","),fixheader:null===getUrlParam("fixheader")?["1"]:getUrlParam("fixheader").split(",")},r=o.id.length;if(r>1&&e){var i=$('[name="sampleTable"]').parents(".portlet:nth(0)");for(a=0;r-1>a;a++)i.parent().append(i.clone())}for(a=0;r>a;a++)objRequest={url:GetJsonUrl(o.id[a]),fixheader:"1"==handleParam(o.fixheader,a,"1")?!0:!1},"0"==objRequest.fixheader&&$('[name="sampleTable"]:eq('+a+")").removeClass("table-header-fixed").addClass("dt-responsive"),n('[name="sampleTable"]:eq('+a+")",objRequest.url,objRequest.fixheader)}}function t(e,t,a){var n,o=getDateRange();return n={bRetrieve:!0,language:{url:getRootPath()+"/assets/pages/controller/DataTableLanguage.min.json"},lengthMenu:[[5,10,15,20,50,100,-1],[5,10,15,20,50,100,"All"]],pageLength:15,dom:a?"<'row tbTools' <'col-md-6 col-sm-12 pull-right'B>><'row'<'col-md-6 col-sm-12'l><'col-md-6 col-sm-12'f>>t<'row'<'col-md-5 col-sm-12'i><'col-md-7 col-sm-12'p>>":"<'clear'>R<'row tbTools' <'col-md-12'B>><'row'<'col-md-6 col-sm-12'l><'col-md-6 col-sm-12'f>r><'table-scrollable't><'row'<'col-md-5 col-sm-12'i><'col-md-7 col-sm-12'p>>",buttons:[{extend:"copyHtml5",exportOptions:{columns:":visible"},text:"复制",className:"btn red btn-outline"},{extend:"excelHtml5",className:"btn yellow btn-outline ",exportOptions:{columns:":visible"},filename:t.title+"("+o.start+" - "+o.end+")"},{extend:"csvHtml5",className:"btn purple btn-outline ",exportOptions:{columns:":visible"},filename:t.title+"("+o.start+" - "+o.end+")"},{extend:"pdfHtml5",orientation:t.cols>10?"landscape":"portrit",pageSize:t.cols>10?"A3":"A4",message:"统计时间:"+o.start+" ~ "+o.end+"\n"+t.source+"\n©成都印钞有限公司 技术质量部",download:"open",title:t.title,exportOptions:{columns:":visible"},className:"btn dark btn-outline",filename:t.title+"("+o.start+" - "+o.end+")"},{extend:"print",autoPrint:!1,text:"打印",message:"统计时间:"+o.start+"~"+o.end+"<br>"+t.source+"<br>©成都印钞有限公司 技术质量部",title:t.title,exportOptions:{columns:":visible"},className:"btn green btn-outline"},{extend:"colvis",text:'隐藏数据列<i class="fa fa-angle-down"></i>',className:"btn green-haze btn-outline"}],bDeferRender:!0,bProcessing:!0,bStateSave:!0,bserverSide:!1,bInfo:!0,bAutoWidth:!0,bSortClasses:!1,bScrollInfinite:!0,aoColumns:t.header,data:t.data,searchHighlight:!0,colReorder:{realtime:!0},scroolY:"70v",scrollCollapse:!0,initComplete:function(){var t=this.api();t.$(document).on("click","td",function(){t.search(this.innerText.trim()).draw()}),$(e).parents(".portlet").find(".tools").append($(e).parents(".portlet").find(".tabletools-btn-group").clone(!0)),$(e).parents(".portlet").find(".tbTools").remove(),infoTips("数据加载完成",2)}},a&&(n.fixedHeader={header:!0,footer:!0,headerOffset:t.fixedHeaderOffset}),n}function a(e,a,n){var r=$(e),i=0;App.getViewPort().width<App.getResponsiveBreakpoint("md")?$(".page-header").hasClass("page-header-fixed-mobile")&&(i=$(".page-header").outerHeight(!0)):$(".page-header").hasClass("navbar-fixed-top")&&(i=$(".page-header").outerHeight(!0)),a.fixedHeaderOffset=i;var l=t(e,a,n);o=r.dataTable(l)}function n(e,t,n){var r=$(e);if("undefined"==typeof n&&(n=!0),Data=ReadData(t,1),r.parents(".portlet").find('[name="TableTitle"]').text(Data.title),r.parents(".portlet").find('[name="datasource"]').text("("+Data.source+")"),$("#today").text(Data.source),Data.cols<2)return void infoTips("请确保数据列在2列以上，当前为："+Data.cols);if(!(Data.rows>0))return void infoTips("该时间范围内无质量数据，请重新选择查询时间!",1);if(!r.find("tbody").length)return void a(e,Data,n);o=r.dataTable(),o.fnClearTable(this);for(var i=o.fnSettings(),l=0;l<Data.rows;l++)o.oApi._fnAddData(i,Data.data[l]);i.aiDisplay=i.aiDisplayMaster.slice(),o.fnDraw()}var o;return{init:function(){$(document).on("click",".ranges li:not(:last),button.applyBtn",function(){e(0)}),null!==getUrlParam("tid")&&e(1),$("#Preview .btn").on("click",function(){n('[name="sampleTable"]',$("#Preview input").val())})}}}();jQuery(document).ready(function(){RoundedTheme(0),UIIdleTimeout.init(),initDashboardDaterange("YYYYMMDD"),initDom(),hideSidebarTool(),dataTable.init(),1==App.getURLParameter("debug")||null===App.getURLParameter("tid")?$("#Preview").show():$("#Preview").hide()}),jQuery(window).resize(function(){HeadFix()});
//# sourceMappingURL=QualityTable.min.js.map