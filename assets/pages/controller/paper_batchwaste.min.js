var FakePiece=function(){function e(){var e=getRootPath(1)+"/DataInterface/Api?Token="+config.TOKEN+"&ID=24&M=3&t=1",t=ReadData(e);InitSelect("prod_id",t),e=getRootPath(1)+"/DataInterface/Api?Token="+config.TOKEN+"&ID=23&M=3&t=0",t=ReadData(e),InitSelect("machine_id",t),$("input[name='rec_date']").val(today(6)),$("input[name='remark']").val("无"),initSelect2(),$(".page-header .dropdown-quick-sidebar-toggler").hide(),c()}function t(){SetSelect2Val("prod_id",-1),SetSelect2Val("machine_id",-1),$('[name="reel_code"]').val(""),$(".detail input").val(""),$("[name='remark']").val("无"),$("[name='reel_code']").focus()}function a(){var e=getRootPath()+"/DataInterface/insert",a=getFormData("theForm");a.utf2gbk=["remark","fake_reason"],a.tbl=TBL.PPR_BATCHWASTE;var n={url:e,type:"post",resetForm:!0,data:a,success:function(e){var a=$.parseJSON(e);bsTips(a.message,a.type),t(),r()},error:function(e){infoTips(JSON.stringify(e))}};return $.ajax(n),!1}function r(){function e(e,t){var a="<tr>\t<td>"+t+"</td>";return e.map(function(e){a+="\t<td>"+e+"</td>"}),a+="</tr>"}var t=$('[name="fakeList"] tbody'),a=$("input[name='rec_date']").val();a=a.replace(/-/g,"");var r=getRootPath(1)+"/DataInterface/Api?Token="+config.TOKEN+"&ID=248&M=3&tstart="+a+"&tend="+a,n=ReadData(r);if(0===n.rows)return void t.html('<tr><td class="text-center" colspan='+(n.cols+1)+">指定时间内无数据</td></tr>");var i="";n.data.map(function(t,a){i+=e(t,a+1)}),t.html(i)}function n(){var e=$("input[name='rec_date']").val();e=e.replace(/-/g,"");var t=getRootPath(1)+"/DataInterface/Api?Token="+config.TOKEN+"&ID=250&M=3&tstart="+e;return t}function i(){var e={url:n(),type:"pie",background:"img",circle:1};require(["../assets/pages/controller/singleChart.min"],function(t){t.init(e,$('[name="singleChart"]'))})}var o=function(){jQuery().datepicker&&$(".date-picker").datepicker({rtl:App.isRTL(),orientation:"left",autoclose:!0,format:"yyyy-mm-dd"})},c=function(){$("input[name='reel_code']").maxlength({limitReachedClass:"label label-danger",threshold:3}),extendValidateRule();var e=getValidateRule("theForm");e.reel_code={minlength:8,maxlength:8,isReelCode:!0,required:!0},e.rec_date.number=!1,e.fake_num={number:!0,required:!0,min:.1},e.fake_reason={required:!0},$("form[name=theForm]").validate({errorElement:"span",errorClass:"help-block",focusInvalid:!0,rules:e,messages:{reel_code:{required:"轴号不能为空."}},highlight:function(e){$(e).closest(".form-group").addClass("has-error")},success:function(e){e.closest(".form-group").removeClass("has-error"),e.remove()},submitHandler:function(e){a()}})};return $('input[name="reel_code"]').on("keyup",function(){var e=$(this).val();if(e.length>=2){var t=e.substr(1,1),a=e.substr(2,1);SetSelect2Val("prod_id",t),SetSelect2Val("machine_id",a)}}),$('[name="reset"]').on("click",function(){t()}),{init:function(){o(),e(),r(),i()}}}();jQuery(document).ready(function(){initDom(),FakePiece.init()}),jQuery(window).resize(function(){HeadFix()});
//# sourceMappingURL=paper_batchwaste.min.js.map