function GetJsonUrl(e){var a=getDateRange(),t=getRootPath()+"/DataInterface/Api?Token=79d84495ca776ccb523114a2120e273ca80b315b&chartType=bar&ID="+e+"&M=3&tstart="+a.start+"&tend="+a.end+"&tstart2="+a.start+"&tend2="+a.end+"&t="+Math.random();return t}$("#HideTips").on("click",function(){$(".mt-element-ribbon").addClass("hide")});var mECharts=function(){function e(){require.config({baseUrl:"assets/global/plugins/echarts/",paths:{theme:"theme",echarts:"js/echarts.min",chartDataTool:"js/extension/chartDataTool.min"}}),require(["echarts","chartDataTool"],function(e,r){var l;s=e,m=r,"undefined"==typeof localStorage.eChartsTheme?(l="real2",localStorage.setItem("eChartsTheme","real2")):l=localStorage.eChartsTheme,require(["theme/"+l],function(e){c=e,a(),t(c)})})}function a(){var e=$(".portlet-body.form");for(i=0;i<d;i++){var a='<div id="eChart-main'+i+'" optionKey="Line" class="eCharts-main margin-top-5"></div>';e.append(a)}var t=$(".eCharts-main"),r=e.width();t.css("width",r),t.css("height",r/(1==t.length?2:2.5))}function t(e,a){if(d&&s){var t,r,i={},n={id:getUrlParam("tid").split(","),type:null===getUrlParam("type")?["line"]:getUrlParam("type").split(","),smooth:null===getUrlParam("smooth")?["1"]:getUrlParam("smooth").split(","),markLine:null===getUrlParam("markline")?["0"]:getUrlParam("markline").split(","),markPoint:null===getUrlParam("markpoint")?["0"]:getUrlParam("markpoint").split(","),barMaxWidth:null===getUrlParam("barwidth")?["0"]:getUrlParam("barwidth").split(","),splitArea:null===getUrlParam("splitarea")?["0"]:getUrlParam("splitarea").split(","),dataZoom:null===getUrlParam("zoom")?["0"]:getUrlParam("zoom").split(","),minMax:null===getUrlParam("minmax")?["0"]:getUrlParam("minmax").split(","),lineAreaStyle:null===getUrlParam("linearea")?["0"]:getUrlParam("linearea").split(","),reverse:null===getUrlParam("reverse")?["0"]:getUrlParam("reverse").split(","),circle:null===getUrlParam("circle")?["0"]:getUrlParam("circle").split(","),roseType:null===getUrlParam("rose")?["0"]:getUrlParam("rose").split(",")};for(t=0;d>t;t++)i={url:GetJsonUrl(n.id[t]),type:handleParam(n.type,t,"line"),smooth:"1"==handleParam(n.smooth,t,"1"),blind:"0"!=getUrlParam("blind")&&null!==getUrlParam("blind"),toolbox:!0,markLine:"1"==handleParam(n.markLine,t,"0"),markPoint:"1"==handleParam(n.markPoint,t,"0"),barMaxWidth:"1"==handleParam(n.barMaxWidth,t,"0"),splitArea:"1"==handleParam(n.splitArea,t,"0"),dataZoom:handleParam(n.dataZoom,t,"0"),minMax:"1"==handleParam(n.minMax,t,"0"),lineAreaStyle:"1"==handleParam(n.lineAreaStyle,t,"0"),reverse:"1"==handleParam(n.reverse,t,"0"),circle:"1"==handleParam(n.circle,t,"1"),roseType:handleParam(n.roseType,t,"0")},console.log(i),"undefined"!=typeof e.color?e.valueAxis.splitArea.show=!!i.splitArea[t]:e.color=["#c23531","#2f4554","#61a0a8","#d48265","#91c7ae","#749f83","#ca8622","#bda29a","#6e7074","#546570","#c4ccd3"],i.color=e.color,r=m.getOption(i),console.log("option = "+JSON.stringify(r)),r!==!1?(h[t]=s.init(document.getElementById("eChart-main"+t),e),h[t].setOption(r)):infoTips("第"+(t+1)+"张图表无数据，请重新选择查询时间",2);i.blind&&l()}}function r(){if($(".actions select opotion").length)return!1;var e,a=$(".actions select"),t="",r=["default","real2","real","powerBI","macarons","helianthus","infographic","shine","dark","blue","green","red","gray","roma","macarons2","sakura"];r.map(function(e,a){t+='<option name="'+e+'">'+e+"</option>"}),a.html(t),"undefined"==typeof localStorage.eChartsTheme?(e="real2",localStorage.setItem("eChartsTheme","real2")):e=localStorage.eChartsTheme,a.find('[name="'+e+'"]').attr("selected",!0),$(".bs-select").selectpicker({iconBase:"fa",tickIcon:"fa-check"}),$("select.bs-select").hide()}function l(){for(var e=[],a=0;d>a;a++)e.push(h[a]);s.connect(e)}function n(e){localStorage.setItem("eChartsTheme",e),bsTips("主题更换成功，请刷新页面查看",1)}function o(){var e=$(".actions select");e&&$(e).change(function(){n($(this).val())})}var s,m,c,h=[],d=null===getUrlParam("tid")?0:getUrlParam("tid").split(",").length;return $(document).on("click",".ranges li:not(:last),button.applyBtn",function(){var e;e=$(".actions select"),require(["theme/"+e.val()],function(e){c=e,setTimeout(t(c),500)})}),$("#Preview a").on("click",function(){var e=$("#Preview input").val(),a=$(".actions select");require(["theme/"+a.val()],function(a){c=a,setTimeout(t(c,e+"&chartType=line"),500)})}),{init:function(){r(),e(),o()},resize:function(){var e=$(".portlet-body.form"),a=$(".eCharts-main"),t=e.width();for(a.css("width",t).css("height",t/(1==a.length?2:2.5)),i=0;i<d;i++)h[i].resize()}}}();jQuery(document).ready(function(){initDashboardDaterange("YYYYMMDD"),initDom(),mECharts.init(),1==App.getURLParameter("debug")||null===App.getURLParameter("tid")?$("#Preview").show():$("#Preview").hide(),hideSidebarTool()}),jQuery(window).resize(function(){HeadFix(),mECharts.resize()});