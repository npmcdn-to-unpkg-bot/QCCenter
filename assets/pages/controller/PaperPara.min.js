var PaperParam=function(){function t(){var t=getRootPath(1)+"/DataInterface/Api?Token=79d84495ca776ccb523114a2120e273ca80b315b&ID=24&M=3&t=1",e=ReadData(t);InitSelect("Prod_id",e),t=getRootPath(1)+"/DataInterface/Api?Token=79d84495ca776ccb523114a2120e273ca80b315b&ID=23&M=3&t=1",e=ReadData(t),InitSelect("machine_id",e),t=getRootPath(1)+"/DataInterface/Api?Token=79d84495ca776ccb523114a2120e273ca80b315b&ID=25&M=3&t=1",e=ReadData(t),InitSelect("oper_id",e),$("input[name='rec_date']").val(today(6)),$("input[name='Reel_Code']").maxlength({limitReachedClass:"label label-danger",threshold:3})}function e(){var t=(new Date).getHours();t>=0&&8>t?SetRadioChecked("class_id",2):t>=8&&16>t?SetRadioChecked("class_id",0):SetRadioChecked("class_id",1)}function a(){return""===$('select[name="oper_id"]').val()||""===$('select[name="prod_ID"]').val()||""===$('select[name="machine_ID"]').val()?($(".portlet.light").hide(),1):($(".portlet.light").show(),0)}function o(){var t=$('input[name="Reel_Code"]').val(),e=getRootPath(1)+"/DataInterface/Api?Token=79d84495ca776ccb523114a2120e273ca80b315b&ID=33&M=2&r="+t,a=ReadData(e);a.header.map(function(t){var e=t.title;$('form .form-control[name="'+e+'"]').val(a.data[0][e])}),SetRadioChecked("class_id",a.data[0].class_id),$('.portlet button[type="submit"]').attr("data-sn",a.data[0].ID),$('.portlet button[type="submit"]').html($('.portlet button[type="submit"]').html().replace("提交","更新")),$(".portlet.light div").removeClass("form-md-floating-label"),$(".portlet.light").show(),r(),$(".amounts h4").html("<strong>评价总分:</strong> "+a.data[0].score),$(".normalPara input").attr("disabled","true"),$(".normalParaEdit").show()}function r(){var t=$("input[name='rec_date']").val();t=t.substr(0,4)+t.substr(5,2);var e=$('select[name="Prod_id"]').val(),a=getRootPath(1)+"/DataInterface/Api?Token=79d84495ca776ccb523114a2120e273ca80b315b&ID=27&M=3&tmonth="+t+"&prod="+e,o=ReadData(a);a=getRootPath(1)+"/DataInterface/Api?Token=79d84495ca776ccb523114a2120e273ca80b315b&ID=28&M=3&tmonth="+t+"&prod="+e;var r=ReadData(a);$(".grey-cascade").html("物理指标得分："+xround(o.data[0][0],2)+"，外观指标得分："+xround(r.data[0][0],2))}function n(){var t=getRootPath(1)+"/assets/pages/controller/data/paper_physic.json";$.get(t,function(t){c=t})}var i=function(){jQuery().datepicker&&$(".date-picker").datepicker({rtl:App.isRTL(),orientation:"left",autoclose:!0,format:"yyyy-mm-dd"})};$('select[name="oper_id"]').change(function(){a()||r()}),$('select[name="machine_id"]').change(function(){a()||r(),e()}),$('select[name="Prod_id"]').change(function(){return a()?void $(".grey-cascade").html(""):void r()}),$('input[name="Reel_Code"]').on("change",function(){o()}),$("#checkbox2").on("click",function(){1==$(this).val()?($(this).val(0),$(".normalPara input").attr("disabled","true")):($(this).val(1),$(".normalPara input").removeAttr("disabled"))});var c={};$(".portlet.light input").on("change",function(){var t=parseFloat($(".amounts h4").text().replace("评价总分:",""),10),e=$(this).attr("name"),a=$(this).val();"undefined"!=typeof c[e]&&(a<c[e].min||a>c[e].max)&&(t-=c[e].score),$(".amounts h4").html("<strong>评价总分:</strong> "+t)});var l=function(){function t(){var t=getRootPath()+"/DataInterface/insert",e=getFormData("theForm");e.tbl=0,e.class_id=GetRadioChecked("class_id"),e.score=$(".amounts h4").text().replace("评价总分:",""),e.utf2gbk=["remark"],e.record_Time=today(1),$.post(t,e,function(t,e){if("success"==e){var a=$.parseJSON(t);infoTips(a.message,a.type),$('button[type="reset"]').click(),$(".portlet.light").hide()}else infoTips("保存设置失败，请稍后重试或联系管理员!",0),infoTips(JSON.stringify(t))})}function e(){var t=getRootPath()+"/DataInterface/update",e=getFormData("theForm");e.tbl=0,e.class_id=GetRadioChecked("class_id"),e.score=$(".amounts h4").text().replace("评价总分:",""),e.utf2gbk=["remark"],e.record_Time=today(1),e.id=$('.portlet button[type="submit"]').attr("data-sn"),$.post(t,e,function(t,e){if("success"==e){var a=$.parseJSON(t);infoTips(a.message,a.type),$('button[type="reset"]').click(),$(".portlet.light").hide(),$(".normalPara input").removeAttr("disabled"),$(".portlet.light div").addClass("form-md-floating-label"),$('.portlet button[type="submit"]').html($('.portlet button[type="submit"]').html().replace("更新","提交"))}else infoTips("保存设置失败，请稍后重试或联系管理员!",0),infoTips(JSON.stringify(t))})}var a=getValidateRule("theForm");a.Reel_Code={minlength:4,maxlength:6,number:!1,required:!0},a.rec_date.number=!1,a.water_imbibition={required:!1},a.PH_val={required:!1},a.sur_Strength={required:!1},a.sur_oil_imbibition={required:!1},$("form[name=theForm]").validate({errorElement:"span",errorClass:"help-block",focusInvalid:!0,rules:a,messages:{Reel_Code:{required:"轴号不能为空."}},highlight:function(t){$(t).closest(".form-group").addClass("has-error")},success:function(t){t.closest(".form-group").removeClass("has-error"),t.remove()},submitHandler:function(){}}),$('button[type="submit"]').on("click",function(){$("form[name=theForm]").validate().form()?"提交"==$('.portlet button[type="submit"]').text().trim()?t():e():infoTips("请确保所有必要信息均正确输入")}),$('button[type="reset"]').on("click",function(){$(".portlet.light").hide(),$(".amounts h4").html("<strong>评价总分:</strong> 100")})};return{init:function(){$(".portlet.light").hide(),$(".normalParaEdit").hide(),i(),t(),e(),l(),n()}}}();jQuery(document).ready(function(){initDom(),PaperParam.init()}),jQuery(window).resize(function(){HeadFix()});
//# sourceMappingURL=PaperPara.min.js.map