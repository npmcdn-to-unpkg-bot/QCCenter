function WorkLogInit(){$("#ErrDesc").summernote({height:300,minHeight:null,maxHeight:null,focus:!0}),$(".form_advance_datetime").datetimepicker({isRTL:Metronic.isRTL(),format:"yyyy-mm-dd hh:ii",autoclose:!0,todayBtn:!0,startDate:"2015-01-01 00:00",pickerPosition:Metronic.isRTL()?"bottom-right":"bottom-left",minuteStep:10,language:"zh-CN"}),$("#ProUserName").multiSelect({keeporder:!0,selectableHeader:"<div class='custom-header'>可选名单</div>",selectionHeader:"<div class='custom-header'>已选择</div>",selectableOptgroup:!0,afterSelect:function(e){for(var a=e.length-1;a>=0;a--){var t=e[a];iProUserName[t]=1}},afterDeselect:function(e){for(var a=e.length-1;a>=0;a--){var t=e[a];iProUserName[t]=0}}}),$("#TransUserName").multiSelect({keeporder:!0,selectableHeader:"<div class='custom-header'>可选名单</div>",selectionHeader:"<div class='custom-header'>已选择</div>",selectableOptgroup:!0,afterSelect:function(e){for(var a=e.length-1;a>=0;a--){var t=e[a];iTransUserName[t]=1}},afterDeselect:function(e){for(var a=e.length-1;a>=0;a--){var t=e[a];iTransUserName[t]=0}}})}function QueryWorkLogData(e){var a,t=$("#ProcID").val(),o=$("#LoadingNum").val(),r=$("#ProStatus").val(),i=$("#KeyWord").val(),s=e?0:$("#LogID").val(),n=$("#dashboard-report-range span").html(),l=n.split(" ~ ")[0],c=n.split(" ~ ")[1],d=getRootUrl("worklog")+"QueryLogInfo";switch(o){case"1":a=20;break;case"2":a=30;break;case"3":a=40;break;case"4":a=50}$.post(d,{ProcID:t,Nums:a,Status:r,KeyWord:i,CurID:s,TimeStart:l,TimeEnd:c},function(a,t){var o=jQuery.parseJSON(a);if(o.rows>0){e&&$(".timeline").html("");for(var r='<div class="timeline-item"><div class="timeline-badge"><div class="timeline-badge"><img class="timeline-badge-userpic" src="http://localhost/assets/admin/pages/media/users/realeve.jpg"></div></div><div class="timeline-body"><div class="timeline-body-arrow"></div><div class="timeline-body-head"><div class="timeline-body-head-caption"><a href="#" class="timeline-body-title font-blue-madison">',i='</a><span class="timeline-body-time font-grey-cascade">发表于',s="</span></div></div></div>",n=o.rows-1;n>=0;n--){var l='</small></span></div><div class="timeline-body-head-actions"><div class="btn-group"><button class="btn btn-circle green-haze btn-sm dropdown-toggle" type="button" data-toggle="dropdown" data-hover="dropdown" data-close-others="true">操作 <i class="fa fa-angle-down"></i></button><ul class="dropdown-menu pull-right" role="menu"><li><a href="http://localhost/worklog/editlog?ID='+o.data[n].ID+'" id="UpdateLog'+n+'" ><i class="icon-pencil"></i>&nbsp;&nbsp;编辑 </a></li>';l+='<li><a href="http://localhost/worklog/Dellog?ID='+o.data[n].ID+'" id="DelLog'+n+'" data-toggle="confirmation" data-singleton="true" data-popout="true" data-placement="left" data-title="确定删除该条日志?" data-btn-ok-label="是" data-btn-ok-icon="icon-trash" data-btn-ok-class="btn-success" data-btn-cancel-label="取消" data-btn-cancel-icon="icon-close" data-btn-cancel-class="btn-danger"><i class="icon-trash"></i>&nbsp;&nbsp;删除 </a></li>',l+='<li><a href="http://localhost/worklog/Marklog?ID='+o.data[n].ID+'" id="MarkLog"><i class="icon-star"></i>&nbsp;&nbsp;收藏 </a></li><li class="divider"></li>',l+='<li><a href="http://localhost/worklog/Completelog?ID='+o.data[n].ID+'" id="CompleteLog'+n+'"  data-toggle="confirmation" data-singleton="true" data-popout="true" data-placement="left" data-title="确定标记为已完成?" data-btn-ok-label="是" data-btn-ok-icon="icon-check" data-btn-ok-class="btn-success" data-btn-cancel-label="取消" data-btn-cancel-icon="icon-close"><i class="icon-check"></i>&nbsp;&nbsp;标记为已完成 </a></li>',l+='</ul></div></div></div><div class="timeline-body-content"><span class="font-grey-cascade">';var c=ReadLog(o.data[n].ID);$(".timeline:first").prepend(r+o.data[n].RecordUserName+i+o.data[n].RecordTime+l+c+s)}$("#LogID").val(o.data[0].ID)}else infoTips("该搜索条件范围内无日志，请重新设置!</br>错误信息："+t+"</br>返回值:"+a,1)})}function ReadLog(e){var a=getRootUrl("worklog")+"ReadLog",t="该条记录未填写任何日志";return $.ajax({type:"POST",async:!1,url:a,data:{ID:e},success:function(e){t=e}}),t}function ReadLogSettings(){var e=getRootUrl("worklog")+"ReadLogQuerySettings";$.ajax({type:"POST",async:!1,url:e,success:function(e){var a=jQuery.parseJSON(e),t=a.data[0];$("#ProcID").val(t.ProcID),$("#LoadingNum").val(t.NumsID),$("#ProStatus").val(t.Status),$("#RefreshTime").val(t.RefreshTime),0===t.AutoRefresh&&$("#AutoRefresh").bootstrapSwitch("toggleState"),$("#QueryData").click()}})}function PromotAlert(){bootbox.prompt("What is your name?",function(e){alert(null===e?"Prompt dismissed":"Hi <b>"+e+"</b>")})}$("#SaveChanges").on("click",function(){for(var e=GetSwitchValue("workProc",4),a=GetSwitchValue("workClass",3),t=$("#MachineName").val(),o=$("#ProductName").val(),r=$("#ProStatus").val(),i=$("#ProTime").val(),s="",n="",l=["无","于潇","丰锋","彭鹏","赵文倩","蒲明玥","舒粤","马可","胡新玥","李超群","徐闵","李宾","杨林","金鑫","包诚"],c=iProUserName.length-1;c>=0;c--)iProUserName[c]&&(""!==n&&(n+=","),n+=l[c]);for(c=iTransUserName.length-1;c>=0;c--)iTransUserName[c]&&(""!==s&&(s+=","),s+=l[c]);""===n&&(n="无"),""===s&&(s="无");var d=$("#ProInfo").val(),u=$("#ReportOutput").bootstrapSwitch("state")===!0?1:0,m=$("#RecordUserName").val(),g=$("#RecordTime").val(),p=$("#MainDesc").val(),v=$("#SubDesc").val(),f=$("#ErrDesc").code(),b=getRootUrl("worklog")+"AddLog";$.post(b,{WorkProc:e,WorkClass:a,MachineName:t,ProductName:o,ProStatus:r,ProTime:i,ProUserName:n,TransUserName:s,ProInfo:d,ReportOutput:u,RecordUserName:m,RecordTime:g,MainDesc:p,SubDesc:v,ErrDescHTML:f},function(e,a){var t=jQuery.parseJSON(e);t>0?infoTips("日志添加成功，请继续添加！</br>更新状态："+a+"</br>所添加数据ID:"+e,1):infoTips("日志添加失败，请检查拼写或联系管理员!</br>错误信息："+a+"</br>所添加数据:"+e,0)})}),$("#dashboard-report-range").on("apply.daterangepicker",function(){QueryWorkLogData(1)}),$("#QueryData").on("click",function(){QueryWorkLogData(1)}),$("#SaveSettings").on("click",function(){var e=$("#ProcID").val(),a=$("#LoadingNum").val(),t=$("#ProStatus").val(),o=$("#RefreshTime").val(),r=$("#AutoRefresh").bootstrapSwitch("state")===!0?1:0,i=getRootUrl("worklog")+"SaveLogQuerySettings";$.post(i,{ProcID:e,NumsID:a,Status:t,RefreshTime:o,AutoRefresh:r},function(e,a){if("success"==a){var t=jQuery.parseJSON(e);infoTips(t.message,1)}else infoTips("保存设置失败，请稍后重试或联系管理员!",0)})}),$("#DelLog1").on("confirmed.bs.confirmation",function(){infoTips("删除成功",1)}),$("#CompleteLog1").on("confirmed.bs.confirmation",function(){infoTips("该条日志已标记为已完成",1)}),$("#Preview").on("click",function(){});
//# sourceMappingURL=WorkLogEdit.min.js.map