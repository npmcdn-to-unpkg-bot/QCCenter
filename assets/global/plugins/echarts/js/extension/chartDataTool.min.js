define(["./js/extension/dataTool.min"],function(e){function t(e,t){var a={};return t=t?"GET":"POST",$.ajax({type:t,async:!1,url:e,success:function(e,t){var i=jQuery.parseJSON(e);a=i},error:function(e){console.log("read data error:<br>"),console.log(e.responseText)}}),a}var a,r=function(a){function r(e,t){return e-t}function s(e){e.sort();var t=[e[0]],a=0;return e.map(function(e){e!=t[a]&&(t.push(e),a++)}),t}function l(e){return["序列 "+e.seriesName+": ","分组 "+e.name+": ","上边缘: "+e.data[4].toFixed(2),"上四分位(Q1): "+e.data[3].toFixed(2),"中位数: "+e.data[2].toFixed(2),"下四分位(Q3): "+e.data[1].toFixed(2),"下边缘: "+e.data[0].toFixed(2)].join("<br/>")}function o(e){return["序列 "+e.seriesName+": ","分组 "+e.name+": ","最大值: "+e.data[4].toFixed(2),"上四分位(Q1): "+e.data[3].toFixed(2),"中位数: "+e.data[2].toFixed(2),"下四分位(Q3): "+e.data[1].toFixed(2),"最小值: "+e.data[0].toFixed(2)].join("<br/>")}function n(e,t){var a=[];return e.map(function(e,i){a[i]=e[t]}),s(a.sort(r))}function d(e,t){var a=[];return e.map(function(e,i){a[i]=e[t]}),a=a.sort(r),{min:Math.floor(a[0]).toFixed(0),max:Math.ceil(a[a.length-1]).toFixed(0)}}function x(e){var t=[];return e.map(function(e,a){isNaN(e)&&t.push(a)}),t}function h(e){var a,i,r,s,l=[];if(a=t(e.url),l.title=a.title,l.subTitle=a.source,l.rows=a.rows,0===a.rows)return l;if(3==a.cols){for(l.xAxisTitle=a.header[1].title,l.yAxisTitle=a.header[2].title,l.legend=n(a.data,0),l.xAxis=n(a.data,1),l.yAxis=[],r=0;r<l.legend.length;r++)for(l.yAxis[l.legend[r]]=[],s=0;s<l.xAxis.length;s++)l.yAxis[l.legend[r]][s]="-";for(r=0;r<a.rows;r++)for(i=a.data[r][0],s=0;s<l.xAxis.length;s++)if(a.data[r][1]==l.xAxis[s]){l.yAxis[i][s]=parseFloat(a.data[r][2]);break}for(l.series=[],r=0;r<l.legend.length;r++)l.series[r]={name:l.legend[r],type:e.type,smooth:e.smooth,barMaxWidth:e.barMaxWidth,data:l.yAxis[l.legend[r]],itemStyle:dataStyle_iT},e.lineAreaStyle&&(l.series[r].areaStyle={normal:{}}),e.reverse||(e.markLine&&(l.series[r].markLine=MLnStyle_avg),e.markPoint&&(l.series[r].markPoint=MPtStyleBoth)),"line"==e.type&&(l.series[r].itemStyle.normal={show:!1})}else if(2==a.cols){for(l.xAxisTitle=a.header[0].title,l.yAxisTitle=a.header[1].title,l.xAxis=n(a.data,0),l.yAxis=[],r=0;r<l.xAxis.length;r++)l.yAxis[r]="-";for(r=0;r<a.rows;r++)l.yAxis[r]=parseFloat(a.data[r][1]);l.legend=[],l.legend[0]=l.yAxisTitle,l.series=[],l.series[0]={name:l.yAxisTitle,type:e.type,smooth:e.smooth,barMaxWidth:e.barMaxWidth,data:l.yAxis,itemStyle:dataStyle_iT},e.lineAreaStyle&&(l.series[0].areaStyle={normal:{}}),e.reverse||(e.markLine&&(l.series[0].markLine=MLnStyle_avg),e.markPoint&&(l.series[0].markPoint=MPtStyleBoth))}else if(1==a.cols){for(l.xAxisTitle="数据编号",l.yAxisTitle=a.header[0].title,l.legend=[],l.legend[0]=l.yAxisTitle,arrTemp=[],r=0;r<a.rows;r++)arrTemp[r]=r+1;for(l.xAxis=arrTemp,l.yAxis=[],r=0;r<a.rows;r++)l.yAxis[r]=parseFloat(a.data[r][0]);l.series=[],l.series[0]={name:l.yAxisTitle,type:e.type,smooth:e.smooth,barMaxWidth:e.barMaxWidth,data:l.yAxis,itemStyle:dataStyle_iT},e.lineAreaStyle&&(l.series[0].areaStyle={normal:{}}),e.reverse||(e.markLine&&(l.series[0].markLine=MLnStyle_avg),e.markPoint&&(l.series[0].markPoint=MPtStyleBoth))}return l}function p(e,t){for(var a=0;a<t.length;a++)t[a].sort(r),e.boxData[a][0]=t[a][0],e.boxData[a][4]=t[a][t[a].length-1];return e}function u(a){var r,s=t(a.url),d=[];if(d.title=s.title,d.subTitle=s.source,d.rows=s.rows,d.series=[],0===s.rows)return d;if(3==s.cols){d.xAxisTitle=s.header[1].title,d.yAxisTitle=s.header[2].title,d.legend=n(s.data,0),d.xAxis=n(s.data,1);var x=[];for(i=0;i<d.legend.length;i++)for(x[d.legend[i]]=[],j=0;j<d.xAxis.length;j++)x[d.legend[i]][j]=[];for(i=0;i<s.rows;i++)for(iTemp=s.data[i][0],j=0;j<d.xAxis.length;j++)if(s.data[i][1]==d.xAxis[j]){x[iTemp][j].push(parseFloat(s.data[i][2]));break}d.legend.map(function(t,i){r=e.prepareBoxplotData(x[t],{layout:a.reverse?"vertical":"horizontal"}),a.minMax&&(r=p(r,x[t])),d.series[i]={name:t,type:a.type,data:r.boxData,tooltip:{formatter:a.minMax?o:l}},d.series[i+3]={name:t,type:"scatter",data:r.outliers}})}else if(2==s.cols){for(d.xAxisTitle=s.header[0].title,d.yAxisTitle=s.header[1].title,d.xAxis=n(s.data,0),d.yAxis=[],i=0;i<d.xAxis.length;i++)d.yAxis[i]=[];for(i=0;i<s.rows;i++)for(iTemp=s.data[i][0],j=0;j<d.xAxis.length;j++)if(iTemp==d.xAxis[j]){d.yAxis[j].push(parseFloat(s.data[i][1]));break}r=e.prepareBoxplotData(d.yAxis),d.legend=[],d.legend[0]=d.yAxisTitle,d.series[0]={name:d.yAxisTitle,type:a.type,data:r.boxData,tooltip:{formatter:l}},d.series[1]={name:d.yAxisTitle,type:"scatter",data:r.outliers}}else if(1==s.cols){for(d.xAxisTitle="数据编号",d.yAxisTitle=s.header[0].title,d.legend=[],d.legend[0]=d.yAxisTitle,d.xAxis=["数据1"],d.yAxis=[],d.yAxis[0]=[],i=0;i<s.rows;i++)d.yAxis[0][i]=parseFloat(s.data[i][0]);r=e.prepareBoxplotData(d.yAxis),d.series[0]={name:d.yAxisTitle,type:a.type,data:r.boxData,tooltip:{formatter:l}},d.series[1]={name:d.yAxisTitle,type:"scatter",data:r.outliers}}return d}function m(e,t,a){var i={},r=[];e.map(function(e){"undefined"==typeof i[e[t]]?i[e[t]]=parseFloat(e[a]):i[e[t]]+=parseFloat(e[a])});for(var s in i)r.push({value:i[s].toFixed(2),name:s});return r}function c(e,t,a,i){var r=[],s=0;return e.map(function(e){0===s?(r.push({value:parseFloat(e[a]).toFixed(2),name:e[t],itemStyle:{normal:{color:i[e[0]]}}}),s++):r[s-1].name==e[t]?(r[s-1].value=parseFloat(r[s-1].value)+parseFloat(e[a]),r[s-1].value=r[s-1].value.toFixed(2)):(r.push({value:parseFloat(e[a]).toFixed(2),name:e[t],itemStyle:{normal:{color:i[e[0]]}}}),s++)}),r}function y(e,t){var a=n(e.data,0),i={},r=t.length;return a.map(function(e,a){i[e]=t[a%r]}),i}function f(e){var a=t(e.url),r=[];if(r.title=a.title,r.subTitle=a.source,r.rows=a.rows,r.series=[],0===a.rows)return r;if(a.cols>2){var s=[];a.header.map(function(e){s.push(e.title)}),r.legend={orient:"vertical",x:"left",data:s};var l=y(a,e.color),o=a.cols-1,d=80/o;for(i=0;i<o;i++)r.series.push({name:a.header[i].title,type:"pie",selectedMode:"single",radius:[i*d+(i>0?0:5)+"%",(i+1)*d+"%"],data:c(a.data,i,o,l),label:{normal:{show:3>o,position:"inner"}},itemStyle:{normal:{borderColor:"#fbfbfb",borderWidth:1},emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}})}else if(2==a.cols)r.legend={orient:"vertical",x:"left",data:n(a.data,0)},r.series=[{name:a.header[0].title,type:e.type,selectedMode:"single",radius:[0,"30%"],data:m(a.data,0,2),itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}],e.circle||(r.series[0].radius=[0,"60%"],r.series[0].center=["50%","50%"]);else if(1==a.cols){r.legend={show:!1,orient:"vertical",x:"left",data:a.header[0].title};var x;a.data.map(function(e,t){x.push({value:parseFloat(e).toFixed(2),name:"数据"+(t+1)})}),r.series=[{name:a.header[0].title,type:e.type,selectedMode:"single",radius:[0,"30%"],data:x,itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}],e.circle||(r.series[0].radius=[0,"60%"],r.series[0].center=["50%","50%"])}return a.cols<3&&(elem.data.length<=6?(r.series[0].label={normal:{position:"inner"}},r.series[0].labelLine={normal:{show:!1}}):r.series[0].labelLine={normal:{show:!0,length2:10,length:15}}),r}function g(e){var a=t(e.url),i=[];if(i.title=a.title,i.subTitle=a.source,i.rows=a.rows,i.series=[],0===a.rows)return i;if(3==a.cols)i.legend={orient:"vertical",x:"left",data:n(a.data,0).concat(n(a.data,1))},i.series=[{name:a.header[0].title,type:e.type,selectedMode:"single",radius:[0,"35%"],data:m(a.data,0,2),itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}},{name:a.header[1].title,type:e.type,radius:["50%","70%"],data:m(a.data,1,2),itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}],e.circle||(i.series[0].radius=[0,"50%"],i.series[1].radius=[0,"50%"],i.series[0].center=["25%","50%"],i.series[1].center=["75%","50%"]),"0"!=e.roseType&&(i.series[0].roseType=e.roseType,i.series[0].radius=["10%","50%"],i.series[0].center=["25%","50%"],i.series[1].roseType=e.roseType,i.series[1].radius=["10%","50%"],i.series[1].center=["75%","50%"]);else if(2==a.cols)i.legend={orient:"vertical",x:"left",data:n(a.data,0)},i.series=[{name:a.header[0].title,type:e.type,selectedMode:"single",radius:[0,"30%"],data:m(a.data,0,2),itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}],e.circle||(i.series[0].radius=[0,"60%"],i.series[0].center=["50%","50%"]);else if(1==a.cols){i.legend={show:!1,orient:"vertical",x:"left",data:a.header[0].title};var r;a.data.map(function(e,t){r.push({value:parseFloat(e).toFixed(2),name:"数据"+(t+1)})}),i.series=[{name:a.header[0].title,type:e.type,selectedMode:"single",radius:[0,"30%"],data:r}],e.circle||(i.series[0].radius=[0,"60%"],i.series[0].center=["50%","50%"])}return i.series.map(function(e,t){e.data.length<=6?(i.series[t].label={normal:{position:"inner"}},i.series[t].labelLine={normal:{show:!1}}):i.series[t].labelLine={normal:{show:!0,length2:10,length:15}}}),i}function b(e,t,a){var i=[],r={normal:{width:1,opacity:.5}},s={};return"undefined"!=typeof t.data?(t.data.map(function(e){s[e]=[]}),e.map(function(e){s[e[0]].push(e.slice(1,e.length))}),t.data.map(function(e,t){i.push({name:e,type:a,lineStyle:r,data:s[e]})})):i.push({name:"平行坐标",type:a,lineStyle:r,data:e}),i}function w(e){var a=t(e.url),i=[];if(i.title=a.title,i.subTitle=a.source,i.rows=a.rows,i.series=[],i.legend=[],i.visualMap=[],i.parallelAxis=[],0==a.rows||1==a.cols)return i;var r=x(a.data[0]),s=0;if(r.length>0&&0===r[0]){var l=n(a.data,0);i.legend={top:20,data:l,itemGap:20,x:"10",y:"top",textStyle:{color:"#aaa",fontSize:14}},s=1,l.length<2&&(i.legend.show=!1)}0===s&&(i.legend.show=!1);for(var o=s;o<a.cols;o++)i.parallelAxis.push({dim:o-s,name:a.header[o].title});for(o=s;o<r.length;o++)i.parallelAxis[r[o]-s].type="category",i.parallelAxis[r[o]-s].data=n(a.data,r[o]);var h=d(a.data,e.dimension);return i.parallelAxis[e.dimension-s].max=h.max,i.parallelAxis[e.dimension-s].min=h.min,i.visualMap={show:!1,min:h.min,max:h.max,dimension:e.dimension-s,calculable:!0,inRange:{color:["#e92312","#a2ca36","#50a3ba"].reverse()}},i.series=b(a.data,i.legend,e.type),i}var A;switch(a.type){case"bar":case"line":A=h(a);break;case"boxplot":A=u(a);break;case"pie":case"funnel":A=g(a);break;case"sunrise":A=f(a);break;case"parallel":A=w(a)}return A},s=function(e){var t={title:[{text:a.title,subtext:a.subTitle,x:"center"},{text:"©成都印钞有限公司 技术质量部",borderColor:"#999",borderWidth:0,textStyle:{fontSize:14,fontWeight:"normal"},x2:10,y2:5}],grid:{left:"5%",right:"5%",top:"10%",bottom:"10%",containLabel:!0},toolbox:{show:e.toolbox,feature:{mark:{show:!0},dataView:{show:!0,readOnly:!1},dataZoom:{show:!0},magicType:{show:!0,type:["line","bar","stack","tiled"]},restore:{show:!0},saveAsImage:{show:!0}}},calculable:!0,tooltip:{trigger:"boxplot"==e.type?"item":"axis"},dataZoom:[{type:"inside",realtime:!0,start:0,end:100},{show:"h"==e.dataZoom||"vh"==e.dataZoom,realtime:!0,start:0,end:100,height:20,y2:25},{type:"inside",yAxisIndex:0,realtime:!0,start:0,end:100},{show:"v"==e.dataZoom||"vh"==e.dataZoom,yAxisIndex:0,filterMode:"empty",width:12,height:"70%",handleSize:8,showDataShadow:!1,right:5}],legend:{data:a.legend,x:"center",y:70,itemGap:20,textStyle:{fontSize:16},show:!(a.legend.length<=1)},xAxis:[{name:a.xAxisTitle,axisTick:{show:!1},type:"category",boundaryGap:"line"!=e.type,data:a.xAxis}],yAxis:[{name:a.yAxisTitle,type:"value",position:"left",scale:!0,axisLabel:{show:!0,interval:"auto",margin:8},axisTick:{show:!1}}],series:a.series};if("boxplot"==e.type&&(t.title[2]={text:"上边缘: Q3 + 1.5 * IRQ \n下边缘: Q1 - 1.5 * IRQ\nIRQ: Q3-Q1",borderColor:"#999",borderWidth:1,textStyle:{fontSize:14},x2:10,y:30},e.minMax&&(t.title[2].text="上边缘: 最大值 \n下边缘: 最小值")),e.reverse){var i;i=t.xAxis,t.xAxis=t.yAxis,t.yAxis=i}return t},l=function(e){var t={title:[{text:a.title,subtext:a.subTitle,x:"center"},{text:"©成都印钞有限公司 技术质量部",borderColor:"#999",borderWidth:0,textStyle:{fontSize:14,fontWeight:"normal"},x2:10,y2:5}],tooltip:{trigger:"item",formatter:"{a} <br/>{b}: {c} ({d}%)"},grid:{left:"5%",right:"5%",top:"10%",bottom:"10%",containLabel:!0},toolbox:{show:e.toolbox,feature:{mark:{show:!0},dataView:{show:!0,readOnly:!1},restore:{show:!0},saveAsImage:{show:!0}}},calculable:!0,legend:a.legend,series:a.series};return"funnel"==e.type&&(t.series.length>1?(t.series[0].width="60%",t.series[0].height="40%",t.series[0].left="20%",t.series[0].top="10%",t.series[0].label={normal:{position:"inner"}},t.series[0].labelLine={normal:{show:!1}},t.series[1].width="60%",t.series[1].height="40%",t.series[1].left="20%",t.series[1].top="50%",t.series[1].sort="ascending",t.series[1].label={normal:{position:"inner"}},t.series[1].labelLine={normal:{show:!1}}):(t.series[0].width="60%",t.series[0].height="60%",t.series[0].left="20%",t.series[0].top="20%",t.series[0].sort="ascending",t.series[0].label={normal:{position:"inner"}},t.series[0].labelLine={normal:{show:!1}})),t},o=function(e){var t={backgroundColor:"#445",title:[{text:a.title,subtext:a.subTitle,x:"center",textStyle:{color:"#bbb"}},{text:"©成都印钞有限公司 技术质量部",borderColor:"#999",borderWidth:0,textStyle:{fontSize:14,fontWeight:"normal",color:"#aaa"},x2:10,y2:5}],toolbox:{show:!0,feature:{dataView:{readOnly:!1},restore:{},saveAsImage:{}}},parallel:{left:"20",right:"8%",top:70,parallelAxisDefault:{type:"value",nameLocation:"start",nameGap:20,nameTextStyle:{color:"#aaa",fontSize:12},axisLine:{lineStyle:{color:"#aaa"}},axisTick:{lineStyle:{color:"#aaa"}},splitLine:{show:!1},axisLabel:{textStyle:{color:"#aaa"}}}},parallelAxis:a.parallelAxis,visualMap:a.visualMap,legend:a.legend,series:a.series};return t},n=function(e){if(a=r(e),0==a.rows)return!1;var t;switch(e.type){case"bar":case"line":case"boxplot":t=s(e);break;case"pie":case"funnel":case"sunrise":t=l(e);break;case"parallel":t=o(e)}return t};return{getOption:n}});
//# sourceMappingURL=chartDataTool.min.js.map