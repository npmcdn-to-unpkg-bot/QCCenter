<<<<<<< HEAD
define(["./js/extension/dataTool.min"],function(e){function t(e,t){var a={};return t=t?"GET":"POST",$.ajax({type:t,async:!1,url:e,success:function(e){var t=jQuery.parseJSON(e);a=t},error:function(e){console.log("read data error:<br>"),console.log(e.responseText)}}),a}var a,r,s=function(a){function r(e){e.sort();var t=[e[0]],a=0;return e.map(function(e){e!=t[a]&&(t.push(e),a++)}),t}function s(e){return["序列 "+e.seriesName+": ","分组 "+e.name+": ","上边缘: "+e.data[4].toFixed(2),"上四分位(Q1): "+e.data[3].toFixed(2),"中位数: "+e.data[2].toFixed(2),"下四分位(Q3): "+e.data[1].toFixed(2),"下边缘: "+e.data[0].toFixed(2)].join("<br/>")}function o(e){return["序列 "+e.seriesName+": ","分组 "+e.name+": ","最大值: "+e.data[4].toFixed(2),"上四分位(Q1): "+e.data[3].toFixed(2),"中位数: "+e.data[2].toFixed(2),"下四分位(Q3): "+e.data[1].toFixed(2),"最小值: "+e.data[0].toFixed(2)].join("<br/>")}function l(e,t,a,i){var s=[];return e.map("undefined"==typeof a?function(e,a){s[a]=e[t]}:function(e,r){e[i]==a&&(s[r]=e[t])}),r(s)}function n(e,t){var a=[];return e.map(function(e,r){a[r]=e[t]}),a}function d(e,t){var a,r=e[0][t],i=e[0][t];return e.map(function(e){a=Number.parseFloat(e[t]),r>a?r=a:a>i&&(i=a)}),{min:Math.floor(r).toFixed(0),max:Math.ceil(i).toFixed(0)}}function u(e){var t=[];return e.map(function(e,a){isNaN(e)&&t.push(a)}),t}function h(e){var a,r,i,s,o=[];a=t(e.url),o.title=a.title,o.subTitle=a.source,o.rows=a.rows;var d={normal:{label:{show:!0,position:e.reverse?"insideRight":"insideTop",formatter:"{c}"},barBorderRadius:e.reverse?[0,4,4,0]:[4,4,0,0]}};if(0===a.rows)return o;if(a.cols>3){o.xAxisTitle=" ",o.yAxisTitle=" ";var h=u(a.data[0]),m=0;h.length>0&&0==h[0]?(o.legend=l(a.data,0),m=1):(o.legend=[],o.legend[0]=o.yAxisTitle),o.xAxis=[];for(var i=m;i<a.header.length;i++)o.xAxis.push(a.header[i].title);o.yAxis=[],o.series=[],a.data.map(function(t){var a={name:m?t[0]:" ",type:e.type,smooth:e.smooth,barMaxWidth:e.barMaxWidth,barMinHeight:20,data:m?t.slice(1,t.length):t,itemStyle:d,symbolSize:10};e.lineAreaStyle&&(a.areaStyle={normal:{opacity:.4}},a.lineStyle={normal:{width:0,type:"solid",shadowColor:"rgba(0,0,0,0)",shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0}}),e.reverse||(e.markLine&&(a.markLine=MLnStyle_avg),e.markPoint&&(a.markPoint=MPtStyleBoth)),"line"==e.type&&(a.label={normal:{show:!1,position:"top"}}),o.series.push(a)})}else if(3==a.cols){for(o.xAxisTitle=a.header[1].title,o.yAxisTitle=a.header[2].title,o.legend=l(a.data,0),o.xAxis=l(a.data,1),o.yAxis=[],i=0;i<o.legend.length;i++)for(o.yAxis[o.legend[i]]=[],s=0;s<o.xAxis.length;s++)o.yAxis[o.legend[i]][s]="-";for(i=0;i<a.rows;i++)for(r=a.data[i][0],s=0;s<o.xAxis.length;s++)if(a.data[i][1]==o.xAxis[s]){o.yAxis[r][s]=Number.parseFloat(a.data[i][2]);break}for(o.series=[],i=0;i<o.legend.length;i++)o.series[i]={name:o.legend[i],type:e.type,smooth:e.smooth,barMaxWidth:e.barMaxWidth,barMinHeight:20,data:o.yAxis[o.legend[i]],itemStyle:d,symbolSize:10},e.lineAreaStyle&&(o.series[i].areaStyle={normal:{opacity:.4}},o.series[i].lineStyle={normal:{width:0,type:"solid",shadowColor:"rgba(0,0,0,0)",shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0}}),e.reverse||(e.markLine&&(o.series[i].markLine=MLnStyle_avg),e.markPoint&&(o.series[i].markPoint=MPtStyleBoth)),"line"==e.type&&(o.series[i].label={normal:{show:!1,position:"top"}})}else if(2==a.cols)o.xAxisTitle=a.header[0].title,o.yAxisTitle=a.header[1].title,o.legend=[],o.legend[0]=o.yAxisTitle,o.xAxis=n(a.data,0),o.yAxis=n(a.data,1),o.series=[],o.series[0]={name:o.yAxisTitle,type:e.type,smooth:e.smooth,barMaxWidth:e.barMaxWidth,barMinHeight:20,data:o.yAxis,itemStyle:d,symbolSize:10},e.lineAreaStyle&&(o.series[0].areaStyle={normal:{opacity:.4}},o.series[0].lineStyle={normal:{width:0,type:"solid",shadowColor:"rgba(0,0,0,0)",shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0}}),e.reverse||(e.markLine&&(o.series[0].markLine=MLnStyle_avg),e.markPoint&&(o.series[0].markPoint=MPtStyleBoth)),"line"==e.type&&(o.series[0].label={normal:{show:!1,position:"top"}});else if(1==a.cols){for(o.xAxisTitle="数据编号",o.yAxisTitle=a.header[0].title,o.legend=[],o.legend[0]=o.yAxisTitle,arrTemp=[],i=0;i<a.rows;i++)arrTemp[i]=i+1;for(o.xAxis=arrTemp,o.yAxis=[],i=0;i<a.rows;i++)o.yAxis[i]=Number.parseFloat(a.data[i][0]);o.series=[],o.series[0]={name:o.yAxisTitle,type:e.type,smooth:e.smooth,barMaxWidth:e.barMaxWidth,barMinHeight:20,data:o.yAxis,itemStyle:d,symbolSize:10},e.lineAreaStyle&&(o.series[0].areaStyle={normal:{opacity:.4}},o.series[0].lineStyle={normal:{width:0,type:"solid",shadowColor:"rgba(0,0,0,0)",shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0}}),e.reverse||(e.markLine&&(o.series[0].markLine=MLnStyle_avg),e.markPoint&&(o.series[0].markPoint=MPtStyleBoth)),"line"==e.type&&(o.series[0].label={normal:{show:!1,position:"top"}})}return o}function m(e,t){for(var a=0;a<t.length;a++)t[a].sort(),e.boxData[a][0]=t[a][0],e.boxData[a][4]=t[a][t[a].length-1];return e}function c(a){var r,n=t(a.url),d=[];if(d.title=n.title,d.subTitle=n.source,d.rows=n.rows,d.series=[],0===n.rows)return d;if(3==n.cols){d.xAxisTitle=n.header[1].title,d.yAxisTitle=n.header[2].title,d.legend=l(n.data,0),d.xAxis=l(n.data,1);var u=[];for(i=0;i<d.legend.length;i++)for(u[d.legend[i]]=[],j=0;j<d.xAxis.length;j++)u[d.legend[i]][j]=[];for(i=0;i<n.rows;i++)for(iTemp=n.data[i][0],j=0;j<d.xAxis.length;j++)if(n.data[i][1]==d.xAxis[j]){u[iTemp][j].push(Number.parseFloat(n.data[i][2]));break}d.legend.map(function(t,i){r=e.prepareBoxplotData(u[t],{layout:a.reverse?"vertical":"horizontal"}),a.minMax&&(r=m(r,u[t])),d.series[i]={name:t,type:a.type,data:r.boxData,tooltip:{backgroundColor:"#009688",formatter:a.minMax?o:s}},d.series[i+3]={name:t,type:"scatter",data:r.outliers}})}else if(2==n.cols){for(d.xAxisTitle=n.header[0].title,d.yAxisTitle=n.header[1].title,d.xAxis=l(n.data,0),d.yAxis=[],i=0;i<d.xAxis.length;i++)d.yAxis[i]=[];for(i=0;i<n.rows;i++)for(iTemp=n.data[i][0],j=0;j<d.xAxis.length;j++)if(iTemp==d.xAxis[j]){d.yAxis[j].push(Number.parseFloat(n.data[i][1]));break}r=e.prepareBoxplotData(d.yAxis),d.legend=[],d.legend[0]=d.yAxisTitle,d.series[0]={name:d.yAxisTitle,type:a.type,data:r.boxData,tooltip:{backgroundColor:"#009688",formatter:s}},d.series[1]={name:d.yAxisTitle,type:"scatter",data:r.outliers}}else if(1==n.cols){for(d.xAxisTitle="数据编号",d.yAxisTitle=n.header[0].title,d.legend=[],d.legend[0]=d.yAxisTitle,d.xAxis=["数据1"],d.yAxis=[],d.yAxis[0]=[],i=0;i<n.rows;i++)d.yAxis[0][i]=Number.parseFloat(n.data[i][0]);r=e.prepareBoxplotData(d.yAxis),d.series[0]={name:d.yAxisTitle,type:a.type,data:r.boxData,tooltip:{backgroundColor:"#009688",formatter:s}},d.series[1]={name:d.yAxisTitle,type:"scatter",data:r.outliers}}return d}function p(e,t,a){var r={},i=[];e.map(function(e){"undefined"==typeof r[e[t]]?r[e[t]]=Number.parseFloat(e[a]):r[e[t]]+=Number.parseFloat(e[a])});for(var s in r)i.push({value:r[s].toFixed(2),name:s});return i}function x(e,t,a,r){var i=[],s=0;return e.map(function(e){0===s?(i.push({value:Number.parseFloat(e[a]).toFixed(2),name:e[t],itemStyle:{normal:{color:r[e[0]]}}}),s++):i[s-1].name==e[t]?(i[s-1].value=Number.parseFloat(i[s-1].value)+Number.parseFloat(e[a]),i[s-1].value=i[s-1].value.toFixed(2)):(i.push({value:Number.parseFloat(e[a]).toFixed(2),name:e[t],itemStyle:{normal:{color:r[e[0]]}}}),s++)}),i}function f(e,t){var a=l(e.data,0),r={},i=t.length;return a.map(function(e,a){r[e]=t[a%i]}),r}function y(e){var a=t(e.url),r=[];if(r.title=a.title,r.subTitle=a.source,r.rows=a.rows,r.series=[],0===a.rows)return r;if(a.cols>2){for(var i=[],s=0;s<a.header.length-1;s++)i.push(a.header[s].title);r.legend={orient:"vertical",x:"left",data:i};var o=f(a,e.color),n=a.cols-1,d=80/n;for(s=0;n>s;s++)r.series.push({name:a.header[s].title,type:"pie",selectedMode:"single",radius:[s*d+(s>0?0:5)+"%",(s+1)*d+"%"],data:x(a.data,s,n,o),label:{normal:{show:3>n?!0:!1,position:"inner"}},itemStyle:{normal:{borderColor:"#fbfbfb",borderWidth:1,opacity:1-.2*(s/n)},emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}})}else if(2==a.cols)r.legend={orient:"vertical",x:"left",data:l(a.data,0)},r.series=[{name:a.header[0].title,type:e.type,selectedMode:"single",radius:[0,"30%"],data:p(a.data,0,2),itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}],e.circle||(r.series[0].radius=[0,"60%"],r.series[0].center=["50%","50%"]);else if(1==a.cols){r.legend={show:!1,orient:"vertical",x:"left",data:a.header[0].title};var u;a.data.map(function(e,t){u.push({value:Number.parseFloat(e).toFixed(2),name:"数据"+(t+1)})}),r.series=[{name:a.header[0].title,type:e.type,selectedMode:"single",radius:[0,"30%"],data:u,itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}],e.circle||(r.series[0].radius=[0,"60%"],r.series[0].center=["50%","50%"])}return a.cols<3&&(elem.data.length<=6?(r.series[0].label={normal:{position:"inner"}},r.series[0].labelLine={normal:{show:!1}}):r.series[0].labelLine={normal:{show:!0,length2:10,length:15}}),r}function b(e){var a=t(e.url),r=[];if(r.title=a.title,r.subTitle=a.source,r.rows=a.rows,r.series=[],0===a.rows)return r;if(3==a.cols)r.legend={orient:"vertical",x:"left",data:l(a.data,0).concat(l(a.data,1))},r.series=[{name:a.header[0].title,type:e.type,selectedMode:"single",radius:[0,"35%"],data:p(a.data,0,2),itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}},{name:a.header[1].title,type:e.type,radius:["50%","70%"],data:p(a.data,1,2),itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}],e.circle||(r.series[0].radius=[0,"50%"],r.series[1].radius=[0,"50%"],r.series[0].center=["25%","50%"],r.series[1].center=["75%","50%"]),"0"!=e.roseType&&(r.series[0].roseType=e.roseType,r.series[0].radius=["10%","50%"],r.series[0].center=["25%","50%"],r.series[1].roseType=e.roseType,r.series[1].radius=["10%","50%"],r.series[1].center=["75%","50%"]);else if(2==a.cols)r.legend={orient:"vertical",x:"left",data:l(a.data,0)},r.series=[{name:a.header[0].title,type:e.type,selectedMode:"single",radius:[0,"30%"],data:p(a.data,0,1),itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}],e.circle||(r.series[0].radius=[0,"60%"],r.series[0].center=["50%","50%"]);else if(1==a.cols){r.legend={show:!1,orient:"vertical",x:"left",data:a.header[0].title};var i;a.data.map(function(e,t){i.push({value:Number.parseFloat(e).toFixed(2),name:"数据"+(t+1)})}),r.series=[{name:a.header[0].title,type:e.type,selectedMode:"single",radius:[0,"30%"],data:i}],e.circle||(r.series[0].radius=[0,"60%"],r.series[0].center=["50%","50%"])}return r.series.map(function(e,t){e.data.length<=6?(r.series[t].label={normal:{position:"inner"}},r.series[t].labelLine={normal:{show:!1}}):r.series[t].labelLine={normal:{show:!0,length2:10,length:15}}}),r}function g(e,t,a){var r=[],i={normal:{width:1,opacity:.5}},s={};return"undefined"!=typeof t.data?(t.data.map(function(e){s[e]=[]}),e.map(function(e){s[e[0]].push(e.slice(1,e.length))}),t.data.map(function(e){r.push({name:e,type:a,lineStyle:i,data:s[e]})})):r.push({name:"平行坐标",type:a,lineStyle:i,data:e}),r}function w(e,t){for(var a=-1,r=e.length-1,i=r;null!=e[i]&&-1==a;i--)if(e[i].name==t)return a=i;return a}function v(e,t,a){if(t.length-1==a.deepLevel)return e;var r=t[a.deepLevel],i=w(e,r);return-1==i?(e.push({name:r,value:a.value}),i=e.length-1,t.length-2>a.deepLevel&&(e[i].children=[])):(e[i].value+=a.value,null==e[i].children&&t.length-2>a.deepLevel&&(e[i].children=[])),a.deepLevel++,t.length-1>a.deepLevel&&(e[i].children=v(e[i].children,t,a)),e}function A(e){var t,a=[],r=e[0].length-1;return e.map(function(e){t={value:Number.parseFloat(e[r]),deepLevel:0},a=v(a,e,t)}),a}function S(e){var t={};return e.map(function(e){isNaN(t[e[0]])&&(t[e[0]]=[]);for(var a=[],r=1;r<e.length;r++)a.push(Number.parseFloat(e[r]).toFixed(2));t[e[0]].push(a)}),t}function k(e){var t={radarIndicator:[],series:[],legend:{}},a=0,r=u(e.data[0]);r.length>0&&0===r[0]&&(t.legend={data:l(e.data,0),orient:"vertical",left:"left"},a=1);for(var i=a;i<e.cols;i++){var s=d(e.data,i);s.max=1.1*s.max,t.radarIndicator.push({name:e.header[i].title,max:s.max.toFixed(0)})}if(a){var o=S(e.data);for(var n in o)t.series.push({name:n,type:"radar",symbol:"none",areaStyle:{normal:{opacity:.3}},lineStyle:{normal:{width:1,opacity:.5}},data:o[n]})}else t.series.push({name:e.title,type:"radar",symbol:"none",areaStyle:{normal:{opacity:.3}},lineStyle:{normal:{width:1,opacity:.5}},data:e.data});return t}function T(e){var a=t(e.url),r=[];if(r.title=a.title,r.subTitle=a.source,r.rows=a.rows,r.series=[],r.legend=[],r.visualMap=[],r.parallelAxis=[],1===a.cols||0===a.rows)return r;var i=u(a.data[0]),s=0;if(i.length>0&&0===i[0]){var o=l(a.data,0);r.legend={top:20,data:o,itemGap:20,x:"10",top:"20",width:"500",textStyle:{color:"#aaa",fontSize:14}},s=1,o.length<2&&(r.legend.show=!1)}0===s&&(r.legend.show=!1);for(var n=s;n<a.cols;n++){var h=d(a.data,n);r.parallelAxis.push({dim:n-s,name:a.header[n].title,max:h.max,min:h.min})}for(n=s;n<i.length;n++)r.parallelAxis[i[n]-s].type="category",r.parallelAxis[i[n]-s].data=l(a.data,i[n]);return h=d(a.data,e.dimension),r.visualMap={show:!1,min:h.min,max:h.max,dimension:e.dimension-s,calculable:!0,inRange:{color:["#e92312","#a2ca36","#50a3ba"].reverse()}},r.series=g(a.data,r.legend,e.type),r}function N(e){function a(){return[{itemStyle:{normal:{borderWidth:0,gapWidth:3,borderColor:"black"}}},{itemStyle:{normal:{gapWidth:2,borderColor:"black"}}},{colorSaturation:[.25,.4],itemStyle:{normal:{gapWidth:1,borderColor:"black"}}}]}var r=t(e.url);if(0===r.rows)return!1;var i={title:r.title,subTitle:r.source,rows:r.rows,series:[{name:r.header[r.cols-1].title,type:e.type,label:{show:!0,formatter:"{b}"},squareRatio:e.squareRatio,width:"100%",height:"90%",top:55,itemStyle:{normal:{borderColor:"black"}},levels:a(),data:A(r.data)}]};return i}function F(e){var a=t(e.url);if(0===a.rows||a.cols<3)return!1;var r=k(a),i={title:a.title,subTitle:a.source,rows:a.rows,radarIndicator:r.radarIndicator,series:r.series,legend:r.legend};return i}function L(e,t){var a={};e.data.map(function(e){"undefined"==typeof a[e[0]]&&(a[e[0]]={name:e[0],type:"scatter",symbolSize:function(e){var a=t*e[1];return a.toFixed(0)},data:[]});for(var r=[],i=1;i<e.length;i++)r.push(Number.parseFloat(e[i]).toFixed(2));a[e[0]].data.push(r)});var r=[];for(var i in a)r.push(a[i]);return r}function M(e){var a=t(e.url);if(0===a.rows||1===a.cols||a.cols<=2&&isNaN(a.data[0][0]))return!1;var r=isNaN(a.data[0][0]),i={title:a.title,subTitle:a.source,rows:a.rows,xAxisName:r?a.header[1].title:a.header[0].title,yAxisName:r?a.header[2].title:a.header[1].title};if(r){i.legend={data:l(a.data,0),left:"left"};var s=d(a.data,2),o=e.scatterSize/s.max;i.series=L(a,o)}else{var s=d(a.data,1),o=e.scatterSize/s.max;i.series={type:"scatter",symbolSize:function(e){var t=o*e[1];return t.toFixed(0)},data:a.data}}return i}function C(e){for(var t={nodes:[],links:[],linkName:[]},a={nodes:[],links:[]},r=e.header.length,i=0;r-1>i;i++)i==r-2&&(t.linkName=t.nodes),t.nodes=t.nodes.concat(l(e.data,i));t.linkName.map(function(e){t.links[e]={}}),e.data.map(function(e){for(var a=0;r-2>a;a++)isNaN(t.links[e[a]][e[a+1]])?t.links[e[a]][e[a+1]]=Number.parseFloat(e[r-1]):t.links[e[a]][e[a+1]]+=Number.parseFloat(e[r-1])}),t.nodes.map(function(e){a.nodes.push({name:e})});for(var s in t.links)for(var o in t.links[s])a.links.push({source:s,target:o,value:t.links[s][o]});return a}function W(e){var a=t(e.url);if(0===a.rows||a.cols<=2)return!1;var r={title:a.title,subTitle:a.source,rows:a.rows,series:C(a)};return r}function O(e,t){for(var a=JSON.stringify(e),r=!1,i=t.length,s=0;i>s&&!r;s++)a==JSON.stringify(t[s])&&(r=!0);return r||t.push(e),t}function z(e){for(var t={nodes:[],nodesName:[],links:[]},a={categories:[],nodes:[],links:[],legend:[]},r=[],i=e.header.length,s=0,o=90/i,n=[],d=0;i-1>d;d++){var u=o*(i-d);n[d]=u.toFixed(0)}return a.legend=l(e.data,0),a.legend.map(function(o,d){a.categories.push({name:o}),r[o]=d,t.nodesName[d]=[],t.nodes[d]=[];for(var u=0;i-1>u;u++){var h=l(e.data,u,o,0);h.map(function(e){t.nodes[d][e]={name:e,value:0,category:d,id:s,symbolSize:n[u]},s++})}}),e.data.map(function(e){for(var a=0;i-2>a;a++){var s=r[e[0]],o=e[a],l=e[a+1];t.links.push({source:t.nodes[s][o].id,target:t.nodes[s][l].id}),t.nodes[s][o].value+=Number.parseFloat(e[i-1])}t.nodes[r[e[0]]][e[a]].value+=Number.parseFloat(e[i-1])}),t.nodes.map(function(e){for(var t in e)a.nodes.push(e[t])}),a.links[0]=t.links[0],t.links.map(function(e){a.links=O(e,a.links)}),a}function I(e){var a=t(e.url);if(0===a.rows||a.cols<=2)return!1;var r={title:a.title,subTitle:a.source,rows:a.rows,series:z(a)};return r}var B;switch(a.type){case"bar":case"line":B=h(a);break;case"boxplot":B=c(a);break;case"pie":case"funnel":B=b(a);break;case"sunrise":B=y(a);break;case"parallel":B=T(a);break;case"treemap":B=N(a);break;case"radar":B=F(a);break;case"scatter":B=M(a);break;case"sankey":B=W(a);break;case"graph":B=I(a)}return B},o=function(e){var t={title:[{text:a.title,subtext:a.subTitle+r,x:"center"},{text:"©成都印钞有限公司 技术质量部",borderColor:"#999",borderWidth:0,textStyle:{fontSize:14,fontWeight:"normal"},x2:10,y2:5}],grid:{left:"5%",right:"5%",top:"10%",bottom:"10%",containLabel:!0},toolbox:{show:e.toolbox,feature:{mark:{show:!0},dataView:{show:!0,readOnly:!1},dataZoom:{show:!0},magicType:{show:!0,type:["line","bar","stack","tiled"]},restore:{show:!0},saveAsImage:{show:!0}}},calculable:!0,tooltip:{backgroundColor:"#009688",trigger:"item"},dataZoom:[{type:"inside",realtime:!0,start:0,end:100},{show:"h"==e.dataZoom||"vh"==e.dataZoom?!0:!1,realtime:!0,start:0,end:100,height:20,y2:25},{show:"v"==e.dataZoom||"vh"==e.dataZoom?!0:!1,yAxisIndex:0,filterMode:"empty",width:12,height:"70%",handleSize:8,showDataShadow:!1,right:5}],legend:{data:a.legend,x:"center",y:70,itemGap:20,textStyle:{fontSize:16},show:a.legend.length<=1?!1:!0},xAxis:[{name:a.xAxisTitle,axisTick:{show:!1},type:"category",boundaryGap:"line"==e.type?!1:!0,data:a.xAxis}],yAxis:[{name:a.yAxisTitle,type:"value",position:"left",scale:!0,axisLabel:{show:!0,interval:"auto",margin:8},axisTick:{show:!1}}],series:a.series};if("boxplot"==e.type&&(t.title[2]={text:"上边缘: Q3 + 1.5 * IRQ \n下边缘: Q1 - 1.5 * IRQ\nIRQ: Q3-Q1",borderColor:"#999",borderWidth:1,textStyle:{fontSize:14},x2:10,y:30},e.minMax&&(t.title[2].text="上边缘: 最大值 \n下边缘: 最小值")),e.reverse){var i;i=t.xAxis,t.xAxis=t.yAxis,t.yAxis=i}return t},l=function(e){var t={title:[{text:a.title,subtext:a.subTitle+r,x:"center"},{text:"©成都印钞有限公司 技术质量部",borderColor:"#999",borderWidth:0,textStyle:{fontSize:14,fontWeight:"normal"},x2:10,y2:5}],tooltip:{backgroundColor:"#009688",trigger:"item",formatter:"{a} <br/>{b}: {c} ({d}%)"},grid:{left:"5%",right:"5%",top:"10%",bottom:"10%",containLabel:!0},toolbox:{show:e.toolbox,feature:{mark:{show:!0},dataView:{show:!0,readOnly:!1},restore:{show:!0},saveAsImage:{show:!0}}},calculable:!0,legend:a.legend,series:a.series};return"funnel"==e.type&&(t.series.length>1?(t.series[0].width="60%",t.series[0].height="40%",t.series[0].left="20%",t.series[0].top="10%",t.series[0].label={normal:{position:"inner"}},t.series[0].labelLine={normal:{show:!1}},t.series[1].width="60%",t.series[1].height="40%",t.series[1].left="20%",t.series[1].top="50%",t.series[1].sort="ascending",t.series[1].label={normal:{position:"inner"}},t.series[1].labelLine={normal:{show:!1}}):(t.series[0].width="60%",t.series[0].height="60%",t.series[0].left="20%",t.series[0].top="20%",t.series[0].sort="ascending",t.series[0].label={normal:{position:"inner"}},t.series[0].labelLine={normal:{show:!1}})),t},n=function(){var e={backgroundColor:"#445",title:[{text:a.title,subtext:a.subTitle+r,x:"center",textStyle:{color:"#bbb"}},{text:"©成都印钞有限公司 技术质量部",borderColor:"#999",borderWidth:0,textStyle:{fontSize:14,fontWeight:"normal",color:"#aaa"},x2:10,y2:5}],toolbox:{show:!0,feature:{dataView:{readOnly:!1},restore:{},saveAsImage:{}}},parallel:{left:"50",right:"50",top:120,parallelAxisDefault:{type:"value",nameLocation:"start",nameGap:20,nameTextStyle:{color:"#aaa",fontSize:12},axisLine:{lineStyle:{color:"#aaa"}},axisTick:{lineStyle:{color:"#aaa"}},splitLine:{show:!1},axisLabel:{textStyle:{color:"#aaa"}}}},parallelAxis:a.parallelAxis,visualMap:a.visualMap,legend:a.legend,series:a.series};return e},d=function(){var e=function(){this.encodeHTML=function(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")},this.addCommas=function(e){return isNaN(e)?"-":(e=(e+"").split("."),e[0].replace(/(\d{1,3})(?=(?:\d{3})+(?!\d))/g,"$1,")+(e.length>1?"."+e[1]:""))}},t=(new e,{title:[{text:a.title,subtext:a.subTitle+r,x:"center"},{text:"©成都印钞有限公司 技术质量部",borderColor:"#999",borderWidth:0,textStyle:{fontSize:14,fontWeight:"normal"},x2:5,y2:2}],toolbox:{show:!0,feature:{dataView:{readOnly:!1},restore:{},saveAsImage:{}}},tooltip:{backgroundColor:"#009688",formatter:function(e){for(var t=e.value,a=e.treePathInfo,r=[],i=1;i<a.length;i++)r.push(a[i].name);return r.join("/")+"<br>"+a[0].name+": "+t}},series:a.series});return t},u=function(e){var t={title:[{text:a.title,subtext:a.subTitle+r,x:"center"},{text:"©成都印钞有限公司 技术质量部",borderColor:"#999",borderWidth:0,textStyle:{fontSize:14,fontWeight:"normal"},x2:5,y2:2}],toolbox:{show:!0,feature:{dataView:{readOnly:!1},restore:{},saveAsImage:{}}},tooltip:{backgroundColor:"#009688"},legend:a.legend,radar:{indicator:a.radarIndicator,shape:e.shape,name:{textStyle:{color:"#555"}},splitLine:{lineStyle:{color:"#bbb"}},center:["50%","58%"],radius:"75%",splitArea:{show:!1}},series:a.series};return t},h=function(){var e={title:[{text:a.title,subtext:a.subTitle+r,x:"center"},{text:"©成都印钞有限公司 技术质量部",borderColor:"#999",borderWidth:0,textStyle:{fontSize:14,fontWeight:"normal"},x2:5,y2:2}],grid:{left:"5%",right:"5%",top:"10%",bottom:"10%",containLabel:!0},toolbox:{show:!0,feature:{mark:{show:!0},dataView:{show:!0,readOnly:!1},dataZoom:{show:!0},restore:{show:!0},saveAsImage:{show:!0}}},tooltip:{trigger:"axis",showDelay:0,formatter:function(e){return e.value.length>1?e.seriesName+" :<br/>"+e.value[0]+" , "+e.value[1]+" ":e.seriesName+" :<br/>"+e.name+" : "+e.value},axisPointer:{show:!0,type:"cross",lineStyle:{type:"dashed",width:1}}},dataZoom:[{type:"inside",realtime:!0,start:0,end:100},{show:!1,realtime:!0,start:0,end:100,height:20,y2:25},{type:"inside",yAxisIndex:0,realtime:!0,start:0,end:100},{show:!1,yAxisIndex:0,filterMode:"empty",width:12,height:"70%",handleSize:8,showDataShadow:!1,right:5}],xAxis:[{name:a.xAxisName,type:"value",axisTick:{show:!1},boundaryGap:!1,scale:!0,axisLabel:{show:!0},axisLine:{show:!0}}],yAxis:[{name:a.yAxisName,type:"value",scale:!0,position:"left",axisLabel:{show:!0,interval:"auto",margin:8},axisTick:{show:!1},axisLine:{show:!0}}],legend:a.legend,series:a.series};return e},m=function(e){var t={title:[{text:a.title,subtext:a.subTitle+r,x:"center"},{text:"©成都印钞有限公司 技术质量部",borderColor:"#999",borderWidth:0,textStyle:{fontSize:14,fontWeight:"normal"},x2:5,y2:2}],grid:{left:"5%",right:"5%",top:"10%",bottom:"10%",containLabel:!0},toolbox:{show:!0,feature:{dataView:{show:!0,readOnly:!1},restore:{show:!0},saveAsImage:{show:!0}}},tooltip:{trigger:"item",triggerOn:"mousemove"},series:{type:e.type,data:a.series.nodes,links:a.series.links,layout:"none",itemStyle:{normal:{borderWidth:1,borderColor:"#aaa"}},lineStyle:{normal:{curveness:.5,opacity:.5}}}};return t},c=function(e){var t={title:[{text:a.title,subtext:a.subTitle+r,x:"center"},{text:"©成都印钞有限公司 技术质量部",borderColor:"#999",borderWidth:0,textStyle:{fontSize:14,fontWeight:"normal"},x2:5,y2:2}],grid:{left:"5%",right:"5%",top:"10%",bottom:"10%",containLabel:!0},toolbox:{show:!0,feature:{dataView:{show:!0,readOnly:!1},restore:{show:!0},saveAsImage:{show:!0}}},legend:{data:a.series.legend,x:"center",y:70,itemGap:20,textStyle:{fontSize:16}},tooltip:{},series:{name:"关系图",type:e.type,layout:"1"==e.force?"force":"circular",label:{normal:{position:"right",formatter:"{b}"}},draggable:!0,nodes:a.series.nodes,categories:a.series.categories,force:{gravity:.07,edgeLength:100,repulsion:150},links:a.series.links}};return t},p=function(e){a=s(e);var t=e.url.split("tstart=")[1],i=jsLeft(t,8),p=jsLeft(t.split("tend=")[1],8);if(r="     统计时间："+i+" - "+p,0==a.rows)return!1;var x;switch(e.type){case"bar":case"line":case"boxplot":x=o(e);break;case"pie":case"funnel":case"sunrise":x=l(e);break;case"parallel":x=n(e);break;case"treemap":x=d(e);break;case"radar":x=u(e);break;case"scatter":x=h(e);break;case"sankey":x=m(e);break;case"graph":x=c(e)}return x};return{getOption:p}});
=======
define(["./js/extension/dataTool.min"],function(e){function t(e,t){var a={};return t=t?"GET":"POST",$.ajax({type:t,async:!1,url:e,success:function(e,t){var r=jQuery.parseJSON(e);a=r},error:function(e){console.log("read data error:<br>"),console.log(e.responseText)}}),a}var a,r=function(a){function r(e){e.sort();var t=[e[0]],a=0;return e.map(function(e){e!=t[a]&&(t.push(e),a++)}),t}function s(e){return["序列 "+e.seriesName+": ","分组 "+e.name+": ","上边缘: "+e.data[4].toFixed(2),"上四分位(Q1): "+e.data[3].toFixed(2),"中位数: "+e.data[2].toFixed(2),"下四分位(Q3): "+e.data[1].toFixed(2),"下边缘: "+e.data[0].toFixed(2)].join("<br/>")}function o(e){return["序列 "+e.seriesName+": ","分组 "+e.name+": ","最大值: "+e.data[4].toFixed(2),"上四分位(Q1): "+e.data[3].toFixed(2),"中位数: "+e.data[2].toFixed(2),"下四分位(Q3): "+e.data[1].toFixed(2),"最小值: "+e.data[0].toFixed(2)].join("<br/>")}function l(e,t,a,i){var s=[];return"undefined"==typeof a?e.map(function(e,a){s[a]=e[t]}):e.map(function(e,r){e[i]==a&&(s[r]=e[t])}),r(s)}function n(e,t){var a=[];return e.map(function(e,r){a[r]=e[t]}),a}function d(e,t){var a,r=e[0][t],i=e[0][t];return e.map(function(e,s){a=Number.parseFloat(e[t]),r>a?r=a:a>i&&(i=a)}),{min:Math.floor(r).toFixed(0),max:Math.ceil(i).toFixed(0)}}function u(e){var t=[];return e.map(function(e,a){isNaN(e)&&t.push(a)}),t}function h(e){var a,r,i,s,o=[];a=t(e.url),o.title=a.title,o.subTitle=a.source,o.rows=a.rows;var d={normal:{label:{show:!0,position:e.reverse?"insideRight":"insideTop",formatter:"{c}"},barBorderRadius:e.reverse?[0,4,4,0]:[4,4,0,0]}};if(0===a.rows)return o;if(a.cols>3){o.xAxisTitle=" ",o.yAxisTitle=" ";var h=u(a.data[0]),m=0;h.length>0&&0==h[0]?(o.legend=l(a.data,0),m=1):(o.legend=[],o.legend[0]=o.yAxisTitle),o.xAxis=[];for(var i=m;i<a.header.length;i++)o.xAxis.push(a.header[i].title);o.yAxis=[],o.series=[],a.data.map(function(t){var a={name:m?t[0]:" ",type:e.type,smooth:e.smooth,barMaxWidth:e.barMaxWidth,barMinHeight:20,data:m?t.slice(1,t.length):t,itemStyle:d,symbolSize:10};e.lineAreaStyle&&(a.areaStyle={normal:{opacity:.4}},a.lineStyle={normal:{width:0,type:"solid",shadowColor:"rgba(0,0,0,0)",shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0}}),e.reverse||(e.markLine&&(a.markLine=MLnStyle_avg),e.markPoint&&(a.markPoint=MPtStyleBoth)),"line"==e.type&&(a.label={normal:{show:!1,position:"top"}}),o.series.push(a)})}else if(3==a.cols){for(o.xAxisTitle=a.header[1].title,o.yAxisTitle=a.header[2].title,o.legend=l(a.data,0),o.xAxis=l(a.data,1),o.yAxis=[],i=0;i<o.legend.length;i++)for(o.yAxis[o.legend[i]]=[],s=0;s<o.xAxis.length;s++)o.yAxis[o.legend[i]][s]="-";for(i=0;i<a.rows;i++)for(r=a.data[i][0],s=0;s<o.xAxis.length;s++)if(a.data[i][1]==o.xAxis[s]){o.yAxis[r][s]=Number.parseFloat(a.data[i][2]);break}for(o.series=[],i=0;i<o.legend.length;i++)o.series[i]={name:o.legend[i],type:e.type,smooth:e.smooth,barMaxWidth:e.barMaxWidth,barMinHeight:20,data:o.yAxis[o.legend[i]],itemStyle:d,symbolSize:10},e.lineAreaStyle&&(o.series[i].areaStyle={normal:{opacity:.4}},o.series[i].lineStyle={normal:{width:0,type:"solid",shadowColor:"rgba(0,0,0,0)",shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0}}),e.reverse||(e.markLine&&(o.series[i].markLine=MLnStyle_avg),e.markPoint&&(o.series[i].markPoint=MPtStyleBoth)),"line"==e.type&&(o.series[i].label={normal:{show:!1,position:"top"}})}else if(2==a.cols)o.xAxisTitle=a.header[0].title,o.yAxisTitle=a.header[1].title,o.legend=[],o.legend[0]=o.yAxisTitle,o.xAxis=n(a.data,0),o.yAxis=n(a.data,1),o.series=[],o.series[0]={name:o.yAxisTitle,type:e.type,smooth:e.smooth,barMaxWidth:e.barMaxWidth,barMinHeight:20,data:o.yAxis,itemStyle:d,symbolSize:10},e.lineAreaStyle&&(o.series[0].areaStyle={normal:{opacity:.4}},o.series[0].lineStyle={normal:{width:0,type:"solid",shadowColor:"rgba(0,0,0,0)",shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0}}),e.reverse||(e.markLine&&(o.series[0].markLine=MLnStyle_avg),e.markPoint&&(o.series[0].markPoint=MPtStyleBoth)),"line"==e.type&&(o.series[0].label={normal:{show:!1,position:"top"}});else if(1==a.cols){for(o.xAxisTitle="数据编号",o.yAxisTitle=a.header[0].title,o.legend=[],o.legend[0]=o.yAxisTitle,arrTemp=[],i=0;i<a.rows;i++)arrTemp[i]=i+1;for(o.xAxis=arrTemp,o.yAxis=[],i=0;i<a.rows;i++)o.yAxis[i]=Number.parseFloat(a.data[i][0]);o.series=[],o.series[0]={name:o.yAxisTitle,type:e.type,smooth:e.smooth,barMaxWidth:e.barMaxWidth,barMinHeight:20,data:o.yAxis,itemStyle:d,symbolSize:10},e.lineAreaStyle&&(o.series[0].areaStyle={normal:{opacity:.4}},o.series[0].lineStyle={normal:{width:0,type:"solid",shadowColor:"rgba(0,0,0,0)",shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0}}),e.reverse||(e.markLine&&(o.series[0].markLine=MLnStyle_avg),e.markPoint&&(o.series[0].markPoint=MPtStyleBoth)),"line"==e.type&&(o.series[0].label={normal:{show:!1,position:"top"}})}return o}function m(e,t){for(var a=0;a<t.length;a++)t[a].sort(),e.boxData[a][0]=t[a][0],e.boxData[a][4]=t[a][t[a].length-1];return e}function c(a){var r,n=t(a.url),d=[];if(d.title=n.title,d.subTitle=n.source,d.rows=n.rows,d.series=[],0===n.rows)return d;if(3==n.cols){d.xAxisTitle=n.header[1].title,d.yAxisTitle=n.header[2].title,d.legend=l(n.data,0),d.xAxis=l(n.data,1);var u=[];for(i=0;i<d.legend.length;i++)for(u[d.legend[i]]=[],j=0;j<d.xAxis.length;j++)u[d.legend[i]][j]=[];for(i=0;i<n.rows;i++)for(iTemp=n.data[i][0],j=0;j<d.xAxis.length;j++)if(n.data[i][1]==d.xAxis[j]){u[iTemp][j].push(Number.parseFloat(n.data[i][2]));break}d.legend.map(function(t,i){r=e.prepareBoxplotData(u[t],{layout:a.reverse?"vertical":"horizontal"}),a.minMax&&(r=m(r,u[t])),d.series[i]={name:t,type:a.type,data:r.boxData,tooltip:{backgroundColor:"#009688",formatter:a.minMax?o:s}},d.series[i+3]={name:t,type:"scatter",data:r.outliers}})}else if(2==n.cols){for(d.xAxisTitle=n.header[0].title,d.yAxisTitle=n.header[1].title,d.xAxis=l(n.data,0),d.yAxis=[],i=0;i<d.xAxis.length;i++)d.yAxis[i]=[];for(i=0;i<n.rows;i++)for(iTemp=n.data[i][0],j=0;j<d.xAxis.length;j++)if(iTemp==d.xAxis[j]){d.yAxis[j].push(Number.parseFloat(n.data[i][1]));break}r=e.prepareBoxplotData(d.yAxis),d.legend=[],d.legend[0]=d.yAxisTitle,d.series[0]={name:d.yAxisTitle,type:a.type,data:r.boxData,tooltip:{backgroundColor:"#009688",formatter:s}},d.series[1]={name:d.yAxisTitle,type:"scatter",data:r.outliers}}else if(1==n.cols){for(d.xAxisTitle="数据编号",d.yAxisTitle=n.header[0].title,d.legend=[],d.legend[0]=d.yAxisTitle,d.xAxis=["数据1"],d.yAxis=[],d.yAxis[0]=[],i=0;i<n.rows;i++)d.yAxis[0][i]=Number.parseFloat(n.data[i][0]);r=e.prepareBoxplotData(d.yAxis),d.series[0]={name:d.yAxisTitle,type:a.type,data:r.boxData,tooltip:{backgroundColor:"#009688",formatter:s}},d.series[1]={name:d.yAxisTitle,type:"scatter",data:r.outliers}}return d}function p(e,t,a){var r={},i=[];e.map(function(e){"undefined"==typeof r[e[t]]?r[e[t]]=Number.parseFloat(e[a]):r[e[t]]+=Number.parseFloat(e[a])});for(var s in r)i.push({value:r[s].toFixed(2),name:s});return i}function x(e,t,a,r){var i=[],s=0;return e.map(function(e){0===s?(i.push({value:Number.parseFloat(e[a]).toFixed(2),name:e[t],itemStyle:{normal:{color:r[e[0]]}}}),s++):i[s-1].name==e[t]?(i[s-1].value=Number.parseFloat(i[s-1].value)+Number.parseFloat(e[a]),i[s-1].value=i[s-1].value.toFixed(2)):(i.push({value:Number.parseFloat(e[a]).toFixed(2),name:e[t],itemStyle:{normal:{color:r[e[0]]}}}),s++)}),i}function f(e,t){var a=l(e.data,0),r={},i=t.length;return a.map(function(e,a){r[e]=t[a%i]}),r}function y(e){var a=t(e.url),r=[];if(r.title=a.title,r.subTitle=a.source,r.rows=a.rows,r.series=[],0===a.rows)return r;if(a.cols>2){for(var i=[],s=0;s<a.header.length-1;s++)i.push(a.header[s].title);r.legend={orient:"vertical",x:"left",data:i};var o=f(a,e.color),n=a.cols-1,d=80/n;for(s=0;n>s;s++)r.series.push({name:a.header[s].title,type:"pie",selectedMode:"single",radius:[s*d+(s>0?0:5)+"%",(s+1)*d+"%"],data:x(a.data,s,n,o),label:{normal:{show:3>n,position:"inner"}},itemStyle:{normal:{borderColor:"#fbfbfb",borderWidth:1,opacity:1-.2*(s/n)},emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}})}else if(2==a.cols)r.legend={orient:"vertical",x:"left",data:l(a.data,0)},r.series=[{name:a.header[0].title,type:e.type,selectedMode:"single",radius:[0,"30%"],data:p(a.data,0,2),itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}],e.circle||(r.series[0].radius=[0,"60%"],r.series[0].center=["50%","50%"]);else if(1==a.cols){r.legend={show:!1,orient:"vertical",x:"left",data:a.header[0].title};var u;a.data.map(function(e,t){u.push({value:Number.parseFloat(e).toFixed(2),name:"数据"+(t+1)})}),r.series=[{name:a.header[0].title,type:e.type,selectedMode:"single",radius:[0,"30%"],data:u,itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}],e.circle||(r.series[0].radius=[0,"60%"],r.series[0].center=["50%","50%"])}return a.cols<3&&(elem.data.length<=6?(r.series[0].label={normal:{position:"inner"}},r.series[0].labelLine={normal:{show:!1}}):r.series[0].labelLine={normal:{show:!0,length2:10,length:15}}),r}function b(e){var a=t(e.url),r=[];if(r.title=a.title,r.subTitle=a.source,r.rows=a.rows,r.series=[],0===a.rows)return r;if(3==a.cols)r.legend={orient:"vertical",x:"left",data:l(a.data,0).concat(l(a.data,1))},r.series=[{name:a.header[0].title,type:e.type,selectedMode:"single",radius:[0,"35%"],data:p(a.data,0,2),itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}},{name:a.header[1].title,type:e.type,radius:["50%","70%"],data:p(a.data,1,2),itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}],e.circle||(r.series[0].radius=[0,"50%"],r.series[1].radius=[0,"50%"],r.series[0].center=["25%","50%"],r.series[1].center=["75%","50%"]),"0"!=e.roseType&&(r.series[0].roseType=e.roseType,r.series[0].radius=["10%","50%"],r.series[0].center=["25%","50%"],r.series[1].roseType=e.roseType,r.series[1].radius=["10%","50%"],r.series[1].center=["75%","50%"]);else if(2==a.cols)r.legend={orient:"vertical",x:"left",data:l(a.data,0)},r.series=[{name:a.header[0].title,type:e.type,selectedMode:"single",radius:[0,"30%"],data:p(a.data,0,1),itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}],e.circle||(r.series[0].radius=[0,"60%"],r.series[0].center=["50%","50%"]);else if(1==a.cols){r.legend={show:!1,orient:"vertical",x:"left",data:a.header[0].title};var i;a.data.map(function(e,t){i.push({value:Number.parseFloat(e).toFixed(2),name:"数据"+(t+1)})}),r.series=[{name:a.header[0].title,type:e.type,selectedMode:"single",radius:[0,"30%"],data:i}],e.circle||(r.series[0].radius=[0,"60%"],r.series[0].center=["50%","50%"])}return r.series.map(function(e,t){e.data.length<=6?(r.series[t].label={normal:{position:"inner"}},r.series[t].labelLine={normal:{show:!1}}):r.series[t].labelLine={normal:{show:!0,length2:10,length:15}}}),r}function g(e,t,a){var r=[],i={normal:{width:1,opacity:.5}},s={};return"undefined"!=typeof t.data?(t.data.map(function(e){s[e]=[]}),e.map(function(e){s[e[0]].push(e.slice(1,e.length))}),t.data.map(function(e,t){r.push({name:e,type:a,lineStyle:i,data:s[e]})})):r.push({name:"平行坐标",type:a,lineStyle:i,data:e}),r}function w(e,t){for(var a=-1,r=e.length-1,i=r;null!=e[i]&&-1==a;i--)if(e[i].name==t)return a=i;return a}function v(e,t,a){if(t.length-1==a.deepLevel)return e;var r=t[a.deepLevel],i=w(e,r);return-1==i?(e.push({name:r,value:a.value}),i=e.length-1,t.length-2>a.deepLevel&&(e[i].children=[])):(e[i].value+=a.value,null==e[i].children&&t.length-2>a.deepLevel&&(e[i].children=[])),a.deepLevel++,t.length-1>a.deepLevel&&(e[i].children=v(e[i].children,t,a)),e}function A(e){var t,a=[],r=e[0].length-1;return e.map(function(e){t={value:Number.parseFloat(e[r]),deepLevel:0},a=v(a,e,t)}),a}function S(e){var t={};return e.map(function(e){isNaN(t[e[0]])&&(t[e[0]]=[]);for(var a=[],r=1;r<e.length;r++)a.push(Number.parseFloat(e[r]).toFixed(2));t[e[0]].push(a)}),t}function k(e){var t={radarIndicator:[],series:[],legend:{}},a=0,r=u(e.data[0]);r.length>0&&0===r[0]&&(t.legend={data:l(e.data,0),orient:"vertical",left:"left"},a=1);for(var i=a;i<e.cols;i++){var s=d(e.data,i);s.max=1.1*s.max,t.radarIndicator.push({name:e.header[i].title,max:s.max.toFixed(0)})}if(a){var o=S(e.data);for(var n in o)t.series.push({name:n,type:"radar",symbol:"none",areaStyle:{normal:{opacity:.3}},lineStyle:{normal:{width:1,opacity:.5}},data:o[n]})}else t.series.push({name:e.title,type:"radar",symbol:"none",areaStyle:{normal:{opacity:.3}},lineStyle:{normal:{width:1,opacity:.5}},data:e.data});return t}function T(e){var a=t(e.url),r=[];if(r.title=a.title,r.subTitle=a.source,r.rows=a.rows,r.series=[],r.legend=[],r.visualMap=[],r.parallelAxis=[],1===a.cols||0===a.rows)return r;var i=u(a.data[0]),s=0;if(i.length>0&&0===i[0]){var o=l(a.data,0);r.legend={top:20,data:o,itemGap:20,x:"10",top:"20",width:"500",textStyle:{color:"#aaa",fontSize:14}},s=1,o.length<2&&(r.legend.show=!1)}0===s&&(r.legend.show=!1);for(var n=s;n<a.cols;n++){var h=d(a.data,n);r.parallelAxis.push({dim:n-s,name:a.header[n].title,max:h.max,min:h.min})}for(n=s;n<i.length;n++)r.parallelAxis[i[n]-s].type="category",r.parallelAxis[i[n]-s].data=l(a.data,i[n]);return h=d(a.data,e.dimension),r.visualMap={show:!1,min:h.min,max:h.max,dimension:e.dimension-s,calculable:!0,inRange:{color:["#e92312","#a2ca36","#50a3ba"].reverse()}},r.series=g(a.data,r.legend,e.type),r}function N(e){function a(){return[{itemStyle:{normal:{borderWidth:0,gapWidth:3,borderColor:"black"}}},{itemStyle:{normal:{gapWidth:2,borderColor:"black"}}},{colorSaturation:[.25,.4],itemStyle:{normal:{gapWidth:1,borderColor:"black"}}}]}var r=t(e.url);if(0===r.rows)return!1;var i={title:r.title,subTitle:r.source,rows:r.rows,series:[{name:r.header[r.cols-1].title,type:e.type,label:{show:!0,formatter:"{b}"},squareRatio:e.squareRatio,width:"100%",height:"90%",top:55,itemStyle:{normal:{borderColor:"black"}},levels:a(),data:A(r.data)}]};return i}function F(e){var a=t(e.url);if(0===a.rows||a.cols<3)return!1;var r=k(a),i={title:a.title,subTitle:a.source,rows:a.rows,radarIndicator:r.radarIndicator,series:r.series,legend:r.legend};return i}function L(e,t){var a={};e.data.map(function(e){"undefined"==typeof a[e[0]]&&(a[e[0]]={name:e[0],type:"scatter",symbolSize:function(e){var a=t*e[1];return a.toFixed(0)},data:[]});for(var r=[],i=1;i<e.length;i++)r.push(Number.parseFloat(e[i]).toFixed(2));a[e[0]].data.push(r)});var r=[];for(var i in a)r.push(a[i]);return r}function M(e){var a=t(e.url);if(0===a.rows||1===a.cols||a.cols<=2&&isNaN(a.data[0][0]))return!1;var r=isNaN(a.data[0][0]),i={title:a.title,subTitle:a.source,rows:a.rows,xAxisName:r?a.header[1].title:a.header[0].title,yAxisName:r?a.header[2].title:a.header[1].title};if(r){i.legend={data:l(a.data,0),left:"left"};var s=d(a.data,2),o=e.scatterSize/s.max;i.series=L(a,o)}else{var s=d(a.data,1),o=e.scatterSize/s.max;i.series={type:"scatter",symbolSize:function(e){var t=o*e[1];return t.toFixed(0)},data:a.data}}return i}function C(e){for(var t={nodes:[],links:[],linkName:[]},a={nodes:[],links:[]},r=e.header.length,i=0;r-1>i;i++)i==r-2&&(t.linkName=t.nodes),t.nodes=t.nodes.concat(l(e.data,i));t.linkName.map(function(e){t.links[e]={}}),e.data.map(function(e){for(var a=0;r-2>a;a++)isNaN(t.links[e[a]][e[a+1]])?t.links[e[a]][e[a+1]]=Number.parseFloat(e[r-1]):t.links[e[a]][e[a+1]]+=Number.parseFloat(e[r-1])}),t.nodes.map(function(e){a.nodes.push({name:e})});for(var s in t.links)for(var o in t.links[s])a.links.push({source:s,target:o,value:t.links[s][o]});return a}function W(e){var a=t(e.url);if(0===a.rows||a.cols<=2)return!1;var r={title:a.title,subTitle:a.source,rows:a.rows,series:C(a)};return r}function O(e,t){for(var a=JSON.stringify(e),r=!1,i=t.length,s=0;i>s&&!r;s++)a==JSON.stringify(t[s])&&(r=!0);return r||t.push(e),t}function z(e){for(var t={nodes:[],nodesName:[],links:[]},a={categories:[],nodes:[],links:[],legend:[]},r=[],i=e.header.length,s=0,o=90/i,n=[],d=0;i-1>d;d++){var u=o*(i-d);n[d]=u.toFixed(0)}return a.legend=l(e.data,0),a.legend.map(function(o,d){a.categories.push({name:o}),r[o]=d,t.nodesName[d]=[],t.nodes[d]=[];for(var u=0;i-1>u;u++){var h=l(e.data,u,o,0);h.map(function(e,a){t.nodes[d][e]={name:e,value:0,category:d,id:s,symbolSize:n[u]},s++})}}),e.data.map(function(e){for(var a=0;i-2>a;a++){var s=r[e[0]],o=e[a],l=e[a+1];t.links.push({source:t.nodes[s][o].id,target:t.nodes[s][l].id}),t.nodes[s][o].value+=Number.parseFloat(e[i-1])}t.nodes[r[e[0]]][e[a]].value+=Number.parseFloat(e[i-1])}),t.nodes.map(function(e){for(var t in e)a.nodes.push(e[t])}),a.links[0]=t.links[0],t.links.map(function(e){a.links=O(e,a.links)}),a}function I(e){var a=t(e.url);if(0===a.rows||a.cols<=2)return!1;var r={title:a.title,subTitle:a.source,rows:a.rows,series:z(a)};return r}var B;switch(a.type){case"bar":case"line":B=h(a);break;case"boxplot":B=c(a);break;case"pie":case"funnel":B=b(a);break;case"sunrise":B=y(a);break;case"parallel":B=T(a);break;case"treemap":B=N(a);break;case"radar":B=F(a);break;case"scatter":B=M(a);break;case"sankey":B=W(a);break;case"graph":B=I(a)}return B},s=function(e){var t={title:[{text:a.title,subtext:a.subTitle,x:"center"},{text:"©成都印钞有限公司 技术质量部",borderColor:"#999",borderWidth:0,textStyle:{fontSize:14,fontWeight:"normal"},x2:10,y2:5}],grid:{left:"5%",right:"5%",top:"10%",bottom:"10%",containLabel:!0},toolbox:{show:e.toolbox,feature:{mark:{show:!0},dataView:{show:!0,readOnly:!1},dataZoom:{show:!0},magicType:{show:!0,type:["line","bar","stack","tiled"]},restore:{show:!0},saveAsImage:{show:!0}}},calculable:!0,tooltip:{backgroundColor:"#009688",trigger:"item"},dataZoom:[{type:"inside",realtime:!0,start:0,end:100},{show:"h"==e.dataZoom||"vh"==e.dataZoom,realtime:!0,start:0,end:100,height:20,y2:25},{show:"v"==e.dataZoom||"vh"==e.dataZoom,yAxisIndex:0,filterMode:"empty",width:12,height:"70%",handleSize:8,showDataShadow:!1,right:5}],legend:{data:a.legend,x:"center",y:70,itemGap:20,textStyle:{fontSize:16},show:!(a.legend.length<=1)},xAxis:[{name:a.xAxisTitle,axisTick:{show:!1},type:"category",boundaryGap:"line"!=e.type,data:a.xAxis}],yAxis:[{name:a.yAxisTitle,type:"value",position:"left",scale:!0,axisLabel:{show:!0,interval:"auto",margin:8},axisTick:{show:!1}}],series:a.series};if("boxplot"==e.type&&(t.title[2]={text:"上边缘: Q3 + 1.5 * IRQ \n下边缘: Q1 - 1.5 * IRQ\nIRQ: Q3-Q1",borderColor:"#999",borderWidth:1,textStyle:{fontSize:14},x2:10,y:30},e.minMax&&(t.title[2].text="上边缘: 最大值 \n下边缘: 最小值")),e.reverse){var r;r=t.xAxis,t.xAxis=t.yAxis,t.yAxis=r}return t},o=function(e){var t={title:[{text:a.title,subtext:a.subTitle,x:"center"},{text:"©成都印钞有限公司 技术质量部",borderColor:"#999",borderWidth:0,textStyle:{fontSize:14,fontWeight:"normal"},x2:10,y2:5}],tooltip:{backgroundColor:"#009688",trigger:"item",formatter:"{a} <br/>{b}: {c} ({d}%)"},grid:{left:"5%",right:"5%",top:"10%",bottom:"10%",containLabel:!0},toolbox:{show:e.toolbox,feature:{mark:{show:!0},dataView:{show:!0,readOnly:!1},restore:{show:!0},saveAsImage:{show:!0}}},calculable:!0,legend:a.legend,series:a.series};return"funnel"==e.type&&(t.series.length>1?(t.series[0].width="60%",t.series[0].height="40%",t.series[0].left="20%",t.series[0].top="10%",t.series[0].label={normal:{position:"inner"}},t.series[0].labelLine={normal:{show:!1}},t.series[1].width="60%",t.series[1].height="40%",t.series[1].left="20%",t.series[1].top="50%",t.series[1].sort="ascending",t.series[1].label={normal:{position:"inner"}},t.series[1].labelLine={normal:{show:!1}}):(t.series[0].width="60%",t.series[0].height="60%",t.series[0].left="20%",t.series[0].top="20%",t.series[0].sort="ascending",t.series[0].label={normal:{position:"inner"}},t.series[0].labelLine={normal:{show:!1}})),t},l=function(e){var t={backgroundColor:"#445",title:[{text:a.title,subtext:a.subTitle,x:"center",textStyle:{color:"#bbb"}},{text:"©成都印钞有限公司 技术质量部",borderColor:"#999",borderWidth:0,textStyle:{fontSize:14,fontWeight:"normal",color:"#aaa"},x2:10,y2:5}],toolbox:{show:!0,feature:{dataView:{readOnly:!1},restore:{},saveAsImage:{}}},parallel:{left:"50",right:"50",top:120,parallelAxisDefault:{type:"value",nameLocation:"start",nameGap:20,nameTextStyle:{color:"#aaa",fontSize:12},axisLine:{lineStyle:{color:"#aaa"}},axisTick:{lineStyle:{color:"#aaa"}},splitLine:{show:!1},axisLabel:{textStyle:{color:"#aaa"}}}},parallelAxis:a.parallelAxis,visualMap:a.visualMap,legend:a.legend,series:a.series};return t},n=function(e){var t=function(){this.encodeHTML=function(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")},this.addCommas=function(e){return isNaN(e)?"-":(e=(e+"").split("."),e[0].replace(/(\d{1,3})(?=(?:\d{3})+(?!\d))/g,"$1,")+(e.length>1?"."+e[1]:""))}},r=(new t,{title:[{text:a.title,subtext:a.subTitle,x:"center"},{text:"©成都印钞有限公司 技术质量部",borderColor:"#999",borderWidth:0,textStyle:{fontSize:14,fontWeight:"normal"},x2:5,y2:2}],toolbox:{show:!0,feature:{dataView:{readOnly:!1},restore:{},saveAsImage:{}}},tooltip:{backgroundColor:"#009688",formatter:function(e){for(var t=e.value,a=e.treePathInfo,r=[],i=1;i<a.length;i++)r.push(a[i].name);return r.join("/")+"<br>"+a[0].name+": "+t}},series:a.series});return r},d=function(e){var t={title:[{text:a.title,subtext:a.subTitle,x:"center"},{text:"©成都印钞有限公司 技术质量部",borderColor:"#999",borderWidth:0,textStyle:{fontSize:14,fontWeight:"normal"},x2:5,y2:2}],toolbox:{show:!0,feature:{dataView:{readOnly:!1},restore:{},saveAsImage:{}}},tooltip:{backgroundColor:"#009688"},legend:a.legend,radar:{indicator:a.radarIndicator,shape:e.shape,name:{textStyle:{color:"#555"}},splitLine:{lineStyle:{color:"#bbb"}},center:["50%","58%"],radius:"75%",splitArea:{show:!1}},series:a.series};return t},u=function(e){var t={title:[{text:a.title,subtext:a.subTitle,x:"center"},{text:"©成都印钞有限公司 技术质量部",borderColor:"#999",borderWidth:0,textStyle:{fontSize:14,fontWeight:"normal"},x2:5,y2:2}],grid:{left:"5%",right:"5%",top:"10%",bottom:"10%",containLabel:!0},toolbox:{show:!0,feature:{mark:{show:!0},dataView:{show:!0,readOnly:!1},dataZoom:{show:!0},restore:{show:!0},saveAsImage:{show:!0}}},tooltip:{trigger:"axis",showDelay:0,formatter:function(e){return e.value.length>1?e.seriesName+" :<br/>"+e.value[0]+" , "+e.value[1]+" ":e.seriesName+" :<br/>"+e.name+" : "+e.value},axisPointer:{show:!0,type:"cross",lineStyle:{type:"dashed",width:1}}},dataZoom:[{type:"inside",realtime:!0,start:0,end:100},{show:!1,realtime:!0,start:0,end:100,height:20,y2:25},{type:"inside",yAxisIndex:0,realtime:!0,start:0,end:100},{show:!1,yAxisIndex:0,filterMode:"empty",width:12,height:"70%",handleSize:8,showDataShadow:!1,right:5}],xAxis:[{name:a.xAxisName,type:"value",axisTick:{show:!1},boundaryGap:!1,scale:!0,axisLabel:{show:!0},axisLine:{show:!0}}],yAxis:[{name:a.yAxisName,type:"value",scale:!0,position:"left",axisLabel:{show:!0,interval:"auto",margin:8},axisTick:{show:!1},axisLine:{show:!0}}],legend:a.legend,series:a.series};return t},h=function(e){var t={title:[{text:a.title,subtext:a.subTitle,x:"center"},{text:"©成都印钞有限公司 技术质量部",borderColor:"#999",borderWidth:0,textStyle:{fontSize:14,fontWeight:"normal"},x2:5,y2:2}],grid:{left:"5%",right:"5%",top:"10%",bottom:"10%",containLabel:!0},toolbox:{show:!0,feature:{dataView:{show:!0,readOnly:!1},restore:{show:!0},saveAsImage:{show:!0}}},tooltip:{trigger:"item",triggerOn:"mousemove"},series:{type:e.type,data:a.series.nodes,links:a.series.links,layout:"none",itemStyle:{normal:{borderWidth:1,borderColor:"#aaa"}},lineStyle:{normal:{curveness:.5,opacity:.5}}}};return t},m=function(e){var t={title:[{text:a.title,subtext:a.subTitle,x:"center"},{text:"©成都印钞有限公司 技术质量部",borderColor:"#999",borderWidth:0,textStyle:{fontSize:14,fontWeight:"normal"},x2:5,y2:2}],grid:{left:"5%",right:"5%",top:"10%",bottom:"10%",containLabel:!0},toolbox:{show:!0,feature:{dataView:{show:!0,readOnly:!1},restore:{show:!0},saveAsImage:{show:!0}}},legend:{data:a.series.legend,x:"center",y:70,itemGap:20,textStyle:{fontSize:16}},tooltip:{},series:{name:"关系图",type:e.type,layout:"1"==e.force?"force":"circular",label:{normal:{position:"right",formatter:"{b}"}},draggable:!0,nodes:a.series.nodes,categories:a.series.categories,force:{gravity:.07,edgeLength:100,repulsion:150},links:a.series.links}};return t},c=function(e){if(a=r(e),0==a.rows)return!1;var t;switch(e.type){case"bar":case"line":case"boxplot":t=s(e);break;case"pie":case"funnel":case"sunrise":t=o(e);break;case"parallel":t=l(e);break;case"treemap":t=n(e);break;case"radar":t=d(e);break;case"scatter":t=u(e);break;case"sankey":t=h(e);break;case"graph":t=m(e)}return t};return{getOption:c}});
>>>>>>> 3d7e5ece247f15c0562572daab551c9982678122
//# sourceMappingURL=chartDataTool.min.js.map